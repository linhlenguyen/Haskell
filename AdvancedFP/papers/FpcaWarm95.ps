%!PS-Adobe-2.0
%%Creator: dvipsk 5.58c Copyright 1986, 1994 Radical Eye Software
%%Title: warm3.dvi
%%Pages: 10
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%EndComments
%DVIPSCommandLine: dvips -o warm-final.ps warm3.dvi
%DVIPSParameters: dpi=300, compressed, comments removed
%DVIPSSource:  TeX output 1995.04.10:1356
%%BeginProcSet: texc.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]/id ch-image N /rw ch-width 7 add 8 idiv string N /rc 0 N /gp 0 N
/cp 0 N{rc 0 ne{rc 1 sub /rc X rw}{G}ifelse}imagemask restore}B /G{{id
gp get /gp gp 1 add N dup 18 mod S 18 idiv pl S get exec}loop}B /adv{cp
add /cp X}B /chg{rw cp id gp 4 index getinterval putinterval dup gp add
/gp X adv}B /nd{/cp 0 N rw exit}B /lsh{rw cp 2 copy get dup 0 eq{pop 1}{
dup 255 eq{pop 254}{dup dup add 255 and S 1 and or}ifelse}ifelse put 1
adv}B /rsh{rw cp 2 copy get dup 0 eq{pop 128}{dup 255 eq{pop 127}{dup 2
idiv S 128 and or}ifelse}ifelse put 1 adv}B /clr{rw cp 2 index string
putinterval adv}B /set{rw cp fillstr 0 4 index getinterval putinterval
adv}B /fillstr 18 string 0 1 17{2 copy 255 put pop}for N /pl[{adv 1 chg}
{adv 1 chg nd}{1 add chg}{1 add chg nd}{adv lsh}{adv lsh nd}{adv rsh}{
adv rsh nd}{1 add adv}{/rc X nd}{1 add set}{1 add clr}{adv 2 chg}{adv 2
chg nd}{pop nd}]dup{bind pop}forall N /D{/cc X dup type /stringtype ne{]
}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300 (warm3.dvi)
@start /Fa 2 20 df<1430146014C0EB0180EB03005B130E130C5B1338133013705B5B
12015B1203A290C7FC5A1206120EA2120C121CA312181238A45AA75AB3A31270A77EA412
18121CA3120C120EA2120612077E7FA212017F12007F13701330133813187F130E7F7FEB
0180EB00C014601430146377811F>18 D<12C012607E7E7E120E7E7E6C7E7F12007F1370
133013381318131CA2130C130E13061307A27F1480A3130114C0A4EB00E0A71470B3A314
E0A7EB01C0A414801303A314005BA21306130E130C131CA213181338133013705B5B1201
5B48C7FC5A120E120C5A5A5A5A14637F811F>I E /Fb 1 106 df<12301278A212301200
A312F81238A912FE07127F910A>105 D E /Fc 16 123 df<EA07F0EA1FFCEA381EEA30
071270A21278EA7E06EA3F8C13F86C5AEA0FFC487EEA38FFEA703F38E01F8013071303A2
1400EA7007EA3C0EEA1FFCEA07F011187E9716>56 D<90381FE0209038FFFCE03803F80F
3807C003381F800190C7FC123E007E1460127C00FC1400A8007C1460127E123E6C14C07F
3907C003803903F80F003800FFFCEB1FF01B1A7E9920>67 D<EA03FCEA0F0EEA1C1F123C
1278130E00F8C7FCA51278A2383C0180381C0300EA0F06EA03FC11117F9014>99
D<EA03F0EA0E1C487EEA3C071278148012F8A2B5FC00F8C7FCA21278A2383C0180381C03
00EA0E06EA03FC11117F9014>101 D<13FEEA03C738078F80EA0F0FA2EB070090C7FCA3
EAFFF0A2000FC7FCADEA3FE0A2111A80990E>I<12FCA2123CA7133EEBC780EA3D03003E
13C0A2123CAA38FF0FF0A2141A7E9919>104 D<123C127EA4123C1200A412FCA2123CAD
12FFA2081B7E9A0D>I<12FCA2123CB3A412FFA2081A7E990D>108
D<EAFC3EEBC780EA3D03003E13C0A2123CAA38FF0FF0A214117E9019>110
D<EA03F8EA0E0E383C0780EA3803007813C0A200F813E0A6007813C0EA7C07003C138038
0E0E00EA03F813117F9016>I<EAF8F0EAF938EA3A7CA2123C13381300A9EAFF80A20E11
7E9012>114 D<EA1FD8EA2078EA401812C0A2EAF000EAFF80EA7FE0EA3FF0EA07F8EA00
3CEAC00CA212E01308EAF830EACFE00E117F9011>I<1206A4120EA2121EEA3FF012FFEA
1E00A81318A5EA0F30EA03E00D187F9711>I<39FF1FE1F8A2393C078060001E14C014C0
EB0DC1000F1480EB1DE1390798E30014F3EBB0733803F076147EEBE03E0001133CA23800
C0181D117F9020>119 D<38FF03F0A2383E01C0001E1380EA1F03000F1300A2EA0786A2
EA03CCA213FC6C5AA26C5AA21360A2EA70C012F812F95B0077C7FC123C14187F9017>
121 D<EA7FFFEA781EEA703EEA603C137813F0120113E0EA03C0EA0780EA0F831303121E
EA3C06127CEA781EEAFFFE10117F9014>I E /Fd 6 111 df<13C3A4EA0186A3B512E0A2
38030C00A2EA0618A2B512E0A2380C3000A3485AA413167E9019>35
D<121FEA3180EA60C0EA4040EAC060A8EA4040EA60C0EA3180EA1F000B107F8F0F>48
D<1218127812981218AC12FF08107D8F0F>I<121FEA6180EA40C0EA806012C01200A213
C0EA0180EA030012065AEA10201220EA7FC012FF0B107F8F0F>I<EA01E0EA0060A5120F
EA30E0EA606012C0A51260EA30E0EA1F780D117F9011>100 D<EAF3C0EA3C601230A8EA
FCF80D0B7F8A11>110 D E /Fe 3 107 df<120CA2EACCC012EDEA7F80EA0C00EA7F80EA
EDC012CCEA0C00A20A0B7D8B10>3 D<1208121CA21238A312301270A21260A212C0A206
0D7E8D09>48 D<12C0B3A702197C9209>106 D E /Ff 15 121 df<EBFC203807036038
0C00E04813605A00701320126000E01300A600601320127012306C13406C138038070300
EA00FC13147E9318>67 D<B51280EA1C031300A21440A2130814001318EA1FF8EA1C1813
0814201300A21460144014C01301B5FC13147F9316>69 D<EAFFC0001CC7FCAB1440A314
C0148013011303B5FC12147F9315>76 D<38FC01FC381E00700017132013801213EA11C0
EA10E01370A21338131C130E130F1307EB03A0EB01E01300A20038136000FE132016147F
9319>78 D<387FFFF03860703000401310A200801308A300001300ACEA07FF15147F9318
>84 D<EA0F80EA1040EA2020EA6030EAC010EAFFF0EAC000A31260EA2010EA1820EA0FC0
0C0D7F8C0F>101 D<1220127012201200A512F01230AB12FC06157F9409>105
D<12F01230B212FC06147F9309>108 D<EAF3E0EA3430EA38181230A9EAFC7E0F0D7F8C
12>110 D<EA0FC0EA1860EA2010EA6018EAC00CA5EA6018A2EA3870EA0FC00E0D7F8C11>
I<EAF3E0EA3430EA3808EA300C1306A5130CEA3808EA3430EA33E0EA3000A512FC0F137F
8C12>I<EAF3C0EA34E01238EA30401300A812FE0B0D7F8C0D>114
D<EA3E80126112C0A2EAE000127EEA3F80EA03C01280A212C0EAE180EA9F000A0D7F8C0D
>I<1210A312301270EAFF80EA3000A71380A3EA1100120E09127F910D>I<EAF87CEA3030
EA1860EA0C401380EA07007EEA0780EA0CC0EA08601210EA3030EAF07C0E0D7F8C11>
120 D E /Fg 11 118 df<EA01F9EA0607EA0803EA1002A213001218EA0F80EA03F0EA00
381308A21240A21310EAE060EA9F8010117D9013>83 D<383FFFC0EA30600040134013C0
1280A200001300485AA448C7FCA41206EA3FE012117E9012>I<12781218A25AA31237EA
78C0EA60401360A2EAC0C0A3EA4180EA6300123C0B117E900E>98
D<EA0390EA0C70EA18301230A2EA6060A3EA20E0EA31C0121E1200A2EA4180EAC300127E
0C107E8A0F>103 D<1204120C1200A5123012581298A21230A212601264A21268123006
127E910B>105 D<123C120CA25AA31370EA3190EA3230EA34001238127FEA61801390A2
EAC1A0EAC0C00C117E9010>107 D<12781218A21230A41260A412C0A212C8A212D01260
05117E900A>I<EA71F0EA9A18129C12981218EA3030A213321362EA606413380F0B7E8A
13>110 D<120FEA10801221EA2000123E7EEA01801280EAC0001283127C090B7D8A0F>
115 D<12081218A312FF1230A41260A212621264A21238080F7E8E0C>I<EA3810EA4830
128C12981218EA3060A2136413E4EA31E8EA0E380E0B7E8A12>I
E /Fh 21 118 df<131CA2133EA2136FA2EBEF8013C700017F1383A2380301E013FF487F
EA0600000E1378120C001C137C39FF01FF80A219147F931C>65 D<EBFF0C000313DC380F
C07C381F003C003C131C007C130C127800F81300A60078130C127C003C131C001F131838
0FC0703803FFE0C6130016147E931B>67 D<B512E0A2EA1E01EB006014701430130C1400
131CEA1FFCA2EA1E1C130CA290C7FCA4EAFFE0A214147E9318>70
D<EAFFC0A2EA1E00B0EAFFC0A20A147E930E>73 D<EAFFE0A2001EC7FCAA14C0A21301A2
EB03801307B5FCA212147E9316>76 D<00FE13FF7E381F8018EA1BC013E01219EA18F013
78133C131E131F130FEB0798EB03D8EB01F81300A21478B41338141818147E931D>78
D<B5FC14C0381E01F0130014F8A414F0EB03E0381FFFC0001EC7FCA7EAFFC0A215147E93
1A>80 D<387FFFFCA238703C1C0060130C00E0130E00C01306A200001300AB3803FFC0A2
17147F931A>84 D<39FF803F80A2391E000C00001F131C6C1318EB803800071330A26C6C
5AA26C6C5AA23800F180A2017BC7FCA2133EA2131CA219147F931C>86
D<EA1FE0EA78707F133C1230EA01FCEA1F3C127812F0A338785F80EA3F8F110D7F8C12>
97 D<133FA2130FA5EA07EFEA1C1F487E127012F0A512701238381C3FC0EA07EF12147F
9315>100 D<EA0FC0EA1C70EA3838EA7018EAF01CA2EAFFFCEAF000A21270EA380CEA1C
18EA07F00E0D7F8C11>I<1238127CA312381200A312FCA2123CA912FFA208157F940B>
105 D<12FCA2123CB012FFA208147F930B>108 D<38FC7C1F39FD8E6380393E0F83C000
3C1303A839FF3FCFF0A21C0D7F8C1F>I<EAFC7CEAFD8EEA3E0F123CA838FF3FC0A2120D
7F8C15>I<EA07E0EA1C38EA781EEA700EEAF00FA5EA700EEA781EEA3C3CEA07E0100D7F
8C13>I<EAFDF8EAFF0EEA3C07EB038014C0A5EB07801400EA3E0EEA3DF8003CC7FCA4B4
FCA212137F8C15>I<EAF8E0EAF978123AA2EA3C301300A6B4FCA20D0D7F8C10>114
D<EA1FE01260EAC060A2EAFE00EA7FC0EA3FE0EA1FF0EA0070EAC030A2EAF060EADF800C
0D7F8C0F>I<EAFC3FA2EA3C0FA85B381C3FC0EA0FCF120D7F8C15>117
D E /Fi 19 107 df<B512FEA217027D891E>0 D<6C13C0EAC00138600300EA30066C5A
6C5A6C5A6C5A6C5AA2EA0360EA0630487E487E487E487E38C001C0EA800012127A911E>
2 D<EA0780EA1FE0EA3870EA6018A2EAC00CA6EA6018A2EA3870EA1FE0EA07800E107E90
13>14 D<EA0780EA1FE0EA3FF0EA7FF8A2EAFFFCA6EA7FF8A2EA3FF0EA1FE0EA07800E10
7E9013>I<D80F801380EA3FE0487E38707801EAC01C90380F0700486CB4FC6D5AEB00F8
19097E8D1E>24 D<4A7EA26E7EA21560A2818181B71280A2C8EA0C005D5D5DA25DA24A5A
A221147E9226>33 D<141880A280140780B612C081C81238151EED0780ED0E0015385DB6
12C05DC70003C7FC1406A25CA25C21167E9326>41 D<EB7FE0EA03FF38078000000CC7FC
5A5AA25AA25AA2B512E0A200C0C7FCA21260A27EA27E7EEA07803803FFE0EA007F13187D
941A>50 D<1460A214C0A2EB0180A2EB0300A213065BA25BA25BA25BA25BA2485AA248C7
FCA21206A25A5AA25AA25AA25A124013227B9900>54 D<12C0A612E0A212C0A6030E7E8F
00>I<0040131000C0133000601360A36C13C0A338180180EA1FFF6C1300EA0C03A2EA06
06A36C5AA2EA0198A3EA00F0A31360A2141A809915>I<380181F0380787F8380F98FC38
07B07CEBE03CEBC038A2380F80701440EB0180EB0E00EB3FC0380E7FE0381E03F0EB01F8
EA1C001478123CA200381370A24813E00073138038F78300EAEFFCEA87F0161A7E9919>
66 D<EB07E0EB1FF0136113C0380180E00003138000071300A37F13F0EA03FCEA00F000
03C7FC12065A5A12385AA238F00180EB0300EAF804EAFE18EA7FF0EA1F80141A7F9914>
69 D<EBFFF8000313FE380C787F0030EB1F800070130F00E01307EAC0700000140013F0
140EA2495A141000011360EBE780497E13C73803C3E01383138100077F01011318903800
F830000EEBFC40EC7F800018EB3E001D1A7E9921>82 D<0040130800C01318B000601330
6C1360381E03C0380FFF803801FC0015167E951A>91 D<124012C0ABB512C0A200C0C7FC
AB1240121A7E9917>96 D<133C13E0EA01C0EA0380ADEA0700121E12F8121E1207EA0380
ADEA01C0EA00E0133C0E257E9B13>102 D<12F8121E1207EA0380ADEA01C0EA00E0133C
13E0EA01C0EA0380ADEA0700121E12F80E257E9B13>I<12C0B3B302257C9B0B>106
D E /Fj 39 123 df<EA01F038070C08380C0E10EA1807123000701320126000E01340A2
14801400A3EA601B383063A0380F81C015107F8F19>11 D<EB03C0EB0C301310EB203813
401380EA0100A2000213701460EB1FC0131138041F60EB0070A35AA31460001813E014C0
EB018038140300EA230EEA20F890C7FCA25AA45A1521809916>I<120FEA03807F1201A2
7F1200A27F1370A213781338A2133C137C13DEEA018EEA030EEA060F487E121C00381380
EA700312E038C001C0121A7E9916>21 D<126012F0A2126004047D830B>58
D<126012F0A212701210A31220A21240A2040B7D830B>I<12E01278121EEA0780EA01E0
EA0078131EEB0780EB01E0EB0078141EA21478EB01E0EB0780EB1E001378EA01E0EA0780
001EC7FC127812E017167D931E>62 D<903807E04090383C18C0EBE0053801C003390380
0180EA0700120E5A003C14001238007890C7FCA25AA41404A35C00705B1230003813606C
1380D80703C7FCEA01FC1A1A7E991B>67 D<0003B512C038007001140015405BA43901C0
2000A3146048B45A13801440A248485A1401A21402120E14061404140C481338B512F81A
1A7E991C>69 D<0003B512C038007001140015405BA43901C02000A3146048B45A138014
40A248485A91C7FCA3120EA4121EEAFFE01A1A7E9919>I<EA03FFEA0070A313E0A4EA01
C0A4EA0380A4EA0700A4120EA45AEAFFC0101A7E9911>73 D<3803FFFC3800700FEC0380
A201E013C0A43901C00780A2EC0F00141E38038038EBFFE00180C7FCA248C8FCA4120EA4
5AEAFFC01A1A7E9919>80 D<EB0FE0EB3838EBE00E48487EEA0780D80F001380000E1303
5A003C14C012381278A248EB0780A315005C140E141E141C38707038EB8070383904E038
1D07C0D80F0FC7FC3803FC04EA0006140C5CEB07F85C5C6D5A1A217E991E>I<EB1F08EB
60D8EB8038EA01004813101206A31400120713C0EA03FC6CB4FC38007F80EB0FC01301A2
13001220A238600180A2EB0300EA7006EACC1CEA83F0151A7E9917>83
D<003FB5128038380E010020130012405B1280A348481300A45BA45BA4485AA41203EA7F
FC191A7F9916>I<39FF801FE0391C000700140614045C121E000E5B5CA25C14C05CD80F
01C7FC120713025BA25B5BEA039013A013C0A25BA290C8FC1B1A7E9916>86
D<EA03E6EA0617EA1C0E123812301270EA601C12E0A3133912C012E0EA6079EA219AEA1E
0E10107F8F14>97 D<127E120EA35AA45AA2EA39E0EA3E10EA7818EA701C130C131C12E0
A313181338EAC030EAE070EA60E0EA2180EA1F000E1A7F9910>I<EA01F0EA070C120CEA
181CEA3008EA7000126012E0A413041308EA6010EA3060EA0F800E107F8F11>I<EB0FC0
1301A3EB0380A4EB0700A2EA03E7EA0617EA1C0E123812301270EA601C12E0A3133912C0
12E0EA6079EA219AEA1E0E121A7F9914>I<EA01F0EA0608EA1C04123812701308EAFFF0
EAE000A41304EA60081310EA3060EA0F800E107F8F12>I<EB07C0EB0C60EB1CE0EB18C0
EB3800A45BA2EA07FFEA0070A25BA5485AA6485AA390C7FCA2126712E65A127813217E99
13>I<EBF980380185C038070380120E120C121C381807001238A3130E12301238EA181E
EA087CEA079CEA001CA25B1260EAE070485AEA7F801217808F12>I<EA1F801203A348C7
FCA4120EA2133E13C7381D0380121E121CA238380700A3130E00701340A2131C1480EAE0
0C38600700121A7F9916>I<120313801300C7FCA7123C124EA2128EA2129C121CA25AA2
12391271A21272A2123C091A7E990D>I<EA1F801203A348C7FCA4120EA21307EB1980EA
1C231341EB8000001DC7FC123EEA3FC0EA38E01370EA7071A31372EAE032EA601C111A7F
9914>107 D<123F1207A3120EA4121CA41238A41270A412E2A312E412641238081A7F99
0B>I<39383E0F80394CC330C0398F03C0E0A2008E1380A2391C0701C0A3EC0380D8380E
1388A2EC0708151039701C032039300C01C01D107E8F22>I<EA703EEA58C7389D038012
9E129CA238380700A3130E00701340A2131C1480EAE00C3860070012107E8F17>I<EA01
F0EA070CEA0C06EA180712301270126012E0A21306130E130C1318EA6030EA30E0EA0F80
10107F8F13>I<38070780380598403809E060EBC07014301470EA0380A31460380700E0
14C01301EB0380380E8600137C90C7FCA25AA4B4FC1417828F13>I<EA30F0EA5918EA9E
38EA9C181300A25AA45AA45A12600D107E8F11>114 D<EA03E0EA06181208EA18381330
EA1C00EA1FC0EA0FE0EA07F0EA0070133012E0A2EA8060EA40C0EA3F000D107E8F12>I<
1206120EA45AA2EAFFE0EA1C005AA45AA4EAE080A2EAE100A2126612380B177E960E>I<
EA3803004C1380384E0700128E129CA2EA1C0E1238A338701C80A3EA303C38184D00EA0F
8711107E8F16>I<EA380CEA4C0E124EEA8E06129CA2EA1C041238A213081270A2EA3010
EA3820EA1840EA0F800F107E8F13>I<381C0306002613873847070700871303128EA238
0E0E02121CA338381C04A200181308001C1310380C26303807C3C018107E8F1C>I<3807
87803808C8C0EA10F1EA20E01400A2EA01C0A4EA0381A212C3EAE582EAC584EA78781210
7F8F16>I<EA3803004C1380384E0700128E129CA2EA1C0E1238A3485AA3EA303C6C5AEA
0FB8EA00385B1260EAE0E0485AEA4380003EC7FC11177E8F13>I<EA0381EA07C2EA0FFC
EA10041308EA003013401380EA01001202EA0C041210EA200CEA3FF8EA41F0EA80E01010
7F8F12>I E /Fk 50 123 df<EB03FEEB0E03EB1C07EB1806EB3800A35BA33807FFFC38
00701CEBE038A41470EA01C0A314E4A2EA0380A21468143090C7FC5AA2126612E65A1278
1821819916>12 D<903803FB80EB0E0FEB1C1FEB181B9038380700A31370140EA23807FF
FE3800700E495AA45CEA01C0A31472A2EA0380A21434141890C8FC5AA2126612E65A1278
1921819917>I<121812381278123812081210A21220A212401280050B7D830C>44
D<EAFF80A2130009037D880E>I<1308131813301370EA01F0EA0E70EA00E0A4EA01C0A4
EA0380A4EA0700A45AEAFFE00D187C9714>49 D<1206120F121E120C1200A81230127812
F0126008107C8F0C>58 D<EA01E0EA0610EA081812101220A21240EA6030EAE0F0EA61E0
EA03C0EA0F80EA0E005AEA1880EA1900121B120CC7FCA41218123C5A12300D1A799914>
63 D<1420146014E0A2130114F0EB0270A213041308A21310A213201340A2EB8038EBFF
F8380100381202A25AA25A121838FE01FF181A7E991D>65 D<3803FFF83800700E140614
0713E0A43801C00E141C143814703803FFE0EB80781438141CEA0700A4000E1338A21470
14E0381C03C0B51200181A7D991B>I<EB0F82EB7062EBC0163803801E3807000C120E5A
121800381308123000701300A25AA41420A314401260148038300100EA1006EA0C18EA03
E0171A7A991B>I<3803FFF83800700E80809038E00180A315C0EA01C0A43903800380A3
150048485AA2140E140C000E131C5C5C5C381C0380D8FFFEC7FC1A1A7D991D>I<0003B5
FC380070071403140113E0A43801C080A313C13803FF001381A3EA0702EB0004A2140812
0E1418141014304813E0B5FC181A7D991A>I<0003B5FC380070071403140113E0A43801
C080A313C13803FF001381A3EA070290C7FCA3120EA4121EEAFFC0181A7D9919>I<3903
FF1FF83900700380A39038E00700A43801C00EA43803FFFCEB801CA348485AA4000E5BA4
485B38FF87FC1D1A7D991D>72 D<EA03FFEA0070A313E0A4EA01C0A4EA0380A4EA0700A4
120EA45AEAFF80101A7D990F>I<EA03FFEA0070A35BA4485AA4485AA448C7FC1410A214
20120E1460144014C0381C0380B5FC141A7D9918>76 D<D803F8EB1FC0D80078EB3C00A2
155C01B85BA290389C0138A239011C0270A21404140800025C1410A214200004EB41C0A2
1481A239080F0380A2130EEA180C4AC7FC39FE083FE0221A7D9922>I<3903F007F83900
7800C01580A290389C0100A3138E38010E0213061307A238020384A3EB01C4000413C8A2
EB00E8A24813F01470A21218142012FE1D1A7D991D>I<EB1F80EB70603801C030380300
180006131C000E130C5A0018130E123812301270A248131CA31438A21430147014E014C0
3860018038700300EA3806EA1C1CEA07E0171A7A991D>I<3803FFF83800701C14061407
13E0A43801C00EA2141C143838038060EBFF80EB8000A248C7FCA4120EA45AB47E181A7D
991A>I<EB3F10EB60903801807013004813201206A31400120713C0EA03F8EA01FEEA00
7FEB0F8013031301A21220A238600300A21306EA700CEAC818EA87E0141A7D9916>83
D<383FFFFC38381C0C00201304124013381280A338007000A45BA4485AA4485AA41207EA
FFF8161A79991B>I<387FE0FF380E00181410A2481320A4481340A4481380A438E00100
A31302A25BEA60085BEA3860EA0F80181A78991D>I<39FF803F80391C000C0014085CA2
5C14601440001E5B120E49C7FC1302A25BA25B5B120F6C5A136013405BA290C8FC1206A2
191A78991D>I<3AFF87FC1FC03A3C00E007000038140413015D1302001C5C13045D1308
5D13105DD920E1C7FC134014E2138014E4EA1D0014E8121E1470121C146012181440221A
789926>I<EA03CCEA0E2EEA181C123812301270EAE038A4EAC072A3EA60F2EA6134EA1E
180F107C8F14>97 D<127E120EA35AA45AA2EA3BC0EA3C301278EA7018A3EAE038A4EAC0
70136013E0EA60C0EA6380EA1E000D1A7C9912>I<EA01E0EA0618120CEA1838EA3010EA
7000126012E0A413081310EA6020EA30C0EA1F000D107C8F12>I<EB1F801303A3EB0700
A4130EA2EA03CEEA0E2EEA181C123812301270485AA4EAC072A3EA60F2EA6134EA1E1811
1A7C9914>I<EA01E0EA0E18EA1C08123812701310EAFFE0EAE000A41308EA60101320EA
30C0EA1F000D107C8F12>I<1307EB0980131BEB3B00133813301370A4EA07FFEA00E0A5
485AA5485AA490C7FC5AA21206126612E412CC1270112181990C>I<13F338038B803806
0700120E120C121CEA380EA4EA301CA3EA183C5BEA07B8EA0038A25B1260EAE0E0EAC1C0
007FC7FC11177E8F12>I<EA1F801203A348C7FCA4120EA2137CEA0F86EA1E07A2121CA2
EA380EA35B00701380A21338EB3900EAE019EA600E111A7E9914>I<1203120712061200
A61238124C124E128E129CA2121C1238A212701272A212E212E41264123808197C980C>
I<EA1F801203A3EA0700A4120EA2130E1313EA1C2713431380EA1F00123CEA3F80EA39C0
EA38E0EA70E2A313E4EAE064EA6038101A7E9912>107 D<121F1207A3120EA4121CA412
38A41270A412E4A412E81230081A7D990A>I<38307C1E38598663399E0783801403129C
A239380E0700A3140ED8701C1340A2141C158038E0380C39601807001A107C8F1F>I<EA
307CEA5986EA9E07A2129CA2EA380EA35B00701380A21338EB3900EAE019EA600E11107C
8F16>I<EA01F0EA0618EA0C0CEA180E12301270126012E0A2130C131C13181330EA6060
EA30C0EA1F000F107C8F14>I<EA030F380590C0EA09E0EBC060A3380380E0A4380701C0
148013031400EA0E8E137890C7FCA25AA4B4FC1317808F14>I<EA03C2EA0E2EEA181C12
3812301270EAE038A4EAC070A3EA60F0EA61E0121E1200A2EA01C0A4EA1FF00F177C8F12
>I<EA30F0EA5D18EA9E38EA9C181300A25AA45AA45A12600D107C8F10>I<EA03E0EA0430
1208EA18701360EA1C00EA1F8013C0EA0FE01200136012E0A2EA80C0EA4180EA3E000C10
7D8F10>I<1206120EA45AA2EAFFC0EA1C005AA45AA412E1A312E212E412380A177C960D>
I<EA3806EA4C07EA4E0E128E129CA2EA1C1C1238A3EA7039A3EA3079EA389AEA0F0C1010
7C8F15>I<EA3818EA4C1C124EEA8E0C129CA2EA1C081238A213101270A21320EA3040EA
18C0EA0F000E107C8F12>I<38380C10384C0E38EA4E1C008E1318129CA2381C38101238
A338707020A2144012303818B880380F0F0015107C8F19>I<EA078F3808D180EA10F3EA
20E1EBE000A2EA01C0A4EA0382A212C3EAE784EAC588EA78F011107E8F12>I<EA3806EA
4C07EA4E0E128E129CA2EA1C1C1238A3EA7038A3EA3078EA38F0EA0F7012001360EA60E0
EAE1C0EAC180EA4700123C10177C8F13>I<EA0382EA07C4EA0FFCEA10081310EA002013
40EA0180EA03001204EA08081210EA2018EA7FF0EA43E0EA81C00F107E8F10>I
E /Fl 27 125 df<EA01801203EA06005A121C121812385AA35AA91270A37E1218121C12
0C7EEA03801201091D799914>40 D<128012C01260123012381218121C120EA31207A912
0EA3121C121812381230126012C01280081D7C9914>I<127012F812FCA2127C120C1218
123012E012C0060A798414>44 D<EAFFFEA30F037E8C14>I<124012E012F8127C121EEA
0F80EA07C0EA01F0EA00F8133E131E133E13F8EA01F0EA07C0EA0F80EA1E00127C5A12E0
12400F157E9514>62 D<EAFFE013F8EA383C131C7FA45B133CEA3FF85BEA38387FA51480
EB1DC0A238FE0F80EB070012177F9614>82 D<EA1FC0EA7FF0EA7078EA2018EA001CA2EA
07FC121FEA3C1C127012E0A3EA707C383FFF80EA0F8F11107E8F14>97
D<12FCA2121CA513F8EA1DFEEA1F07EA1E03001C1380EB01C0A6EB0380001E1300EA1F0E
EA1DFCEA0CF81217809614>I<EA03F8EA0FFEEA1C0EEA3804EA7000126012E0A4126012
70EA380EEA1C1EEA0FFCEA03F00F107E8F14>I<137EA2130EA5EA07CEEA0FFEEA1C3EEA
301EEA700E12E0A61270EA301EEA383E381FEFC0EA07CF12177F9614>I<EA07E0EA0FF0
EA1C38EA301CEA700CEAE00EA2EAFFFEA2EAE00012601270EA380EEA1C1EEA0FFCEA03F0
0F107E8F14>I<13FCEA01FEEA038EEA07041300A3EA7FFE12FFEA0700ACEAFFF8A20F17
7F9614>I<EA07CF381FFF80EA383B38301800EA701CA3EA3018EA3838EA3FF0EA37C000
70C7FCA2EA3FF86C7E487EEA700F38E00380A438700700EA3C1EEA1FFCEA07F011197F8F
14>I<1206120FA21206C7FCA4B4FCA21207ACEAFFF8A20D187C9714>105
D<12FCA2121CA5EBFF80A2EB1C005B5B5BEA1DC0EA1FE0A2EA1E70EA1C38133C131C7F38
FF1F80A21117809614>107 D<EAFF80A21203B3EAFFFEA20F177E9614>I<EAFB8EEAFFDF
383CF380A2EA38E3AA38FEFBE013791310808F14>I<EAFC78EAFDFEEA1F86EA1E07121C
AA38FF8FE0A21310808F14>I<EA07C0EA1FF0EA3C78EA701CA2EAE00EA6EA701CEA783C
EA3C78EA1FF0EA07C00F107E8F14>I<EAFCF8EAFDFEEA1F07EA1E03001C1380EB01C0A6
EB0380001E1300EA1F0EEA1DFCEA1CF890C7FCA6B47EA21218808F14>I<EAFE1FEB7F80
EA0EE3380F810090C7FCA2120EA8EAFFF0A211107F8F14>114 D<EA0FD8EA3FF8EA6038
12C0A2EAF000EA7F80EA3FF0EA07F8EA001CEA600612E012F0EAF81CEAFFF8EACFE00F10
7E8F14>I<1206120EA4EA7FFC12FFEA0E00A8130EA3131CEA07F8EA01F00F157F9414>I<
EAFC3FA2EA1C07AB131F380FFFE0EA03E71310808F14>I<38FE3F80A2383C1E00EA1C1C
A36C5AA3EA0630EA0770A36C5AA311107F8F14>I<EA3FFF5AEA700E131C1338EA007013
E0EA01C0EA0380EA0700120EEA1C0712381270B5FCA210107F8F14>122
D<12E0B3AB031D789914>124 D E /Fm 89 125 df<1318A3133CA3134EA31387A33801
0380A2000313C0EA0201A2000413E01300A24813F01470A200181378123838FE01FF181A
7F991B>3 D<B612C0390E001C00B3A639FFE1FFC01A1A7F991D>5
D<B512FC3870003C0078130C003813046C1306001E1302120E7EEB800012036C7E7F1200
13601340A25B3801000212025A481306481304140C48133C387FFFFCB5FC171A7E991C>
I<EBFE7C380381C6380603CE000E1384001C1380A6B512F0381C0380AE38FF8FF0171A80
9916>11 D<13FEEA038138060180EA0E03381C010090C7FCA5B51280EA1C03AE38FF8FF0
141A809915>I<EBFF80EA0383EA0603120E121CA6B5FCEA1C03AE38FF9FF0141A809915>
I<90387E1F803901C17040390703C0600006EB80E0000E14401500A5B612E0380E0380AE
397F8FE3FC1E1A809920>I<EAFFFC0E017E9413>22 D<126012F0A61260AA12201200A4
126012F0A21260041A7D990B>33 D<EA60C0EAF1E0EAF9F0EA68D0EA0810A3EA1020A2EA
2040EA40800C0B7F9913>I<EB0C06A3495AA4495AA4495AB612E0A23900C06000A34848
5AA3B612E0A23903018000A2D80603C7FCA5EA0C06A41B217E9920>I<EA01C0EA0320EA
0610120EA45B5BA23907807F809038001E0014086D5A120B3811C020EA31E000605BEB70
80EAE078013DC7FC6D1380130E39701F0100383861C3380F807C191A7E991E>38
D<126012F012F812681208A31210A212201240050B7D990B>I<1380EA010012025A120C
120812185AA35AA412E0AA1260A47EA37E1208120C12047E7EEA008009267D9B0F>I<7E
12407E7E12181208120C7EA37EA41380AA1300A41206A35A1208121812105A5A5A09267E
9B0F>I<130CACB61280A2D8000CC7FCAC191A7E951E>43 D<126012F0A212701210A312
20A21240A2040B7D830B>I<EAFFC0A20A0280880D>I<126012F0A2126004047D830B>I<
1304130C1318A31330A31360A313C0A3EA0180A3EA0300A31206A35AA35AA35AA35AA35A
A20E257E9B13>I<EA07E0EA1C38EA381CEA300CEA700EEA6006A2EAE007AAEA6006A2EA
700EEA300CEA381CEA1C38EA07E010187F9713>I<12035AB4FC1207B3A2EA7FF80D187D
9713>I<EA0F80EA1060EA2030EA4038EA803CEAC01C12E01240EA003C1338A213701360
13C0EA018013001202EA040412081210EA3008EA3FF8127F12FF0E187E9713>I<EA07E0
EA1838EA201CEA601EEA700EEA201E1200131CA213381370EA07E0EA0038131C130E130F
A212E0A212C0EA400EEA601CEA1838EA07E010187F9713>I<1318A21338137813F813B8
EA01381202A212041208121812101220124012C0B5FCEA0038A6EA03FF10187F9713>I<
EA3018EA3FF013E01380EA2000A5EA2FC0EA3060EA2030EA00381318131CA2124012E0A2
EA8018EA40381330EA30E0EA0F800E187E9713>I<EA01F8EA0704EA0C06EA180E123013
001270126012E0EAE3E0EAE418EAE80CEAF00EEAE0061307A31260A2EA7006EA300EEA18
0CEA0C38EA07E010187F9713>I<1240EA7FFF13FEA2EA4004EA80081310A2EA00201340
A21380120113005AA25A1206A2120EA5120410197E9813>I<EA07E0EA1818EA300CEA20
061260A21270EA780CEA3E18EA1F30EA07C0EA03E0EA0CF8EA307CEA601E130FEAC00713
03A3EA6002EA2004EA1818EA07E010187F9713>I<EA07E0EA1C30EA3018EA700CEA600E
EAE006A21307A31260EA700FEA3017EA1827EA07C7EA00071306130E130C12701318EA60
30EA3060EA0F8010187F9713>I<126012F0A212601200A8126012F0A2126004107D8F0B>
I<126012F0A212601200A8126012F0A212701210A31220A21240A204177D8F0B>I<B612
80A2C9FCA6B61280A2190A7E8D1E>61 D<EA1FC0EA2060EA4030EAC03812E0A212001370
13E0EA018013005A1202A6C7FCA41206120FA212060D1A7E9912>63
D<130CA3131EA2132F1327A2EB4380A3EB81C0A200017F1300A248B47E38020070A2487F
A3487FA2003C131EB4EBFFC01A1A7F991D>65 D<B51280380E00E014701438143CA51478
1470EB01E0380FFFC0380E00F01478143C141C141EA4141C143C147814F0B512C0171A7F
991B>I<EB3F023801C0C63803002E000E131E48130E14065A007813021270A200F01300
A600701302A21278003813047E14087E000313303801C0C038003F00171A7E991C>I<B5
7E380E00E01470808080A280A21580A81500A25C140E5CA2147814E0B51280191A7F991D
>I<B512F8380E003814181408140C1404A3EB0100A35BEA0FFFEA0E037FA3EB0002A314
061404A2140C143CB512FC171A7F991A>I<B512F8380E003814181408140C1404A3EB01
00A35BEA0FFFEA0E037FA390C7FCA8EAFFE0161A7F9919>I<EB3F023801C0C63803002E
000E131E48130E14065A007813021270A200F090C7FCA5903801FFC03970000E00A21278
12387EA27E000313163801C06638003F821A1A7E991E>I<39FFE1FFC0390E001C00AB38
0FFFFC380E001CAC39FFE1FFC01A1A7F991D>I<EAFF80EA1C00B3A6EAFF80091A7E990E>
I<EA0FFEEA0070B3124012E0A2EA40E0EA61C0EA1F000F1A7E9914>I<39FFE01FC0390E
000F00140C14085C5C5C495A0102C7FC5B130C131C132E1347EB8380EA0F03380E01C06D
7EA2147080A280141E141F39FFE07FC01A1A7F991E>I<EAFFE0000EC7FCB01408A31418
14101430147014F0B5FC151A7F9918>I<B414FF000F14F0A2390B800170A23809C002A3
3808E004A2EB7008A3EB3810A3EB1C20A2EB0E40A3EB0780A2EB0300121C39FF8307FF20
1A7F9923>I<00FEEB7FC0000FEB0E001404EA0B80EA09C0A2EA08E01370A21338131CA2
130E1307EB0384A2EB01C4EB00E4A21474143CA2141C140C121C38FF80041A1A7F991D>
I<137F3801C1C038070070000E7F487F003C131E0038130E0078130F00707F00F01480A8
0078EB0F00A20038130E003C131E001C131C6C5B6C5B3801C1C0D8007FC7FC191A7E991E
>I<B51280380E01E0EB007014781438143CA4143814781470EB01E0380FFF80000EC7FC
ABEAFFE0161A7F991A>I<B5FC380E01C0EB0070147880A55C1470EB01C0D80FFFC7FC38
0E0380EB00C0801470A31478A31540143CEC1C8039FFE00F001A1A7F991C>82
D<EA0FC2EA1836EA200EEA600612C01302A3EAE0001270127EEA3FE0EA1FF8EA03FCEA00
7E130E130713031280A3EAC0021306EAE004EAD818EA87E0101A7E9915>I<007FB5FC38
701C0700401301A200C0148000801300A300001400B13803FFE0191A7F991C>I<39FFE0
7FC0390E000E001404B200065B12076C5B6C6C5A3800E0C0013FC7FC1A1A7F991D>I<39
FF801FC0391C00070014066C1304A36C5BA26C6C5AA36C6C5AA26C6C5AA3EB7080A21379
0139C7FCA2131EA3130CA21A1A7F991D>I<3AFF81FF07F03A3C007801C0001CEC0080A3
6C90389C0100A33907010E02A33903830F04EB8207A2150C3901C40388A33900E801D0A3
90387000E0A301305B01201340241A7F9927>I<B512C038F8038012E038C00700A2EA80
0E5BA2485AA25B5BA2485AA2485A38070040A2120EA24813C04813801301EA70031307B5
FC121A7E9917>90 D<12FEA212C0B3AF12FEA207257D9B0B>I<EA2040A2EA4080A2EA81
00A3EAE1C0EAF1E0A2EA60C00B0B7A9913>I<12FEA21206B3AF12FEA20725809B0B>I<12
20A21240A21280A312E012F0A21260040B7D990B>96 D<EA1FC0EA38707FEA101C1200A2
EA03FCEA1E1C1238127012E01480A2133CEA705F381F8F0011107F8F13>I<12FC121CA9
13FCEA1D07381E0380381C01C0130014E0A6EB01C01480381E0300EA1906EA10F8131A80
9915>I<EA07F8EA1C1C1238EA700813005AA612701304EA3808EA1C18EA07E00E107F8F
11>I<133F1307A9EA03E7EA0C17EA180F487E127012E0A6126012706C5AEA1C373807C7
E0131A7F9915>I<EA07C0EA1C30EA30181270EA600C12E0EAFFFCEAE000A41260EA7004
EA3808EA1C18EA07E00E107F8F11>I<EA01F0EA0718EA0E38EA1C101300A6EAFFC0EA1C
00AEEAFF800D1A80990C>I<EA0FCF3818718038303000EA7038A4EA30306C5AEA2FC000
60C7FCA21270EA3FF013FC6C7EEA600FEAC003A4EA6006EA381CEA07E011187F8F13>I<
12FC121CA9137CEA1D87381E0380A2121CAB38FF9FF0141A809915>I<1218123CA21218
1200A612FC121CAE12FF081A80990A>I<EA0180EA03C0A2EA0180C7FCA6EA0FC01201B2
1241EAE180EAE300127E0A2182990C>I<12FC121CA9EB1FC0EB0F00130C5B13205B13E0
121DEA1E70EA1C7813387F131E7F148038FF9FE0131A809914>I<12FC121CB3A6EAFF80
091A80990A>I<38FC7C1F391D8E6380391E0781C0A2001C1301AB39FF9FE7F81D107F8F
20>I<EAFC7CEA1D87381E0380A2121CAB38FF9FF01410808F15>I<EA07E0EA1C38EA300C
EA700EEA6006EAE007A6EA6006EA700EEA381CEA1C38EA07E010107F8F13>I<EAFCFCEA
1D07381E0380381C01C0A2EB00E0A6EB01C01480381E0300EA1D06EA1CF890C7FCA6B47E
1317808F15>I<EA03E1EA0C13EA180BEA300FEA700712E0A61270A26C5AEA1C37EA07C7
EA0007A6EB3FE013177F8F14>I<EAFC78EA1D9CEA1E1C1308EA1C00ABEAFF800E10808F
0F>I<EA1F20EA60E0EA402012C0A2EAF000127FEA3FC0EA1FE0EA00F0EA8070133012C0
1320EAF040EA8F800C107F8F0F>I<1208A41218A21238EAFFC0EA3800A81320A41218EA
1C40EA07800B177F960F>I<38FC1F80EA1C03AB1307120CEA0E0B3803F3F01410808F15>
I<38FF0F80383C0700EA1C061304A26C5AA26C5AA3EA03A0A2EA01C0A36C5A11107F8F14
>I<39FE7F1F8039381C0700003C1306381C0C04130E380E16081317A238072310149013
A33803C1A014E0380180C0A319107F8F1C>I<38FE3F80383C1E00EA1C086C5AEA0F306C
5A6C5A12017F1203EA0270487E1208EA181CEA381E38FC3FC012107F8F14>I<38FF0F80
383C0700EA1C061304A26C5AA26C5AA3EA03A0A2EA01C0A36C5AA248C7FCA212E112E212
E4127811177F8F14>I<EAFFF8EAE07012C0EA80E0EA81C0A2EA0380EA0700A2EA0E0412
1CA2EA380812701338EAFFF80E107F8F11>I<B512C01201808913>I<B712F82501808926
>I E /Fn 49 121 df<12F8A512301270126012E005097D840B>44
D<EAFFE0A30B0380890E>I<12F8A505057D840B>I<EA01C01203121F12FFA212671207B1
EA7FFC12FF127F0E1A7D9915>49 D<EA07E0EA1FF0EA3FFCEA7FFEEAF87EEAF03F1260EA
201F1200133FA2133E137CA213F8EA01F0EA03E0EA0780EA0F00120E5A5AEA7FFFB5FCA2
7E101A7E9915>I<EA0FE0EA3FF8EA7FFC12FFEA707E1240EA003E137EA213FCEA07F813
F013F8EA007C133E133FA412401260EAF87EEAFFFEEA7FFCEA3FF8EA0FE0101A7E9915>
I<13FCA21201A2EA03BC1207133C120FA2121EA2123CA21278A212F0B512C0A438003C00
A6121A7F9915>I<EA1FFF5AA3003EC7FCA6EA3FF87F7FEA3E1F001C13801200A3122012
60127038F83F00EA7FFF6C5A6C5AEA07F0111A7F9915>I<EA01F0EA07F8121FA2EA3F08
EA7C00A2127812F813F0EAFBFCEAFFFEEAFE3EEAFC1F12F8A51278127C133EEA3FFEEA1F
FCEA0FF8EA07E0101A7E9915>I<B5FCA4EA001E133C137C13F8A2EA01F0A2EA03E0A212
0713C0120FA31380121FA7101A7E9915>I<EA0FF0EA3FFCEA7FFEA2EAFC3FEAF81FA4EA
781EEA7FFEEA1FF8A2EA7E7EEA7C3EEAF81FA6EA7C3EEA7FFEEA3FFCEA1FF8EA07E0101A
7E9915>I<EA07E0EA1FF0EA3FFC127FEA7C3E12F8131E131FA5133FEA7C7FEA7FFFEA3F
DFEA0F1F1200131E133EA2EA307CEA3FFCEA7FF8EA3FF0EA0FC0101A7E9915>I<EA1FC0
EA7FF0EAFFF8EAF07C12601240120013FCEA01F813F0EA03E0EA07C01380A51300C7FCA3
EA0F80A412070E1A7E9913>63 D<13FC487EA2487EA213DFA200071380139F138F000F13
C0A2130F381F07E0A2121E383E03F0EA3FFFA24813F8EA7C01127838F800FCA348137C16
1A7E991B>65 D<EA7FFEB5128014C038FC0FE0EB03F0A514E0130FB512C0148014E038FC
07F01303EB01F8A51303EB07F0B512E014C06C1300151A7D991B>I<EB7FC03803FFF812
0F5A383FC070EB0010007E1300A35AA8127EA36C1308EBC078381FFFF87E000313F03800
7F80151A7E991A>I<387FFFC0B5FCA300FCC7FCA7B51280A400FCC7FCA7B512C0A37E12
1A7D9918>69 D<387FFF80B5FCA300FCC7FCA7B5FCA400FCC7FCAA127C111A7D9917>I<
127C12FCB3A6127C061A7D990C>73 D<127C12FCB3A3B5FCA37E101A7D9916>76
D<007EEB01FCB41303A3EB800700F7147CEBC00F00F3130EA2EBE01E00F1131CEBF03CA2
00F01338EBF878A2EB7870EB7CF0A2EB3CE0A2EB1FC0A3EB0F80387007001E1A7D9925>
I<EBFF80000313E0000F13F8381FC1FC383F007E003E133E007E133F007C7F00FC1480AA
007EEB3F00A2007F5B6C137E381FC1FC6CB45A6C5BC61380191A7E991E>79
D<EA7FFEB5128014C038FC0FE0130314F0A614E0130FB512C01480EBFE0000FCC7FCA912
7C141A7D991A>I<EA7FFEB5128014C038FC07E0EB03F0A6EB07E0B512C01480EBFE00EA
FC7E7FA2EB1F80A2EB0FC0A2EB07E0A2EB03F0A2EA7C01141A7D991A>82
D<EA07F8EA1FFE487E5AEA7C0FEAF80290C7FCA27EB47EEA7FF87F6CB4FC120F6C138038
007FC0130F1307A2124012F038FC0F80B5FC6C1300EA1FFEEA07F8121A7E9917>I<007F
B5FCB6FCA338007E00B3A3133E181A7F991B>I<00F001F813706C486C13F0A2007C15E0
903803FE0114BE149E003EEC03C0EB079FA2140FD81F0FEB07801587A2260F0E07130001
8E138F019E13CF139C0007EB03CEA201DC13DE01F813FE00036D5AA36C486C5A241A7F99
27>87 D<EA0FF0EA3FFC13FEEA381F1220120013FF120FEA3F1F127C12F8A3EAFC7FEA7F
FFEA3FDFEA1F1F10117F9014>97 D<127812F8A813F8EAFBFE12FFEAFC1F00F81380130F
A7EB1F006C5AEAFFFEEAFBFCEA79F0111A7E9915>I<EA07F8EA1FFE123FEA7C0E13005A
A7EA7C02130EEA3FFE121FEA07F80F117F9012>I<EB0F80A9EA0FCFEA1FFF5AEA7E1FEA
7C0F12F8A7127C131FEA3FFFEA1FEFEA0FCF111A7F9915>I<EA07F0EA1FFCEA3FFEEA7C
1EEA780F12F8A2B5FCA2EAF800A31278EA7C03EA3FFF7EEA03FC10117F9013>I<EA01FC
1207120FEA1F041300A5EA7FE012FFA2EA1F00AD7E0E1A80990D>I<380FE1C0EA3FFFEA
7FFD387C7C00487EA5EA7C7CEA7FFC6C5AEA6FE00060C7FCEA7FFC13FF6C13804813C0EA
F0071303A2EAF807387FFF806C1300EA0FFC12197F9015>I<127812F8A813FCEAF9FEEA
FBFFEAFE1F12FC12F8AB1278101A7E9915>I<127C12FCA51200A4123C127CAF123C061B
7F9A0A>I<127012F0A8137C13F812F1EAF3F0EAF7E0EAFFC01380A313C0EAFBE012F113
F0EAF0F8137C133C12700E1A7D9914>107 D<127812F8B3A61278051A7E990A>I<3978FC
1F8039F9FE3FC039FBFF7FE038FE1FC300FC138300F81303AB38780F011B117E9020>I<
EA78FCEAF9FEEAFBFFEAFE1F12FC12F8AB127810117E9015>I<EA07F8EA1FFE487E387E
1F80EA7C0F38F807C0A7387C0F80EA7E1F383FFF006C5AEA07F812117F9015>I<EA78F8
EAFBFE12FFEAFC3F38F81F80130FA7EB1F006C5AEAFFFEEAFBFCEAF9F000F8C7FCA61278
11187E9015>I<EA78C012FB12FFA2EAFE005A5AAA12780A117E900E>114
D<EA1FC0EA3FF0127FEAF0701300A2B4FCEA7FE0EA3FF0121FEA03F8EA007812C012F0EA
FFF0EA7FE0EA1FC00D117F9010>I<121E123EA4EA7FE012FFA2EA3E00AA1320EA3FF012
1FEA0FC00C167F950F>I<EA781F12F8AC137FB5FCEA7F9FEA3F1F10117E9015>I<EAE007
EAF00FA2EA781EA3EA3C3CA3EA1E78A3EA0FF0A3EA07E0A210117F9013>I<39E03E0380
38F07F07A33978F70F00EBE78FA3383CE39E383DC3DEA3381FC1DC14FC1381A26CC65A19
117F901C>I<EAF00EEAF81EEA7C3CEA3E78EA1EF8EA0FF0EA07E013C01203EA07E0EA0F
F0EA1E701378EA3C3CEA781EEAF81FEAF00F10117F9013>I E /Fo
16 118 df<121C123E127E127F123F121F1207120E121E127C12F81260080C788518>44
D<1230127812FCA2127812300606778518>46 D<137CEA01FEEA07FF380F8780381E03C0
EA3C1DEA387F3870FFE0EA71E313C112E1EAE380A638E1C1C0127113E33870FF8038387F
00EA3C1C381E00E0EA0F833807FFC00001138038007E00131C7E9B18>64
D<EA0FF0EA1FFC487EEA3C0FEA180738000380A213FF1207121FEA7F03127812E0A3EAF0
07EA780F383FFFF8EA1FFDEA07F015147E9318>97 D<EA01FEEA07FF001F1380EA3E0738
38030048C7FCA25AA61270EB01C01238EA3E03381FFF8000071300EA01FC12147D9318>
99 D<EB1F80133F131F1303A5EA03E3EA0FFBEA1FFFEA3C1FEA380FEA7007130312E0A6
EA7007A2EA380FEA3C1F381FFFF0380FFBF83803E3F0151C7E9B18>I<EA01F0EA07FCEA
1FFEEA3E0F38380780EA7003A238E001C0A2B5FCA300E0C7FC1270EB01C01238EA3E0738
1FFF8000071300EA01F812147D9318>I<3801E1F03807FFF85A381E1E30381C0E00487E
A5EA1C0EEA1E1EEA1FFC5BEA39E00038C7FC7EEA1FFEEBFFC04813E0387801F038700070
481338A4007813F0EA7E03381FFFC06C13803801FC00151F7F9318>103
D<127E12FE127E120EA5133EEBFF80000F13C013C1EB80E01300120EAB387FC7FC38FFE7
FE387FC7FC171C809B18>I<EA0380EA07C0A3EA0380C7FCA4EA7FC012FF127F1201AEB5
FCA3101D7C9C18>I<1338137CA313381300A4EA0FFCA3EA001CB3A4EA6038EAF078EAFF
F0EA7FE0EA3F800E277E9C18>I<EAFFC0A31201B3A4B51280A3111C7D9B18>108
D<EA01F0EA0FFE487E383E0F80EA3803387001C0A238E000E0A5EAF001007013C0EA7803
383C0780EA3E0F381FFF006C5AEA01F013147E9318>111 D<38FF0FC0EB3FE0EB7FF0EA
07F0EBE060EBC0005BA290C7FCA9EAFFFC7F5B14147E9318>114
D<EA07F7EA3FFF5AEA780FEAE007A3007CC7FCEA7FE0EA1FFCEA03FEEA001F38600780EA
E003A212F038F80F00B5FC13FCEAE7F011147D9318>I<387E07E0EAFE0FEA7E07EA0E00
AC1301EA0F033807FFFC6C13FE3801FCFC1714809318>117 D E
/Fp 2 104 df<130F1338136013E0EA01C0AFEA0380EA0700121E12F8121E1207EA0380
EA01C0AFEA00E013601338130F102D7DA117>102 D<12F8121E1207EA0380EA01C0AFEA
00E013601338130F1338136013E0EA01C0AFEA0380EA0700121E12F8102D7DA117>I
E /Fq 40 122 df<137813841201EA03021207A45BA25BA2EA03909038A00FFC9038C001
E0EC00C000011480EC0100EA02E000041302EA08703818780438303808EA703CEB1C10EA
F00EEB0F20EB07C09038038004387001C0397802E0083938047018391C183C303907E00F
C01E227EA023>38 D<127012F012F8A212781208A31210A31220A21240050E7C840D>44
D<EAFFF0A20C02808A0F>I<127012F8A3127005057C840D>I<EA03F0EA0E1C487EEA1806
EA380738700380A400F013C0AD00701380A3EA780700381300EA1806EA1C0E6C5AEA03F0
121F7E9D17>48 D<13801203120F12F31203B3A6EA07C0EAFFFE0F1E7C9D17>I<EA03F0
EA0C1CEA100E487E00401380128000F013C0EAF803A3EA200712001480A2EB0F00130E5B
5B5B13605B485A48C7FC000613405A5A00101380EA3FFF5AB5FC121E7E9D17>I<124038
7FFFE014C0A23840008038800100A21302485AA25B5BA25BA21360A213E05B1201A41203
A76C5A131F7E9D17>55 D<EA03F0EA0E18487E487E13071270EB038012F0A214C0A5EA70
07A21238EA180BEA0E13EA03E338000380A3EB07001230EA7806130EEA700CEA2018EA10
70EA0FC0121F7E9D17>57 D<5B497EA3497EA3EB09E0A3EB10F0A3EB2078A3497EA2EBC0
3EEB801EA248B5FCEB000FA20002EB0780A348EB03C0A2120C001E14E039FF801FFE1F20
7F9F22>65 D<B512E0380F0078141EA2801580A515005C141E147CEBFFF0EB007C141FEC
0F80EC07C0140315E0A515C014071580EC0F00143EB512F01B1F7E9E20>I<90380FE010
9038381C309038E002703803C00139078000F048C71270121E15305A1510127C127800F8
1400A7EC3FFEEC01F000781300127C123CA27EA27E6C7E3903C001703900E00230903838
0C1090380FF0001F217E9F24>71 D<EAFFF0EA0F00B3ABEAFFF00C1F7E9E10>73
D<3807FFC038003E00131EB3A3122012F8A3EAF01CEA403CEA6038EA1070EA0FC012207F
9E17>I<EAFFF8EA0F8090C7FCB21402A414061404A2140C141C147CB512FC171F7E9E1C>
76 D<EB1FE0EB70383801C00E48487E39070003804814C0001EEB01E048EB00F0A2007C
14F8A20078147800F8147CA900781478007C14F8A2003C14F0003E1301001E14E06CEB03
C06C148039038007003801E01E38007038EB1FE01E217E9F23>79
D<B512E0380F007C141E80EC0780A215C0A41580A2EC0F00141E147CEBFFE090C8FCAEEA
FFF01A1F7E9E1F>I<B57E380F00F0143C8080A21580A41500A2141E5C14F0EBFF80EB01
C0EB0070A280143CA3143EA31504143F141FEC0F0839FFF00788C7EA01F01E207E9E21>
82 D<3803F040380C0CC0EA1803EA3001EA6000A212E01440A36C13007E127CEA7F80EA
3FF86CB4FC00071380C613C0EB1FE013031301EB00F014707EA46C136014E06C13C038F8
018038C60300EA81FC14217E9F19>I<007FB512E038780F010060EB006000401420A200
C0143000801410A400001400B3497E3803FFFC1C1F7E9E21>I<39FFF00FF8390F0003E0
EC0080B3A46CEB01001380120314026C6C5A6C6C5AEB3830EB0FC01D207E9E22>I<EA1F
E0EA3030EA7818131CEA300E1200A313FEEA078EEA1E0E1238127800F01310A3131E1278
38386720380F83C014147E9317>97 D<121C12FC121CAA137CEA1D87381E0180EB00C000
1C13E01470A21478A6147014F014E0001E13C0381A018038198700EA107C15207E9F19>
I<EA01FCEA0706EA1C0F123813060078C7FC127012F0A61270127800381380A2381C0100
EA0706EA01F811147F9314>I<EB01C0130F1301AAEA01F1EA070DEA0C03EA1801123812
78127012F0A61270A21238EA1803120CEA070D3801F1F815207F9F19>I<EA03F0EA0E1C
487E487EA21270EB038012F0A2B5FC00F0C7FCA31270A26C1380A2381C0100EA0706EA01
F811147F9314>I<137CEA01C6EA030F1207EA0E061300A7EAFFF0EA0E00B2EA7FE01020
809F0E>I<14E03803E330EA0E3CEA1C1C38380E00EA780FA5EA380E6C5AEA1E38EA33E0
0020C7FCA21230A2EA3FFE381FFF8014C0383001E038600070481330A4006013606C13C0
381C03803803FC00141F7F9417>I<121C12FC121CAA137C1386EA1D03001E1380A2121C
AE38FF8FF014207E9F19>I<1238127CA31238C7FCA6121C12FC121CB1EAFF80091F7F9E
0C>I<121C12FC121CB3ABEAFF8009207F9F0C>108 D<391C3E03E039FCC30C30391D0390
38391E01E01CA2001C13C0AE3AFF8FF8FF8021147E9326>I<EA1C7CEAFC86EA1D03001E
1380A2121CAE38FF8FF014147E9319>I<EA01F8EA070E381C0380383801C0A2387000E0
A200F013F0A6007013E0A2383801C0A2381C038038070E00EA01F814147F9317>I<EA1C
F0EAFD18EA1E3CA21318EA1C00AEEAFFC00E147E9312>114 D<EA0FC8EA3038EA6018EA
C008A3EAE000127CEA3FE0EA1FF0EA07F8EA003CEA800E130612C0A21304EAE00CEAD818
EA87E00F147F9312>I<1202A31206A2120EA2123EEAFFF8EA0E00AB1304A5EA07081203
EA01F00E1C7F9B12>I<381C0380EAFC1FEA1C03AE1307120CEA061B3803E3F014147E93
19>I<38FF87F8381E03C0380E0180EB0300EA0702EA0384EA01C813D8EA00F013701378
13F8139CEA010E1202EA060738040380000C13C0003C13E038FE07FC16147F9318>120
D<38FF83F8383E00E0001C13C06C1380A338070100A21383EA0382A2EA01C4A213E4EA00
E8A21370A31320A25BA3EAF080A200F1C7FC1262123C151D7F9318>I
E /Fr 25 119 df<EB07F8EB3C06EB7001EBE0073901C00F801203EA0780EC070091C7FC
A8B61280A23807800F1407B3A3397FF87FF8A21D2A7FA921>12 D<EAFFFEA30F037F8E14
>45 D<127812FCA412781200AE127812FCA41278061A7B9910>58
D<B6FC15C0390FC003F00007EB00F881157E153E153FA6153E157E157C5D4A5AEC07E090
B512809038C001F06E7E153E153F811680150F16C0A6ED1F80A2ED3F00A215FE000FEB01
F8B65A158022297DA829>66 D<02FF13200107EBC06090381F807090397E0018E001F813
054848130348481301485A48481300A248C812605A123E007E1520A2127C160012FCA912
7CA2007E1520A2123E123F6C15406C7EA26C6C14806C6CEB01006C6C5B6C6C1306017E13
1C90381F8070903807FFE0010090C7FC232B7DA92A>I<B67E15F03907E001FC0003EB00
3E81ED0F80ED07C0ED03E0ED01F0A2ED00F8A216FC167CA3167EAA167CA216FC16F8A2ED
01F0A2ED03E016C0ED0780ED1F00153E0007EB01FCB612F0158027297EA82D>I<B612FC
A2380FC0000007141C150E1506A21502A415011404A21500A3140C141CEBFFFCA2EBC01C
140C1404A591C7FCAA487EB57EA220297DA826>70 D<B512FCECFFC03907E007F00003EB
00F8157C81153F811680A61600153EA215784A5AEC07C0D9FFFEC7FCEBE007EC03C06E7E
6E7E811578157CA4157EA41601157F153F486CEB1F02B538800F82ED0784C8EA01F8282A
7EA82B>82 D<3DFFFC03FFF003FF80A2270FE0003FC7EA7C006C4816386F14107F00035F
6F7EA26C6C5EED17C0A26C6C5EED23E0A2017C4BC7FCED41F0A26D1502ED80F8A26D5D91
3801007CA2D90F815C0283137E0282133E02C21418D907C6EB3F1002C4131F02E4143001
0315A002E8130F14F8010115C04A1307A201005D4A1303A2026091C8FC02407F392A7FA8
3C>87 D<EA03FCEA0C0738100380383C01C0003E7F6D7E121C1208C7FCA3137FEA03E0EA
0F80EA1E005A127C0078144012F8A31301127C393C027880381E0C7F3907F01E001A1A7E
991D>97 D<137F3801C0E038070010000E1378001E13F85A1470007C13200078130012F8
A81278127C003C1308A26C1310000E13206C13603801C18038007E00151A7E991A>99
D<140F14FFA2141F80AC133F3801C0CF3803802F380F001F121E001C7F123C127C1278A2
12F8A71278A27EA26C5B000E132F6CEB4F803901C18FF038007E0F1C2A7EA921>I<13FC
38038780380701C0000E13E0EA1C00003C13F0A2481378A212F8A2B512F800F8C7FCA512
78A26C1308A26C1310000E13206C13403801C18038007E00151A7E991A>I<131FEB70C0
EBE1E0EA01C31203EB81C0380780801400A9EAFFFEA2EA0780B3A37FEA7FFCA2132A7FA9
12>I<140F3901FC308038070743380E03C3001EEBC100486C7EA2007C7FA5003C5BA26C
485A000E5BD81707C7FCEA11FC0030C8FCA47E381FFF806C13F06C7F3818007C48131E00
70130E00607F12E0A40070130EA26C5B6C5B380781E0C6B4C7FC19287E9A1D>I<121E12
3FA4121EC7FCA9120FB4FCA2121F7EB3A2EAFFF0A20C297EA811>105
D<120FB4FCA2121F7EB3B2EAFFF0A20C2A7EA911>108 D<3A0F07F007F03AFF18381838
9039201C201C3A1F400E400E000F010F130F01801380A201001300B13BFFF0FFF0FFF0A2
2C1A7E9931>I<380F07F038FF1838EB201C381F400E000F130F1380A21300B139FFF0FF
F0A21C1A7E9921>I<137E3803C3C0380700E0000E1370481338003C133CA248131EA200
F8131FA80078131EA26C133CA2001C13386C13706C13E03803C3C038007E00181A7E991D
>I<380F0F8038FF11C0EB23E0EA1F43EA0F83EB81C0EB800090C7FCB07FEAFFFCA2131A
7E9917>114 D<3807F080EA1C0DEA3003EA600112E01300A27E6C1300127EEA7FE0EA3F
FC6C7EEA07FF38003F801307388003C0A2130112C0A200E01380130300F01300EACC0EEA
83F8121A7E9917>I<7FA41201A31203A21207120F381FFF80B5FC38078000AD1440A738
03C08012013800E100133E12257FA417>I<000F130FB413FFA2001F131F6C7FB05CA26C
132F3903804F803901C08FF038007F0F1C1A7E9921>I<39FFF01FF0A2390F8007800007
EB03001402A26C6C5AA2EBE00C00011308A26C6C5AA2EBF830EB7820A26D5AA2EB3EC0EB
1E80A26DC7FCA31306A21C1A7F991F>I E end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
1 0 bop 157 42 a Fr(W)-5 b(arm)20 b(F)-5 b(usion:)25
b(Deriving)17 b(Build-Catas)h(from)h(Recursiv)n(e)f(De\014nitions)646
157 y Fq(John)d(Launc)o(h)o(bury)h(&)g(Tim)f(Sheard)454
213 y(Oregon)g(Graduate)g(Institute)h(of)e(Science)j(&)f(T)l(ec)o
(hnology)495 269 y(P)l(.O.)f(Bo)o(x)g(91000,)e(P)o(ortland,)h(OR)i
(97291-1000)d(USA)697 326 y Fp(f)p Fo(jl,sheard)p Fp(g)p
Fo(@cse.ogi.edu)-76 638 y Fn(Abstract)-76 717 y Fm(Program)19
b(fusion)g(is)g(the)f(pro)q(cess)h(whereb)o(y)g(separate)g(pieces)g(of)
-76 758 y(co)q(de)d(are)f(fused)g(in)o(to)h(a)e(single)j(piece,)f(t)o
(ypically)i(transforming)e(a)-76 800 y(m)o(ulti-pass)j(algorithm)h(in)o
(to)e(a)g(single)h(pass.)31 b(Recen)o(t)17 b(w)o(ork)h(has)-76
841 y(made)k(it)f(clear)h(that)f(the)g(pro)q(cess)h(is)g(esp)q(ecially)
i(successful)e(if)-76 883 y(the)15 b(lo)q(ops)i(or)e(recursions)i(are)e
(expressed)i(using)f(catamorphisms)-76 924 y(\(e.g.)p
Fl(foldr)p Fm(\))g(and)k(constructor-abstraction)i(\(e.g.)35
b Fl(build)p Fm(\).)d(In)-76 966 y(this)20 b(pap)q(er)g(w)o(e)f(sho)o
(w)g(ho)o(w)g(to)g(transform)g Fk(r)n(e)n(cursive)e(pr)n(o)n(gr)n(ams)
-76 1007 y Fm(in)o(to)c(this)f(form)f(automatically)m(,)k(th)o(us)d
(enabling)i(the)d(fusion)i(trans-)-76 1049 y(formation)h(to)f(b)q(e)g
(applied)j(more)d(easily)i(than)e(b)q(efore.)-76 1147
y Fn(1)41 b(Intro)q(duction)-76 1225 y Fm(There)17 b(are)g
(signi\014can)o(t)i(adv)n(an)o(tages)f(to)f(m)o(ulti-pass)h
(algorithms,)-76 1267 y(in)e(whic)o(h)g(in)o(termediate)i
(data-structures)e(are)g(created)g(and)f(tra-)-76 1308
y(v)o(ersed.)25 b(In)15 b(particular,)i(eac)o(h)f(of)f(the)h(passes)g
(ma)o(y)f(b)q(e)h(relativ)o(ely)-76 1350 y(simple,)e(so)f(are)g(b)q
(oth)g(easier)h(to)e(write)h(and)h(are)e(p)q(oten)o(tially)k(more)-76
1391 y(reusable.)33 b(By)18 b(separating)h(man)o(y)f(distinct)i(phases)
e(it)g(b)q(ecomes)-76 1433 y(p)q(ossible)c(to)d(fo)q(cus)h(on)g(a)f
(single)i(task,)f(rather)g(than)g(attempting)g(to)-76
1474 y(do)h(man)o(y)h(things)g(at)f(the)g(same)h(time.)-20
1516 y(The)e(classic)i(to)o(y)e(example)h(of)f(this)h(is)f(to)g
(compute)h(the)f(sum)g(of)-76 1557 y(the)d(squares)h(of)f(the)g(n)o(um)
o(b)q(ers)h(from)f(1)g(to)g Fj(n)p Fm(.)16 b(W)m(e)9
b(migh)o(t)h(write)f(it)g(as,)-76 1599 y Fk(sum)18 b
Fm(\()p Fk(map)f(squar)n(e)g Fm([)p Fk(1)5 b Fj(::)p
Fk(n)s Fm(]\).)19 b(There)c(are)g(t)o(w)o(o)f(in)o(termediate)j(lists)
-76 1640 y(here.)g(First)d(the)e(list)i(of)e(n)o(um)o(b)q(ers)i([1)p
Fj(::n)p Fm(],)d(and)j(second,)f(the)g(list)g(of)-76
1682 y(squares)i(of)f(those)h(n)o(um)o(b)q(ers.)21 b(These)14
b(lists)h(serv)o(e)g(the)f(v)o(ery)g(useful)-76 1723
y(purp)q(ose)f(of)d(acting)j(as)e(the)g(\\glue")i(whic)o(h)f(binds)h
(the)e(comp)q(onen)o(ts)-76 1765 y(of)j(the)g(algorithm)i(together.)21
b(In)14 b(this)h(case)f(the)h(comp)q(onen)o(ts)g(are)-76
1806 y(en)o(tirely)g(standard,)f(\\o\013)f(the)h(shelf)s(")g(parts.)-20
1848 y(Here's)e(the)g(rub,)g(ho)o(w)o(ev)o(er.)17 b(A)12
b(direct)g(implemen)o(tation)j(of)d(the)-76 1889 y(sum)j(of)g(squares)h
(w)o(ould)f Fk(liter)n(al)r(ly)e Fm(construct,)j(tra)o(v)o(erse,)f(and)
g(dis-)-76 1931 y(card)h(the)g(in)o(termediate)h(lists,)g(and)f(so)g
(degrade)h(execution)g(time)-76 1972 y(dreadfully)c(compared)e(with)g
(a)g(function)h(written)f(to)f(compute)h(the)-76 2014
y(sum)j(of)f(squares)h(directly)h(using,)f(sa)o(y)m(,)f(an)h(accum)o
(ulating)i(param-)-76 2055 y(eter.)-20 2097 y(The)c(problem)i(is)e(not)
g(simply)i(one)f(of)e(lists.)18 b(Compiler)c(writers)-76
2138 y(commonly)j(face)e(the)h(c)o(hallenge)i(of)d(deciding)j(ho)o(w)d
(man)o(y)h(passes)-76 2180 y(their)d(compiler)h(should)h(p)q(erform.)i
(Exactly)c(the)g(same)f(tradeo\013)i(is)-76 2221 y(presen)o(t.)34
b(Increasing)20 b(the)f(n)o(um)o(b)q(er)g(of)f(passes)i(means)f
(simpler,)-76 2263 y(more)h(mo)q(dular)i(and)f(more)f(main)o(tainabl)q
(e)j(co)q(de,)f(whereas)e(de-)-76 2304 y(creasing)14
b(the)e(n)o(um)o(b)q(er)g(of)g(passes)h(leads)g(to)f(greater)g
(run-time)h(e\016-)-76 2346 y(ciency)m(.)k(In)9 b(this)h(case)g(the)f
(in)o(termediate)i(structure)f(is)g(an)g(abstract-)-76
2387 y(syn)o(tax)k(tree.)1076 638 y(Another)d(telling)i(example)f(is)f
(that)g(of)f(depth-\014rst)i(tra)o(v)o(ersal)f(of)1020
680 y(graphs.)25 b(Man)o(y)16 b(standard)g(algorithms)h(ma)o(y)f(b)q(e)
f(expressed)i(v)o(ery)1020 721 y(succinctly)d(and)f(simply)g(as)f
(explicit)j(manipulations)g(of)d(a)f(graph's)1020 763
y(depth-\014rst)h(spanning)h(forest,)e(but)h(in)f(execution)i(the)e
(literal)i(pres-)1020 804 y(ence)g(of)g(the)g(forest)g(is)h
(ine\016cien)o(t)h([KL95].)1076 846 y(The)e(long-sough)o(t)i(solution)g
(to)e(this)h(tension)g(b)q(et)o(w)o(een)g(mo)q(du-)1020
887 y(larit)o(y)d(and)g(reuse)f(on)h(the)f(one)g(hand,)h(and)g
(e\016ciency)g(on)f(the)g(other,)1020 929 y(is)j(to)f(increase)h(the)g
(transformation-p)q(o)o(w)o(er)h(of)e(compilers)i(so)e(that)1020
970 y(the)j(programmer)i(ma)o(y)e(feel)h(lib)q(erated)h(to)e(write)h
(programs)g(in)g(a)1020 1012 y(comp)q(onen)o(t)i(st)o(yle,)f
(con\014den)o(t)h(that)e(the)h(compiler)h(can)e Fk(fuse)f
Fm(the)1020 1053 y(comp)q(onen)o(ts)d(together,)g(remo)o(ving)g(the)f
(in)o(termediate)i(structures.)1020 1095 y(In)e(general,)h(of)f
(course,)h(w)o(e)e(cannot)i(exp)q(ect)g(that)f(all)h(in)o(termediate)
1020 1136 y(structures)j(can)f(b)q(e)g(remo)o(v)o(ed:)20
b(data)14 b(structures)h(do)f(serv)o(e)g(a)g(true)1020
1178 y(computational)20 b(role.)31 b(W)m(e)18 b(can)f(hop)q(e,)i(ho)o
(w)o(ev)o(er,)g(that)e(\\unnec-)1020 1219 y(essary")h(in)o(termediate)i
(structures)e(will)h(b)q(e)e(remo)o(v)o(ed)h(whenev)o(er)1020
1261 y(p)q(ossible.)1076 1302 y(In)12 b(this)g(pap)q(er,)h(w)o(e)e(sho)
o(w)h(ho)o(w)f(to)h(prepro)q(cess)h(recursiv)o(e)g(func-)1020
1344 y(tion)e(de\014nitions,)i(turning)f(them)e(in)o(to)h(a)f(form)g
(particularly)j(suited)1020 1385 y(to)g(enabling)j(comp)q(onen)o(t)e
(fusion.)1020 1483 y Fn(2)41 b(Background)1020 1562 y
Fm(Darlington)21 b(and)d(Burstall)i(sho)o(w)o(ed)f(ho)o(w)f
(fold-unfold)i(transfor-)1020 1603 y(mations)12 b(could)h(b)q(e)e(used)
g(\(with)h(h)o(uman)f(help\))h(to)f(pro)q(duce)h(single-)1020
1645 y(pass)20 b(function)i(de\014nitions)g(from)e(the)g(comp)q
(osition)i(of)e(t)o(w)o(o)f(or)1020 1686 y(more)14 b(other)f(functions)
i([DB76)q(].)i(T)m(urc)o(hin)e(applied)g(similar)h(ideas)1020
1728 y(within)10 b(his)g(sup)q(ercompilati)q(on)i(pro)q(cess)d([T)m
(ur86].)15 b(The)9 b Fk(sup)n(er)p Fm(vising-)1020 1769
y Fk(c)n(ompiler)16 b Fm(p)q(erformed)j(a)f(sym)o(b)q(olic)i(execution)
f(of)f(the)g(program,)1020 1811 y(building)i(a)c(residual)j(program)e
(whenev)o(er)g(computations)i(could)1020 1852 y(not)13
b(b)q(e)h(p)q(erformed.)k(P)o(atterns)13 b(in)h(the)g(nesting)g(of)f
(recursiv)o(e)i(calls)1020 1894 y(of)g(functions)j(w)o(ere)d(sp)q
(otted)h(and)g(a)g(single)i(new)d(recursiv)o(e)i(func-)1020
1935 y(tion)f(pro)q(duced.)25 b(While)17 b(the)e(pro)q(cess)h(sho)o(w)o
(ed)f(a)g(high)i(degree)e(of)1020 1977 y(automation,)21
b(the)d(metho)q(d)h(of)f(generalisation)j(used)e(to)f(con)o(trol)1020
2018 y(termination)d(w)o(as)e(rather)g(crude.)1076 2060
y(W)m(adler)k(also)f(dev)o(elop)q(ed)i(man)o(y)e(of)f(these)h(same)f
(ideas)i(in)f(his)1020 2101 y Fk(listless)d(tr)n(ansformer)f
Fm([W)m(ad84)q(].)20 b(Multi-pass)d(programs)e(with)g(in-)1020
2143 y(termediate)i(lists)g(w)o(ere)e(con)o(v)o(erted)i(in)o(to)g
(single)g(lo)q(ops)g(in)g(an)f(im-)1020 2184 y(p)q(erativ)o(e)g
(language.)23 b(Later,)15 b(it)g(b)q(ecame)g(clear)g(that)g(the)f
(metho)q(d)1020 2226 y(could)e(b)q(e)e(expressed)i(within)f(the)f
(functional)j(language)f(itself,)f(and)1020 2267 y(he)h(further)g
(re\014ned)h(the)f(idea,)g(calling)j(the)d(metho)q(d)g
Fk(defor)n(estation)1020 2309 y Fm([W)m(ad90)q(],)f(a)g(pun)i(whic)o(h)
f(has)g(stuc)o(k)g(and)g(is)g(no)o(w)g(commonly)h(used.)1020
2350 y(In)j(order)g(to)g(b)q(e)g(precise)g(ab)q(out)h(whic)o(h)g(in)o
(termediate)g(lists)g(w)o(ere)1020 2392 y(remo)o(v)o(ed,)c(W)m(adler)h
(de\014ned)g(a)f Fk(tr)n(e)n(eless)f(form)g Fm(for)h(function)h
(de\014ni-)1020 2433 y(tions)i(in)g(whic)o(h)f(functions)i(w)o(ere)d
(guaran)o(teed)i(to)f(ha)o(v)o(e)g(no)h(in)o(ter-)1020
2475 y(nal)i(data)f(structures.)28 b(He)16 b(then)h(pro)o(v)o(ed)g
(that)g(comp)q(ositions)i(of)1020 2516 y(treeless)c(functions,)h(could)
f(b)q(e)f(deforested)h(in)o(to)g(a)f(single)i(treeless)1020
2558 y(function.)i(A)13 b(termination)i(pro)q(of)e(follo)o(w)o(ed)i
(later)e([FW89)q(].)1076 2599 y(The)c(original)j(deforestation)f(w)o
(ork)f(w)o(as)f(limited)i(to)e(\014rst)h(order.)1020
2641 y(A)o(ttempts)h(to)g(extend)h(it)f(to)g(higher)i(order)e(ha)o(v)o
(e)h(met)e(with)i(limited)1020 2682 y(success)k(so)e(far.)22
b(In)15 b(particular,)i(it)e(is)h(often)e(hard)i(to)f(\014nd)g(where)p
eop
%%Page: 2 2
2 1 bop -76 -34 a Fm(to)15 b(tie)h(the)f(recursiv)o(e)i(knot.)24
b(T)m(ermination)17 b(pro)q(ofs)f(also)g(seem)f(to)-76
7 y(b)q(e)e(rather)h(hard.)-20 49 y(Recen)o(tly)m(,)f(the)f(fusion)h
(pro)q(cess)f(has)h(receiv)o(ed)g(imp)q(etus)g(from)e(a)-76
90 y(di\013eren)o(t)j(direction)g(en)o(tirely)m(.)19
b(Rejecting)13 b(the)g(fo)q(cus)f(on)h(arbitrary)-76
132 y(recursiv)o(e)h(programs,)f(the)g(recen)o(t)g(w)o(ork)f(has)h(fo)q
(cussed)h(on)f(the)g(fu-)-76 173 y(sion)e(of)f Fk(c)n(atamorphisms)d
Fm(\(literally:)19 b(do)o(wn-formers\),)10 b(the)g(list)h(v)o(er-)-76
215 y(sion)g(v)n(ariously)h(kno)o(wn)e(as)f Fl(fold)f
Fm(in)i(ML,)f Fl(reduce)e Fm(in)j(early)h(v)o(ersions)-76
256 y(of)j(Miranda,)i(and)f Fl(foldr)d Fm(in)j(Hask)o(ell.)22
b(Catamorphisms)16 b(express)-76 298 y(\\regular)i(recursion")g(o)o(v)o
(er)e(data)h(structures.)27 b(Generalising)19 b(the)-76
339 y(datat)o(yp)q(e-sp)q(eci\014c)13 b(w)o(ork)e(of)f(Bird)h(and)g
(Meerten's,)g(Malcolm)i(p)q(op-)-76 381 y(ularised)f(the)d(promotion)i
(theorems)f(from)f(category)h(theory)f(whic)o(h)-76 422
y(describ)q(e)15 b(ho)o(w)e(to)g(fuse)g(catamorphisms)i([Mal89)q(].)-20
464 y(Muc)o(h)f(of)g(this)g(theory)g(w)o(as)g(turned)g(in)o(to)h
(practice)f(b)o(y)g(Sheard)-76 505 y(and)g(F)m(egaras)f([SF93)q(].)k(W)
m(orking)d(with)g(a)f(language)i(without)f(gen-)-76 547
y(eral)d(recursion)i(but)e(con)o(taining)i(catamorphisms)f(\(and)g
(their)f(gen-)-76 588 y(eralisation:)32 b(homomorphisms\),)22
b(Sheard)e(and)g(F)m(egaras)f(imple-)-76 630 y(men)o(ted)g(a)g(fusion)g
(algorithm)i(based)e(on)g(the)g(promotion)h(theo-)-76
671 y(rems.)d(Ho)o(w)o(ev)o(er,)12 b(a)g(problem)h(arises)g(in)g
(practice.)18 b(Without)c(some)-76 713 y(user-supplied)19
b(guidance,)f(the)e(fusion)h(engine)g(attempts)f(to)g(fuse)-76
754 y(ev)o(erything,)f(leading)g(to)e(com)o(binatorial)j(explosion.)-20
796 y(Ab)q(out)9 b(the)g(same)g(time,)h(Gill,)h(Launc)o(h)o(bury)g(and)
e(P)o(eyton)h(Jones)-76 837 y(explored)17 b(a)f(one-step)g(fusion)g
(algorithm)h(whic)o(h)g(relied)g(on)e(func-)-76 879 y(tions)10
b(b)q(eing)g(written)f(in)h(a)f(highly-st)o(yli)q(zed)j(form)c
([GLPJ93].)15 b(F)m(unc-)-76 920 y(tions)j(had)f(to)g(consume)h(their)f
(argumen)o(ts)h(using)g(the)f(catamor-)-76 962 y(phism)c
Fl(foldr)d Fm(and)j(pro)q(duce)g(their)f(list-results)j(b)o(y)d
(\014rst)g(abstract-)-76 1003 y(ing)i(o)o(v)o(er)f Fl(cons)e
Fm(and)j Fl(nil)p Fm(,)d(and)i(then)g(using)i(a)d(new)h(language)i
(con-)-76 1045 y(struct)f(called)h Fl(build)p Fm(.)h(While)f(it)f(w)o
(as)f(unrealistic)j(to)d(exp)q(ect)h(pro-)-76 1086 y(grammers)e(to)g
(program)g(this)g(w)o(a)o(y)m(,)f(the)h(list-pro)q(cessing)j(functions)
-76 1128 y(from)j(the)h(Hask)o(ell)h(standard-prelude)h(w)o(ere)d
(reprogrammed)h(in)-76 1169 y(this)f(st)o(yle.)31 b(F)m(rom)17
b(then)h(on,)g(an)o(y)g(com)o(bination)h(of)e(these)h(stan-)-76
1211 y(dard)d(functions)g(w)o(ere)e(automatically)k(deforested)e
(including,)h(for)-76 1253 y(example,)d(the)d(sum)i(of)e(squares)i
(example)g(from)f(the)g(in)o(tro)q(duction.)-76 1346
y Fn(2.1)41 b(This)13 b(P)o(ap)q(er)-76 1412 y Fm(This)j(pap)q(er)f
(builds)i(on)e(these)g(last)h(t)o(w)o(o.)21 b(W)m(e)15
b(generalise)i(Sheard)-76 1453 y(and)g(F)m(egaras')g(fusion)h
(algorithm)g(to)e(cop)q(e)h(with)g(explicit)i(recur-)-76
1495 y(sion,)12 b(and)e(use)h(it)f(to)h Fk(automatic)n(al)r(l)o(y)f
Fm(deriv)o(e)i(the)e Fl(build)p Fm(/)p Fl(cata)c Fm(form)-76
1536 y(from)14 b(functions)i(de\014nitions)g(written)f(in)g(the)f
(common)h(recursiv)o(e)-76 1578 y(st)o(yle.)26 b(W)m(e)16
b(can)h(then)f(use)g(the)g(one-step)h(fusion)g(la)o(w)f(to)g(ac)o(hiev)
o(e)-76 1619 y(in)o(ter-function)f(deforestation.)-20
1661 y(The)c(t)o(w)o(o)g(steps)h(of)f(the)h(pro)q(cess)g(b)q(ear)g(an)f
(in)o(teresting)j(ph)o(ysical)-76 1703 y(analogy)m(.)k(First)12
b(w)o(e)f(\\ionise")i(function)g(de\014nitions)h(to)d(exp)q(ose)h(the)
-76 1744 y(n)o(ucleus|this)19 b(is)d(the)f Fl(build)p
Fm(/)p Fl(cata)d Fm(form|and)k(then)g(the)g(sepa-)-76
1786 y(rate)10 b(comp)q(onen)o(ts)i(of)e(the)g(program)h(\\plasma")h
(are)e(able)h(to)f(fuse)g(in)-76 1827 y(a)h(single)i(step,)f(simply)h
(b)o(y)e(bringing)j(them)d(in)o(to)h(con)o(tact)f(with)h(one)-76
1869 y(another.)22 b(Exp)q(erimen)o(ts)16 b(suggest)f(that)f(this)h(is)
g(m)o(uc)o(h)f(more)h(real-)-76 1910 y(istic)f(than)g(attempting)g
(\\cold)g(fusion")h(on)e(the)g(original)j(function)-76
1952 y(de\014nitions.)-20 1993 y(This)d(t)o(w)o(o)e(step)h(approac)o(h)
i(addresses)f(some)f(of)g(the)g(shortcom-)-76 2035 y(ing)i(of)f
(previous)i(metho)q(ds.)-20 2114 y Fi(\017)k Fm(It)12
b(is)i(not)g(limited)h(to)e(lists,)h(but)g(w)o(orks)f(for)g(a)g(large)h
(class)g(of)18 2156 y(data)f(structures.)-20 2227 y Fi(\017)19
b Fm(The)10 b(scop)q(e)h(of)e(the)i(fusion)g(engine)h(is)f(limited)h
(to)e(the)g(b)q(o)q(dy)h(of)18 2269 y(the)j(function.)23
b(The)15 b(fusion)g(engine)h(is)f(not)g(used)g(for)g(in)o(ter-)18
2310 y(function)e(deforestation.)18 b(This)12 b(helps)h(to)f(con)o
(trol)h(com)o(bina-)18 2352 y(torial)h(explosion.)-20
2423 y Fi(\017)19 b Fm(A)o(t)e(no)h(time)g(in)h(the)f(pro)q(cess)g(do)h
(w)o(e)e(need)h(to)g(searc)o(h)g(for)18 2465 y(arbitrary)12
b(patterns)f(of)f(recursiv)o(e)j(calls.)k(The)11 b(fusion)h(engine)18
2506 y(simply)i(needs)f(to)f(sp)q(ot)g(a)h(recursiv)o(e)g(call)h(to)e
(the)g(function)i(it)18 2548 y(is)f(curren)o(tly)i(pro)q(cessing.)-20
2627 y(The)10 b(cost)g(of)f(deriving)j Fl(build)p Fm(/)p
Fl(cata)7 b Fm(form)i(is)i(amortised)g(across)-76 2669
y(fusions.)21 b(W)m(e)15 b(pa)o(y)f(once)h(to)f(generate)g(the)g(form)g
(but)h(ma)o(y)f(fuse)g(it)-76 2710 y(man)o(y)g(times)f(with)h(man)o(y)f
(other)h(functions.)1020 -34 y Fn(3)41 b(Language)1020
44 y Fm(T)m(o)9 b(demonstrate)i(our)f(tec)o(hniques,)i(w)o(e)e(use)g
(the)g(language)h(giv)o(en)g(in)1020 86 y(Figure)k(1.)k(A)14
b(program)g(is)h(a)f(sequence)h(of)e(de\014nitions.)23
b(F)m(unction)1020 127 y(de\014nitions)16 b(ma)o(y)e(b)q(e)f(directly)i
(recursiv)o(e)g(\(though,)f(as)f(presen)o(ted,)1020 169
y(our)g(tec)o(hniques)h(only)g(w)o(ork)e(for)g(direct)h(recursion)h(|)f
(i.e.)k(no)12 b(m)o(u-)1020 210 y(tual)h(recursion\),)h(but)f
(recursion)h(in)f(t)o(yp)q(e)f(de\014nitions)j(is)e(sp)q(eci\014ed)1020
252 y(using)i(an)e(explicit)i(recursion)g(op)q(erator,)e
Fl(Rec)o Fm(.)1076 293 y(F)m(or)k(example,)j(lists)f(and)f(binary)h
(trees)f(ma)o(y)f(b)q(e)h(de\014ned)h(as)1020 335 y(follo)o(ws.)1196
402 y Fk(List)44 b Fm(=)37 b(\003)p Fj(\013)10 b(:)h
Fl(Rec)g Fj(\014)k(:)1398 444 y Fh(Nil)d Fm(\(\))c(+)h
Fh(Cons)j Fm(\()p Fj(\013)c Fi(\002)h Fj(\014)r Fm(\))1196
485 y Fk(T)m(r)n(e)n(e)37 b Fm(=)g(\003)p Fj(\013)10
b(:)h Fl(Rec)g Fj(\014)k(:)1398 527 y Fh(Tip)d Fm(\(\))d(+)f
Fh(No)q(de)13 b Fm(\()p Fj(\014)d Fi(\002)e Fj(\013)h
Fi(\002)f Fj(\014)r Fm(\))1020 604 y(An)o(y)i(w)o(ell)g(formed)g(t)o
(yp)q(e)g(constructor)h(de\014nition)h Fj(T)k Fm(=)11
b Fj(:)6 b(:)g(:)g Fh(C)1906 608 y Fg(i)1929 604 y Fj(t)1943
608 y Fg(i)1972 604 y Fj(:)g(:)g(:)1020 645 y Fm(with)15
b Fj(n)g Fm(constructors)h(can)g(b)q(e)f(decomp)q(osed)i(in)o(to)e(a)g
(sequence)h(of)1020 687 y Fj(n)10 b Fm(+)g(2)16 b(equations)h(in)g
(whic)o(h)f(the)g(recursion)h(is)f(op)q(ened)g(out,)g(and)1020
728 y(the)d(argumen)o(t)h(to)f(eac)o(h)g(constructor)h(is)g(named.)k(F)
m(or)13 b(example:)1096 810 y Fk(List)74 b Fm(=)37 b(\003)p
Fj(\013)10 b(:)g Fl(Rec)i Fj(\014)j(:)d(E)1547 794 y
Ff(List)1618 810 y Fj(\013)h(\014)1096 858 y(E)1126 842
y Ff(List)1235 858 y Fm(=)37 b(\003)p Fj(\013)10 b(:)g
Fm(\003)p Fj(\014)i(:)1328 900 y Fh(Nil)g Fm(\()p Fj(E)1434
907 y Ff(Nil)1492 900 y Fj(\013)h(\014)r Fm(\))20 b(+)i
Fh(Cons)12 b Fm(\()p Fj(E)1778 907 y Ff(Cons)1865 900
y Fj(\013)g(\014)r Fm(\))1096 941 y Fj(E)1124 948 y Ff(Nil)1235
941 y Fm(=)37 b(\003)p Fj(\013)10 b(:)g Fm(\003)p Fj(\014)i(:)f
Fm(\(\))1096 983 y Fj(E)1124 990 y Ff(Cons)1235 983 y
Fm(=)37 b(\003)p Fj(\013)10 b(:)g Fm(\003)p Fj(\014)i(:)f(\013)d
Fi(\002)g Fj(\014)1020 1062 y Fm(T)o(yp)q(e)j(constructors)g(corresp)q
(ond)i(to)d(functors)h(\(in)g(the)g(categorical)1020
1103 y(sense\),)18 b(so)f(they)g(ha)o(v)o(e)g(a)f(natural)j(action)e
(on)g(functions)h(as)f(w)o(ell)1020 1145 y(as)f(on)h(t)o(yp)q(es.)26
b(F)m(or)16 b(example,)i(the)e(natural)i(action)f(of)f
Fk(List)f Fm(on)h(a)1020 1186 y(function)f(is)f(to)f(map)h(it)g(do)o
(wn)g(a)f(list.)19 b(In)14 b(particular,)h(the)f Fj(E)1928
1193 y Fh(C)1970 1186 y Fm(for)1020 1228 y(eac)o(h)g(constructor)g(are)
f(also)h(functors)g(whose)g(de\014nitions)i(w)o(e)d(will)1020
1269 y(need)h(later.)j(The)c Fj(E)1321 1276 y Fh(C)1363
1269 y Fm(turn)h(out)f(to)g(ha)o(v)o(e)h(a)f(st)o(ylised)i(form:)1314
1345 y Fj(E)1342 1352 y Fh(C)1395 1345 y Fm(::=)22 b(\(\003)p
Fj(\013)1536 1349 y Fg(i)1559 1345 y Fj(:)11 b Fm(\))1596
1327 y Fe(\003)1626 1345 y Fm(\003)p Fj(\014)h(:)f(t)1020
1421 y Fm(where)g(the)f Fj(\014)i Fm(is)f(the)f(v)n(ariable)j(o)o(v)o
(er)e(whic)o(h)g(t)o(yp)q(e)g(recursion)h(o)q(ccurs.)1020
1463 y(This)19 b(is)g(the)g(only)g(v)n(ariable)i(o)o(v)o(er)d(whic)o(h)
h(w)o(e)f(need)h(to)g(parame-)1020 1504 y(terise)d(the)g(function)h
(part)f(of)f Fj(E)1507 1511 y Fh(C)1552 1504 y Fm(\(the)h(others)g(are)
f(all)i(instan)o(ti-)1020 1546 y(ated)f(to)f(the)g(iden)o(tit)o(y)i
(function)g(for)e(our)h(purp)q(oses\).)25 b(W)m(e)15
b(de\014ne)1020 1587 y Fj(E)1048 1594 y Fh(C)1090 1587
y Fm(\()p Fj(g)q Fm(\))24 b(=)g Fi(E)1237 1591 y Fg(g)1255
1587 y Fm([)-6 b([)10 b Fj(t)g Fm(])-6 b(])12 b(where)1039
1664 y Fi(E)1059 1668 y Fg(g)1077 1664 y Fm([)-6 b([)10
b(\(\))g(])-6 b(])61 b(=)37 b Fj(\025)p Fm(\(\))11 b
Fj(:)g Fm(\(\))1039 1706 y Fi(E)1059 1710 y Fg(g)1077
1706 y Fm([)-6 b([)10 b Fk(int)f Fm(])-6 b(])45 b(=)37
b Fj(\025x)11 b(:)f(x)1039 1747 y Fi(E)1059 1751 y Fg(g)1077
1747 y Fm([)-6 b([)10 b Fj(\013)1128 1751 y Fg(i)1151
1747 y Fm(])-6 b(])53 b(=)37 b Fj(\025x)11 b(:)f(x)1039
1789 y Fi(E)1059 1793 y Fg(g)1077 1789 y Fm([)-6 b([)10
b Fj(\014)i Fm(])-6 b(])67 b(=)37 b Fj(g)1039 1830 y
Fi(E)1059 1834 y Fg(g)1077 1830 y Fm([)-6 b([)10 b(\()p
Fj(t)1132 1834 y Fd(1)1157 1830 y Fi(\002)f Fj(:)d(:)g(:)i
Fi(\002)g Fj(t)1301 1834 y Fg(n)1323 1830 y Fm(\))i(])-6
b(])1220 1872 y(=)37 b Fj(\025)p Fm(\()p Fj(x)1346 1876
y Fd(1)1364 1872 y Fj(;)6 b(:)g(:)g(:)g(;)g(x)1471 1876
y Fg(n)1492 1872 y Fm(\))11 b Fj(:)f Fm(\()p Fi(E)1574
1876 y Fg(g)1592 1872 y Fm([)-6 b([)10 b Fj(t)1632 1876
y Fd(1)1660 1872 y Fm(])-6 b(])11 b Fj(x)1709 1876 y
Fd(1)1726 1872 y Fj(;)c(:)f(:)g(:)g(;)g Fi(E)1832 1876
y Fg(g)1850 1872 y Fm([)-6 b([)10 b Fj(t)1890 1876 y
Fg(n)1922 1872 y Fm(])-6 b(])11 b Fj(x)1971 1876 y Fg(n)1992
1872 y Fm(\))1039 1917 y Fi(E)1059 1921 y Fg(g)1077 1917
y Fm([)-6 b([)10 b Fj(T)18 b(t)11 b Fm(])-6 b(])36 b(=)h
Fj(\025x)11 b(:)f Fk(map)1434 1901 y Fg(T)1471 1917 y
Fm(\()p Fi(E)1506 1921 y Fg(g)1524 1917 y Fm([)-6 b([)10
b Fj(t)h Fm(])-6 b(]\))11 b Fj(x)1020 2001 y Fm(where)e
Fk(map)1198 1985 y Fg(T)1231 2001 y Fm(is)h(the)f(usual)i(functional)g
(comp)q(onen)o(t)g(of)d(the)i(functor)1020 2043 y Fj(T)5
b Fm(.)18 b(F)m(or)13 b(example,)h(w)o(e)f(get)g(the)g(follo)o(wing)i
(functional)h(b)q(eha)o(viours)1020 2084 y(for)d Fj(E)1107
2091 y Ff(Nil)1165 2084 y Fm(and)h Fj(E)1268 2091 y Ff(Cons)1342
2084 y Fm(:)1355 2159 y Fj(E)1383 2166 y Ff(Nil)1441
2159 y Fm(\()p Fj(g)q Fm(\))24 b(=)f Fj(\025)p Fm(\(\))11
b Fj(:)g Fm(\(\))1259 2201 y Fj(E)1287 2208 y Ff(Cons)1374
2201 y Fm(\()p Fj(g)q Fm(\))24 b(=)f Fj(\025)p Fm(\()p
Fj(x;)6 b(y)q Fm(\))11 b Fj(:)f Fm(\()p Fj(x;)19 b(g)14
b(y)q Fm(\))1020 2280 y(W)m(e)e(will)i(often)e(use)h(the)f(notation)k
(\026)-21 b Fj(x)12 b Fm(for)g(the)g(v)o(ector)g(\()p
Fj(x)1845 2284 y Fd(1)1862 2280 y Fj(;)6 b(:)h(:)f(:)g(;)g(x)1970
2284 y Fg(n)1991 2280 y Fm(\),)1020 2321 y(esp)q(ecially)13
b(when)e(the)g(size)g(dep)q(ends)h(on)e(the)h(con)o(text.)16
b(In)11 b(addition)1020 2363 y(b)q(ecause)j(of)f(the)h(isomophism)h
(\(\006)c Fj(t)1550 2367 y Fg(i)1563 2363 y Fm(\))g Fi(!)g
Fj(t)1663 2353 y Fi(\030)1663 2365 y Fm(=)1704 2363 y(\005)g(\()p
Fj(t)1773 2367 y Fg(i)1797 2363 y Fi(!)g Fj(t)p Fm(\))i(and)h(the)1020
2404 y(de\014nition)k Fj(E)r Fm(\()p Fj(T)5 b Fm(\))29
b(=)g(\006)14 b(\()p Fj(E)1453 2411 y Fh(C)1482 2404
y Fm(\()p Fj(T)5 b Fm(\)\))16 b(w)o(e)e(often)i(express)g(functions)
1020 2446 y(out)i(of)g(a)g(sum)g Fj(E)r Fm(\()p Fj(\013)p
Fm(\))h Fi(!)h Fj(\013)d Fm(as)h(the)g(pro)q(duct)i(of)d(functions)j
(out)1020 2487 y(of)e(eac)o(h)i(summand)f(\005\()p Fj(E)1414
2494 y Fh(C)1443 2487 y Fm(\()p Fj(\013)p Fm(\))h Fi(!)h
Fj(\013)p Fm(\).)33 b(Th)o(us)19 b(the)g(pro)q(duct)g(of)1020
2536 y(constructors)f(\()p Fh(Nil)o Fj(;)7 b Fh(Cons)o
Fm(\))17 b(has)h(t)o(yp)q(e)f Fj(E)1631 2521 y Ff(List)1690
2536 y Fm(\()p Fk(List)f Fj(\013)p Fm(\))h Fi(!)h Fk(List)f
Fj(\013)p Fm(,)1020 2586 y(and)h(the)f(t)o(yp)q(e)g(of)f
Fl(cata)g Fm(is:)25 b(\()p Fj(E)1508 2570 y Ff(List)1566
2586 y Fm(\()p Fj(\014)r Fm(\))17 b Fi(!)g Fj(\014)r
Fm(\))g Fi(!)g Fk(List)g Fj(\013)g Fi(!)g Fj(\014)r Fm(.)1020
2627 y(Also,)10 b(for)f(an)o(y)h(t)o(yp)q(e)g(constructor)g
Fj(T)15 b Fm(the)9 b(constructors)h(of)f Fj(T)15 b Fm(can)10
b(b)q(e)1020 2669 y(sp)q(eci\014ed)15 b(b)o(y)f Fk(Constrs)r
Fm(\()p Fj(T)5 b Fm(\).)19 b(So,)13 b(for)g(example:)20
b Fk(Constrs)r Fm(\()p Fk(List)o Fm(\))i(=)1020 2718
y(\()p Fh(Nil)o Fj(;)6 b Fh(Cons)p Fm(\))k(:)h Fj(E)1261
2702 y Ff(List)1319 2718 y Fm(\()p Fk(List)f Fj(\013)p
Fm(\))g Fi(!)h Fk(List)f Fj(\013)p Fm(.)p eop
%%Page: 3 3
3 2 bop 263 -5 a Fk(e)91 b Fm(::=)37 b Fj(v)699 b Fm(v)n(ariables)392
36 y Fi(j)58 b Fj(n)695 b Fm(constan)o(ts)392 78 y Fi(j)58
b Fm(\()p Fj(e)494 82 y Fd(1)511 78 y Fj(;)6 b(:)g(:)g(:)g(;)g(e)614
82 y Fg(n)635 78 y Fm(\))529 b(tuples)392 119 y Fi(j)58
b Fj(e)479 123 y Fd(1)509 119 y Fj(e)527 123 y Fg(n)1179
119 y Fm(applicatio)q(ns)392 161 y Fi(j)g Fl(case)11
b Fj(e)i Fl(of)f Fh(C)662 165 y Fd(1)681 161 y Fm(\026)-21
b Fj(x)701 165 y Fd(1)731 161 y Fl(->)12 b Fj(e)801 165
y Fd(1)824 161 y Fl(|)h Fj(:)6 b(:)g(:)12 b Fl(|)h Fh(C)974
165 y Fg(n)997 161 y Fm(\026)-21 b Fj(x)1017 165 y Fg(n)1051
161 y Fl(->)12 b Fj(e)1121 165 y Fg(n)1179 161 y Fm(pattern)i(matc)o
(hing)g(case)392 202 y Fi(j)58 b Fj(\025v)12 b(:)e(e)626
b Fm(lam)o(b)q(da)15 b(abstractions)392 244 y Fi(j)58
b Fj(\025)p Fm(\()p Fj(v)517 248 y Fd(1)534 244 y Fj(;)6
b(:)g(:)g(:)g(;)g(v)638 248 y Fg(n)659 244 y Fm(\))11
b Fj(:)f(e)455 b Fm(abstractions)15 b(o)o(v)o(er)f(tuples)392
289 y Fi(j)58 b Fl(cata)539 273 y Fg(T)563 289 y Fm(\()p
Fj(e)596 293 y Fd(1)613 289 y Fj(;)7 b(:)f(:)g(:)g(;)g(e)717
293 y Fd(2)734 289 y Fm(\))430 b(catamorphisms)392 334
y Fi(j)58 b Fl(build)559 319 y Fg(T)596 334 y Fj(e)565
b Fm(builds)392 376 y Fi(j)58 b Fh(C)691 b Fm(constructors)263
459 y Fk(De)n(cl)36 b Fm(::=)h Fj(v)11 b Fm(=)g Fj(e)629
b Fm(\(recursiv)o(e\))15 b(function)f(de\014nition)392
501 y Fi(j)58 b Fj(T)16 b Fm(=)11 b(\(\003)p Fj(\013)607
505 y Fg(i)630 501 y Fj(:)f Fm(\))666 485 y Fe(\003)684
501 y Fk(Con)426 b Fm(t)o(yp)q(e)14 b(de\014nition)263
584 y Fk(Con)40 b Fm(::=)d Fl(Rec)11 b Fj(\014)k(:)d
Fh(C)619 588 y Fd(1)649 584 y Fj(t)663 588 y Fd(1)689
584 y Fm(+)c Fj(:)e(:)g(:)j Fm(+)f Fh(C)846 588 y Fg(n)880
584 y Fj(t)894 588 y Fg(n)263 667 y Fk(t)96 b Fm(::=)37
b(\(\))12 b Fi(j)h Fj(t)541 671 y Fd(1)566 667 y Fi(\002)c
Fj(:)d(:)g(:)i Fi(\002)h Fj(t)711 671 y Fg(n)744 667
y Fi(j)k Fj(\013)f Fi(j)h Fk(int)f Fi(j)g Fj(T)19 b(t)213
b Fm(constructor)14 b(argumen)o(t)g(t)o(yp)q(es)748 788
y(Figure)h(1:)i(Abstract)c(Syn)o(tax)-20 911 y(The)e(seman)o(tics)i(of)
e(our)g(language)j(is)e(that)f(of)g(a)g(standard)i(non-)-76
953 y(strict)j(language)i(with)e(the)g(addition)i(of)d
Fl(build)f Fm(and)i Fl(cata)o Fm(.)24 b(The)-76 995 y(seman)o(tics)c
(of)e(of)f(these)i(constructs)g(ob)q(ey)g(the)f(follo)o(wing)j(equa-)
-76 1036 y(tions.)130 1113 y Fl(cata)208 1095 y Fg(T)233
1113 y Fm(\()p Fj(f)267 1117 y Fd(1)283 1113 y Fj(;)6
b(:)h(:)f(:)g(;)g(f)388 1117 y Fg(n)409 1113 y Fm(\))12
b(\()p Fj(C)478 1117 y Fg(i)p 505 1092 22 2 v 505 1113
a Fj(x)o Fm(\))167 1173 y(=)37 b Fj(f)253 1177 y Fg(i)279
1173 y Fm(\()p Fj(E)322 1177 y Fg(i)342 1173 y Fm(\()p
Fl(cata)435 1156 y Fg(T)459 1173 y Fm(\()p Fj(f)493 1177
y Fd(1)510 1173 y Fj(;)6 b(:)g(:)g(:)h(;)f(f)615 1177
y Fg(n)635 1173 y Fm(\)\))p 678 1152 V 13 w Fj(x)p Fm(\))156
b(\(1\))197 1257 y Fl(build)295 1239 y Fg(T)332 1257
y Fj(f)25 b Fm(=)d Fj(f)t Fm(\()p Fk(Constrs)9 b Fj(T)c
Fm(\))224 b(\(2\))29 1326 y Fl(cata)107 1308 y Fg(T)131
1326 y Fm(\()p Fj(f)165 1330 y Fd(1)182 1326 y Fj(;)6
b(:)g(:)g(:)h(;)f(f)287 1330 y Fg(n)308 1326 y Fm(\))12
b(\()p Fl(build)448 1308 y Fg(T)485 1326 y Fj(g)q Fm(\))22
b(=)f Fj(g)15 b Fm(\()p Fj(f)659 1330 y Fd(1)676 1326
y Fj(;)6 b(:)g(:)g(:)g(;)g(f)780 1330 y Fg(n)801 1326
y Fm(\))55 b(\(3\))-76 1389 y(where)19 b(\()p Fj(f)75
1393 y Fd(1)92 1389 y Fj(;)6 b(:)g(:)g(:)g(;)g(f)196
1393 y Fg(n)217 1389 y Fm(\))27 b(:)g(\005\()p Fj(E)369
1393 y Fg(i)382 1389 y Fm(\()p Fj(\013)p Fm(\))20 b Fi(!)h
Fj(\013)p Fm(\))e(\(view)o(ed)h(as)f(the)g(t)o(yp)q(e)-76
1430 y Fj(E)r Fm(\()p Fj(\013)p Fm(\))11 b Fi(!)g Fj(\013)p
Fm(\).)-20 1477 y(A)19 b(catamorphism,)i Fl(cata)374
1461 y Fg(T)398 1477 y Fm(\()p Fj(f)432 1481 y Fd(1)449
1477 y Fj(;)6 b(:)g(:)g(:)g(;)g(f)553 1481 y Fg(n)574
1477 y Fm(\),)20 b(can)f(b)q(e)g(view)o(ed)h(as)-76 1518
y(a)f(function)h(that)f(replaces)h(ev)o(ery)g(constructor,)g
Fh(C)714 1522 y Fg(i)727 1518 y Fm(,)f(in)h(a)f(data)-76
1560 y(structure)12 b(with)f(a)g(corresp)q(onding)j(function,)e
Fj(f)625 1564 y Fg(i)638 1560 y Fm(.)k(F)m(or)11 b(example)h(b)o(y)-76
1601 y(rep)q(eatedly)j(applying)h(equation)f(1:)128 1683
y Fl(cata)206 1667 y Ff(List)264 1683 y Fm(\()p Fj(n;)6
b(c)p Fm(\))13 b(\()p Fh(Cons)o Fm(\(7)p Fj(;)7 b Fh(Cons)o
Fm(\(3)p Fj(;)f Fh(Nil)p Fm(\(\)\)\)\)\))60 1732 y(=)38
b Fj(c)12 b Fm(\(7)p Fj(;)6 b Fl(cata)287 1716 y Ff(List)345
1732 y Fm(\()p Fj(n;)g(c)p Fm(\))12 b(\()p Fh(Cons)p
Fm(\(3)p Fj(;)6 b Fh(Nil)o Fm(\(\)\)\)\))60 1780 y(=)38
b Fj(c)12 b Fm(\(7)p Fj(;)6 b(c)13 b Fm(\(3)p Fj(;)6
b Fl(cata)367 1764 y Ff(List)425 1780 y Fm(\()p Fj(n;)h(c)p
Fm(\))12 b(\()p Fh(Nil)o Fm(\(\)\)\)\))60 1821 y(=)38
b Fj(c)12 b Fm(\(7)p Fj(;)6 b(c)13 b Fm(\(3)p Fj(;)6
b(n)p Fm(\)\))-20 1906 y(A)15 b Fl(build)122 1890 y Fg(T)161
1906 y Fm(is)g(applied)j(to)c(a)h(function)i(whic)o(h)e(abstracts)h(o)o
(v)o(er)-76 1947 y(the)d(constructors)h(of)f(the)g(datat)o(yp)q(e)h
Fj(T)5 b Fm(.)18 b(Th)o(us:)137 2032 y Fl(build)235 2014
y Ff(List)293 2032 y Fm(\()p Fj(\025)p Fm(\()p Fj(n;)6
b(c)p Fm(\))11 b Fj(:)f(c)i Fm(\(7)p Fj(;)6 b(c)13 b
Fm(\(3)p Fj(;)6 b(n)p Fm(\(\)\)\)\))-76 2108 y(applies)21
b(the)d(function)i(argumen)o(t)f(to)f(the)h(constructors)g(of)f(list,)
-76 2150 y(\()p Fh(Nil)o Fj(;)6 b Fh(Cons)p Fm(\))13
b(\(equation)h(2\),)f(and)h(reconstructs)g(the)f(list:)234
2225 y Fh(Cons)p Fm(\(7)p Fj(;)6 b Fh(Cons)p Fm(\(3)p
Fj(;)g Fh(Nil)o Fm(\(\)\)\))-76 2303 y(A)11 b(more)f(detailed)j
(description)h(of)c(build)j(can)f(b)q(e)f(found)g(in)h(Section)-76
2344 y(6.)-20 2386 y(W)m(e)g(assume)h(renaming)g(is)g(done)f(whenev)o
(er)h(there)f(is)g(an)o(y)h(dan-)-76 2427 y(ger)e(of)f(name-capture,)i
(and)f(for)g(simplicit)o(y)m(,)i(w)o(e)d(restrict)i(ourselv)o(es)-76
2469 y(to)i(singly-recursi)q(v)o(e)j(datat)o(yp)q(es)e(and)g(functions)
g(\(i.e.)21 b(no)14 b(m)o(utual)-76 2510 y(recursion\),)h(though)g(w)o
(e)e(exp)q(ect)h(the)g(algorithms)i(to)d(ha)o(v)o(e)i(a)e(nat-)-76
2552 y(ural)h(extension)h(to)f(the)f(more)g(general)i(case.)j(More)13
b(signi\014can)o(tl)q(y)m(,)-76 2593 y(w)o(e)e(also)h(restrict)g
(ourselv)o(es)h(to)e(ground)i(data)f(t)o(yp)q(es,)f(that)h(is,)g(data)
-76 2635 y(t)o(yp)q(es)g(whic)o(h)g(are)f(not)g(built)i(using)f
(function)h(space.)k(Recen)o(t)11 b(w)o(ork)-76 2676
y(b)o(y)g(Hutton)g(and)h(Meijer)f(ma)o(y)g(p)q(oin)o(t)h(the)f(w)o(a)o
(y)f(to)h(relaxing)i(this)f(re-)-76 2718 y(striction)j([MH95].)h(In)d
(a)g(practical)h(con)o(text,)f(if)g(these)g(data)h(t)o(yp)q(es)1020
911 y(o)q(ccur,)f(then)h(our)f(algorithm)i(simply)g(mak)o(es)f(no)f
(attempt)g(to)g(fuse)1020 953 y(them.)1076 995 y(Finally)m(,)19
b(while)e(the)f Fl(build)e Fm(form)i(is)g(presen)o(ted)h(as)f(a)g(part)
g(of)1020 1036 y(the)e(language,)i(our)e(in)o(ten)o(t)g(is)h(that)f(it)
g(b)q(e)g(used)h(for)e(in)o(ternal)j(pur-)1020 1078 y(p)q(oses)e(only)h
(and)f(not)g(exp)q(osed)g(to)g(a)f(programmer.)19 b(Our)13
b(metho)q(d)1020 1119 y(for)18 b(in)o(tro)q(ducing)i
Fl(build)c Fm(in)o(to)i(a)g(term)g(guaran)o(tees)h(the)f(v)n(alidit)o
(y)1020 1161 y(of)c(a)h(the)g Fl(cata)p Fm(-)p Fl(build)c
Fm(equation)16 b(ab)q(o)o(v)o(e|in)h(general)f(the)f(rule)h(is)1020
1202 y(not)i(v)n(alid.)31 b(If)16 b Fl(build)g Fm(w)o(as)h(exp)q(osed)h
(to)f(the)h(programmer)g(then)1020 1244 y(a)c(corresp)q(onding)i
(\\cleanliness")h(c)o(hec)o(k)d(w)o(ould)h(b)q(e)e(required:)20
b(the)1020 1285 y(t)o(yp)q(e-rule)15 b(of)f(Gill,)h(Launc)o(h)o(bury)h
(and)e(P)o(eyton)h(Jones)f(serv)o(es)g(this)1020 1327
y(purp)q(ose,)g(for)f(example)h([GLPJ93].)1020 1424 y
Fn(4)41 b(Tw)o(o-stage)12 b(F)o(usion)1020 1502 y Fm(As)j(stated)h
(earlier,)h(our)f(fusion)g(pro)q(cess)g(pro)q(ceeds)h(in)f(t)o(w)o(o)f
(sepa-)1020 1544 y(rate)j(phases.)31 b(First)18 b(individua)q(l)i
(function)f(de\014nitions)i(are)c(pre-)1020 1585 y(pro)q(cessed)22
b(in)f(an)f(attempt)h(to)f(re-express)h(their)g(de\014nition)i(in)1020
1627 y(terms)18 b(of)g(a)g Fl(build)e Fm(and)i(a)g(catamorphism.)34
b(Second,)20 b(separate)1020 1668 y(in)o(v)o(o)q(cations)14
b(of)e(suc)o(h)g(functions)h(are)f(fused)g(with)g(one)g(another)h(us-)
1020 1710 y(ing)k(the)f(one-step)h(fusion)h(rule)f(\(equation)g(3\))g
(in)f(whic)o(h)h Fl(build)p Fm('s)1020 1751 y(and)d Fl(cata)p
Fm('s)d(cancel.)1076 1793 y(In)18 b(realit)o(y)m(,)h(there)f(is)g(some)
f(in)o(terpla)o(y)j(b)q(et)o(w)o(een)e(the)f(phases.)1020
1834 y(As)f(the)g Fl(reverse)e Fm(example)k(will)f(sho)o(w)g(later,)g
(it)g(is)g(often)f(w)o(orth)1020 1876 y(taking)h(adv)n(an)o(tage)g(of)e
(ha)o(ving)i(already)g(prepro)q(cessed)h(functions)1020
1917 y(used)h(within)g(the)f(b)q(o)q(dy)h(of)e(the)h(function)h(b)q
(eing)h(prepro)q(cessed.)1020 1959 y(But)c(in)g(the)g(life-cycle)h(of)e
(an)o(y)h(giv)o(en)h(function,)g(the)f(t)o(w)o(o)f(phases)1020
2000 y(are)e(distinct.)1076 2042 y(In)18 b(principle,)j(preparing)f
(for)d(the)h(\014rst)g(phase)h(is)f(simplicit)o(y)1020
2083 y(itself.)25 b(Supp)q(ose)17 b(w)o(e)e(had)h(a)g(function)g
Fk(fo)n(o)h Fm(=)d Fk(b)n(o)n(dy)j Fm(:)d Fk(List)h(int)f
Fi(!)1020 2125 y Fk(List)e(int)o Fm(,)f(where)h Fk(b)n(o)n(dy)h
Fm(is)g(a)e(function-v)n(alued)k(expression)f(\(usually)1020
2167 y(of)c(the)h(form:)k Fj(\025x)c(:)f(:::)p Fm(\))f(calling)k
Fk(fo)n(o)c Fm(recursiv)o(ely)m(.)18 b(W)m(e)11 b(ma)o(y)f(rede\014ne)
1020 2208 y Fk(fo)n(o)i Fm(as)h(follo)o(ws:)1127 2289
y Fj(f)t(oo)36 b Fm(=)h Fj(\025w)12 b(:)e Fl(build)1472
2273 y Ff(List)1530 2289 y Fm(\()p Fj(\025)p Fm(\()p
Fj(n;)d(c)p Fm(\))j Fj(:)g Fl(cata)1765 2273 y Ff(List)1836
2289 y Fm(\()p Fj(n;)c(c)p Fm(\))1342 2337 y(\()p Fk(b)n(o)n(dy)12
b Fm(\()p Fl(cata)1535 2322 y Ff(List)1606 2337 y Fm(\()p
Fh(Nil)o Fj(;)6 b Fh(Cons)p Fm(\))13 b Fj(w)q Fm(\)\)\))1020
2414 y(There)19 b(are)f(t)o(w)o(o)g(thing)i(going)g(on)e(here.)34
b(The)18 b(\014rst)h(is)g(that)g(w)o(e)1020 2456 y(apply)i(a)f
(particular)i(form)d(of)h(the)f(iden)o(tit)o(y)j(function)f(\(namely)
1020 2505 y Fl(cata)1099 2489 y Ff(List)1169 2505 y Fm(\()p
Fh(Nil)o Fj(;)6 b Fh(Cons)p Fm(\),)12 b(also)i(called)g(the)f
Fk(c)n(opy)e Fm(function\))i(to)g Fk(b)n(o)n(dy)o Fm('s)1020
2546 y(argumen)o(t.)18 b(Our)12 b(purp)q(ose)i(is)f(to)f(attempt)h(to)f
(fuse)h Fk(b)n(o)n(dy)d Fm(with)j(this)1020 2588 y(catamorphism.)19
b(If)12 b(successful,)i(w)o(e)f(will)h(ha)o(v)o(e)f(managed)h(to)f
(reex-)1020 2629 y(press)h(the)f(recursion)h(in)g Fk(b)n(o)n(dy)e
Fm(as)h(a)g(catamorphism.)1076 2676 y(The)e(second)h(c)o(hange)g(to)f
Fk(fo)n(o)e Fm(in)o(v)o(olv)o(es)14 b(in)o(tro)q(ducing)f
Fl(build)1948 2661 y Ff(List)2006 2676 y Fm(.)1020 2718
y(The)h(purp)q(ose)i(of)e Fl(build)e Fm(is)i(to)h(enshroud)g(a)g
(function)g(whic)o(h)g(cor-)p eop
%%Page: 4 4
4 3 bop -76 -34 a Fm(resp)q(onds)17 b(to)f(a)f(data)h(structure)h
(\(here)e(a)h(list\))h(except)f(that)g(it)g(is)-76 7
y(abstracted)f(o)o(v)o(er)f(the)g(constructors)i(of)d(the)h(data)h(t)o
(yp)q(e.)20 b(The)14 b(ab-)-76 49 y(straction)19 b(is)f(easily)h(ac)o
(hiev)o(ed)g(using)g Fl(cata)p Fm(,)d(since)j(as)e(describ)q(ed)-76
90 y(earlier)h(cata)f(replaces)h(ev)o(ery)f(constructor)h(in)g(a)e
(data)i(structure)-76 132 y(with)e(an)g(asso)q(ciated)i(function,)f
(Here)e(the)h(asso)q(ciated)i(functions)-76 173 y(are)e(the)h(v)n
(ariables)h(abstracting)g(the)e(constructors.)27 b(Again,)18
b(our)-76 215 y(goal)d(is)g(to)g(fuse)f(this)h(use)g(of)f
Fl(cata)e Fm(in)o(to)j Fk(b)n(o)n(dy)o Fm(,)f(replacing)i(an)o(y)f(ex-)
-76 256 y(plicit)g(\\output)f(constructors")h(with)e(the)g(parameters)h
Fj(n)f Fm(and)h Fj(c)p Fm(.)-76 350 y Fn(4.1)41 b(Rewrite)13
b(rules)-76 416 y Fm(The)j(fusion)g(algorithm)i(can)e(b)q(e)f
(expressed)i(in)f(terms)g(of)f(rewrite)-76 457 y(rules,)g(except)g
(that)g(in)g(order)f(to)g(fuse)h(catamorphisms,)h(w)o(e)e(ha)o(v)o(e)
-76 499 y(to)h(allo)o(w)h(the)f(rule)h(set)f(to)g(gro)o(w)f(and)i
(shrink)g(dynamicall)q(y)m(.)25 b(The)-76 540 y(basic)18
b(rewrite)e(rules,)i(called)g Fi(R)409 544 y Fd(0)426
540 y Fm(,)f(are)f(giv)o(en)i(in)f(Figure)g(2.)27 b(The)-76
582 y(syn)o(tax)14 b Fj(b)p Fm([)p Fj(v)e Fi(7!)g Fj(e)p
Fm(])g(denotes)j(the)e(\(capture-free\))h(substitution)i(of)d
Fj(e)-76 623 y Fm(for)g(free)g(o)q(ccurences)h(of)f Fj(v)g
Fm(in)h Fj(b)p Fm(.)-20 665 y(The)k(\014nal)h(rule)f(p)q(erforms)g
(one-step)h(deforestation.)32 b(As)18 b(w)o(e)-76 706
y(noted)e(in)f(Section)i(3,)e(w)o(e)f(need)i(some)f(mec)o(hanism)h(to)f
(guaran)o(tee)-76 748 y(its)f(correctness.)20 b(F)m(or)14
b(our)g(purp)q(oses,)h(w)o(e)e(guaran)o(tee)i(correctness)-76
789 y(b)o(y)c(limiting)j Fl(build)n Fm(-in)o(tro)q(duction)f(to)d(in)o
(tro)q(duce)j(a)d(corresp)q(onding)-76 831 y Fl(cata)e
Fm(as)j(in)f(the)g(example)i(ab)q(o)o(v)o(e)f(\(more)f(details)h(are)f
(in)h(Section)h(6\).)-76 872 y(Then,)j(assuming)i(that)d(all)i
(rewrites)f(preserv)o(e)h(equalit)o(y)m(,)g(an)o(y)f(ar-)-76
914 y(gumen)o(t)e Fl(g)e Fm(to)g Fl(build)f Fm(m)o(ust)i(remain)h
(equal)g(to)f(a)f(term)h(of)g(the)f(form)-76 955 y Fj(\025)q
Fm(\026)-20 b Fj(c)11 b(:)f Fl(cata)i Fm(\026)-20 b Fj(c)13
b(e)p Fm(,)f(for)h(some)g Fj(e)p Fm(.)k(Th)o(us)97 1039
y Fl(cata)175 1021 y Fg(T)213 1029 y Fm(\026)213 1039
y Fj(h)c Fm(\()p Fl(build)d Fj(g)q Fm(\))134 1084 y(=)38
b Fl(cata)280 1069 y Fg(T)318 1075 y Fm(\026)317 1084
y Fj(h)13 b Fm(\()p Fl(build)n Fm(\()p Fj(\025)q Fm(\026)-20
b Fj(c)11 b(:)f Fl(cata)630 1069 y Fg(T)667 1084 y Fm(\026)-19
b Fj(c)12 b(e)p Fm(\)\))134 1130 y(=)38 b Fl(cata)280
1114 y Fg(T)318 1120 y Fm(\026)317 1130 y Fj(h)13 b Fm(\()p
Fl(cata)445 1114 y Fg(T)483 1130 y Fm(\()p Fk(Constrs)q
Fm(\()p Fj(T)5 b Fm(\)\))14 b Fj(e)p Fm(\))134 1175 y(=)38
b Fl(cata)280 1159 y Fg(T)318 1165 y Fm(\026)317 1175
y Fj(h)13 b(e)134 1220 y Fm(=)38 b(\()p Fj(\025)q Fm(\026)-20
b Fj(c)10 b(:)h Fl(cata)366 1205 y Fg(T)404 1220 y Fm(\026)-20
b Fj(c)13 b(e)p Fm(\))479 1211 y(\026)478 1220 y Fj(h)134
1264 y Fm(=)38 b Fj(g)234 1254 y Fm(\026)234 1264 y Fj(h)-76
1344 y Fm(so)13 b(demonstrating)i(the)f(v)n(alidit)o(y)h(of)e(the)g
Fl(cata)p Fm(-)p Fl(build)c Fm(la)o(w.)-20 1385 y(It)21
b(is)g(often)g(adv)n(an)o(tageous)i(to)e(extend)h(the)f(notation)i(of)d
(a)-76 1427 y(rewrite)10 b(rule)h Fi(f)p Fk(lhs)f Fi(!)h
Fk(rhs)o Fi(g)f Fm(to)f(co)o(v)o(er)h(the)g(case)g(where)g(b)q(oth)g
Fk(lhs)f Fm(and)-76 1469 y Fk(rhs)14 b Fm(are)h(tuples.)23
b(W)m(e)14 b(in)o(tro)q(duce)j(the)d(notation)j Fi(\))d
Fm(for)h(this)g(case.)-76 1510 y(W)m(e)d(de\014ne)h Fi(f)p
Fm(\()p Fj(x)155 1514 y Fd(1)172 1510 y Fj(;)6 b(:)g(:)g(:)g(;)g(x)279
1514 y Fg(n)300 1510 y Fm(\))22 b Fi(\))f Fm(\()p Fj(y)430
1514 y Fd(1)448 1510 y Fj(;)6 b(:)g(:)g(:)g(;)g(y)552
1514 y Fg(n)573 1510 y Fm(\))p Fi(g)12 b Fm(to)g(mean)g(the)g(set)f(of)
-76 1552 y(rules)j(extracted)g(comp)q(onen)o(t-wise)h
Fi(f)p Fj(x)507 1556 y Fd(1)535 1552 y Fi(!)c Fj(y)603
1556 y Fd(1)620 1552 y Fj(;)6 b(:)g(:)g(:)g(;)g(x)727
1556 y Fg(n)759 1552 y Fi(!)11 b Fj(y)827 1556 y Fg(n)848
1552 y Fi(g)p Fm(.)-20 1593 y(W)m(e)k(also)h(extend)g(the)g
Fi(\))f Fm(notation)i(b)o(y)e(allo)o(wing)i Fj(E)h Fm(functors)-76
1635 y(o)o(v)o(er)d(the)f(tuples.)22 b(Th)o(us:)e Fi(f)p
Fj(E)369 1642 y Fh(C)399 1635 y Fm(\()p Fj(g)q Fm(\)\()p
Fj(x)485 1639 y Fd(1)502 1635 y Fj(;)6 b(:)g(:)g(:)h(;)f(x)610
1639 y Fg(n)631 1635 y Fm(\))12 b Fi(\))i Fm(\()p Fj(y)744
1639 y Fd(1)761 1635 y Fj(;)6 b(:)g(:)g(:)g(;)g(y)865
1639 y Fg(n)886 1635 y Fm(\))p Fi(g)-76 1676 y Fm(is)19
b(equiv)n(alen)o(t)i(to)d(the)h(set)f(of)g(rules)h Fi(f)p
Fj(z)528 1680 y Fd(1)565 1676 y Fi(!)h Fj(y)642 1680
y Fd(1)659 1676 y Fj(;)6 b(:)g(:)g(:)g(;)h(z)763 1680
y Fg(n)803 1676 y Fi(!)20 b Fj(y)880 1680 y Fg(n)901
1676 y Fi(g)-76 1718 y Fm(where)14 b Fj(z)54 1722 y Fg(i)81
1718 y Fm(is)g(some)h(term)e(dep)q(ending)k(on)d Fj(x)572
1722 y Fg(i)585 1718 y Fm(,)g Fj(g)q Fm(,)g(and)h Fj(E)758
1725 y Fh(C)787 1718 y Fm(,)f(gained)-76 1759 y(b)o(y)j(expanding)h
(out)f(the)f(de\014nition)j(of)d Fj(E)558 1766 y Fh(C)603
1759 y Fm(to)h(giv)o(e)g(a)f(v)o(ector)g(of)-76 1801
y(rules.)i(F)m(or)13 b(example)132 1878 y Fi(f)p Fj(E)179
1885 y Ff(Cons)254 1878 y Fm(\()p Fj(g)q Fm(\)\()p Fj(x)340
1882 y Fd(1)357 1878 y Fj(;)6 b(x)396 1882 y Fd(2)413
1878 y Fm(\))24 b Fi(\))g Fm(\()p Fj(y)548 1882 y Fd(1)565
1878 y Fj(;)6 b(y)601 1882 y Fd(2)618 1878 y Fm(\))p
Fi(g)247 1920 y Fm(=)37 b Fi(f)p Fm(\()p Fj(x)370 1924
y Fd(1)387 1920 y Fj(;)6 b(g)12 b(x)456 1924 y Fd(2)473
1920 y Fm(\))24 b Fi(\))g Fm(\()p Fj(y)608 1924 y Fd(1)625
1920 y Fj(;)6 b(y)661 1924 y Fd(2)678 1920 y Fm(\))p
Fi(g)247 1961 y Fm(=)37 b Fi(f)p Fj(x)355 1965 y Fd(1)383
1961 y Fi(!)11 b Fj(y)451 1965 y Fd(1)468 1961 y Fj(;)19
b Fm(\()p Fj(g)12 b(x)565 1965 y Fd(2)582 1961 y Fm(\))f
Fi(!)g Fj(y)676 1965 y Fd(2)693 1961 y Fi(g)-76 2056
y Fn(4.2)41 b(F)o(using)12 b(Catamo)o(rphisms)-76 2122
y Fm(The)h(success)g(of)g(our)g(tec)o(hnique)i(dep)q(ends)f(critically)
i(on)d(our)g(abil-)-76 2163 y(it)o(y)i(to)f(fuse)g(catamorphisms.)23
b(The)14 b(algorithm)i(for)e(this)i(is)e(based)-76 2205
y(on)i(the)f Fk(pr)n(omotion)f(the)n(or)n(em)p Fm(,)g(whic)o(h)i
(describ)q(es)h(when)e(the)g(com-)-76 2246 y(p)q(osition)e(of)c(a)i
(\(strict\))f(function)i Fj(g)f Fm(with)g(a)f Fl(cata)e
Fm(can)j(b)q(e)f(expressed)-76 2288 y(as)j(another)h
Fl(cata)d Fm([Mal89)r(,)h(MFR91)q(].)-4 2368 y Fi(8)p
Fc(C)f Fm(:)23 b Fj(g)15 b Fm(\()p Fj(f)161 2375 y Fh(C)190
2368 y Fm(\()p Fj(y)224 2372 y Fd(1)241 2368 y Fj(;)6
b(:)g(:)g(:)g(;)g(y)345 2372 y Fg(n)366 2368 y Fm(\)\))21
b(=)h Fj(h)491 2375 y Fh(C)520 2368 y Fm(\()p Fj(E)563
2375 y Fh(C)592 2368 y Fm(\()p Fj(g)q Fm(\)\()p Fj(y)675
2372 y Fd(1)693 2368 y Fj(;)6 b(:)g(:)g(:)g(;)g(y)797
2372 y Fg(n)818 2368 y Fm(\)\))p -22 2382 890 2 v 187
2429 a Fj(g)14 b Fm(\()p Fl(cata)312 2413 y Fg(T)356
2419 y Fm(\026)347 2429 y Fj(f)h(x)p Fm(\))21 b(=)g Fl(cata)568
2413 y Fg(T)604 2419 y Fm(\026)603 2429 y Fj(h)11 b(x)-76
2509 y Fm(Instan)o(tiating)16 b(the)d(theorem)g(to)g(lists)h(giv)o(es:)
109 2587 y Fj(g)h Fm(\()p Fj(f)176 2594 y Ff(Nil)220
2587 y Fm(\(\)\))156 b(=)37 b Fj(h)510 2594 y Ff(Nil)555
2587 y Fm(\(\))109 2628 y Fj(g)15 b Fm(\()p Fj(f)176
2635 y Ff(Cons)249 2628 y Fm(\()p Fj(y)283 2632 y Fd(1)300
2628 y Fj(;)6 b(y)336 2632 y Fd(2)353 2628 y Fm(\)\))38
b(=)f Fj(h)510 2635 y Ff(Cons)584 2628 y Fm(\()p Fj(y)618
2632 y Fd(1)635 2628 y Fj(;)6 b(g)14 b(y)703 2632 y Fd(2)721
2628 y Fm(\))p -55 2642 954 2 v -36 2692 a Fj(g)h Fm(\()p
Fl(cata)90 2676 y Ff(List)161 2692 y Fm(\()p Fj(f)195
2699 y Ff(Nil)240 2692 y Fj(;)6 b(f)276 2699 y Ff(Cons)349
2692 y Fm(\))11 b Fj(x)p Fm(\))23 b(=)g Fl(cata)567 2676
y Ff(List)638 2692 y Fm(\()p Fj(h)675 2699 y Ff(Nil)720
2692 y Fj(;)6 b(h)759 2699 y Ff(Cons)833 2692 y Fm(\))11
b Fj(x)1076 -34 y Fm(The)i(follo)o(wing)j(example)f(is)f(helpful)h(in)g
(understanding)h(what)1020 7 y(the)e(promotion)i(theorem)e(is)h(doing.)
21 b(If)13 b(the)h Fj(x)f Fm(in)i(the)f(theorem)h(is)1020
49 y(tak)o(en)f(to)f(b)q(e)g(the)g(list)h Fh(Cons)p Fm(\(7)p
Fj(;)6 b Fh(Cons)p Fm(\(3)p Fj(;)g Fh(Nil)o Fm(\(\)\)\),)12
b(then)i(w)o(e)e(ha)o(v)o(e:)1142 130 y Fj(g)i Fm(\()p
Fl(cata)1267 114 y Ff(List)1325 130 y Fm(\()p Fj(f)1359
137 y Ff(Nil)1404 130 y Fj(;)6 b(f)1440 137 y Ff(Cons)1514
130 y Fm(\))13 b(\()p Fh(Cons)o Fm(\(7)p Fj(;)6 b Fh(Cons)p
Fm(\(3)p Fj(;)g Fh(Nil)o Fm(\(\)\)\)\)\))1074 171 y(=)38
b Fj(g)14 b Fm(\()p Fj(f)1208 178 y Ff(Cons)1281 171
y Fm(\(7)p Fj(;)7 b(f)1352 178 y Ff(Cons)1425 171 y Fm(\(3)p
Fj(;)f(f)1495 178 y Ff(Nil)1540 171 y Fm(\(\)\)\)\))1020
245 y(Applying)19 b(the)d(second)h(h)o(yp)q(othesis)i(t)o(wice)d(allo)o
(ws)i(us)e(to)g(push)i Fj(g)1020 287 y Fm(all)f(the)f(w)o(a)o(y)g(to)g
(the)g(end)h(of)e(the)i(list,)g(c)o(hanging)h(the)e Fj(f)1867
294 y Ff(Cons)1941 287 y Fm('s)f(to)1020 328 y Fj(h)1042
335 y Ff(Cons)1116 328 y Fm('s)e(in)g(the)h(pro)q(cess.)1244
400 y(=)38 b Fj(g)14 b Fm(\()p Fj(f)1378 407 y Ff(Cons)1451
400 y Fm(\(7)p Fj(;)7 b(f)1522 407 y Ff(Cons)1595 400
y Fm(\(3)p Fj(;)f(f)1665 407 y Ff(Nil)1710 400 y Fm(\(\)\)\)\))1244
442 y(=)38 b Fj(h)1334 449 y Ff(Cons)1408 442 y Fm(\(7)p
Fj(;)6 b(g)14 b Fm(\()p Fj(f)1525 449 y Ff(Cons)1599
442 y Fm(\(3)p Fj(;)6 b(f)1669 449 y Ff(Nil)1714 442
y Fm(\(\)\)\)\))1244 483 y(=)38 b Fj(h)1334 490 y Ff(Cons)1408
483 y Fm(\(7)p Fj(;)6 b(h)1481 490 y Ff(Cons)1555 483
y Fm(\(3)p Fj(;)g(g)14 b Fm(\()p Fj(f)1672 490 y Ff(Nil)1717
483 y Fm(\(\)\)\)\))1020 557 y(No)o(w)f(applying)i(the)e(\014rst)h(h)o
(yp)q(othesis)h(remo)o(v)o(es)e Fj(g)i Fm(altogether:)1244
629 y(=)38 b Fj(h)1334 636 y Ff(Cons)1408 629 y Fm(\(7)p
Fj(;)6 b(h)1481 636 y Ff(Cons)1555 629 y Fm(\(3)p Fj(;)g(g)14
b Fm(\()p Fj(f)1672 636 y Ff(Nil)1717 629 y Fm(\(\)\)\)\))1244
671 y(=)38 b Fj(h)1334 678 y Ff(Cons)1408 671 y Fm(\(7)p
Fj(;)6 b(h)1481 678 y Ff(Cons)1555 671 y Fm(\(3)p Fj(;)g(h)1628
678 y Ff(Nil)1673 671 y Fm(\(\)\)\))1020 745 y(But)13
b(this)h(is)g(just)1136 826 y Fl(cata)1214 808 y Ff(List)1272
826 y Fm(\()p Fj(h)1309 833 y Ff(Nil)1355 826 y Fj(;)6
b(h)1394 833 y Ff(Cons)1468 826 y Fm(\))12 b(\()p Fh(Cons)p
Fm(\(7)p Fj(;)6 b Fh(Cons)p Fm(\(3)p Fj(;)g Fh(Nil)o
Fm(\(\)\)\)\))1020 899 y(W)m(e)11 b(in)o(tend)i(to)e(apply)i(the)f
(promotion)h(theorem)e(as)h(a)f(left-to-righ)o(t)1020
941 y(rewrite)j(rule.)k(In)13 b(order)g(to)h(do)f(this)h(w)o(e)f(m)o
(ust)g(\014nd)h(a)f(set)g(of)g(func-)1020 982 y(tions)e
Fj(h)1133 989 y Fh(C)1173 982 y Fm(whic)o(h)g(meet)f(the)g(conditions)j
(of)d(the)g(premise.)17 b(In)10 b(previ-)1020 1024 y(ous)k(w)o(ork,)g
(Sheard)h(and)f(F)m(egaras)g(describ)q(ed)i(a)e Fk(fusion)e(algorithm)
1020 1065 y Fm(whic)o(h)17 b(either)f(computed)h(the)f
Fj(h)1515 1072 y Fh(C)1544 1065 y Fm(,)g(or)g(terminated)h(with)g
(failure)1020 1107 y([SF93)q(].)h(The)c(c)o(hallenge)i(in)e(computing)i
(the)d Fj(h)1726 1114 y Fh(C)1769 1107 y Fm(is)h(the)g(presence)1020
1148 y(of)e(the)g Fj(E)1156 1155 y Fh(C)1186 1148 y Fm(\()p
Fj(g)q Fm(\))g(term)g(on)h(the)f(righ)o(t-hand)i(side)g(of)e(the)g
(premise)h(\(in)1020 1190 y(the)j(general)i(case\).)26
b(In)16 b(the)h(list)g(instance)h(of)d(the)i(theorem)f(this)1020
1231 y(manifests)c(itself)g(as)f(the)g Fj(g)h Fm(in)g(the)f(the)g(call)
h(to)f Fj(h)1724 1238 y Ff(Cons)1808 1231 y Fm(on)g(the)g(righ)o(t-)
1020 1273 y(hand)16 b(side)g(of)e(the)h(second)h(h)o(yp)q(othesis.)25
b(Without)16 b(this)g(term)f(w)o(e)1020 1314 y(w)o(ould)f(ha)o(v)o(e)g
(an)f(immediate)i(de\014nition)g(of)e(the)g Fj(h)1764
1321 y Fh(C)1793 1314 y Fm(.)1076 1356 y(The)k(approac)o(h)h(w)o(e)e
(tak)o(e)h(to)g(generate)g(the)g Fj(h)1775 1363 y Fh(C)1821
1356 y Fm(functions)i(is)1020 1397 y(to)14 b(in)o(tro)q(duce)i
(additional)i(free)13 b(v)n(ariables,)19 b(\026)-21 b
Fj(z)q Fm(,)14 b(and)h(to)f(extend)h(the)1020 1439 y(curren)o(t)f(set)f
(of)g(rewrite)g(rules)h(with)g(additional)i(temp)q(orary)e(rules)1020
1480 y(whic)o(h)20 b(describ)q(e)h(ho)o(w)e(to)g(eliminate)j(com)o
(binations)g(of)d(the)g(old)1020 1522 y(v)n(ariables)f(\()s(\026)-22
b Fj(y)q Fm(\))15 b(with)g Fj(g)q Fm(,)h(in)g(fa)o(v)o(or)g(of)f(the)g
(new)g(free)g(v)n(ariables.)26 b(If,)1020 1563 y(at)13
b(the)f(end)h(of)g(rewriting,)g(all)h(the)f(old)h Fj(y)q
Fm('s)e(ha)o(v)o(e)h(b)q(een)g(eliminated)1020 1605 y(then)d(w)o(e)f
(ha)o(v)o(e)h(successfully)i(disco)o(v)o(ered)f(a)f(de\014nition)i(for)
d Fj(h)1898 1612 y Fh(C)1927 1605 y Fm(,)h(oth-)1020
1646 y(erwise)15 b(failure)h(is)f(rep)q(orted.)21 b(See)15
b(Section)h(4.3)e(and)h(Figure)g(3)f(for)1020 1688 y(a)e(detailed)j
(example.)j(Note)12 b(that)g(the)h(additional)j(rules)d(are)f(v)n(alid)
1020 1729 y(only)g(for)e(the)h(b)q(o)q(dy)h(of)e(the)h
Fj(h)1444 1736 y Fh(C)1484 1729 y Fm(function,)h(and)f(m)o(ust)g(b)q(e)
g(discarded)1020 1771 y(once)j(the)f(rewriting)h(of)f(the)g(b)q(o)q(dy)
h(of)f Fj(h)1611 1778 y Fh(C)1653 1771 y Fm(has)g(terminated.)1076
1812 y(T)m(o)g(mak)o(e)h(this)h(formal)g(w)o(e)e(in)o(tro)q(duce)i(the)
f(follo)o(wing)i(sequen)o(t)1020 1854 y(notation.)33
b(W)m(e)18 b(write)g Fi(R)36 b(`)h Fj(e)18 b Fi(\000)-6
b(!)19 b Fj(e)1641 1838 y Fe(0)1670 1854 y Fm(to)e(mean)i(that,)g
(using)1020 1895 y(rule-set)g Fi(R)p Fm(,)g(the)g(term)f
Fj(e)h Fm(rewrites)g(to)f Fj(e)1652 1879 y Fe(0)1681
1895 y Fm(\(in)i(one)e(step\).)34 b(The)1020 1937 y(notation)18
b Fi(R)31 b(`)h Fj(e)26 b Fi(!)-48 b(\000)-7 b(!)17 b
Fj(e)1426 1921 y Fe(0)1453 1937 y Fm(is)f(its)h(re\015exiv)o(e,)h
(transitiv)o(e)g(closure.)1020 1978 y(The)13 b(complete)h(rewrite)f
(system)h(is)f(giv)o(en)i(in)f(Figure)g(3.)1076 2020
y(The)d(\014rst)h(rule)g(simply)h(applies)h(existing)f(rewrite)f(rules)
g(in)h(an)o(y)1020 2061 y(con)o(text.)j(The)10 b(second)g(rule)h(is)f
(the)f(most)h(in)o(teresting.)18 b(It)9 b(p)q(erforms)1020
2103 y Fl(cata)p Fm(-fusion.)26 b(If)15 b(a)h(term)g(of)g(the)g(form)g
Fj(g)8 b Fm(\()p Fl(cata)1748 2087 y Fg(T)1773 2103 y
Fm(\()p Fj(f)1807 2107 y Fd(1)1824 2103 y Fj(;)e(:)g(:)g(:)g(;)g(f)1928
2107 y Fg(n)1949 2103 y Fm(\))16 b Fj(x)p Fm(\))1020
2144 y(is)i(encoun)o(tered)g(then)f(for)g(eac)o(h)h(constructor)f(in)h
(the)f(data)h(t)o(yp)q(e)1020 2186 y Fj(T)5 b Fm(,)20
b(an)e(extended)h(rewriting)h(system)e(is)h(constructed)g(and)f(used)
1020 2227 y(to)c(attempt)g(to)g(pro)q(duce)h(the)f(b)q(o)q(dy)h(of)f
(the)g(functions)h Fj(h)1876 2234 y Fh(C)1906 2227 y
Fm(.)k(Note)1020 2269 y(that)12 b(as)g(far)g(as)g(the)g(rewriting)i
(system)e(is)g(concerned,)i(the)e(v)o(ectors)1020 2310
y(of)k(new)g(v)n(ariables)i(ha)o(v)o(e)e(to)g(b)q(e)g(treated)h(as)f
(literals,)i(and)f(not)f(as)1020 2352 y(term-rewriting)g(v)n(ariables.)
25 b(W)m(e)15 b(indicate)h(this)g(using)g(b)q(old)h(fon)o(t.)1020
2393 y(Finally)m(,)e(if)e(the)g(result)h(of)f(an)o(y)g(of)g(these)g
(rewritings)i(still)g(con)o(tains)1020 2435 y(an)o(y)d(o)q(ccurrence)g
(of)f(the)g(new)g(free)g(v)n(ariables)i Fc(y)q Fm(,)e(then)h(the)f
(premise)1020 2476 y(of)i(the)g(rule)h(fails,)g(and)f
Fl(cata)p Fm(-fusion)g(is)g(not)h(p)q(erformed.)1020
2569 y Fn(4.3)41 b(Example)1020 2635 y Fm(T)m(o)15 b(see)g(these)h
(rules)g(in)g(action,)h(consider)g(fusing)f(the)g(sum)f(func-)1020
2676 y(tion)20 b(with)g Fj(map)f Fm(when)g(eac)o(h)h(are)f(already)i
(expressed)f(as)f(cata-)1020 2718 y(morphisms)c(\(w)o(e)e(will)i(deal)g
(with)f(explicit)i(recursion)f(in)f(the)g(next)p eop
%%Page: 5 5
5 4 bop 72 -5 a Fi(R)105 -1 y Fd(0)145 -5 y Fm(=)24 b
Fi(f)37 b Fm(\()p Fj(\025v)12 b(:)f(b)p Fm(\))g Fj(e)618
b Fi(!)37 b Fj(b)p Fm([)p Fj(v)12 b Fi(7!)f Fj(e)p Fm(])p
Fj(;)44 b Fm(if)16 b Fj(v)e Fm(linear)h(in)f Fj(b)255
36 y Fm(\()p Fj(\025)p Fm(\()p Fj(v)326 40 y Fd(1)344
36 y Fj(;)6 b(:)g(:)g(:)g(;)g(v)448 40 y Fg(n)469 36
y Fm(\))k Fj(:)h(b)p Fm(\))i(\()p Fj(e)593 40 y Fd(1)610
36 y Fj(;)6 b(:)g(:)g(:)g(;)g(e)713 40 y Fg(n)734 36
y Fm(\))274 b Fi(!)37 b Fj(b)p Fm([)p Fj(v)1144 40 y
Fd(1)1172 36 y Fi(7!)11 b Fj(e)1239 40 y Fd(1)1256 36
y Fj(;)6 b(:)h(:)f(:)g(;)g(v)1361 40 y Fg(n)1392 36 y
Fi(7!)11 b Fj(e)1459 40 y Fg(n)1480 36 y Fm(])p Fj(;)45
b Fm(if)16 b Fj(v)1604 40 y Fg(i)1629 36 y Fm(linear)f(in)f
Fj(e)1799 40 y Fg(i)255 78 y Fl(case)e Fh(C)374 82 y
Fg(i)400 78 y Fm(\026)-22 b Fj(x)13 b Fl(of)f Fh(C)511
82 y Fd(1)530 78 y Fm(\026)-21 b Fj(v)547 82 y Fd(1)577
78 y Fl(->)12 b Fj(e)647 82 y Fd(1)671 78 y Fl(|)g Fj(:)6
b(:)g(:)13 b Fl(|)f Fh(C)820 82 y Fg(n)843 78 y Fm(\026)-21
b Fj(v)860 82 y Fg(n)894 78 y Fl(->)12 b Fj(e)964 82
y Fg(n)1023 78 y Fi(!)37 b Fj(e)1116 82 y Fg(i)1129 78
y Fm([)q(\026)-20 b Fj(v)1159 82 y Fg(i)1183 78 y Fi(7!)13
b Fm(\026)-21 b Fj(x)o Fm(])p Fj(;)45 b Fm(if)16 b Fj(v)1377
82 y Fg(i)1402 78 y Fm(linear)f(in)f Fj(e)1572 82 y Fg(i)255
123 y Fl(cata)334 107 y Fg(T)358 123 y Fm(\()p Fj(f)392
127 y Fd(1)409 123 y Fj(;)6 b(:)g(:)g(:)g(;)g(f)513 127
y Fg(n)534 123 y Fm(\))11 b(\()p Fj(C)602 127 y Fg(i)630
123 y Fm(\026)-21 b Fj(x)p Fm(\))358 b Fi(!)37 b Fj(f)1117
127 y Fg(i)1143 123 y Fm(\()p Fj(E)1186 127 y Fg(i)1212
123 y Fm(\()p Fl(cata)1306 107 y Fg(T)1330 123 y Fm(\()p
Fj(f)1364 127 y Fd(1)1381 123 y Fj(;)6 b(:)g(:)g(:)g(;)g(f)1485
127 y Fg(n)1506 123 y Fm(\)\))15 b(\026)-21 b Fj(x)o
Fm(\))p Fj(;)255 168 y Fl(cata)334 153 y Fg(T)358 168
y Fm(\()p Fj(f)392 172 y Fd(1)409 168 y Fj(;)6 b(:)g(:)g(:)g(;)g(f)513
172 y Fg(n)534 168 y Fm(\))13 b(\()p Fl(build)675 153
y Fg(T)699 168 y Fm(\()p Fj(g)q Fm(\)\))260 b Fi(!)37
b Fj(g)15 b Fm(\()p Fj(f)1165 172 y Fd(1)1182 168 y Fj(;)6
b(:)g(:)g(:)g(;)g(f)1286 172 y Fg(n)1307 168 y Fm(\))527
b Fi(g)662 290 y Fm(Figure)14 b(2:)j(Basic)d(Set)f(of)g(Rewrite)h
(Rules)725 413 y Fi(R)8 b([)g(f)p Fj(l)k Fi(!)f Fj(r)q
Fi(g)24 b(`)g Fj(P)5 b Fm([)p Fj(l)q Fm(])10 b Fi(\000)-6
b(!)11 b Fj(P)5 b Fm([)p Fj(r)q Fm(])436 496 y Fi(8)p
Fc(C)11 b Fm(:)23 b Fi(R)8 b([)g(f)p Fj(E)656 503 y Fh(C)686
496 y Fm(\()p Fj(g)q Fm(\))737 495 y(\026)735 496 y Fc(y)k
Fi(\))819 495 y Fm(\026)819 496 y Fc(z)p Fi(g)24 b(`)g
Fj(\025)951 495 y Fm(\026)951 496 y Fc(z)10 b Fj(:)h(g)j
Fm(\()p Fj(f)1069 503 y Fh(C)1113 495 y Fm(\026)1111
496 y Fc(y)p Fm(\))26 b Fi(!)-53 b(\000)-6 b(!)11 b Fj(h)1255
503 y Fh(C)p 417 510 886 2 v 563 558 a Fi(R)23 b(`)h
Fj(g)15 b Fm(\()p Fl(cata)792 542 y Fg(T)837 548 y Fm(\026)829
558 y Fj(f)i(x)p Fm(\))10 b Fi(\000)-7 b(!)12 b Fl(cata)1063
542 y Fg(T)1101 548 y Fm(\026)1100 558 y Fj(h)h(x)1328
528 y Fc(y)1351 532 y Fb(i)1374 528 y Fi(62)d Fj(F)5
b(V)k Fm(\()1486 518 y(\026)1486 528 y Fj(h)p Fm(\))729
679 y(Figure)14 b(3:)j(Rewrite)c(Algorithm)-76 802 y(section\).)18
b(Their)c(de\014nitions)i(are:)4 889 y Fk(sum)76 b Fm(=)37
b Fl(cata)293 873 y Ff(List)364 889 y Fm(\()p Fj(\025)p
Fm(\(\))11 b Fj(:)g Fm(0)p Fj(;)19 b Fm(\(+\)\))4 937
y Fk(map)13 b Fj(f)41 b Fm(=)c Fl(cata)293 921 y Ff(List)364
937 y Fm(\()p Fh(Nil)p Fj(;)18 b(\025)p Fm(\()p Fj(x;)7
b(w)q Fm(\))j Fj(:)g Fh(Cons)p Fm(\()p Fj(f)16 b(x;)6
b(w)q Fm(\)\))-76 1017 y(No)o(w,)12 b(to)h(enable)h(rewiting)h(these)e
(to)g(a)g(single)h(catamorphism)h(us-)-76 1059 y(ing)f(the)f(rule)21
1145 y Fi(R)54 1149 y Fd(0)94 1145 y Fi(`)24 b Fk(sum)8
b Fi(\016)h Fm(\()p Fk(map)j Fj(f)t Fm(\))f Fi(\000)-7
b(!)11 b Fl(cata)543 1127 y Ff(List)613 1145 y Fm(\()p
Fj(h)650 1152 y Ff(Nil)696 1145 y Fj(;)6 b(h)735 1152
y Ff(Cons)809 1145 y Fm(\))-76 1224 y(w)o(e)j(ha)o(v)o(e)i(to)f
(successfully)i(deriv)o(e)f Fj(h)441 1231 y Ff(Nil)496
1224 y Fm(and)f Fj(h)589 1231 y Ff(Cons)673 1224 y Fm(using)h(extended)
-76 1266 y(rewrite)i(systems.)18 b(In)13 b(the)g(case)g(of)g
Fh(Nil)f Fm(w)o(e)h(ha)o(v)o(e)120 1343 y Fi(R)153 1350
y Ff(Nil)236 1343 y Fm(=)37 b Fi(R)336 1347 y Fd(0)361
1343 y Fi([)8 b(f)p Fj(E)442 1350 y Ff(Nil)488 1343 y
Fm(\()p Fk(sum)p Fm(\)\(\))i Fi(\))h Fm(\(\))p Fi(g)236
1385 y Fm(=)37 b Fi(R)336 1389 y Fd(0)361 1385 y Fi([)8
b(f)p Fm(\(\))j Fi(\))g Fm(\(\))p Fi(g)236 1426 y Fm(=)37
b Fi(R)336 1430 y Fd(0)-76 1506 y Fm(and)14 b(for)f Fh(Cons)f
Fm(w)o(e)h(ha)o(v)o(e,)-42 1584 y Fi(R)-9 1591 y Ff(Cons)-5
1626 y Fm(=)37 b Fi(R)95 1630 y Fd(0)121 1626 y Fi([)8
b(f)p Fj(E)202 1633 y Ff(Cons)276 1626 y Fm(\()p Fk(sum)p
Fm(\)\()p Fc(y)412 1630 y Fd(1)429 1626 y Fj(;)e Fc(y)469
1630 y Fd(2)487 1626 y Fm(\))k Fi(\))h Fm(\()p Fc(z)596
1630 y Fd(1)613 1626 y Fj(;)6 b Fc(z)650 1630 y Fd(2)667
1626 y Fm(\))p Fi(g)-5 1667 y Fm(=)37 b Fi(R)95 1671
y Fd(0)121 1667 y Fi([)8 b(f)p Fm(\()p Fc(y)212 1671
y Fd(1)230 1667 y Fj(;)e Fk(sum)12 b Fc(y)350 1671 y
Fd(2)368 1667 y Fm(\))e Fi(\))h Fm(\()p Fc(z)477 1671
y Fd(1)494 1667 y Fj(;)6 b Fc(z)531 1671 y Fd(2)548 1667
y Fm(\))p Fi(g)-5 1715 y Fm(=)37 b Fi(R)95 1719 y Fd(0)121
1715 y Fi([)8 b(f)p Fm(\()p Fc(y)212 1719 y Fd(1)230
1715 y Fj(;)e Fl(cata)325 1700 y Ff(List)396 1715 y Fm(\()p
Fj(\025)p Fm(\(\))11 b Fj(:)f Fm(0)p Fj(;)19 b Fm(\(+\)\))13
b Fc(y)655 1719 y Fd(2)672 1715 y Fm(\))e Fi(\))g Fm(\()p
Fc(z)782 1719 y Fd(1)799 1715 y Fj(;)6 b Fc(z)836 1719
y Fd(2)853 1715 y Fm(\))p Fi(g)-5 1764 y Fm(=)37 b Fi(R)95
1768 y Fd(0)121 1764 y Fi([)8 b(f)p Fc(y)197 1768 y Fd(1)225
1764 y Fi(!)j Fc(z)294 1768 y Fd(1)311 1764 y Fj(;)6
b Fl(cata)407 1748 y Ff(List)478 1764 y Fm(\()p Fj(\025)p
Fm(\(\))11 b Fj(:)f Fm(0)p Fj(;)19 b Fm(\(+\)\))12 b
Fc(y)736 1768 y Fd(2)765 1764 y Fi(!)f Fc(z)834 1768
y Fd(2)851 1764 y Fi(g)-76 1843 y Fm(Rewriting)k(the)e
Fh(Nil)f Fm(case)h(is)h(immediate:)-35 1930 y Fi(R)-2
1937 y Ff(Nil)67 1930 y Fi(`)24 b Fj(\025)p Fm(\(\))10
b Fj(:)h Fl(cata)276 1912 y Ff(List)347 1930 y Fm(\()p
Fj(\025)p Fm(\(\))g Fj(:)f Fm(0)p Fj(;)d Fm(\(+\)\))12
b(\()p Fh(Nil)g Fm(\(\)\))e Fi(\000)-6 b(!)11 b Fj(\025)p
Fm(\(\))g Fj(:)f Fm(0)-76 2009 y(In)j(the)g Fh(Cons)g
Fm(case)g(it)g(pro)q(ceeds)i(as)e(follo)o(ws:)-57 2087
y Fi(R)-24 2094 y Ff(Cons)-1 2135 y Fi(`)57 b Fj(\025)p
Fm(\()p Fc(z)136 2139 y Fd(1)154 2135 y Fj(;)6 b Fc(z)191
2139 y Fd(2)208 2135 y Fm(\))k Fj(:)h Fl(cata)333 2119
y Ff(List)404 2135 y Fm(\()p Fj(\025)p Fm(\(\))g Fj(:)f
Fm(0)p Fj(;)c Fm(\(+\)\))131 2176 y(\(\()p Fj(\025)p
Fm(\()p Fj(x;)g(w)q Fm(\))k Fj(:)g Fh(Cons)p Fm(\()p
Fj(f)16 b(x;)6 b(w)q Fm(\)\))12 b(\()p Fc(y)592 2180
y Fd(1)610 2176 y Fj(;)6 b Fc(y)650 2180 y Fd(2)667 2176
y Fm(\)\))-20 2225 y Fi(\000)-6 b(!)37 b Fj(\025)p Fm(\()p
Fc(z)136 2229 y Fd(1)154 2225 y Fj(;)6 b Fc(z)191 2229
y Fd(2)208 2225 y Fm(\))k Fj(:)h Fl(cata)333 2209 y Ff(List)404
2225 y Fm(\()p Fj(\025)p Fm(\(\))g Fj(:)f Fm(0)p Fj(;)c
Fm(\(+\)\))13 b(\()p Fh(Cons)o Fm(\()p Fj(f)k Fc(y)797
2229 y Fd(1)815 2225 y Fj(;)6 b Fc(y)855 2229 y Fd(2)872
2225 y Fm(\)\))-20 2273 y Fi(\000)-6 b(!)37 b Fj(\025)p
Fm(\()p Fc(z)136 2277 y Fd(1)154 2273 y Fj(;)6 b Fc(z)191
2277 y Fd(2)208 2273 y Fm(\))k Fj(:)h Fm(\(+\))h(\()p
Fj(f)17 b Fc(y)401 2277 y Fd(1)418 2273 y Fj(;)6 b Fl(cata)514
2257 y Ff(List)585 2273 y Fm(\()p Fj(\025)p Fm(\(\))11
b Fj(:)f Fm(0)p Fj(;)c Fm(\(+\)\))13 b Fc(y)831 2277
y Fd(2)848 2273 y Fm(\))-20 2314 y Fi(\000)-6 b(!)37
b Fj(\025)p Fm(\()p Fc(z)136 2318 y Fd(1)154 2314 y Fj(;)6
b Fc(z)191 2318 y Fd(2)208 2314 y Fm(\))k Fj(:)h Fm(\(+\))h(\()p
Fj(f)17 b Fc(z)398 2318 y Fd(1)415 2314 y Fj(;)6 b Fc(z)452
2318 y Fd(2)469 2314 y Fm(\))-76 2394 y(In)12 b(b)q(oth)g(cases,)g(the)
g(results)g(ha)o(v)o(e)g(eliminated)j(the)c Fc(y)q Fm('s,)g(so)h
(rewrit-)-76 2436 y(ing)f(of)e(the)g(main)i(term)e(ma)o(y)g(pro)q(ceed)
i(resulting)g(in)f Fk(sum)e Fi(\016)g Fm(\()p Fj(map)j(f)t
Fm(\))-76 2477 y(equal)k(to)105 2564 y Fl(cata)183 2546
y Ff(List)254 2564 y Fm(\()p Fj(\025)p Fm(\(\))c Fj(:)f
Fm(0)p Fj(;)20 b(\025)p Fm(\()p Fj(z)458 2568 y Fd(1)475
2564 y Fj(;)6 b(z)510 2568 y Fd(2)527 2564 y Fm(\))11
b Fj(:)f(f)15 b(z)626 2568 y Fd(1)651 2564 y Fm(+)9 b
Fj(z)708 2568 y Fd(2)725 2564 y Fm(\))1020 802 y Fn(5)41
b(Exp)o(ressing)11 b(Recursive)j(F)o(unctions)e(as)h(Catamo)o(rphisms.)
1020 881 y Fm(The)k Fl(cata)p Fm(-fusion)f(fusion)j(algorithm)g(pro)o
(vides)f(the)g(mec)o(hanism)1020 922 y(for)h(computing)h(the)f(equiv)n
(alen)o(t)i Fl(cata)c Fm(for)i(a)g(function.)35 b(F)m(or)19
b(a)1020 964 y Fk(unary)14 b Fm(function,)j Fj(g)f Fm(:)e
Fj(T)21 b Fi(!)15 b Fj(\013)p Fm(,)g(\014rst)g(express)h(the)g(iden)o
(tit)o(y)h(func-)1020 1006 y(tion)10 b(as)g(a)f(catamorphism)i(o)o(v)o
(er)f Fj(T)5 b Fm(,)10 b(comp)q(ose)h(it)e(with)h Fj(g)h
Fm(on)f(the)f(left,)1020 1047 y(and)14 b(then)g(apply)g(the)g(fusion)g
(algorithm.)20 b(The)13 b(iden)o(tit)o(y)i(function)1020
1089 y(at)c(t)o(yp)q(e)g Fj(T)16 b Fm(is)11 b(easily)h(expressed)g(b)o
(y)f(using)h(the)f(constructors)h(as)e(ar-)1020 1130
y(gumen)o(ts)h(to)g(the)g(catamorphism)h(op)q(erator:)17
b Fl(cata)1773 1114 y Fg(T)1798 1130 y Fm(\()p Fh(C)1840
1134 y Fd(1)1857 1130 y Fj(;)6 b(:)g(:)g(:)g(;)g Fh(C)1969
1134 y Fg(n)1991 1130 y Fm(\).)1076 1172 y(F)m(or)14
b(non-unary)h(recursiv)o(e)h(function,)f Fj(f)t Fm(,)e(there)h(are)g
(some)g(ad-)1020 1213 y(ditional)21 b(di\016culties.)36
b(T)m(o)17 b(whic)o(h)j(argumen)o(t)f(should)h(the)e(cata-)1020
1255 y(morphism)i(b)q(e)g(applied?)37 b(Whic)o(h)20 b(sub)q(expression)
i(of)d Fj(f)t Fm('s)f(b)q(o)q(dy)1020 1296 y(corresp)q(onds)h(to)e(t)o
(ying)h(the)f(knot)h(of)f(the)g(recursiv)o(e)h(cycle?)31
b(W)m(e)1020 1338 y(ha)o(v)o(e)13 b(dev)o(elop)q(ed)h(heuristics)h(to)d
(address)i(these)e(di\016culties)j(whic)o(h)1020 1379
y(seem)e(to)g(w)o(ork)g(w)o(ell)h(in)g(a)f(wide)g(v)n(ariet)o(y)h(of)f
(cases.)1076 1421 y(In)d(essense,)h(w)o(e)f(collect)h(the)f
Fk(explicit)e Fm(argumen)o(ts)j(to)f(a)g(function)1020
1462 y(\(those)i(giv)o(en)g(b)o(y)f(literal)i(outer)f(lam)o(b)q(das\),)
h(and)e(then)h(lo)q(ok)g(for)f(the)1020 1504 y(outermost)k
Fl(case)d Fm(expression)17 b(whic)o(h)e(w)o(e)f(exp)q(ect)h(to)f(b)q(e)
g(o)o(v)o(er)h(one)1020 1545 y(of)d(the)g(explicit)j(argumen)o(ts.)j
(If)11 b(the)i(function)g(is)g(written)g(in)g(some)1020
1587 y(other)g(form)g(then)g(w)o(e)g(giv)o(e)h(up.)j(This)c(ma)o(y)h
(seem)f(restrictiv)o(e,)h(but)1020 1628 y(it)h(successfully)h(catc)o
(hes)f(all)g(de\014nitions)i(written)e(using)h(pattern-)1020
1670 y(matc)o(hing)f(argumen)o(ts.)1076 1711 y(More)h(formally)m(,)i
(giv)o(en)f(a)f(de\014nition)j Fj(f)g Fm(=)d Fk(b)n(o)n(dy)n
Fm(,)h(w)o(e)e(express)1020 1753 y(the)e(structure)h(of)f
Fk(b)n(o)n(dy)e Fm(in)j(the)f(form)1189 1827 y Fk(b)n(o)n(dy)c
Fm(=)h Fj(\025x)1355 1831 y Fd(1)1379 1827 y Fj(:)c(:)g(:)g(\025x)1474
1831 y Fg(n)1507 1827 y Fj(:)k(Q)p Fm([)p Fl(case)h Fj(x)1682
1831 y Fg(k)1714 1827 y Fl(of)h Fj(pats)p Fm(])1020 1902
y(where)h Fj(Q)g Fm(is)h(a)f(non-)p Fl(case)f Fm(con)o(text)h
(de\014ned)i(b)o(y)m(,)1238 1976 y Fj(Q)c Fm(::=)23 b([)6
b(])12 b Fi(j)h Fj(\025x)d(:)h(Q)i Fi(j)f Fj(Q)h(Q)1633
1960 y Fe(0)1658 1976 y Fi(j)f Fj(Q)1711 1960 y Fe(0)1735
1976 y Fj(Q)1315 2018 y Fi(j)g Fm(\()p Fj(Q;)7 b(Q)1431
2002 y Fe(0)1442 2018 y Fm(\))13 b Fi(j)f Fm(\()p Fj(Q)1538
2002 y Fe(0)1550 2018 y Fj(;)6 b(Q)p Fm(\))13 b Fi(j)f
Fl(build)f Fj(Q)1238 2060 y(Q)1268 2044 y Fe(0)1290 2060
y Fm(::=)23 b Fj(n)13 b Fi(j)f Fj(v)i Fi(j)f Fc(C)f Fi(j)h
Fj(\025x)e(:)f(Q)1655 2044 y Fe(0)1679 2060 y Fi(j)j
Fj(Q)1733 2044 y Fe(0)1757 2060 y Fj(Q)1787 2044 y Fe(0)1315
2102 y Fi(j)f Fm(\()p Fj(Q)1383 2086 y Fe(0)1395 2102
y Fj(;)6 b(Q)1442 2086 y Fe(0)1453 2102 y Fm(\))13 b
Fi(j)f Fl(build)f Fj(Q)1645 2086 y Fe(0)1020 2180 y Fm(and)g(where)g
Fj(x)1223 2184 y Fg(k)1242 2180 y Fj(;)6 b(f)15 b Fi(62)10
b Fj(F)5 b(V)k Fm(\()p Fj(Q)p Fm([)d(]\))k(and)h Fj(x)1582
2184 y Fg(k)1612 2180 y Fi(62)f Fj(F)5 b(V)k Fm(\()p
Fj(pats)p Fm(\).)16 b(The)11 b(condi-)1020 2221 y(tion)g(that)f
Fj(f)j Fm(do)q(es)e(not)f(o)q(ccur)g(in)h(the)f(free)g(v)n(ariables)i
(of)e(the)g(con)o(text)1020 2263 y(ensures)k(that)f(an)o(y)g(recursiv)o
(e)h(call)g(to)f Fj(f)j Fm(is)d(`guarded')h(b)o(y)f(the)g(case)1020
2304 y(statemen)o(t.)26 b(The)16 b(restriction)i(on)e(the)g
Fj(x)1638 2308 y Fg(k)1672 2304 y Fm(rejects)g(a)g(case)g(of)g(full)
1020 2346 y(primitiv)o(e)f(recursion.)1076 2387 y(If)10
b Fk(b)n(o)n(dy)f Fm(do)q(es)i(not)f(ha)o(v)o(e)h(this)h(structure)f(w)
o(e)f(giv)o(e)h(up,)g(otherwise)1020 2429 y(w)o(e)i(generate)g(a)g(new)
g(function)i(de\014nition)g Fj(f)1685 2413 y Fd(#)1725
2429 y Fm(as)e(follo)o(ws:)1222 2507 y Fj(f)68 b Fm(=)37
b Fj(\025x)1420 2511 y Fd(1)1438 2507 y Fj(::\025x)1504
2511 y Fg(n)1535 2507 y Fj(:)11 b(Q)p Fm([)p Fj(f)1621
2491 y Fd(#)1660 2507 y Fj(x)1682 2511 y Fg(k)1715 2507
y Fm(\026)-20 b Fj(v)q Fm(])1222 2552 y Fj(f)1245 2536
y Fd(#)1309 2552 y Fm(=)37 b Fj(\025x)1420 2556 y Fg(k)1450
2552 y Fj(:)11 b(\025)q Fm(\026)-20 b Fj(v)12 b(:)e Fl(case)h
Fj(x)1659 2556 y Fg(k)1691 2552 y Fl(of)h Fj(pats)1020
2630 y Fm(where)j(\026)-21 b Fj(v)12 b Fm(=)e Fj(F)5
b(V)k Fm(\()p Fj(pats)p Fm(\))g Fi(\000)f Fj(F)d(V)k
Fm(\()p Fk(b)n(o)n(dy)n Fm(\))g Fi(\000)f(f)p Fj(x)1661
2634 y Fg(k)1680 2630 y Fi(g)p Fm(.)1076 2676 y(The)k(function)h
Fj(f)i Fm(is)d(a)g(\\wrapp)q(er")g(and)h Fj(f)1689 2661
y Fd(#)1727 2676 y Fm(a)e(\\w)o(ork)o(er")i(in)f(the)1020
2718 y(sense)17 b(of)e(P)o(eyton)i(Jones)f(and)h(Launc)o(h)o(bury)h
([PJL91].)25 b(W)m(rapp)q(er)p eop
%%Page: 6 6
6 5 bop -76 -34 a Fm(functions)13 b(are)e(freely)g(unfolded,)i(so)e(w)o
(e)g(substitute)h(the)f(new)g(b)q(o)q(dy)-76 7 y(of)i
Fj(f)j Fm(in)e(the)f(de\014nition)j(of)d Fj(f)352 -9
y Fd(#)378 7 y Fm(.)-20 49 y(W)m(e)c(no)o(w)h(ha)o(v)o(e)f(a)g
(recursiv)o(e)i(function)f(with)g(an)f(outer)h Fl(case)d
Fm(o)o(v)o(er)-76 90 y(the)12 b(\014rst)g(argumen)o(t.)17
b(W)m(e)12 b(attempt)g(to)f(fuse)h(this)g(de\014nition)i(of)e
Fj(f)894 74 y Fd(#)-76 132 y Fm(with)k(the)g(cop)o(y)g(function)h(to)f
(obtain)h(a)e(catamorphic)i(v)o(ersion)g(of)-76 173 y
Fj(f)-53 157 y Fd(#)-26 173 y Fm(.)f(If)9 b(successful,)i(w)o(e)f(ma)o
(y)g(substitute)h(\(the)f(no)o(w)g(non-recursiv)o(e\))-76
220 y(de\014nition)16 b(of)e Fj(f)163 204 y Fd(#)203
220 y Fm(bac)o(k)g(in)o(to)h(the)f(new)f(de\014n)o(tion)j(of)d
Fj(f)t Fm(,)g(so)h(\014nally)-76 261 y(obtaining)i(a)d(de\014nition)i
(of)e Fj(f)k Fm(as)c(a)g(catamorphism.)-20 303 y(T)m(o)g(see)g(this)h
(in)g(practice,)f(consider)i(the)e(example)i(of)d Fl(map)p
Fm(.)62 380 y Fk(map)e Fm(=)h Fj(\025f)k(:)10 b(\025x)h(:)106
421 y Fl(case)h Fj(x)g Fl(of)174 463 y Fh(Nil)o Fm(\(\))h
Fl(->)f Fh(Nil)o Fm(\(\))126 504 y Fi(j)37 b Fh(Cons)p
Fm(\()p Fj(z)r(;)5 b(z)r(s)p Fm(\))12 b Fl(->)g Fh(Cons)p
Fm(\()p Fj(f)i(z)r(;)e Fk(map)e Fj(f)15 b(z)r(s)p Fm(\))-76
582 y(After)d(breaking)j(the)e(de\014nition)i(in)o(to)e(t)o(w)o(o)g
(comp)q(onen)o(ts)h(w)o(e)e(ha)o(v)o(e,)62 662 y Fk(map)e
Fm(=)h Fj(\025f)k(:)10 b(\025x)h(:)f Fk(map)408 647 y
Fd(#)445 662 y Fj(x)h(f)62 708 y Fk(map)133 692 y Fd(#)170
708 y Fm(=)g Fj(\025x)g(:)f(\025f)15 b(:)106 750 y Fl(case)d
Fj(x)g Fl(of)174 791 y Fh(Nil)o Fm(\(\))h Fl(->)f Fh(Nil)o
Fm(\(\))126 833 y Fi(j)37 b Fh(Cons)p Fm(\()p Fj(z)r(;)5
b(z)r(s)p Fm(\))12 b Fl(->)g Fh(Cons)p Fm(\()p Fj(f)i(z)r(;)e
Fk(map)e Fj(f)15 b(z)r(s)p Fm(\))-76 911 y(Then,)c(b)o(y)g(unfolding)i
(the)e(new)f(de\014nition)j(for)d Fk(map)g Fm(w)o(e)g(obtain)i(the)-76
952 y(follo)o(wing)j(recursiv)o(e)g(de\014nition:)49
1032 y Fk(map)119 1016 y Fd(#)157 1032 y Fm(=)10 b Fj(\025x)h(:)f
(\025f)15 b(:)93 1074 y Fl(case)c Fj(x)i Fl(of)160 1115
y Fh(Nil)p Fm(\(\))f Fl(->)g Fh(Nil)p Fm(\(\))112 1161
y Fi(j)37 b Fh(Cons)p Fm(\()p Fj(z)r(;)6 b(z)r(s)p Fm(\))12
b Fl(->)g Fh(Cons)o Fm(\()p Fj(f)j(z)r(;)d Fk(map)654
1145 y Fd(#)692 1161 y Fj(z)r(s)e(f)t Fm(\))-76 1239
y(This)i(function's)h(b)q(o)q(dy)g(is)f(a)f(case)h(expression)i(o)o(v)o
(er)d(it's)h(\014rst)g(argu-)-76 1286 y(men)o(t)f(and)g(is)g(readily)i
(fused)d(with)h Fl(cata)512 1270 y Ff(List)580 1286 y
Fm(\()p Fh(Nil)o Fj(;)6 b Fh(Cons)p Fm(\))k(to)h(obtain)-76
1328 y(a)i(de\014nition)j(of)d(the)g(form:)150 1404 y
Fj(\025x)d(:)h(\025f)k(:)10 b Fl(cata)381 1387 y Ff(List)452
1404 y Fm(\()p Fj(h)489 1411 y Ff(Nil)535 1404 y Fj(;)c(h)574
1411 y Ff(Cons)648 1404 y Fm(\))k Fj(x)-76 1487 y Fm(Note)16
b(that,)g(b)o(y)h(construction,)h(the)e(function)h Fk(map)701
1471 y Fd(#)743 1487 y Fm(is)g(strict)f(in)-76 1528 y(its)h(\014rst)h
(argumen)o(t)f(\(it)g(is)h(ab)q(out)f(to)g(p)q(erform)g(a)g(case)g
(analysis\))-76 1570 y(so)e(the)g(fusion)h(theorem)g(applies.)25
b(T)m(o)14 b(see)h(the)g(fusion)i(in)e(action,)-76 1611
y(consider)i(the)e(rewite)h(rules.)24 b(Once)16 b(again)g
Fi(R)613 1618 y Ff(Nil)672 1611 y Fm(=)f Fi(R)750 1615
y Fd(0)782 1611 y Fm(and)g(this)-76 1653 y(time)g Fi(R)46
1660 y Ff(Cons)132 1653 y Fm(=)d Fi(R)207 1657 y Fd(0)233
1653 y Fi([)d(f)p Fc(y)310 1657 y Fd(1)341 1653 y Fi(!)k
Fc(z)412 1657 y Fd(1)429 1653 y Fj(;)6 b(map)519 1637
y Fd(#)560 1653 y Fc(y)583 1657 y Fd(2)613 1653 y Fi(!)13
b Fc(z)684 1657 y Fd(2)701 1653 y Fi(g)p Fm(.)21 b(Then)14
b Fj(h)875 1660 y Ff(Nil)-76 1694 y Fm(and)g Fj(h)21
1701 y Ff(Cons)108 1694 y Fm(are)f(computed)h(b)o(y:)-10
1774 y Fi(R)23 1781 y Ff(Nil)91 1774 y Fi(`)24 b Fj(\025)p
Fm(\(\))11 b Fj(:)g Fk(map)293 1758 y Fd(#)320 1774 y
Fm(\()p Fh(Nil)h Fm(\(\)\))f Fi(\000)-7 b(!)11 b Fj(h)548
1781 y Ff(Nil)-10 1820 y Fi(R)23 1827 y Ff(Cons)120 1820
y Fi(`)24 b Fj(\025)p Fm(\()p Fj(z)222 1824 y Fd(1)239
1820 y Fj(;)6 b(z)274 1824 y Fd(2)291 1820 y Fm(\))11
b Fj(:)f Fk(map)409 1804 y Fd(#)436 1820 y Fm(\()p Fh(Cons)o
Fm(\()p Fc(y)570 1824 y Fd(1)588 1820 y Fj(;)c Fc(y)628
1824 y Fd(2)646 1820 y Fm(\)\))k Fi(\000)-6 b(!)11 b
Fj(h)781 1827 y Ff(Cons)-76 1898 y Fm(under)19 b(the)f(condition)j
(that)d(the)g Fc(y)q Fm('s)g(are)g(eliminated)i(from)e(the)-76
1939 y(resulting)d(terms.)-20 1981 y(Note)j(that)f(our)h(implemen)o
(tation)j(actually)f(substitutes)f(the)-76 2022 y(b)q(o)q(dy)d(of)f
Fk(map)139 2007 y Fd(#)181 2022 y Fm(in)g(the)g(ab)q(o)o(v)o(e.)24
b(This)15 b(is)g(the)g(only)i(place)e(w)o(e)g(use)-76
2064 y(information)h(ab)q(out)g(the)e(de\014nition)j(of)d
Fk(map)599 2048 y Fd(#)640 2064 y Fm(and)h(this)g(guaran-)-76
2105 y(tees)e(that)g(it)h(is)f(unfolded)i(exactly)f(once.)-20
2147 y(By)f(applying)j(the)d(v)n(arious)i(rules)f(w)o(e)e(obtain:)58
2223 y Fj(h)80 2230 y Ff(Nil)191 2223 y Fm(=)38 b Fj(\025)p
Fm(\(\))11 b Fj(:)f(\025f)15 b(:)10 b Fh(Nil)o Fm(\(\))58
2264 y Fj(h)80 2271 y Ff(Cons)191 2264 y Fm(=)38 b Fj(\025)p
Fm(\()p Fc(z)316 2268 y Fd(1)333 2264 y Fj(;)6 b Fc(z)370
2268 y Fd(2)387 2264 y Fm(\))k Fj(:)h(\025f)k(:)10 b
Fh(Cons)p Fm(\()p Fj(f)k Fc(z)661 2268 y Fd(1)678 2264
y Fj(;)e Fc(z)721 2268 y Fd(2)749 2264 y Fj(f)t Fm(\))-76
2350 y(Finally)m(,)18 b(substituting)f Fk(map)351 2334
y Fd(#)392 2350 y Fm(bac)o(k)f(in)o(to)g(the)f(de\014nition)i(of)e
Fk(map)-76 2391 y Fm(giv)o(es)f(a)f(new)g(de\014nition)j(of)d
Fk(map)f Fm(as)h(a)g(catamorphism.)72 2476 y Fk(map)d
Fm(=)h Fj(\025f)k(:)10 b(\025x)h(:)f Fl(cata)425 2458
y Ff(List)496 2476 y Fm(\()p Fj(h)533 2483 y Ff(Nil)579
2476 y Fj(;)c(h)618 2483 y Ff(Cons)692 2476 y Fm(\))k
Fj(x)h(f)-76 2569 y Fn(5.1)41 b(Static)13 b(P)o(a)o(rameters,)g(T)m
(uples)g(and)h(Irrelevant)f(Cases)-76 2635 y Fm(The)i(astute)h(reader)g
(will)h(notice)f(that)f(the)h(previous)h(example)g(is)-76
2676 y(actually)f(a)d Fk(higher-or)n(der)e Fm(catamorphism:)20
b(eac)o(h)13 b(term)h(is)g(a)f(func-)-76 2718 y(tion)19
b(w)o(aiting)h(to)e(b)q(e)g(applied)j(to)d Fj(f)t Fm(.)31
b(While)20 b(this)f(generalit)o(y)i(is)1020 -34 y(sometimes)15
b(essen)o(tial,)h(it)e(is)g(not)g(useful)h(in)g(this)f(case.)20
b(The)14 b(v)n(alue)1020 7 y(inherited)e(b)o(y)e(the)g(recursiv)o(e)h
(applicatio)q(ns)i(of)c Fl(cata)f Fm(are)i(all)h Fj(f)t
Fm(,)f(they)1020 49 y(are)j(iden)o(tical)j(to)d(eac)o(h)g(other.)1076
90 y(It)h(is)g(p)q(ossible)j(to)d(mak)o(e)g(an)g(impro)o(v)o(emen)o(t)i
(to)e(the)g(algorithm)1020 132 y(ab)q(o)o(v)o(e)g(whereb)o(y)g(static)g
(parameters)g(are)g(not)f(inherited)j(b)q(et)o(w)o(een)1020
173 y(the)d(recursiv)o(e)i(lev)o(els)g(of)e(a)g(catamorphism.)20
b(If)13 b(w)o(e)f(had)i(done)g(this)1020 215 y(in)g(the)f(case)g(of)g
Fk(map)f Fm(w)o(e)h(w)o(ould)h(ha)o(v)o(e)f(obtained)i(the)e(follo)o
(wing:)1163 278 y Fj(map)e Fm(=)g Fj(\025f)j(:)d(\025x)f(:)1189
327 y Fl(cata)1267 311 y Ff(List)1338 327 y Fm(\()p Fh(Nil)o
Fj(;)c(\025)p Fm(\()p Fj(z)1475 331 y Fd(1)1493 327 y
Fj(;)g(z)1528 331 y Fd(2)1545 327 y Fm(\))k Fj(:)h Fh(Cons)o
Fm(\()p Fj(f)f(z)1735 331 y Fd(1)1753 327 y Fj(;)i(z)1794
331 y Fd(2)1811 327 y Fm(\)\))f Fj(x)1020 392 y Fm(whic)o(h)19
b(is)g(as)g(go)q(o)q(d)g(as)g(it)f(gets.)34 b(The)18
b(higher-orderness)j(of)d(the)1020 434 y(original)e(de\014nition)f
(comes)e(from)g(passing)i Fj(f)h Fm(explicitly)g(as)d(an)g(ar-)1020
475 y(gumen)o(t)g(to)f Fk(map)1273 460 y Fd(#)1300 475
y Fm(.)17 b(If)11 b(w)o(e)h(reduce)h(the)f(argumen)o(ts)h(to)f(the)g(w)
o(ork)o(er)1020 517 y(function)17 b(\()p Fk(map)1259
501 y Fd(#)1301 517 y Fm(in)f(this)h(case\))f(b)o(y)g(omitting)h(those)
f(argumen)o(ts)1020 558 y(whic)o(h)d(are)g(unc)o(hanged)h(in)g(the)e
(recursiv)o(e)i(calls,)g(then)f(in)g(this)g(and)1020
600 y(similar)i(cases,)e(the)g(catamorphism)i(b)q(ecomes)f(\014rst)f
(order.)1076 641 y(Note,)g(ho)o(w)o(ev)o(er,)g(that)h(the)f(w)o(ork)o
(er)h(is)f(not)h(no)o(w)f(a)h(function)g(in)1020 683
y(it's)g(o)o(wn)f(righ)o(t,)h(but)g(should)h(b)q(e)e(view)o(ed)h(as)g
(a)f(de\014nition)j(lo)q(cal)f(to)1020 724 y(the)j(wrapp)q(er)f(as)h
(it)g(con)o(tains)h(extra)e(free)g(v)n(ariables.)33 b(Ho)o(w)o(ev)o
(er,)1020 766 y(once)12 b(the)h(catamorphic)g(de\014nition)i(is)e
(substituted)h(bac)o(k)e(in)o(to)h(the)1020 807 y(de\014nition)h(of)c
(the)h(w)o(ork)o(er,)h(the)f(free)f(v)n(ariables)k(are)d(captured)h
(once)1020 849 y(again,)i(and)g(all)g(is)g(w)o(ell.)1076
891 y(Another)h(ob)o(vious)i(extension)g(is)e(to)g(allo)o(w)h(eac)o(h)f
(of)g(the)g Fj(x)1955 895 y Fg(i)1982 891 y Fm(to)1020
932 y(b)q(e)g(tuples.)22 b(In)15 b(addition,)i(w)o(e)d(will)i(see)f(a)f
(couple)i(of)e(examples)i(at)1020 974 y(the)f(end)g(of)f(the)h(pap)q
(er)g(where)g(w)o(e)f(also)i(pass)f(o)o(v)o(er)f(a)h
Fl(case)e Fm(when)1020 1015 y(the)g(argumen)o(t)h(to)f(the)g(case)g(is)
h(other)f(than)h(a)f(v)n(ariable.)1076 1057 y(As)20 b(with)g(the)g
(static)g(parameter)g(optimisation)q(,)j(this)e(addi-)1020
1098 y(tional)14 b(generalit)o(y)g(is)e(useful)h(but)f(not)g(critical.)
19 b(As)12 b(it)g(complicates)1020 1140 y(notation)20
b(w)o(e)e(left)h(it)g(out)g(of)f(the)h(algorithm)h(de\014nition.)36
b(Con-)1020 1181 y(v)o(ersely)m(,)13 b(as)e(none)h(of)g(these)g(in)o
(tro)q(duce)h(an)o(y)f(additional)j(c)o(hallenges)1020
1223 y(w)o(e)d(will)i(feel)f(free)g(to)f(assume)i(from)e(no)o(w)h(on)g
(that)f(static)i(parame-)1020 1264 y(ters,)f(tuples)h(and)g(irrelev)n
(an)o(t)g(cases)g(are)f(handled)i(sensibly)m(.)1020 1355
y Fn(5.2)41 b(Linea)o(r)12 b(Reverse)1020 1421 y Fm(The)k(linear)i(v)o
(ersion)f(of)f(the)g(rev)o(erse)g(function)i(pro)o(vides)f(a)f(go)q(o)q
(d)1020 1463 y(example)j(of)e(a)g(c)o(hanging)i(recursiv)o(e)g
(parameter,)f(leading)i(to)d(an)1020 1504 y(essen)o(tial)e(use)e(of)g
(a)g(higher-order)i(catamorphism.)1130 1568 y Fk(lr)n(everse)9
b Fm(=)i Fj(\025x)f(:)h(\025w)g(:)1174 1609 y Fl(case)g
Fj(x)i Fl(of)1242 1651 y Fh(Nil)o Fm(\(\))g Fl(->)f Fj(w)1194
1692 y Fi(j)37 b Fh(Cons)o Fm(\()p Fj(z)r(;)6 b(z)r(s)p
Fm(\))12 b Fl(->)g Fk(lr)n(everse)f Fj(z)r(s)h Fm(\()p
Fh(Cons)p Fm(\()p Fj(z)r(;)5 b(w)q Fm(\)\))1020 1758
y(The)10 b(de\014nition)j(is)e(already)h(in)f(the)g(form)f(constructed)
i(b)o(y)e(the)h(con-)1020 1800 y(text)e(mac)o(hinery)h(\(i.e.)16
b Fk(lr)n(everse)1483 1784 y Fd(#)1519 1800 y Fm(w)o(ould)10
b(b)q(e)f(iden)o(tical)i(to)e Fk(lr)n(everse)n Fm(\),)1020
1849 y(so)k(w)o(e)f(are)h(ready)h(to)e(fuse)h Fj(l)q(r)q(ev)q(er)q(se)g
Fm(to)g Fl(cata)1695 1833 y Ff(List)1766 1849 y Fm(\()p
Fh(Nil)o Fj(;)6 b Fh(Cons)p Fm(\).)16 b(As)1020 1890
y(b)q(efore,)d Fi(R)1179 1897 y Ff(Nil)1235 1890 y Fm(=)d
Fi(R)1308 1894 y Fd(0)1325 1890 y Fm(.)1123 1955 y Fi(R)1156
1962 y Ff(Nil)1224 1955 y Fi(`)24 b Fj(\025)p Fm(\(\))11
b Fj(:)f Fl(lreverse)m Fm(\()p Fh(Nil)i Fm(\(\)\))f Fi(\000)-7
b(!)11 b Fj(\025)p Fm(\(\))g Fj(:)f(\025w)i(:)e(w)1020
2020 y Fm(so)j Fj(h)1089 2027 y Ff(Nil)1145 2020 y Fm(=)e
Fj(\025)p Fm(\(\))g Fj(:)f(\025w)i(:)e(w)q Fm(.)1076
2061 y(In)j(the)g Fh(Cons)g Fm(case)g(w)o(e)f(ha)o(v)o(e)1102
2118 y Fi(R)1135 2125 y Ff(Cons)1139 2159 y Fm(=)37 b
Fi(R)1239 2163 y Fd(0)1265 2159 y Fi([)8 b(f)p Fj(E)1346
2166 y Ff(Cons)1420 2159 y Fm(\()p Fl(lreverse)m Fm(\)\()p
Fc(y)1645 2163 y Fd(1)1662 2159 y Fj(;)e Fc(y)1702 2163
y Fd(2)1720 2159 y Fm(\))11 b Fi(\))g Fm(\()p Fc(z)1830
2163 y Fd(1)1847 2159 y Fj(;)6 b Fc(z)1884 2163 y Fd(2)1901
2159 y Fm(\))p Fi(g)1139 2201 y Fm(=)37 b Fi(R)1239 2205
y Fd(0)1265 2201 y Fi([)8 b(f)p Fm(\()p Fc(y)1356 2205
y Fd(1)1374 2201 y Fj(;)e Fl(lreverse)j Fc(y)1583 2205
y Fd(2)1601 2201 y Fm(\))i Fi(\))g Fm(\()p Fc(z)1711
2205 y Fd(1)1727 2201 y Fj(;)c Fc(z)1765 2205 y Fd(2)1782
2201 y Fm(\))p Fi(g)1139 2242 y Fm(=)37 b Fi(R)1239 2246
y Fd(0)1265 2242 y Fi([)8 b(f)p Fc(y)1341 2246 y Fd(1)1369
2242 y Fi(!)j Fc(z)1438 2246 y Fd(1)1455 2242 y Fj(;)6
b Fl(lreverse)i Fc(y)1663 2246 y Fd(2)1691 2242 y Fi(!)j
Fc(z)1760 2246 y Fd(2)1777 2242 y Fi(g)1020 2308 y Fm(and)j(the)f
(rewriting)h(pro)q(ceeds)g(as)g(follo)o(ws)1042 2372
y Fi(R)1075 2379 y Ff(Cons)1205 2372 y Fi(`)57 b Fj(\025)p
Fm(\()p Fc(z)1342 2376 y Fd(1)1360 2372 y Fj(;)6 b Fc(z)1397
2376 y Fd(2)1414 2372 y Fm(\))k Fj(:)g Fl(lreverse)m
Fm(\()p Fh(Cons)p Fm(\()p Fc(y)1752 2376 y Fd(1)1770
2372 y Fj(;)c Fc(y)1810 2376 y Fd(2)1827 2372 y Fm(\)\))1186
2413 y Fi(\000)-6 b(!)37 b Fj(\025)p Fm(\()p Fc(z)1342
2417 y Fd(1)1360 2413 y Fj(;)6 b Fc(z)1397 2417 y Fd(2)1414
2413 y Fm(\))k Fj(:)g(\025w)i(:)e Fl(lreverse)g Fc(y)1736
2417 y Fd(2)1767 2413 y Fm(\()p Fh(Cons)o Fm(\()p Fc(y)1901
2417 y Fd(1)1919 2413 y Fj(;)c(w)q Fm(\)\))1186 2455
y Fi(\000)-6 b(!)37 b Fj(\025)p Fm(\()p Fc(z)1342 2459
y Fd(1)1360 2455 y Fj(;)6 b Fc(z)1397 2459 y Fd(2)1414
2455 y Fm(\))k Fj(:)g(\025w)i(:)e Fc(z)1563 2459 y Fd(2)1593
2455 y Fm(\()p Fh(Cons)p Fm(\()p Fc(z)1725 2459 y Fd(1)1742
2455 y Fj(;)c(w)q Fm(\)\))1020 2521 y(The)15 b Fc(y)q
Fm('s)g(ha)o(v)o(e)h(b)q(een)g(eliminated)i(from)d(the)g(resulting)j
(terms,)d(so)1020 2562 y(w)o(e)e(ma)o(y)g(rewrite)1051
2632 y Fi(R)1084 2636 y Fd(0)1157 2632 y Fi(`)57 b Fj(l)q(r)q(ev)q(er)q
(se)9 b Fi(\016)g Fl(cata)1492 2616 y Ff(List)1563 2632
y Fm(\()p Fh(Nil)o Fj(;)d Fh(Cons)p Fm(\))1138 2699 y
Fi(\000)-6 b(!)1256 2681 y Fl(cata)1334 2665 y Ff(List)1405
2681 y Fm(\()p Fj(\025)p Fm(\(\))11 b Fj(:)g(\025w)g(:)f(w)q(;)1420
2722 y(\025)p Fm(\()p Fc(z)1477 2726 y Fd(1)1495 2722
y Fj(;)c Fc(z)1532 2726 y Fd(2)1549 2722 y Fm(\))k Fj(:)g(\025w)i(:)e
Fc(z)1698 2726 y Fd(2)1728 2722 y Fm(\()p Fh(Cons)p Fm(\()p
Fc(z)1860 2726 y Fd(1)1877 2722 y Fj(;)c(w)q Fm(\)\)\))p
eop
%%Page: 7 7
7 6 bop -76 -34 a Fm(So,)13 b(\014nally)m(,)i(w)o(e)d(no)o(w)h
(de\014ne,)-22 45 y Fk(lr)n(everse)c Fm(=)i Fl(cata)234
30 y Ff(List)305 45 y Fm(\()p Fj(\025)p Fm(\(\))g Fj(:)f(\025w)i(:)e(w)
q(;)320 87 y(\025)p Fm(\()p Fc(z)377 91 y Fd(1)394 87
y Fj(;)c Fc(z)431 91 y Fd(2)448 87 y Fm(\))11 b Fj(:)f(\025w)i(:)e
Fc(z)598 91 y Fd(2)628 87 y Fm(\()p Fh(Cons)o Fm(\()p
Fc(z)759 91 y Fd(1)776 87 y Fj(;)c(w)q Fm(\)\)\))-76
185 y Fn(6)41 b(Exp)o(ressing)12 b(T)m(erms)h(as)g(Builds)-76
263 y Fm(The)i(purp)q(ose)g(of)f Fl(build)f Fm(is)i(to)f(allo)o(w)i(us)
e(to)h(represen)o(t)g(a)f(term)g(of)-76 305 y(some)e(data)g(t)o(yp)q(e)
g(as)g(a)f(function)i(parameterised)h(o)o(v)o(er)e(the)f(output)-76
346 y(constructors.)17 b(So,)11 b(for)f(example,)i(rather)e(than)h(w)o
(ork)f(with)h(the)f(lit-)-76 388 y(eral)16 b(list:)22
b Fh(Cons)p Fm(\(1)p Fj(;)6 b Fh(Cons)p Fm(\(2)p Fj(;)g
Fh(Cons)p Fm(\(3)p Fj(;)g Fh(Nil)o Fm(\(\)\)\)\))15 b(w)o(e)f(w)o(ork)h
(with)h(the)-76 430 y(function)h Fj(\025)p Fm(\()p Fj(n;)7
b(c)p Fm(\))14 b Fj(:)h(c)g Fm(\(1)p Fj(;)21 b(c)15 b
Fm(\(2)p Fj(;)22 b(c)15 b Fm(\(3)p Fj(;)6 b(n)p Fm(\(\)\)\)\).)24
b(But)16 b(no)o(w)g(the)f(ex-)-76 471 y(pression)j(is)f(no)g(longer)h
(a)e(list!)29 b(It's)15 b(a)i(function.)28 b(So)17 b(\(follo)o(wing)-76
513 y([GLPJ93]\))f(w)o(e)h(in)o(tro)q(duce)h(a)f(construct)h(for)e(eac)
o(h)h(data)h(t)o(yp)q(e)f Fj(T)-76 559 y Fm(called)c
Fl(build)129 543 y Fg(T)164 559 y Fm(de\014ned)f(b)o(y)f
Fl(build)443 543 y Fg(T)478 559 y Fj(g)h Fm(=)f Fj(g)h
Fm(\()p Fk(Constrs)r Fm(\()p Fj(T)5 b Fm(\)\).)16 b(Th)o(us,)-76
600 y(reducing)f(the)e(term)70 682 y Fl(build)168 664
y Ff(List)239 682 y Fm(\()p Fj(\025)p Fm(\()p Fj(n;)6
b(c)p Fm(\))k Fj(:)h(c)h Fm(\(1)p Fj(;)19 b(c)13 b Fm(\(2)p
Fj(;)19 b(c)12 b Fm(\(3)p Fj(;)6 b(n)p Fm(\(\)\)\)\)\))-76
756 y(simply)13 b(reconstructs)g(the)e(list)h Fh(Cons)p
Fm(\(1)p Fj(;)6 b Fh(Cons)p Fm(\(2)p Fj(;)g Fh(Cons)p
Fm(\(3)p Fj(;)g Fh(Nil)o Fm(\(\)\)\)\).)-20 798 y(Of)11
b(course,)h(the)f(purp)q(ose)i(of)e(in)o(tro)q(ducing)j
Fl(build)p Fm('s)9 b(is)i(not)h(sim-)-76 839 y(ply)17
b(to)g(reduce)g(them)f(a)o(w)o(a)o(y)g(again!)29 b(Rather)16
b(the)h(purp)q(ose)g(is)g(to)-76 881 y(enable)d(the)f
Fl(build)d Fm(to)i(cancel)i(with)f(an)f(enclosing)j(catamorphism)-76
922 y(\(as)e(p)q(erformed)g(b)o(y)g(the)f Fl(cata)6 b
Fi(\000)i Fl(build)i Fm(la)o(w\),)j(and)g(so)f(remo)o(v)o(e)h(the)-76
964 y(need)h(to)f(construct)h(an)f(in)o(termediate)i(structure.)-20
1005 y(W)m(e)c(in)o(tro)q(duce)h(appropriate)g Fl(build)n
Fm(s)e(to)h(an)f(expression)i(b)o(y)f(ap-)-76 1047 y(plying)i(the)e
(syn)o(tax-to-syn)o(tax)i(translation)g Fi(B)f Fm(de\014ned)g(as)e
(follo)o(ws:)-57 1120 y Fi(B)k Fj(x)139 b Fm(=)37 b Fj(x)418
b Fm([)p Fk(x)16 b Fm(is)e(a)f(v)n(ariable)r(])-57 1162
y Fi(B)h Fm(\()p Fj(\025x)d(:)f(e)p Fm(\))37 b(=)g Fj(\025x)11
b(:)g Fi(B)j Fj(e)-57 1203 y Fi(B)g Fm(\()p Fj(e)15 1207
y Fd(1)32 1203 y Fj(;)6 b(e)67 1207 y Fd(2)84 1203 y
Fm(\))44 b(=)37 b(\()p Fi(B)14 b Fj(e)282 1207 y Fd(1)299
1203 y Fj(;)19 b Fi(B)14 b Fj(e)386 1207 y Fd(2)404 1203
y Fm(\))-57 1245 y Fc(or)h(else)-57 1290 y Fi(B)f Fj(e)143
b Fm(=)37 b Fl(build)308 1274 y Fg(T)333 1290 y Fm(\()p
Fj(\025)s Fm(\026)-22 b Fj(p)11 b(:)f Fl(cata)500 1274
y Fg(T)540 1290 y Fm(\026)-22 b Fj(p)13 b(e)p Fm(\))p
Fj(;)37 b Fc(if)16 b Fj(e)10 b Fm(:)g Fj(T)19 b(t)143
1331 y Fm(=)37 b Fj(e;)411 b Fc(otherwise)-76 1407 y
Fm(Consider)14 b(the)g(de\014nition)h(of)e(a)g(function)h(suc)o(h)g(as)
f Fk(app)n(end)n Fm(.)54 1480 y Fk(app)n(end)8 b Fm(=)j
Fj(\025x)g(:)f(\025y)j(:)111 1521 y Fl(case)f Fj(x)g
Fl(of)179 1563 y Fh(Nil)o Fm(\(\))h Fl(->)f Fj(y)131
1604 y Fi(j)37 b Fh(Cons)p Fm(\()p Fj(z)r(;)5 b(z)r(s)p
Fm(\))12 b Fl(->)g Fh(Cons)p Fm(\()p Fj(z)r(;)5 b Fk(app)n(end)k
Fj(z)r(s)h(y)q Fm(\))-76 1679 y(Applying)16 b Fi(B)e
Fm(to)f(it's)g(b)q(o)q(dy)h(giv)o(es:)-17 1759 y Fk(app)n(end)8
b Fm(=)j Fj(\025x)g(:)f(\025y)i(:)f Fl(build)399 1743
y Ff(List)470 1759 y Fm(\()p Fj(\025)p Fm(\()p Fj(n;)6
b(c)p Fm(\))k Fj(:)h Fl(cata)704 1743 y Ff(List)775 1759
y Fm(\()p Fj(n;)6 b(c)p Fm(\))40 1801 y Fl(case)11 b
Fj(x)i Fl(of)108 1842 y Fh(Nil)o Fm(\(\))f Fl(->)h Fj(y)60
1884 y Fi(j)37 b Fh(Cons)o Fm(\()p Fj(z)r(;)6 b(z)r(s)p
Fm(\))12 b Fl(->)g Fh(Cons)o Fm(\()p Fj(z)r(;)6 b Fk(app)n(end)i
Fj(z)r(s)i(y)q Fm(\))j(\))-76 1959 y(Giv)o(en)k(that)e(our)h(aim)g(is)g
(to)f(remo)o(v)o(e)h(unnecessary)h(in)o(termediate)-76
2000 y(data)h(structures,)h(then)f(the)g Fl(build)d Fm(in)o(tro)q
(duction)20 b(strategy)e(ap-)-76 2042 y(p)q(ears)h(to)f(b)q(e)g(a)g
(bad)g(idea,)i(as)e(w)o(e)g(generate)g(new)g(in)o(termediate)-76
2083 y(data)i(structures.)35 b(Ho)o(w)o(ev)o(er,)20 b(these)g(in)o
(termediates)h(only)f(exist)-76 2125 y(temp)q(orarily|they)f(will)f(b)q
(e)e(fused)g(with)h(other)f(comp)q(onen)o(ts)h(of)-76
2166 y(the)c(function)i(de\014nition.)-20 2208 y(T)o(ypically)m(,)21
b(the)d(newly)g(in)o(tro)q(duced)i Fl(build)15 b Fm(and)j
Fl(cata)e Fm(come)-76 2249 y(to)i(rest)h(immediately)h(surrounding)h
(an)e(existing)h Fl(case)d Fm(expres-)-76 2291 y(sion)e(\(as)e(in)h
(the)g Fk(app)n(end)d Fm(example)j(ab)q(o)o(v)o(e\).)19
b(There)13 b(are)h(then)g(t)o(w)o(o)-76 2332 y(distinct)h(w)o(a)o(ys)e
(to)g(pro)q(ceed:)-31 2400 y(1.)19 b(either)12 b(w)o(e)f(ma)o(y)g
(distribute)j(the)d(new)g Fl(cata)f Fm(across)i(the)f
Fl(case)18 2441 y Fm(expression,)21 b(and)e(then)g(con)o(v)o(ert)g(the)
g(whole)g(term)g(in)o(to)g(a)18 2483 y(single)12 b(catamorphism)h
(using)f(the)f(tec)o(hniques)h(of)f(Section)h(5;)18 2524
y(or)-31 2593 y(2.)19 b(w)o(e)12 b(ma)o(y)g(turn)h(the)g(whole)g(term)g
(in)o(to)g(a)g(catamorphism)h(im-)18 2635 y(mediately)m(,)f(and)f(only)
h(then)g(fuse)e(the)h(outer)g(catamorphism)18 2676 y(to)f(the)h(new)g
(one)h(\(this)f(latter)h(fusion)g(is)f(t)o(ypically)j(a)d(higher-)18
2718 y(order)h(fusion,)h(describ)q(ed)h(in)f(Section)g(7\).)1020
-34 y(The)c(second)h(of)f(these)h(sometimes)g(fails)h(\(none)f(of)f
(the)g(fusion)i(steps)1020 7 y(go)f(through\),)h(but)g(when)f(it)h
(succeeds)g(it)f(seems)g(to)g(giv)o(e)h(b)q(etter)f(re-)1020
49 y(sults)16 b(than)g(the)g(\014rst.)24 b(In)15 b(constrast,)i(the)e
(\014rst)h(seems)g(the)f(more)1020 90 y(robust:)i(on)c(the)f(examples)h
(w)o(e)f(ha)o(v)o(e)g(tried)h(it)f(succeeds)h(whenev)o(er)1020
132 y(the)c(second)i(do)q(es.)16 b(On)9 b(man)o(y)h(common)g(examples,)
h(b)q(oth)f(metho)q(ds)1020 173 y(are)15 b(completely)j(equiv)n(alen)o
(t:)23 b(they)16 b(b)q(oth)g(succeed)g(and)g(pro)q(duce)1020
215 y(exactly)g(the)f(same)f(term.)22 b(Suc)o(h)15 b(is)h(the)e(case)h
(with)g Fk(app)n(end)n Fm(.)21 b(Ap-)1020 256 y(plying)15
b(the)e(algorithm)i(giv)o(es)g(the)e(result)1039 334
y Fk(app)n(end)8 b Fm(=)j Fj(\025x)f(:)h(\025y)h(:)1064
382 y Fl(build)1162 366 y Ff(List)1233 382 y Fm(\()p
Fj(\025)p Fm(\()p Fj(n;)7 b(c)p Fm(\))j Fj(:)g Fl(cata)1468
366 y Ff(List)1539 382 y Fm(\()p Fj(\025)p Fm(\(\))h
Fj(:)f Fl(cata)1716 366 y Ff(List)1787 382 y Fm(\()p
Fj(n;)c(c)p Fm(\))13 b Fj(y)q(;)6 b(c)p Fm(\))12 b Fj(x)p
Fm(\))1020 464 y(whic)o(h)i(is)g(equiv)n(alen)o(t)h(to)e(the)g(v)o
(ersion)h(giv)o(en)h(in)f([GLPJ93].)1076 506 y(The)19
b(di\013erence)i(b)q(et)o(w)o(een)f(the)f(t)o(w)o(o)g(metho)q(ds)h(sho)
o(ws)g(up)f(in)1020 547 y Fk(r)n(everse)o Fm(,)h(where)f(the)g(second)h
(metho)q(d)g(fails,)h(and)f(in)g(its)f(linear)1020 589
y(coun)o(terpart)14 b Fk(lr)n(everse)o Fm(,)e(where)h(the)g(second)h
(is)g(sup)q(erior.)1020 683 y Fn(6.1)41 b(Reverse)13
b(example)1020 748 y Fm(W)m(e)g(de\014ne)h Fk(r)n(everse)e
Fm(as)h(usual.)1039 819 y Fk(r)n(everse)c Fm(=)i Fj(\025x)f(:)1096
860 y Fl(case)h Fj(x)i Fl(of)1163 902 y Fh(Nil)p Fm(\(\))f
Fl(->)g Fh(Nil)p Fm(\(\))1115 943 y Fi(j)37 b Fh(Cons)p
Fm(\()p Fj(z)r(;)6 b(z)r(s)p Fm(\))12 b Fl(->)g Fk(app)n(end)e
Fm(\()p Fk(r)n(everse)h Fj(z)r(s)p Fm(\))i(\()p Fh(Cons)o
Fm(\()p Fj(z)r(;)6 b Fh(Nil)o Fm(\(\)\)\))1020 1023 y(Pushing)15
b(the)e Fl(build)e Fm(in)j(place)g(giv)o(es:)1039 1108
y Fk(r)n(everse)9 b Fm(=)i Fj(\025x)f(:)h Fl(build)1381
1092 y Ff(List)1452 1108 y Fm(\()p Fj(\025)p Fm(\()p
Fj(n;)6 b(c)p Fm(\))k Fj(:)h Fl(cata)1686 1092 y Ff(List)1757
1108 y Fm(\()p Fj(n;)6 b(c)p Fm(\))1096 1149 y Fl(case)11
b Fj(x)i Fl(of)1163 1191 y Fh(Nil)p Fm(\(\))f Fl(->)g
Fh(Nil)p Fm(\(\))1115 1232 y Fi(j)37 b Fh(Cons)p Fm(\()p
Fj(z)r(;)6 b(z)r(s)p Fm(\))12 b Fl(->)g Fk(app)n(end)e
Fm(\()p Fk(r)n(everse)h Fj(z)r(s)p Fm(\))i(\()p Fh(Cons)o
Fm(\()p Fj(z)r(;)6 b Fh(Nil)o Fm(\(\)\)\)\))1020 1312
y(No)o(w,)20 b(follo)o(wing)h(the)e(\014rst)h(strategy)f(from)g
(Section)h(6,)h(w)o(e)d(dis-)1020 1354 y(tribute)c(the)e
Fl(cata)f Fm(across)i(the)f Fl(case)p Fm(.)j(After)d(some)h(simple)h
(rewrit-)1020 1395 y(ing)g(w)o(e)f(get)g(the)g(term:)1120
1480 y Fk(r)n(everse)c Fm(=)i Fj(\025x)f(:)h Fl(build)1462
1464 y Ff(List)1533 1480 y Fm(\()p Fj(\025)p Fm(\()p
Fj(n;)6 b(c)p Fm(\))k Fj(:)1177 1521 y Fl(case)h Fj(x)i
Fl(of)1244 1563 y Fh(Nil)p Fm(\(\))f Fl(->)g Fj(n)p Fm(\(\))1196
1611 y Fi(j)37 b Fh(Cons)p Fm(\()p Fj(z)r(;)6 b(z)r(s)p
Fm(\))12 b Fl(->)g(cata)1573 1595 y Ff(List)1644 1611
y Fm(\()p Fj(n;)6 b(c)p Fm(\))1257 1652 y(\()p Fk(app)n(end)11
b Fm(\()p Fk(r)n(everse)g Fj(z)r(s)p Fm(\))h(\()p Fh(Cons)p
Fm(\()p Fj(z)r(;)5 b Fh(Nil)o Fm(\(\)\)\)\)\))1020 1732
y(T)m(o)16 b(turn)h(this)g(in)o(to)h(a)e(single)j(catamorphism)f(w)o(e)
e(pro)q(ceed)i(as)e(in)1020 1774 y(Section)e(5.)j(W)m(e)d(express)f
Fk(r)n(everse)f Fm(as)h(a)g(wrapp)q(er)h(and)f(a)g(w)o(ork)o(er:)1087
1858 y Fk(r)n(everse)d Fm(=)g Fj(\025x)h(:)f Fl(build)1429
1842 y Ff(List)1500 1858 y Fm(\()p Fj(\025)p Fm(\()p
Fj(n;)d(c)p Fm(\))j Fj(:)g Fk(r)n(everse)1773 1842 y
Fd(#)1813 1858 y Fj(x)i Fm(\()p Fj(n;)7 b(c)p Fm(\)\))1087
1904 y Fk(r)n(everse)1204 1888 y Fd(#)1242 1904 y Fm(=)j
Fj(\025x)h(:)f(\025)p Fm(\()p Fj(n;)d(c)p Fm(\))j Fj(:)1144
1945 y Fl(case)i Fj(x)g Fl(of)1212 1987 y Fh(Nil)o Fm(\(\))h
Fl(->)f Fj(n)p Fm(\(\))1164 2035 y Fi(j)37 b Fh(Cons)p
Fm(\()p Fj(z)r(;)5 b(z)r(s)p Fm(\))12 b Fl(->)g(cata)1541
2019 y Ff(List)1612 2035 y Fm(\()p Fj(n;)6 b(c)p Fm(\))1225
2077 y(\()p Fk(app)n(end)k Fm(\()p Fk(r)n(everse)i Fj(z)r(s)p
Fm(\))g(\()p Fh(Cons)o Fm(\()p Fj(z)r(;)6 b Fh(Nil)o
Fm(\(\)\)\)\))1020 2164 y(and)14 b(unfolding)h Fk(r)n(everse)d
Fm(in)i Fk(r)n(everse)1555 2148 y Fd(#)1595 2164 y Fm(giv)o(es)1039
2246 y Fk(r)n(everse)1155 2230 y Fd(#)1193 2246 y Fm(=)d
Fj(\025x)f(:)h(\025)p Fm(\()p Fj(n;)6 b(c)p Fm(\))k Fj(:)1096
2287 y Fl(case)h Fj(x)i Fl(of)1163 2329 y Fh(Nil)p Fm(\(\))f
Fl(->)g Fj(n)p Fm(\(\))1115 2376 y Fi(j)37 b Fh(Cons)p
Fm(\()p Fj(z)r(;)6 b(z)r(s)p Fm(\))12 b Fl(->)g(cata)1492
2360 y Fe(j)p Fg(S)q(ublist)1616 2376 y Fm(\()p Fj(n;)6
b(c)p Fm(\))1176 2424 y(\()p Fk(app)n(end)11 b Fm(\()p
Fl(build)1433 2408 y Ff(List)1504 2424 y Fm(\()p Fk(r)n(everse)1635
2408 y Fd(#)1675 2424 y Fj(z)r(s)p Fm(\)\))h(\()p Fh(Cons)o
Fm(\()p Fj(z)r(;)6 b Fh(Nil)o Fm(\(\)\)\)\))1020 2504
y(Recall)15 b(that)e(the)g Fl(build)n Fm(-)p Fl(cata)e
Fm(form)i(of)g Fk(app)n(end)d Fm(is,)1039 2582 y Fk(app)n(end)e
Fm(=)j Fj(\025x)f(:)h(\025y)h(:)1064 2630 y Fl(build)1162
2614 y Ff(List)1233 2630 y Fm(\()p Fj(\025)p Fm(\()p
Fj(n;)7 b(c)p Fm(\))j Fj(:)g Fl(cata)1468 2614 y Ff(List)1539
2630 y Fm(\()p Fj(\025)p Fm(\(\))h Fj(:)f Fl(cata)1716
2614 y Ff(List)1787 2630 y Fm(\()p Fj(n;)c(c)p Fm(\))13
b Fj(y)q(;)19 b(c)p Fm(\))12 b Fj(x)p Fm(\))p eop
%%Page: 8 8
8 7 bop 301 -5 a Fi(8)p Fh(C)11 b Fm(:)49 b Fj(E)448
2 y Fh(C)477 -5 y Fm(\()p Fj(\025s)11 b(:)f(g)h Fi(\016)d
Fj(s)p Fm(\))14 b(\026)-20 b Fj(s)10 b Fm(=)h Fj(E)763
2 y Fh(C)792 -5 y Fm(\()p Fj(\025r)i(:)d(r)g Fi(\016)f
Fj(k)q Fm(\))14 b(\026)-20 b Fj(r)37 b Fi(\))g Fj(g)10
b Fi(\016)f Fm(\()p Fj(f)1203 2 y Fh(C)1244 -5 y Fm(\026)-21
b Fj(s)p Fm(\))11 b(=)f(\()p Fj(h)1363 2 y Fh(C)1405
-5 y Fm(\026)-21 b Fj(r)q Fm(\))9 b Fi(\016)g Fj(k)p
282 9 1231 2 v 584 56 a(g)15 b Fm(\()p Fl(cata)710 40
y Fg(T)755 46 y Fm(\026)747 56 y Fj(f)i(x)12 b(w)q Fm(\))21
b(=)g Fl(cata)1012 40 y Fg(T)1049 46 y Fm(\026)1049 56
y Fj(h)13 b(x)f Fm(\()p Fj(k)i(w)q Fm(\))1538 26 y Fj(g)g
Fm(strict)610 177 y(Figure)g(4:)j(The)c(second)h(order)g(fusion)g
(theorem)62 301 y Fi(8)p Fc(C)d Fm(:)49 b Fi(R)8 b([)g(f)p
Fj(E)308 308 y Fh(C)338 301 y Fm(\()p Fj(\025s)j(:)f(g)g
Fi(\016)f Fj(s)p Fm(\))520 300 y(\026)520 301 y Fc(s)i
Fi(\))h Fj(E)626 308 y Fh(C)655 301 y Fm(\()p Fj(\025r)g(:)f(r)f
Fi(\016)e Fj(g)q Fm(\))837 300 y(\026)838 301 y Fc(r)p
Fi(g)h([)f(f)p Fj(g)15 b Fc(y)d Fi(!)f Fc(z)p Fi(g)23
b(`)h Fj(\025)1185 300 y Fm(\026)1185 301 y Fc(r)11 b
Fj(:)g(\025)p Fc(z)f Fj(:)h(g)j Fm(\()p Fj(f)1376 308
y Fh(C)1417 300 y Fm(\026)1418 301 y Fc(s)f(y)q Fm(\))25
b Fi(!)-53 b(\000)-6 b(!)11 b Fj(h)1592 308 y Fh(C)p
44 315 1597 2 v 472 362 a Fi(R)24 b(`)g Fj(g)14 b Fm(\()p
Fl(cata)701 346 y Fg(T)747 352 y Fm(\026)738 362 y Fj(f)j(x)c(w)q
Fm(\))d Fi(\000)-7 b(!)11 b Fl(cata)1014 346 y Fg(T)1051
352 y Fm(\026)1051 362 y Fj(h)i(x)f Fm(\()p Fj(g)j(w)q
Fm(\))1665 332 y Fc(s)1682 336 y Fg(i)1696 332 y Fj(;)6
b Fc(y)12 b Fi(62)e Fj(F)5 b(V)k Fm(\()1860 323 y(\026)1860
332 y Fj(h)p Fm(\))599 491 y(Figure)14 b(5:)j(Rewrite)d(for)f(2)989
475 y Fd(nd)1037 491 y Fm(order)h(Cata-F)m(usion)-76
614 y(Substituting)23 b(this,)e(and)f(p)q(erforming)h(t)o(w)o(o)e
Fl(cata)o Fm(-)p Fl(build)e Fm(reduc-)-76 656 y(tions)d(giv)o(es)3
738 y Fk(r)n(everse)120 722 y Fd(#)157 738 y Fm(=)d Fj(\025x)g(:)f
(\025)p Fm(\()p Fj(n;)d(c)p Fm(\))j Fj(:)60 779 y Fl(case)i
Fj(x)g Fl(of)128 821 y Fh(Nil)o Fm(\(\))h Fl(->)f Fj(n)p
Fm(\(\))80 866 y Fi(j)37 b Fh(Cons)p Fm(\()p Fj(z)r(;)5
b(z)r(s)p Fm(\))12 b Fl(->)g Fk(r)n(everse)495 850 y
Fd(#)535 866 y Fj(z)r(s)g Fm(\()p Fj(c)g Fm(\()p Fj(z)r(;)6
b(n)12 b Fm(\(\)\))p Fj(;)19 b(c)p Fm(\))-76 946 y(No)o(w)9
b(w)o(e)g(are)h(in)g(a)g(p)q(osition)h(to)f(turn)g(this)g(recursiv)o(e)
h(de\014nition)h(in)o(to)-76 988 y(a)j(catamorphism.)23
b(Assuming)15 b(w)o(e)f(optimise)j(for)d(static)h(parame-)-76
1029 y(ters)9 b(\(the)h Fj(c)p Fm(\),)f(w)o(e)g(get)g(the)g(follo)o
(wing)j(higher-order)f(catamorphism.)-46 1113 y Fk(r)n(everse)70
1097 y Fd(#)108 1113 y Fm(=)f Fj(\025x)h(:)g(\025)p Fm(\()p
Fj(n;)6 b(c)p Fm(\))k Fj(:)-8 1161 y Fl(cata)70 1145
y Ff(List)141 1161 y Fm(\()p Fj(\025)p Fm(\(\))h Fj(:)g(\025w)g(:)f(w)q
(;)c(\025)p Fm(\()p Fj(z)424 1165 y Fd(1)442 1161 y Fj(;)g(z)477
1165 y Fd(2)494 1161 y Fm(\))k Fj(:)h(\025w)g(:)g(z)642
1165 y Fd(2)672 1161 y Fm(\()p Fj(c)h Fm(\()p Fj(z)749
1165 y Fd(1)766 1161 y Fj(;)6 b(w)q Fm(\)\)\))12 b Fj(x)-76
1241 y Fm(This)j(can)f(b)q(e)h(substituted)h(bac)o(k)e(in)o(to)h(the)g
(de\014nition)h(of)e Fk(r)n(everse)o Fm(,)-76 1283 y(giving:)-54
1367 y Fk(r)n(everse)9 b Fm(=)i Fj(\025x)g(:)f Fl(build)288
1351 y Ff(List)359 1367 y Fm(\()p Fj(\025)p Fm(\()p Fj(n;)d(c)p
Fm(\))j Fj(:)-15 1415 y Fl(cata)63 1400 y Ff(List)134
1415 y Fm(\()p Fj(\025)p Fm(\(\))h Fj(:)f(\025w)i(:)e(w)q(;)c(\025)p
Fm(\()p Fj(z)417 1419 y Fd(1)434 1415 y Fj(;)g(z)469
1419 y Fd(2)486 1415 y Fm(\))11 b Fj(:)f(\025w)i(:)e(z)634
1419 y Fd(2)664 1415 y Fm(\()p Fj(c)i Fm(\()p Fj(z)741
1419 y Fd(1)759 1415 y Fj(;)6 b(w)q Fm(\)\)\))12 b Fj(x)p
Fm(\))-76 1495 y(In)o(terestingly)m(,)f(the)e(fusion)h(w)o(e)f(p)q
(erformed)g(with)g Fk(app)n(end)d Fm(has)k(turned)-76
1537 y(the)j(original)i(quadratic)f(de\014nition)h(of)d
Fk(r)n(everse)f Fm(in)o(to)j(a)e(linear)i(v)o(er-)-76
1578 y(sion)20 b(\(if)g(the)f Fl(build)e Fm(and)j(the)f
Fl(cata)e Fm(of)i(the)h(new)f(de\014nition)i(of)-76 1620
y(rev)o(erse)14 b(are)f(expanded,)i(then)f(w)o(e)f(obtain)i(exactly)g
(the)e(usual)i(lin-)-76 1661 y(ear)10 b(v)o(ersion\).)17
b(The)10 b(reason)h(for)f(this)h(is)f(that)g(the)g(w)o(ork)o(er)g
Fj(r)q(ev)q(er)q(se)893 1646 y Fd(#)-76 1703 y Fm(w)o(as)g(abstracted)i
(o)o(v)o(er)f(the)f(tail)i(of)e(its)h(list)h(\(the)e
Fj(n)h Fm(parameter\)|an)-76 1744 y(abstraction)k(induced)g(b)o(y)e
(the)g(in)o(tro)q(duction)j(of)d Fl(build)n Fm(.)-20
1786 y(If)e(w)o(e)h(w)o(ere)f(to)h(carry)g(the)g(same)g(program)h
(through)g(but)f Fk(start-)-76 1827 y(ing)g Fm(with)i(the)g(linear)h(v)
o(ersion)g(of)e(rev)o(erse,)g(then)h(the)g(result)g(is)g(not)-76
1869 y(quite)g(so)f(go)q(o)q(d.)18 b(W)m(e)13 b(obtain)i(the)e(result)
12 1956 y Fk(lr)n(everse)c Fm(=)i Fj(\025x)g(:)f(\025w)i(:)e
Fl(build)447 1938 y Ff(List)518 1956 y Fm(\()p Fj(\025)p
Fm(\()p Fj(n;)c(c)p Fm(\))11 b Fj(:)51 2004 y Fl(cata)129
1988 y Ff(List)200 2004 y Fm(\()p Fj(\025)p Fm(\(\))g
Fj(:)f(\025u)h(:)g Fl(cata)454 1988 y Ff(List)525 2004
y Fm(\()p Fj(n;)6 b(c)p Fm(\))13 b Fj(u;)215 2045 y(\025)p
Fm(\()p Fj(z)270 2049 y Fd(1)287 2045 y Fj(;)6 b(z)322
2049 y Fd(2)340 2045 y Fm(\))k Fj(:)h(\025u)g(:)f(z)481
2049 y Fd(2)511 2045 y Fm(\()p Fh(Cons)p Fm(\()p Fj(z)641
2049 y Fd(1)658 2045 y Fj(;)c(u)p Fm(\)\)\))12 b Fj(x)h(w)q
Fm(\))-76 2125 y(where)h(a)f(true)h(in)o(termediate)i(list)e(is)g
(inherited)i(and)e(constructed,)-76 2167 y(and)g(only)g(at)f(the)g(end)
h(it)f(is)h(abstracted)g(o)o(v)o(er)f Fj(n)g Fm(and)h
Fj(c)p Fm(.)-20 2208 y(In)d(order)h(to)e(a)o(v)o(oid)j(this,)f(w)o(e)e
(need)i(to)e(adopt)i(metho)q(d)g(2)f(ab)q(o)o(v)o(e,)-76
2250 y(in)18 b(whic)o(h)g(the)f Fl(cata)e Fm(is)j(not)f(distributed)j
(across)e(the)f Fl(case)p Fm(,)f(but)-76 2291 y(is)k(fused)f(with)g
(the)g(result)h(of)e(turning)j(the)e(inner)h(term)f(in)o(to)g(a)-76
2333 y Fl(cata)o Fm(.)29 b(This)18 b(second)g(fusion)g(is)g(t)o
(ypically)i(second-order,)f(whic)o(h)-76 2374 y(w)o(e)13
b(address)h(no)o(w.)-76 2472 y Fn(7)41 b(Second-Order)12
b(Cata-F)o(usion)-76 2551 y Fm(A)d(second)h(order)f(catamorphism,)j
Fl(cata)514 2535 y Fg(T)555 2541 y Fm(\026)547 2551 y
Fj(f)h(x)p Fm(,)c(is)g(a)g(catamorphism)-76 2592 y(whic)o(h)17
b(tra)o(v)o(erses)f(the)g(structure)h Fj(x)e Fm(and)i(constructs)f(a)g
(function.)-76 2634 y(Assuming)d(w)o(e)e(use)h(the)g(static)g
(parameter)g(optimization)q(,)i(higher-)-76 2675 y(order)h
(catamorphisms)i(only)e(arise)h(when)e(the)h(recursiv)o(e)h(in)o(v)o(o)
q(ca-)-76 2717 y(tions)c(of)e(the)h(catamorphism)i(really)g(need)e(an)g
(inherited)i(attribute)1020 614 y(from)e(ab)q(o)o(v)o(e.)17
b(F)m(or)11 b(example,)i(iterativ)o(e)g(rev)o(erse)e(w)o(orks)h(b)o(y)f
(passing)1020 656 y(the)16 b(rev)o(ersed)g(fron)o(t)f(of)h(the)f(list)i
(as)f(an)f(inherited)j(attribute.)26 b(A)o(t)1020 697
y(eac)o(h)10 b(lev)o(el)h(this)g(is)f(augmen)o(ted,)h(and)f(at)g(the)f
(end)h(the)g(accum)o(ulated)1020 739 y(list)k(is)g(returned.)1076
780 y(W)m(e)g(need)g(a)f(fusion)i(algorithm)g(to)e(handle)i(suc)o(h)f
(higher-order)1020 822 y(catamorphisms.)k(Once)11 b(again,)g(the)g
(algorithm)h(is)f(deriv)o(ed)h(from)e(a)1020 863 y(fundamen)o(tal)15
b(theorem)f(found)h(in)f(Figure)h(4.)j(The)c(theorem)g(ma)o(y)1020
905 y(b)q(e)f(pro)o(v)o(ed)h(b)o(y)g(an)f(easy)g(\014xed-p)q(oin)o(t)i
(induction.)1076 946 y(Consider)h(an)e(instan)o(tiation)j(of)d(this)h
(theorem)g(in)g(the)f(case)g(of)1020 988 y(lists.)1340
1058 y Fj(g)d Fi(\016)d Fj(f)1415 1065 y Ff(Nil)1460
1058 y Fm(\(\))j(=)f Fj(h)1563 1065 y Ff(Nil)1609 1058
y Fm(\(\))e Fi(\016)h Fj(k)1111 1072 y Fa(\022)1160 1108
y Fm(\()p Fj(s)1193 1112 y Fd(1)1210 1108 y Fj(;)d(g)k
Fi(\016)f Fj(s)1301 1112 y Fd(2)1318 1108 y Fm(\))i(=)f(\()p
Fj(r)1416 1112 y Fd(1)1434 1108 y Fj(;)c(r)1468 1112
y Fd(2)1494 1108 y Fi(\016)j Fj(k)q Fm(\))36 b Fi(\))1211
1150 y Fj(g)15 b Fm(\()p Fj(f)1278 1157 y Ff(Cons)1351
1150 y Fm(\()p Fj(s)1384 1154 y Fd(1)1401 1150 y Fj(;)6
b(s)1436 1154 y Fd(2)1453 1150 y Fm(\))13 b Fj(a)p Fm(\))e(=)f
Fj(h)1589 1157 y Ff(Cons)1663 1150 y Fm(\()p Fj(r)1695
1154 y Fd(1)1713 1150 y Fj(;)c(r)1747 1154 y Fd(2)1765
1150 y Fm(\))12 b(\()p Fj(k)i(a)p Fm(\))1895 1072 y Fa(\023)p
1092 1172 853 2 v 1230 1222 a Fj(g)h Fm(\()p Fl(cata)1356
1206 y Ff(List)1427 1222 y Fm(\()p Fj(f)1461 1229 y Ff(Nil)1506
1222 y Fj(;)6 b(f)1542 1229 y Ff(Cons)1615 1222 y Fm(\))13
b Fj(x)g(w)q Fm(\))23 b(=)1307 1270 y Fl(cata)1385 1254
y Ff(List)1456 1270 y Fm(\()p Fj(h)1493 1277 y Ff(Nil)1539
1270 y Fj(;)6 b(h)1578 1277 y Ff(Cons)1652 1270 y Fm(\))12
b Fj(x)h Fm(\()p Fj(k)h(w)q Fm(\))1020 1350 y(Once)e(again,)h(w)o(e)e
(in)o(tend)i(to)f(in)o(terpret)g(this)h(la)o(w)f(as)f(a)h(left-to-righ)
o(t)1020 1392 y(rewrite)k(rule.)24 b(This)16 b(is)f(giv)o(en)i(in)f
(Figure)g(5,)f(with)h(the)f(di\013erence)1020 1433 y(that)f(the)g
Fk(same)f Fm(function)i Fj(g)g Fm(is)f(used)h(b)q(oth)f(on)g(the)g
(left)g(and)g(righ)o(t)1020 1475 y(\(i.e.)i Fj(k)11 b
Fm(is)g(instan)o(tiated)i(to)d Fj(g)q Fm(\).)16 b(This)11
b(is)g(less)g(general)g(than)g(the)f(the-)1020 1516 y(orem)h(allo)o
(ws,)i(but)f(seems)f(to)g(b)q(e)h(su\016cien)o(t)h(for)e(the)g(cases)h
(w)o(e)f(ha)o(v)o(e)1020 1558 y(seen.)16 b(The)10 b(more)g(general)h
(case)f(p)q(oses)h(the)f(problem)h(of)e(generating)1020
1599 y(an)k(appropriate)i Fj(k)f Fm(during)h(rewriting.)1020
1693 y Fn(7.1)41 b(Example)1020 1764 y Fm(As)14 b(an)h(example,)g
(consider)h(fusing)g(the)e(function)i Fl(cata)1857 1748
y Ff(List)1930 1764 y Fm(\()p Fj(n;)6 b(c)p Fm(\))1020
1806 y(\(where)j Fj(n)g Fm(and)h Fj(c)f Fm(are)g(v)n(ariables\))i(to)e
(the)g(iterativ)o(e)i(rev)o(erse)f(function)1020 1847
y(when)f(the)g(latter)h(is)f(expressed)h(as)f(a)g(second)h(order)g
(catamorphism.)1020 1889 y(This)k(is)f(exactly)i(the)e(sort)g(of)g
(situation)i(whic)o(h)f(m)o(ust)f(succeed)h(for)1020
1930 y(metho)q(d)g(2)f(of)g(Section)h(6)f(to)g(w)o(ork.)1076
1972 y(F)m(rom)g(Section)h(5)f(w)o(e)g(had)1077 2049
y Fk(lr)n(everse)d Fm(=)g Fl(cata)1334 2033 y Ff(List)1404
2049 y Fm(\()p Fj(\025)p Fm(\(\))h Fj(:)g(\025w)g(:)g(w)q(;)1419
2090 y(\025)p Fm(\()p Fj(z)1474 2094 y Fd(1)1492 2090
y Fj(;)6 b(z)1527 2094 y Fd(2)1544 2090 y Fm(\))11 b
Fj(:)f(\025w)i(:)e(z)1692 2094 y Fd(2)1722 2090 y Fm(\()p
Fh(Cons)o Fm(\()p Fj(z)1851 2094 y Fd(1)1869 2090 y Fj(;)c(w)q
Fm(\)\)\))1020 2170 y(The)13 b(fusion)h(w)o(e)f(w)o(an)o(t)g(to)g(p)q
(erform)g(is)1231 2257 y Fl(cata)1309 2239 y Ff(List)1380
2257 y Fm(\()p Fj(n;)6 b(c)p Fm(\))12 b(\()p Fk(lr)n(everse)g
Fj(x)g Fm(\()p Fh(Nil)g Fm(\(\)\)\))1020 2336 y(W)m(e)j(calculate)j
(the)d(additional)k(rules)d(in)g(eac)o(h)g(of)f(the)g(t)o(w)o(o)g
(cases.)1020 2377 y(F)m(or)e Fh(Nil)f Fm(the)h(additional)j(rules)e
(are)1149 2455 y Fi(f)p Fj(E)1196 2462 y Ff(Nil)1242
2455 y Fm(\()p Fj(\025s)d(:)f Fl(cata)1408 2439 y Ff(List)1479
2455 y Fm(\()p Fc(n)p Fj(;)5 b Fc(c)p Fm(\))j Fi(\016)h
Fj(s)p Fm(\))d(\(\))1318 2503 y Fi(\))11 b Fj(E)1395
2510 y Ff(Nil)1440 2503 y Fm(\()p Fj(\025r)i(:)d(r)g
Fi(\016)f Fl(cata)1661 2487 y Ff(List)1732 2503 y Fm(\()p
Fc(n)p Fj(;)d Fc(c)p Fm(\)\)\(\))p Fi(g)1279 2551 y([)13
b(f)p Fl(cata)1415 2535 y Ff(List)1486 2551 y Fm(\()p
Fc(n)p Fj(;)6 b Fc(c)p Fm(\))12 b Fc(y)g Fi(!)f Fc(z)p
Fi(g)1186 2599 y Fm(=)38 b Fi(f)p Fm(\(\))10 b Fi(!)h
Fm(\(\))p Fi(g)e([)f(f)p Fl(cata)1552 2583 y Ff(List)1623
2599 y Fm(\()p Fc(n)p Fj(;)d Fc(c)p Fm(\))13 b Fc(y)e
Fi(!)g Fc(z)p Fi(g)1186 2647 y Fm(=)38 b Fi(f)p Fl(cata)1351
2631 y Ff(List)1422 2647 y Fm(\()p Fc(n)p Fj(;)6 b Fc(c)p
Fm(\))12 b Fc(y)g Fi(!)f Fc(z)p Fi(g)p eop
%%Page: 9 9
9 8 bop -76 -34 a Fm(and)10 b(for)e Fh(Cons)g Fm(w)o(e)g(ha)o(v)o(e)i
(\(writing)g Fl(cata)497 -50 y Ff(List)564 -34 y Fm(\()p
Fc(n)p Fj(;)5 b Fc(c)p Fm(\))k(as)f Fj(g)j Fm(for)d(brevit)o(y\),)-26
31 y Fi(f)p Fj(E)21 38 y Ff(Cons)96 31 y Fm(\()p Fj(\025s)i(:)h(g)f
Fi(\016)f Fj(s)p Fm(\))d(\()p Fc(s)310 35 y Fd(1)328
31 y Fj(;)g Fc(s)362 35 y Fd(2)379 31 y Fm(\))11 b Fi(\))g
Fj(E)482 38 y Ff(Cons)556 31 y Fm(\()p Fj(\025r)i(:)d(r)g
Fi(\016)e Fj(g)q Fm(\)\()p Fc(r)765 35 y Fd(1)784 31
y Fj(;)e Fc(r)819 35 y Fd(2)836 31 y Fm(\))p Fi(g)105
72 y([)12 b(f)p Fj(g)j Fc(y)c Fi(!)g Fc(z)p Fi(g)12 114
y Fm(=)37 b Fi(f)p Fm(\()p Fc(s)130 118 y Fd(1)148 114
y Fj(;)6 b Fm(\()p Fj(\025s)11 b(:)f(g)g Fi(\016)f Fj(s)p
Fm(\))k Fc(s)371 118 y Fd(2)388 114 y Fm(\))e Fi(\))g
Fm(\()p Fc(r)496 118 y Fd(1)513 114 y Fj(;)c Fm(\()p
Fj(\025r)12 b(:)e(r)g Fi(\016)f Fj(g)q Fm(\))k Fc(r)738
118 y Fd(2)756 114 y Fm(\))p Fi(g)105 155 y([)f(f)p Fj(g)j
Fc(y)c Fi(!)g Fc(z)p Fi(g)12 197 y Fm(=)37 b Fi(f)p Fc(s)115
201 y Fd(1)144 197 y Fi(!)11 b Fc(r)p Fm(1)p Fj(;)19
b(g)10 b Fi(\016)f Fc(s)333 201 y Fd(2)361 197 y Fi(!)i
Fc(r)428 201 y Fd(2)454 197 y Fi(\016)e Fj(g)q(;)20 b(g)14
b Fc(y)e Fi(!)f Fc(z)p Fi(g)12 238 y Fm(=)37 b Fi(f)p
Fc(s)115 242 y Fd(1)144 238 y Fi(!)11 b Fc(r)p Fm(1)p
Fj(;)19 b(g)14 b Fm(\()p Fc(s)324 242 y Fd(2)355 238
y Fj(x)p Fm(\))c Fi(!)h Fc(r)469 242 y Fd(2)500 238 y
Fm(\()p Fj(g)j(x)p Fm(\))p Fj(;)k(g)d Fc(y)d Fi(!)f Fc(z)p
Fi(g)-76 303 y Fm(So)i(the)h(additional)i(rules)e(for)f
Fh(Cons)f Fm(are:)25 359 y Fi(f)p Fc(s)61 363 y Fd(1)89
359 y Fi(!)f Fc(r)p Fm(1)p Fj(;)44 407 y Fl(cata)122
391 y Ff(List)193 407 y Fm(\()p Fc(n)p Fj(;)6 b Fc(c)p
Fm(\))12 b(\()p Fc(s)329 411 y Fd(2)360 407 y Fj(x)p
Fm(\))e Fi(!)h Fc(r)474 411 y Fd(2)504 407 y Fm(\()p
Fl(cata)598 391 y Ff(List)669 407 y Fm(\()p Fc(n)p Fj(;)5
b Fc(c)p Fm(\))13 b Fj(x)p Fm(\))p Fj(;)44 455 y Fl(cata)122
439 y Ff(List)193 455 y Fm(\()p Fc(n)p Fj(;)6 b Fc(c)p
Fm(\))12 b Fc(y)g Fi(!)f Fc(z)p Fi(g)-76 520 y Fm(P)o(erforming)16
b(the)f(rewriting)h(for)e Fj(h)441 527 y Ff(Cons)530
520 y Fm(and)h Fj(h)628 527 y Ff(Nil)688 520 y Fm(w)o(e)f(obtain)i(the)
-76 567 y(fused)10 b(v)o(ersion)i(of)d Fl(cata)267 551
y Ff(List)335 567 y Fm(\()p Fc(n)p Fj(;)c Fc(c)p Fm(\))k(\()p
Fk(lr)n(everse)f Fj(x)i Fm(\()p Fh(Nil)o Fm(\(\)\)\))f(as)h(follo)o
(ws:)-57 639 y Fi(R)-24 646 y Ff(Nil)77 639 y Fi(`)57
b Fj(\025)p Fm(\(\))11 b Fj(:)g(\025)p Fc(z)f Fj(:)h
Fl(cata)394 623 y Ff(List)465 639 y Fm(\()p Fc(n)p Fj(;)6
b Fc(c)p Fm(\))12 b(\(\()p Fj(\025)p Fm(\(\))f Fj(:)f(\025w)i(:)e(w)q
Fm(\))i(\(\))h Fc(y)q Fm(\))58 687 y Fi(\000)-6 b(!)37
b Fj(\025)p Fm(\(\))11 b Fj(:)g(\025)p Fc(z)f Fj(:)h
Fl(cata)394 671 y Ff(List)465 687 y Fm(\()p Fc(n)p Fj(;)6
b Fc(c)p Fm(\))12 b Fc(y)58 729 y Fi(\000)-6 b(!)37 b
Fj(\025)p Fm(\(\))11 b Fj(:)g(\025)p Fc(z)f Fj(:)h Fc(z)-76
794 y Fm(and)j(in)g(the)f Fh(Cons)f Fm(case:)-44 849
y Fi(R)-11 856 y Ff(Cons)13 897 y Fi(`)57 b Fj(\025)p
Fm(\()p Fc(r)148 901 y Fd(1)166 897 y Fj(;)6 b Fc(r)201
901 y Fd(2)219 897 y Fm(\))k Fj(:)g(\025)p Fc(z)h Fj(:)f
Fl(cata)418 882 y Ff(List)489 897 y Fm(\()p Fc(n)p Fj(;)5
b Fc(c)p Fm(\))119 939 y(\(\()p Fj(\025)p Fm(\()p Fj(z)204
943 y Fd(1)221 939 y Fj(;)h(z)256 943 y Fd(2)273 939
y Fm(\))11 b Fj(:)f(\025u)h(:)g(z)415 943 y Fd(2)445
939 y Fm(\()p Fh(Cons)o Fm(\()p Fj(z)574 943 y Fd(1)591
939 y Fj(;)6 b(u)p Fm(\)\)\))13 b(\()p Fc(s)720 943 y
Fd(1)738 939 y Fj(;)6 b Fc(s)772 943 y Fd(2)789 939 y
Fm(\))13 b Fc(y)q Fm(\))-6 987 y Fi(\000)-7 b(!)38 b
Fj(\025)p Fm(\()p Fc(r)148 991 y Fd(1)166 987 y Fj(;)6
b Fc(r)201 991 y Fd(2)219 987 y Fm(\))k Fj(:)g(\025)p
Fc(z)h Fj(:)f Fl(cata)418 971 y Ff(List)489 987 y Fm(\()p
Fc(n)p Fj(;)5 b Fc(c)p Fm(\))13 b(\()p Fc(s)625 991 y
Fd(2)655 987 y Fm(\()p Fh(Cons)p Fm(\()p Fc(s)784 991
y Fd(1)801 987 y Fj(;)7 b Fc(y)q Fm(\)\)\))-6 1035 y
Fi(\000)-7 b(!)38 b Fj(\025)p Fm(\()p Fc(r)148 1039 y
Fd(1)166 1035 y Fj(;)6 b Fc(r)201 1039 y Fd(2)219 1035
y Fm(\))k Fj(:)g(\025)p Fc(z)h Fj(:)f Fc(r)357 1039 y
Fd(2)388 1035 y Fm(\()p Fl(cata)481 1019 y Ff(List)552
1035 y Fm(\()p Fc(n)p Fj(;)c Fc(c)p Fm(\))12 b(\()p Fh(Cons)p
Fm(\()p Fc(s)785 1039 y Fd(1)802 1035 y Fj(;)6 b Fc(y)q
Fm(\)\)\))-6 1084 y Fi(\000)-7 b(!)38 b Fj(\025)p Fm(\()p
Fc(r)148 1088 y Fd(1)166 1084 y Fj(;)6 b Fc(r)201 1088
y Fd(2)219 1084 y Fm(\))k Fj(:)g(\025)p Fc(z)h Fj(:)f
Fc(r)357 1088 y Fd(2)388 1084 y Fm(\()p Fc(c)i Fm(\()p
Fc(s)467 1088 y Fd(1)485 1084 y Fj(;)6 b Fl(cata)580
1068 y Ff(List)651 1084 y Fm(\()p Fc(n)p Fj(;)g Fc(c)p
Fm(\))12 b Fc(y)q Fm(\)\)\))-6 1125 y Fi(\000)-7 b(!)38
b Fj(\025)p Fm(\()p Fc(r)148 1129 y Fd(1)166 1125 y Fj(;)6
b Fc(r)201 1129 y Fd(2)219 1125 y Fm(\))k Fj(:)g(\025)p
Fc(z)h Fj(:)f Fc(r)357 1129 y Fd(2)388 1125 y Fm(\()p
Fc(c)i Fm(\()p Fc(s)467 1129 y Fd(1)485 1125 y Fj(;)6
b Fc(z)p Fm(\)\)\))-6 1167 y Fi(\000)-7 b(!)38 b Fj(\025)p
Fm(\()p Fc(r)148 1171 y Fd(1)166 1167 y Fj(;)6 b Fc(r)201
1171 y Fd(2)219 1167 y Fm(\))k Fj(:)g(\025)p Fc(z)h Fj(:)f
Fc(r)357 1171 y Fd(2)388 1167 y Fm(\()p Fc(c)i Fm(\()p
Fc(r)468 1171 y Fd(1)486 1167 y Fj(;)6 b Fc(z)p Fm(\)\)\))-76
1232 y(so)14 b(eliminatin)q(g)i(all)f Fc(s)p Fm('s)f(and)g
Fc(y)q Fm(.)19 b(Putting)c(this)f(all)h(in)g(the)f(con)o(text)-76
1273 y(of)f(the)g(build,)i(w)o(e)d(obtain,)-57 1343 y
Fk(lr)n(everse)d Fm(=)h Fj(\025x)h(:)g(\025w)g(:)g Fl(build)378
1327 y Ff(List)449 1343 y Fm(\()p Fj(\025)p Fm(\()p Fj(n;)6
b(c)p Fm(\))k Fj(:)-19 1391 y Fl(cata)60 1375 y Ff(List)131
1391 y Fm(\()p Fj(\025)p Fm(\(\))g Fj(:)h(\025z)h(:)f(z)r(;)18
b(\025)p Fm(\()p Fj(r)407 1395 y Fd(1)425 1391 y Fj(;)6
b(r)459 1395 y Fd(2)477 1391 y Fm(\))k Fj(:)h(\025z)h(:)e(r)614
1395 y Fd(2)645 1391 y Fm(\()p Fj(c)i Fm(\()p Fj(r)721
1395 y Fd(1)739 1391 y Fj(;)6 b(z)r Fm(\)\)\))12 b Fj(x)g(w)q
Fm(\))-76 1456 y(whic)o(h)19 b(is)f(equiv)n(alen)o(t)i(to)e(the)g
(result)g(obtained)i(from)d(quadratic)-76 1497 y(rev)o(erse!)-76
1593 y Fn(8)41 b(Status)-76 1671 y Fm(The)20 b(algorithm)h(w)o(e)e(ha)o
(v)o(e)h(describ)q(ed)i(handles)f(a)f(wide)g(v)n(ariet)o(y)-76
1713 y(of)15 b(cases|expressions)k(whic)o(h)d(are)f(consumers)i(or)e
(pro)q(ducers)h(of)-76 1754 y(structured)e(t)o(yp)q(es,)f(or)g(b)q
(oth.)k(Expressions)e(whic)o(h)f(are)f(pro)q(ducers)-76
1796 y(of)c Fj(T)14 b Fm(ob)r(jects)9 b(are)g(transformed)h(in)o(to)g
Fl(build)p Fm('s)c(o)o(v)o(er)j Fj(T)c Fm(.)16 b(Consumers)-76
1837 y(of)d Fj(T)20 b Fm(ob)r(jects)14 b(are)f(transformed)i(in)o(to)f
Fl(cata)p Fm('s)e(o)o(v)o(er)h Fj(T)5 b Fm(.)20 b(F)m(unctions)-76
1879 y(whic)o(h)11 b(are)f(pro)q(ducers)h(of)f Fj(T)15
b Fm(ob)r(jects)10 b(and)h(consumers)g(of)f Fj(S)i Fm(ob)r(jects)-76
1920 y(are)f(transformed)g(in)o(to)g Fl(build)p Fm('s)d(o)o(v)o(er)i
Fj(S)j Fm(surrounding)g(a)d Fl(cata)f Fm(o)o(v)o(er)-76
1962 y Fj(T)c Fm(.)-20 2003 y(When)12 b(w)o(e)e(ha)o(v)o(e)h(a)g
(function)h(whic)o(h)g(is)f(b)q(oth)g(a)g(pro)q(ducer)h(and)f(a)-76
2045 y(consumer)j(w)o(e)d(\014rst)i(in)o(tro)q(duce)h(a)f
Fl(build)d Fm(in)o(to)j(the)g(recursion,)h(and)-76 2086
y(then)g(try)f(to)g(turn)h(this)g(recursiv)o(e)h(function)g(in)o(to)f
(a)f Fl(cata)p Fm(.)j(Of)d(the)-76 2128 y(t)o(w)o(o)d(metho)q(ds)h(of)f
(Section)h(6)f(initiall)q(y)j(try)d(the)g(second,)i(since)f(when)-76
2169 y(it)16 b(succeeds)g(it)g(seems)f(to)g(pro)q(duce)i(sup)q(erior)g
(results.)25 b(If)14 b(the)i(fu-)-76 2211 y(sion)d(algorithm)g(fails)g
(using)g(this)f(strategy)m(,)g(w)o(e)f(then)g(attempt)h(the)-76
2252 y(\014rst)g(metho)q(d)f(\(pushing)j(the)d Fl(cata)18
b(\(n,c\))9 b Fm(across)j(the)f Fl(case)p Fm(\),)f(and)-76
2294 y(then)17 b(attempt)g(to)f(obtain)i(a)e(catamorphism.)29
b(If)16 b(neither)h(w)o(orks)-76 2335 y(w)o(e)12 b(simply)i(giv)o(e)f
(up)g(and)f(lea)o(v)o(e)i(the)e(function)h(as)g(it)f(w)o(as)g
(orignally)-76 2377 y(de\014ned.)-76 2468 y Fn(8.1)41
b(Mo)o(re)12 b(Examples)-76 2534 y Fm(The)h Fl(upto)e
Fm(function)k(pro)q(duces)f(lists)g(from)f(in)o(tegers.)-36
2598 y Fk(upto)f Fm(=)f Fj(\025)p Fk(low)k Fj(:)10 b(\025)p
Fk(high)i Fj(:)98 2639 y Fl(case)g Fj(l)q(ow)e(>)h(hig)q(h)j
Fl(of)166 2681 y Fh(F)m(alse)o Fm(\(\))f Fl(->)f Fh(Cons)p
Fm(\()p Fj(l)q(ow)q(;)5 b(upto)12 b Fm(\()p Fj(l)q(ow)d
Fm(+)g(1\))j Fj(hig)q(h)p Fm(\))118 2722 y Fi(j)37 b
Fh(T)m(rue)p Fm(\(\))12 b Fl(->)g Fh(Nil)o Fm(\(\))1020
-34 y(Since)20 b(\(in)f(our)f(setting\))i(in)o(tegers)f(are)g(not)f
(freely)h(constructed,)1020 7 y Fl(upto)13 b Fm(is)i(only)h(a)e(pro)q
(ducer)i(and)f(not)g(a)f(consumer,)i(so)e(w)o(e)g(merely)1020
49 y(obtain)h(a)e Fl(build)d Fm(form:)1039 123 y Fk(upto)h
Fm(=)g Fj(\025)p Fk(low)k Fj(:)10 b(\025)p Fk(high)j
Fj(:)d Fl(build)i Fm(\()p Fk(upto)1607 107 y Fd(#)1646
123 y Fk(low)18 b(high)s Fm(\))1039 168 y Fj(upto)1113
152 y Fd(#)1150 168 y Fm(=)11 b Fj(\025l)q(ow)g(:)f(\025hig)q(h)i(:)f
(\025)p Fm(\()p Fj(n;)6 b(c)p Fm(\))11 b Fj(:)1173 210
y Fl(case)g Fj(l)q(ow)g(>)f(hig)q(h)k Fl(of)1240 255
y Fh(F)m(alse)p Fm(\(\))e Fl(->)g Fj(c)h Fm(\()p Fj(l)q(ow)q(;)5
b(upto)1611 239 y Fd(#)1650 255 y Fm(\()p Fj(l)q(ow)k
Fm(+)g(1\))j Fj(hig)q(h)i Fm(\()p Fj(n;)6 b(c)p Fm(\)\))1192
297 y Fi(j)37 b Fh(T)m(rue)p Fm(\(\))12 b Fl(->)h Fj(n)f
Fm(\(\))1076 376 y(A)17 b(function)i(whic)o(h)f(b)q(oth)g(pro)q(duces)h
(and)f(consumes)h(lists)g(is)1020 417 y(the)d Fl(zip)e
Fm(function.)26 b(It)15 b(is)h(in)o(teresting)i(b)q(ecause)f(it)f
(recurses)g(o)o(v)o(er)1020 459 y(t)o(w)o(o)d(argumen)o(ts)h(sim)o
(ultaneously:)1039 536 y Fk(zip)e Fm(=)e Fj(\025)p Fk(x)16
b Fj(:)10 b(\025)p Fk(y)k Fj(:)1070 578 y Fl(case)d Fj(x)i
Fl(of)1138 619 y Fh(Nil)o Fm(\(\))g Fl(->)f Fh(Nil)o
Fm(\(\))1090 661 y Fi(j)37 b Fh(Cons)o Fm(\()p Fj(a;)7
b(b)p Fm(\))13 b Fl(->)31 b(case)11 b Fj(y)j Fl(of)1454
702 y Fh(Nil)p Fm(\(\))e Fl(->)g Fh(Nil)o Fm(\(\))1406
744 y Fi(j)37 b Fh(Cons)p Fm(\()p Fj(c;)6 b(d)p Fm(\))12
b Fl(->)g Fh(Cons)p Fm(\(\()p Fj(a;)6 b(c)p Fm(\))p Fj(;)19
b(z)r(ip)12 b(b)i(d)p Fm(\))1020 825 y(The)9 b(resulting)j(wrapp)q
(er/w)o(ork)o(er)e(pair,)g(wraps)g(a)f Fl(build)e Fm(o)o(v)o(ers)j
Fk(lists)1020 866 y Fm(around)k(a)f Fl(cata)f Fm(o)o(v)o(er)h
Fk(lists)p Fm(.)1040 943 y Fk(zip)f Fm(=)e Fj(\025)p
Fk(x)15 b Fj(:)c(\025)p Fk(y)j Fj(:)c Fl(build)1391 927
y Ff(List)1463 943 y Fm(\()p Fk(zip)1528 927 y Fd(#)1568
943 y Fk(x)18 b(y)s Fm(\))1040 988 y Fj(z)r(ip)1092 972
y Fd(#)1129 988 y Fm(=)11 b Fj(\025x)f(:)h(\025y)h(:)e(\025)p
Fm(\()p Fj(n;)d(c)p Fm(\))j Fj(:)1097 1036 y Fl(cata)1175
1021 y Ff(List)1246 1036 y Fm(\()p Fj(\025)p Fm(\(\))h
Fj(:)f(\025u)h(:)g(n)i Fm(\(\))p Fj(;)1261 1078 y(\025)p
Fm(\()p Fj(w)q(;)6 b(g)q Fm(\))11 b Fj(:)f(\025u)i(:)1305
1120 y Fl(case)f Fj(u)i Fl(of)1373 1161 y Fh(Nil)o Fm(\(\))g
Fl(->)f Fj(n)p Fm(\(\))1325 1203 y Fi(j)37 b Fh(Cons)o
Fm(\()p Fj(z)r(;)6 b(z)r(s)p Fm(\))12 b Fl(->)g Fj(c)g
Fm(\(\()p Fj(w)q(;)6 b(z)r Fm(\))p Fj(;)18 b(g)d(z)r(s)p
Fm(\)\))d Fj(x)g(y)1020 1282 y Fm(Only)j Fj(z)r(ip)p
Fm('s)e(\014rst)h(argumen)o(t)g(is)h(tra)o(v)o(ersed)f(using)h
Fl(cata)p Fm(.)j(The)13 b(sec-)1020 1323 y(ond)19 b(is)g(tak)o(en)g
(apart)f(b)o(y)h(explicit)i(case-analysis.)35 b(Th)o(us,)20
b(as)e(in)1020 1365 y([GLPJ93,)13 b(SF93],)f Fj(z)r(ip)h
Fm(only)h(fuses)g(on)f(it's)g(\014rst)g(argumen)o(t.)1076
1406 y(The)j Fl(take)f Fm(function)i(is)g(in)o(teresting)h(since)f
(it's)g Fj(Q)f Fm(con)o(text)h(is)1020 1448 y(non-trivial,)i(b)q
(ecause)e(of)e(testing)i(the)e(in)o(teger)i(argumen)o(t)g(in)f(the)1020
1489 y(original)22 b(recursiv)o(e)e(de\014nition.)38
b(T)o(ying)19 b(the)g(recursiv)o(e)i(knot)e(in)1020 1531
y(tak)o(e)11 b(is)h(complicated)i(b)o(y)d(the)h(fact)f(that)g(this)h
(con)o(text)g(needs)g(to)f(b)q(e)1020 1572 y(duplicated)16
b(inside)f(the)e Fl(cata)p Fm(.)i(F)m(or)e(example:)1039
1649 y Fk(take)f Fm(=)e Fj(\025)p Fk(m)15 b Fj(:)10 b(\025)p
Fk(x)15 b Fj(:)1096 1691 y Fl(case)c Fj(m)g Fm(==)f(0)j
Fl(of)1163 1732 y Fh(T)m(rue)p Fm(\(\))g Fl(->)f Fh(Nil)o
Fm(\(\))1115 1774 y Fi(j)37 b Fh(F)m(alse)p Fm(\(\))12
b Fl(->)31 b(case)11 b Fj(x)i Fl(of)1426 1815 y Fh(Nil)o
Fm(\(\))g Fl(->)f Fh(Nil)o Fm(\(\))1378 1857 y Fi(j)37
b Fh(Cons)o Fm(\()p Fj(a;)7 b(b)p Fm(\))13 b Fl(->)f
Fh(Cons)p Fm(\()p Fj(a;)6 b(tak)q(e)13 b Fm(\()p Fj(m)8
b Fi(\000)h Fm(1\))k Fj(b)p Fm(\))1020 1936 y(results)h(in)g(the)f
(follo)o(wing:)1039 2020 y Fk(take)f Fm(=)e Fj(\025)p
Fk(m)15 b Fj(:)10 b(\025)p Fk(x)15 b Fj(:)c Fl(build)1424
2004 y Ff(List)1496 2020 y Fm(\()p Fj(\025)p Fm(\()p
Fk(n)s Fj(;)5 b Fk(c)r Fm(\))11 b Fj(:)1096 2061 y Fl(case)g
Fj(m)g Fm(==)f(0)j Fl(of)1163 2103 y Fh(T)m(rue)p Fm(\(\))g
Fl(->)f Fh(Nil)o Fm(\(\))1115 2144 y Fi(j)37 b Fh(F)m(alse)p
Fm(\(\))12 b Fl(->)1233 2192 y(cata)1312 2176 y Ff(List)1383
2192 y Fm(\()p Fj(\025)p Fm(\(\))f Fj(:)f(\025m)h(:)f(n)p
Fm(\(\))p Fj(;)1398 2234 y(\025)p Fm(\()p Fj(z)r(;)5
b(g)q Fm(\))12 b Fj(:)e(\025m)h(:)1423 2275 y(c)i Fm(\()p
Fj(z)r(;)24 b Fl(case)11 b Fj(m)d Fi(\000)h Fm(1)i(==)f(0)j
Fl(of)1590 2317 y Fh(T)m(rue)p Fm(\(\))g Fl(->)f Fj(n)p
Fm(\(\))1542 2358 y Fi(j)37 b Fh(F)m(alse)p Fm(\(\))12
b Fl(->)g Fj(g)j Fm(\()p Fj(m)8 b Fi(\000)h Fm(1\)\)\))j
Fj(x)h(m)1076 2437 y Fm(The)j(\015atten)h(function)h(whic)o(h)f
(squashes)h(trees)f(in)o(to)g(lists,)h(il-)1020 2479
y(lustrates)e(the)e(case)h(where)g(the)f(pro)q(ducer)i(and)f(consumer)h
(are)e(of)1020 2520 y(di\013eren)o(t)h(t)o(yp)q(es.)1039
2598 y Fk(\015atten)c Fm(=)g Fj(\025)p Fk(t)j Fj(:)29
b Fl(case)12 b Fj(t)i Fl(of)1357 2639 y Fh(Tip)o Fm(\(\))g
Fl(->)f Fh(Nil)o Fm(\(\))1309 2681 y Fi(j)37 b Fh(No)q(de)p
Fm(\()p Fj(a;)6 b(b;)h(c)p Fm(\))13 b Fl(->)1412 2722
y Fk(app)n(end)e Fm(\()p Fj(f)t(l)q(atten)i(a)p Fm(\))h(\()p
Fh(Cons)p Fm(\()p Fj(b;)6 b(f)t(l)q(atten)14 b(c)p Fm(\)\))p
eop
%%Page: 10 10
10 9 bop -76 -34 a Fm(It)15 b(is)g(in)o(teresting)i(to)e(note)g(that,)h
(lik)o(e)g(the)f Fk(r)n(everse)f Fm(function,)i(the)-76
7 y(additional)c(abstraction)f(in)o(tro)q(duced)g(b)o(y)e
Fl(build)e Fm(pro)q(duces)j(a)e(linear)-76 49 y(\015atten)14
b(function:)-57 115 y Fk(\015atten)d Fm(=)g Fj(\025)p
Fk(t)j Fj(:)c Fl(build)i Fm(\()p Fk(\015atten)413 100
y Fd(#)452 115 y Fk(t)t Fm(\))-57 161 y Fj(f)t(l)q(atten)67
145 y Fd(#)104 161 y Fm(=)f Fj(\025t)g(:)f(\025)p Fm(\()p
Fj(n;)d(c)p Fm(\))j Fj(:)77 209 y Fl(cata)155 193 y Ff(T)m(ree)234
209 y Fm(\()o Fj(\025)p Fm(\(\))h Fj(:)g(\025n)378 193
y Fe(0)400 209 y Fj(:)f(n)444 193 y Fe(0)456 209 y Fm(\(\))p
Fj(;)248 251 y(\025)p Fm(\()p Fj(f)r(;)c(x;)g(g)q Fm(\))12
b Fj(:)e(\025n)474 235 y Fe(0)496 251 y Fj(:)h(\025)p
Fm(\(\))g Fj(:)f(f)16 b Fm(\()p Fj(c)d Fm(\()p Fj(x;)5
b(g)15 b(n)791 235 y Fe(0)802 251 y Fm(\)\)\))e Fj(t)g(n)-20
323 y Fm(Our)k(\014nal)h(example)g(is)f(tak)o(en)g(from)g(a)f(sligh)o
(tly)k(ric)o(her)d(t)o(yp)q(e,)-76 365 y(in)o(tended)f(to)d(indicate)j
(ho)o(w)d(our)h(algorithm)i(is)e(lik)o(ely)i(to)d(p)q(erform)-76
406 y(when)k(applied)i(to)e(abstract)g(syn)o(tax)h(structures.)29
b(Consider)18 b(the)-76 448 y(t)o(yp)q(es)-4 518 y Fk(Exp)13
b Fm(=)d Fl(Rec)o Fj(\014)e(:)e Fh(Num)14 b Fk(Int)25
b Fm(+)d Fh(Id)13 b Fk(String)25 b Fm(+)d Fh(Plus)12
b Fm(\()p Fj(\014)r(;)6 b(\014)r Fm(\))-4 559 y Fj(C)s(ode)k
Fm(=)h Fh(LoadI)i Fj(I)s(nt)21 b Fm(+)g Fh(LoadV)14 b
Fj(S)r(tr)q(ing)24 b Fm(+)d Fh(Add)p Fm(\(\))-76 631
y(The)16 b(\014rst)g(represen)o(ts)g(expressions,)j(the)d(second)g(a)g
(p)q(ost\014x)h(co)q(de)-76 673 y(form.)31 b(A)17 b(t)o(ypical)i
(translation)h(function)f(from)f(the)g(one)g(to)f(the)-76
714 y(other)d(could)g(b)q(e)f(de\014ned)h(as)g(follo)o(ws.)-18
777 y Fk(p)n(ost\014x)f Fm(=)d Fj(\025)p Fk(x)16 b Fj(:)26
818 y Fl(case)11 b Fj(x)i Fl(of)94 860 y Fh(Num)g Fj(n)g
Fl(->)f Fh(Cons)o Fm(\()p Fh(LoadI)h Fj(n;)6 b Fh(Nil)p
Fm(\(\)\))46 901 y Fi(j)37 b Fh(Id)12 b Fj(s)h Fl(->)f
Fh(Cons)p Fm(\()p Fh(LoadV)h Fj(s;)6 b Fh(Nil)o Fm(\(\)\))46
943 y Fi(j)37 b Fh(Plus)n Fm(\()p Fj(x;)6 b(y)q Fm(\))13
b Fl(->)f Fk(app)n(end)f Fm(\()p Fj(postf)t(ix)h(x)p
Fm(\))145 984 y(\()p Fk(app)n(end)e Fm(\()p Fj(postf)t(ix)i(y)q
Fm(\))h(\()p Fh(Cons)p Fm(\()p Fh(Add)o Fm(\(\))p Fj(;)6
b Fh(Nil)p Fm(\(\)\)\)\))-76 1056 y(Applying)16 b(the)d(transformation)
h(of)f(the)g(pap)q(er)h(giv)o(es:)-57 1133 y Fk(p)n(ost\014x)f
Fm(=)d Fj(\025)p Fk(x)16 b Fj(:)10 b Fl(build)278 1117
y Ff(List)336 1133 y Fm(\()p Fk(p)n(ost\014x)463 1117
y Fd(#)501 1133 y Fk(x)5 b Fm(\))-57 1178 y Fj(postf)t(ix)71
1162 y Fd(#)108 1178 y Fm(=)10 b Fj(\025x)h(:)f(\025)p
Fm(\()p Fj(n;)d(c)p Fm(\))j Fj(:)-13 1227 y Fl(cata)66
1211 y Ff(Exp)139 1227 y Fm(\()o Fj(\025m)h(:)g(\025n)287
1211 y Fe(0)309 1227 y Fj(:)f(c)j Fm(\()p Fh(LoadI)g
Fj(m;)6 b(n)556 1211 y Fe(0)567 1227 y Fm(\(\)\))p Fj(;)153
1269 y(\025s)11 b(:)g(\025n)271 1253 y Fe(0)293 1269
y Fj(:)f(c)j Fm(\()p Fh(LoadV)g Fj(s;)6 b(n)538 1253
y Fe(0)550 1269 y Fm(\(\)\))p Fj(;)153 1310 y(\025)p
Fm(\()p Fj(f)r(;)g(g)q Fm(\))12 b Fj(:)196 1352 y(\025n)241
1336 y Fe(0)264 1352 y Fj(:)e(f)16 b Fm(\()p Fj(\025)p
Fm(\(\))11 b Fj(:)g(g)j Fm(\()p Fj(\025)p Fm(\(\))d Fj(:)f(c)j
Fm(\()p Fh(Add)o Fm(\(\))p Fj(;)6 b(n)735 1336 y Fe(0)747
1352 y Fm(\(\)\)\)\))12 b Fj(x)h(n)-76 1446 y Fn(8.2)41
b(What)13 b(next?)-76 1511 y Fm(W)m(e)d(ha)o(v)o(e)g(implemen)o(ted)i
(the)d(algorithm)j(describ)q(ed)f(here,)f(but)g(cur-)-76
1553 y(ren)o(tly)k(only)f(in)g(the)g(form)f(of)g(a)g(to)q(olb)q(o)o(x)i
(of)f(op)q(erations)h(whic)o(h)f(are)-76 1594 y(applied)21
b(to)d(function)h(de\014nitions.)35 b(A)18 b(next)g(step)h(w)o(ould)g
(b)q(e)f(to)-76 1636 y(com)o(bine)g(them)f(in)g(a)f(single)j(op)q
(eration)f(whic)o(h)f(tak)o(es)g(a)g(Hask)o(ell)-76 1678
y(mo)q(dule,)d(sa)o(y)m(,)f(and)h(rewrites)f(man)o(y)h(of)f(the)g
(de\014nitions)j(in)e Fl(build)p Fm(-)-76 1719 y Fl(cata)e
Fm(form.)20 b(Doing)15 b(this)g(w)o(ould)g(pro)o(vide)g(more)f
(realistic)i(exp)q(eri-)-76 1761 y(ence)e(with)f(our)g(heuristics)j
(than)d(at)g(presen)o(t.)-20 1802 y(One)e(notable)g(shortcoming)i(of)d
(our)g(presen)o(tation)i(is)f(the)g(infor-)-76 1844 y(mal)j(use)g(of)g
(t)o(yp)q(es,)f(ev)o(en)h(though)h(these)f(are)g(critical)h(to)f
(deciding)-76 1885 y(whic)o(h)f(form)e(of)h Fl(build)e
Fm(or)i Fl(cata)e Fm(to)i(use.)k(There)c(w)o(ould)h(b)q(e)f(signi\014-)
-76 1927 y(can)o(t)e(b)q(ene\014t)h(in)g(exploring)h(our)e(algorithm)i
(more)e(formally)i(within)-76 1968 y(an)h(extended)i(2nd-Order)e(p)q
(olymorphi)q(c)i(lam)o(b)q(da)g(calculus.)-76 2065 y
Fn(9)41 b(Ackno)o(wledgments)-76 2143 y Fm(The)14 b(authors)h(wish)f
(to)g(ac)o(kno)o(wledge)i(Leo)e(F)m(egaras)g(for)f(a)h(careful)-76
2185 y(reading)19 b(of)e(an)g(earlier)i(draft.)29 b(The)18
b(researc)o(h)f(rep)q(orted)h(in)g(this)-76 2226 y(pap)q(er)13
b(w)o(as)f(supp)q(orted)i(b)o(y)f(the)f(USAF)g(Air)h(Materiel)h
(Command,)-76 2268 y(con)o(tract)g(#)e(F19628-93-C-0069.)-76
2364 y Fn(References)-76 2443 y Fm([DB76])81 b(J.Darlington)22
b(and)f(R.Burstall,)j Fk(A)19 b(System)g(which)121 2484
y(A)o(utomatic)n(al)r(ly)d(Impr)n(oves)i(Pr)n(o)n(gr)n(ams)p
Fm(.)g(Acta)g(Infor-)121 2526 y(matica,)13 b(6\(1\),)g(pp)h(41-60,)f
(1976.)-76 2593 y([FW89])73 b(A.F)m(erguson)13 b(and)h(P)m(.W)m(adler,)
g Fk(When)f(wil)r(l)g(defor)n(esta-)121 2635 y(tion)18
b(stop?)p Fm(.)f(Pro)q(c.)i(Glasgo)o(w)h(w)o(orkshop)g(on)f(F)m(unc-)
121 2676 y(tional)c(Programming,)g(Rothesa)o(y)m(,)f(Scotland,)h(Dept.)
121 2718 y(of)e(CS,)f(Glasgo)o(w,)i(1989.)1020 -34 y([GLPJ93])37
b(A.Gill,)23 b(J.Launc)o(h)o(bury)m(,)g(and)e(S.P)o(eyton)g(Jones,)h
Fk(A)1217 7 y(Short-cut)16 b(to)i(Defor)n(estation)o
Fm(.)d(Pro)q(c.)j(A)o(CM)g(FPCA)1217 49 y(93,)13 b(Cop)q(enhagen,)h
(1993.)1020 120 y([KL95])83 b(D.King)13 b(and)g(J.Launc)o(h)o(bury)m(,)
g Fk(Structuring)e(DFS)h(A)o(l-)1217 162 y(gorithms)g(in)i(Haskel)r(l)p
Fm(.)c(Pro)q(c.)j(A)o(CM)g(POPL)g(95,)g(San)1217 203
y(F)m(rancisco,)h(1995.)1020 275 y([Mal89])73 b(G.Malcolm.)24
b Fk(Homomorphisms)c(and)h(Pr)n(omotabil-)1217 316 y(ity)p
Fm(.)d(In)i Fk(Mathematics)d(of)i(Pr)n(o)n(gr)n(am)h(Construction)p
Fm(,)1217 358 y(pp)13 b(335{347.)h(Springer-V)m(erlag,)h(June)e(1989.)
1020 429 y([MFR91])49 b(E.Meijer,)21 b(M.F)m(okkinga,)i(and)d(R.P)o
(aterson,)i Fk(F)m(unc-)1217 470 y(tional)12 b(Pr)n(o)n(gr)n(amming)i
(with)g(Bananas,)d(L)n(enses,)i(En-)1217 512 y(velop)n(es)8
b(and)h(Barb)n(e)n(d)g(Wir)n(e)p Fm(.)g(Pro)q(c.)h(FPCA)e(91,)i(LNCS)
1217 553 y(523,)j(S-V)g(1991.)1020 625 y([MH95])73 b(E.Meijer)13
b(and)h(G.Hutton,)e Fk(Bananas)f(in)i(Sp)n(ac)n(e:)j(Ex-)1217
666 y(tending)10 b(Squiggol)f(to)j(F)m(unction-Sp)n(a)o(c)n(e)d(T)m(yp)
n(es)p Fm(.)h(Pro)q(c.)1217 708 y(FPCA)i(95,)1020 779
y([PJL91])67 b(S.P)o(eyton)10 b(Jones)h(and)f(J.Launc)o(h)o(bury)m(,)h
Fk(Unb)n(oxe)n(d)e(V)m(al-)1217 821 y(ues)h(as)g(First)g(Class)h
(Citizens)e(in)h(a)h(Non-strict)d(F)m(unc-)1217 862 y(tional)j(L)n
(anguage)p Fm(,)f(Pro)q(c.)i(FPCA)g(91,)g(LNCS)h(523,)f(S-)1217
904 y(V)g(1991.)1020 975 y([SF93])91 b(T.Sheard)11 b(and)g(L.F)m
(egaras,)f Fk(A)h(F)m(old)f(for)h(A)o(l)r(l)f(Se)n(asons)p
Fm(.)1217 1017 y(Pro)q(c.)j(A)o(CM)f(FPCA)h(93,)g(Cop)q(enhagen,)h
(1993.)1020 1088 y([SF93])91 b(T.)15 b(Sheard,)i(L.)e(F)m(egaras)h(and)
g(T.)f(Zhou,)i Fk(Impr)n(oving)1217 1130 y(Pr)n(o)n(gr)n(ams)11
b(Which)f(Induct)g(Over)h(Multiple)f(Inductive)1217 1171
y(Structur)n(es)p Fm(.)k(A)o(CM)j(SIGPLAN)g(w)o(orkshop)h(on)f(P)o(ar-)
1217 1213 y(tial)g(Ev)n(aluation)h(and)e(Seman)o(tic's)h(Based)g
(Program)1217 1254 y(Manipulatio)q(n,)d(PEPM'94.)c(Orlando)j(Florida.)f
(June)1217 1296 y(1994.)1020 1367 y([T)m(ur86])76 b(V.T)m(urc)o(hin,)28
b Fk(The)c(Conc)n(ept)e(of)i(a)g(Sup)n(er)n(c)n(ompiler)p
Fm(.)1217 1409 y(A)o(CM)12 b(TOPLAS,)h Fc(8)p Fm(,)f(3,)h(pp)g
(292-325,)h(1986.)1020 1480 y([W)m(ad84])61 b(P)m(.W)m(adler,)24
b Fk(Listlessness)18 b(is)j(b)n(etter)f(than)g(laziness:)1217
1522 y(lazy)10 b(evaluation)d(and)j(garb)n(age)f(c)n(ol)r(le)n(ction)f
(at)j(c)n(ompile)1217 1563 y(time)p Fm(.)h(Pro)q(c.)h(A)o(CM)f(L&FP)m
(,)h(Austin,)g(1984.)1020 1634 y([W)m(ad90])61 b(P)m(.W)m(adler,)31
b Fk(Defor)n(estation:)40 b(T)m(r)n(ansforming)26 b(Pr)n(o-)1217
1676 y(gr)n(ams)14 b(to)g(Eliminate)f(T)m(r)n(e)n(es)p
Fm(.)h(TCS)g(73,)g(pp)h(231-284,)1217 1717 y(North)e(Holland)i(1990.)p
eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
