%!PS-Adobe-2.0
%%Creator: dvips(k) 5.86 Copyright 1999 Radical Eye Software
%%Title: meta-haskell.dvi
%%CreationDate: Fri Sep 27 13:31:28 2002
%%Pages: 16
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Helvetica-Bold Helvetica Times-Bold Times-Roman
%%+ Times-Italic CMTT9 CMSY10 CMTT8 Symbol CMR10 CMMI10 CMITT10
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: "C:\Program Files\MiKTeX\miktex\bin\dvips.exe" -t
%+ letter meta-haskell -P cmz
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 2002.09.27:1331
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "1 July 1998",
%   filename = "8r.enc",
%   email = "tex-fonts@@tug.org",
%   docstring = "Encoding for TrueType or Type 1 fonts
%                to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both 
% ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def

%%EndProcSet
%%BeginProcSet: texps.pro
%!
TeXDict begin/rf{findfont dup length 1 add dict begin{1 index/FID ne 2
index/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type/integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics/Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont/setfont cvx]cvx def}def/ObliqueSlant{
dup sin S cos div neg}B/SlantFont{4 index mul add}def/ExtendFont{3 -1
roll mul exch}def/ReEncodeFont{CharStrings rcheck{/Encoding false def
dup[exch{dup CharStrings exch known not{pop/.notdef/Encoding true def}
if}forall Encoding{]exch pop}{cleartomark}ifelse}if/Encoding exch def}
def end

%%EndProcSet
%%BeginProcSet: special.pro
%!
TeXDict begin/SDict 200 dict N SDict begin/@SpecialDefaults{/hs 612 N
/vs 792 N/ho 0 N/vo 0 N/hsc 1 N/vsc 1 N/ang 0 N/CLIP 0 N/rwiSeen false N
/rhiSeen false N/letter{}N/note{}N/a4{}N/legal{}N}B/@scaleunit 100 N
/@hscale{@scaleunit div/hsc X}B/@vscale{@scaleunit div/vsc X}B/@hsize{
/hs X/CLIP 1 N}B/@vsize{/vs X/CLIP 1 N}B/@clip{/CLIP 2 N}B/@hoffset{/ho
X}B/@voffset{/vo X}B/@angle{/ang X}B/@rwi{10 div/rwi X/rwiSeen true N}B
/@rhi{10 div/rhi X/rhiSeen true N}B/@llx{/llx X}B/@lly{/lly X}B/@urx{
/urx X}B/@ury{/ury X}B/magscale true def end/@MacSetUp{userdict/md known
{userdict/md get type/dicttype eq{userdict begin md length 10 add md
maxlength ge{/md md dup length 20 add dict copy def}if end md begin
/letter{}N/note{}N/legal{}N/od{txpose 1 0 mtx defaultmatrix dtransform S
atan/pa X newpath clippath mark{transform{itransform moveto}}{transform{
itransform lineto}}{6 -2 roll transform 6 -2 roll transform 6 -2 roll
transform{itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll
curveto}}{{closepath}}pathforall newpath counttomark array astore/gc xdf
pop ct 39 0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}
if}N/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1
-1 scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3
get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip
yflip not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub
neg 0 TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{
noflips{TR pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop
90 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get
neg sub neg TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr
1 get neg sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr
2 get ppr 0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4
-1 roll add 2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S
TR}if}N/cp{pop pop showpage pm restore}N end}if}if}N/normalscale{
Resolution 72 div VResolution 72 div neg scale magscale{DVImag dup scale
}if 0 setgray}N/psfts{S 65781.76 div N}N/startTexFig{/psf$SavedState
save N userdict maxlength dict begin/magscale true def normalscale
currentpoint TR/psf$ury psfts/psf$urx psfts/psf$lly psfts/psf$llx psfts
/psf$y psfts/psf$x psfts currentpoint/psf$cy X/psf$cx X/psf$sx psf$x
psf$urx psf$llx sub div N/psf$sy psf$y psf$ury psf$lly sub div N psf$sx
psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub
TR/showpage{}N/erasepage{}N/copypage{}N/p 3 def @MacSetUp}N/doclip{
psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2
roll moveto 6 -1 roll S lineto S lineto S lineto closepath clip newpath
moveto}N/endTexFig{end psf$SavedState restore}N/@beginspecial{SDict
begin/SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count/ocount X/dcount countdictstack N}N/@setspecial{
CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto
closepath clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx
sub div rhiSeen{rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR
}{rhiSeen{rhi ury lly sub div dup scale llx neg lly neg TR}if}ifelse
CLIP 2 eq{newpath llx lly moveto urx lly lineto urx ury lineto llx ury
lineto closepath clip}if/showpage{}N/erasepage{}N/copypage{}N newpath}N
/@endspecial{count ocount sub{pop}repeat countdictstack dcount sub{end}
repeat grestore SpecialSave restore end}N/@defspecial{SDict begin}N
/@fedspecial{end}B/li{lineto}B/rl{rlineto}B/rc{rcurveto}B/np{/SaveX
currentpoint/SaveY X N 1 setlinecap newpath}N/st{stroke SaveX SaveY
moveto}N/fil{fill SaveX SaveY moveto}N/ellipse{/endangle X/startangle X
/yrad X/xrad X/savematrix matrix currentmatrix N TR xrad yrad scale 0 0
1 startangle endangle arc savematrix setmatrix}N end

%%EndProcSet
%%BeginFont: CMITT10
%!PS-AdobeFont-1.1: CMITT10 1.0
%%CreationDate: 1991 Aug 18 17:48:50

% Copyright (C) 1997 American Mathematical Society.  All Rights Reserved.

11 dict begin
/FontInfo 7 dict dup begin
/version (1.0) readonly def
/Notice (Copyright (C) 1997 American Mathematical Society. All Rights Reserved) readonly def
/FullName (CMITT10) readonly def
/FamilyName (Computer Modern) readonly def
/Weight (Medium) readonly def
/ItalicAngle -14.04 def
/isFixedPitch true def
end readonly def
/FontName /CMITT10 def
/PaintType 0 def
/FontType 1 def
/FontMatrix [0.001 0 0 0.001 0 0] readonly def
/Encoding 256 array
0 1 255 {1 index exch /.notdef put} for
dup 81 /Q put
readonly def
/FontBBox{11 -233 669 696}readonly def
/UniqueXX 5000779 def
currentdict end
currentfile eexec
9b9c1569015f2c1d2bf560f4c0d52257bacee583a5c939393e012707b47e0c1f
a47d284a1edc9d01a497d772bca8c543388e6dc0d1e2c4944740470e0914f65e
fb0737b0851b2ba713a9a00b36d07da6bcb52920b9b59efe587734027a3c5e65
66aad332fe6fbcced1417802822a3b81d6187875263d6bbda04bbcf6e4870fee
ad60f104bb3c5a766610dd11aea64a6b107b0b04439fa2888b8cc39232bb83f7
695aba81f0260cd5248b9e649cdbafa8977dcfa841fdff9afd3a7a7c7905c219
28506d4d50a72fd1db1b54a855775831bec099a567f3f795b812ed5e145213c6
d5d27f9ec6709245e9e4068a6606742aef616dfcfc9e0b9af7e687fdcda43c51
81a08d6ab72b86fb38756fec992191c1b3fd151c417125d4777f0bd0c57d2959
0db35f1e9e27945498a3f7dd60bc54d72bc8a573457c16796914029dc282aaea
fdaa4b1439f4125add4b7399be6fc68e4d5a766cbe5ddd161180d4e1ee3c95d8
64e79fd0c65b8f459336e99827454d662768df3e6c1c3647b00b70b5f96a3944
b7a197be0f58a1e995a77221bd374a40159d81c7196c94e8af7c3392255ee6dd
0663e05998ff917a62d635ca45e952252342507d6b4d28833c7809c1b88400ea
50c652efc339a66355c8017651fd24d9a5cc51ecb55bbe64ea523b094332c832
52f7b426909808ae113c1e5601b0e081fa8e7777ab93b42207100f43abbb9ce4
ebbf51e584299a06fbea62b8ad3632ff0f281ebf9503ba6b8ae4f3b57f650388
df63eea9e1ef1e08f7a2c6e4f5cae2c4dc7b42726a6ea6b7592e9355a01fe517
12264a713ba83c057cb5f663045791d4c7598b246cd3b8466a1130249568e95d
ee2c0b4abfabc8e362b78d9fdc025fc19cdf1887997d32fd1487cf2bf0ccc966
319e3e3cf4add90ab51f0c3e918a00e5726ee346ae410ec3ce90404580c47572
35b3ec4f5ddf23dd43224d90d8dc932ec7f0acfbbcdaf80f261482ea4a2a2644
129c27fb4b44ba8c78d23273122cbf1ca49ae879ddeb6991b87ce2ff25c655e6
b5ad950028de17f6628f9eec6842b79f69c84b6c55ae423714e622eb4e47f9fb
c30a71808d70b89cc1a9b60f0ef21ad074a63d38344446947fcae80d22c6bf9e
efecac8e558ed73566db2222c7b32071a1fc47e0f64d440eff06a79bfa137c70
eb57b259eab9f76e66f8dbae78bf6d6f8be89eaa4d49aba154b87aded8312c62
83d2739ab22fc18ef2e281e07b7e40683af3541b7f35b2c447f9d7aa8703d2da
20900507ae57f983ce5400ae146a456d2261742fe441f8b46b144c871139a395
da10f609d73a09dd828c733aeb9aaabc5873938800cf99128db314ba4a648bea
f4d97a2202540dd632c0cc6c4ccc5960f3888afdc7563b895a7757da2ded00cf
48b52ce8985157d8f6957ec9987ec7ae0a8933cd43374bddefb60958b393c206
f8d1c4047b449e22b5120e2910fd0c2aedbeb671dd29b9195f163b21cca4cfa1
8e3f19a917a5516aab477503a626533a695fd6ab11e32603a62faa56fa59c6e3
3de011c6e8b98132f3fc3b6800c39cb19296e56c8381dee1f28a6537d5afe330
a8ed313468e1f6bc7dd7b2
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
cleartomark

%%EndFont 
%%BeginFont: CMR10
%!PS-AdobeFont-1.1: CMR10 1.00B
%%CreationDate: 1992 Feb 19 19:54:52

% Copyright (C) 1997 American Mathematical Society.  All Rights Reserved.

11 dict begin
/FontInfo 7 dict dup begin
/version (1.00B) readonly def
/Notice (Copyright (C) 1997 American Mathematical Society. All Rights Reserved) readonly def
/FullName (CMR10) readonly def
/FamilyName (Computer Modern) readonly def
/Weight (Medium) readonly def
/ItalicAngle 0 def
/isFixedPitch false def
end readonly def
/FontName /CMR10 def
/PaintType 0 def
/FontType 1 def
/FontMatrix [0.001 0 0 0.001 0 0] readonly def
/Encoding 256 array
0 1 255 {1 index exch /.notdef put} for
dup 40 /parenleft put
dup 41 /parenright put
dup 43 /plus put
dup 61 /equal put
dup 91 /bracketleft put
dup 93 /bracketright put
readonly def
/FontBBox{-251 -250 1009 969}readonly def
/UniqueXX 5000793 def
currentdict end
currentfile eexec
8053514d28ec28da1630165fab262882d3fca78881823c5537fe6c3dda8ee5b8
97e17cb027f5c73fdbb56b0a7c25fc3512b55fe8f3acfbffcc7f4a382d8299cc
8fd37d3cea49dabdca92847af0560b404ef71134b0f3d99934fc9d0b4e602011
b9cfb856c23f958f3c5a2fbe0ef8587d1f5774879c324e51fcb22888b74f2415
50d7401eb990d4f3a7af635198422283cac1b6cd446ddbcbd915db9bff88844e
784c6bf7389803d9450b0c21756a017306457c7e62c1d269f306bd3402e266de
fc3b5e7d8a8d2f5bf0fe6ddd40d07391df4fad4a6018dce29a2b8f692b29f202
3a7c0e66de8ed85c14f1f8492167357f51a7e84cc5d92e0fee4d81cf7fbc8de5
2d2e7bb57142033993f9c08c315abade8dbc4a732e84e142d3bee51557910e12
cd8aa37c459a5e6b7f5269f59078aba3be4641a11ac48d0b625c8325b38ec08e
4c9e5e7fed976a5650d99d82114f449b9ca14c4ec957702295a39a93ef93f618
99b8ea06b092c3c1e503e6e436e0a9fa22576c8930ab3dc8c20f5d82b69cddf8
ff4dacfa9c54bed5a3aa3ea5b129fe96be632843b9b6bc91b615581a985db56b
1e01ca60ee69ca92cf5c0882ece62edad3e106d835348822400f0b66af658f2a
e56ed08f8b0010571807009b73ab12a8cf14ca6c71f03c2a48c500f9d62266af
154a6375ff600d9bac3f05ce34142d6867a79581c533176bb2f3117336671e2e
44638a97167e2ea9644e31ea16c2ad2990ea33c54001e0c8156e6de8ab6a4d40
a7137ba275f39589fea2e2db8256adc103d6f9cc038037a47e8fd469c5f98a5e
3c15bd4ace40d340018b1cff7d1ed8abb0ac57b5b5a2c20a51957b96c453edb7
dae5affd91a46d938fe0a13363001d844ded4323f1ee6d30012aea19b024a552
315505535c85dc26bad31e09c50e6512802976d298c4e90d0044c362e6bf3ab3
62a454ee93de25ce54411090c29e9d75c80ce26a84404bd9de3aee0e3f921ac5
87f907572b8354a5c3165eea7e8b2ba4e4f834663063e9a307d8ff6f8b61acd8
799bc105cddcf8f95f2160494fc01f7ec3effb95de571b8d7f27a2f9ad203c09
cd4cffd98a119a507460e7fef5c910405e877aa1f8da68d1272e59e3adccef8d
82e692b3229926fbe621080b7831a2ee248948dd3ae55082a939f02875a7a0eb
7ae7d50270a576fbdfde7109c670f51be75b80b6fe3045ea50e2121021e62adf
47101df97d95a5a98efbf72e0a8772e90ee5ae28f88d9a1875c5c5203e3a3887
6df75ef7e65b98d215ad7084756b5f9e3768a329d0fb8c16dfa2bee83072549f
b9a3ac5854a3ed9e0ccc35aa8da23d88b893ef9c777e8e0bf28eb6aac5dfdda1
35cb1519d7dd0d7d75235a4f38527400355e1accf05ecf8b80913f368b3edff6
5780be402670efad2ddbce83807f546965184b38e118bbfb363b6ecc5d09a687
938259ca0324c3ff53acbffa20c7c60eb2ea03f660a0cd67556d03dd6ead467a
40525fc22f3afbf7594ff34117b008590b4da385739f8839212c9f87184739e7
54a663c0b0b5e4a763e2278f5f60692cb9c96967af48a195ad9137f196b85966
688268e647e192a7ebadac7f170e8096e31b8e55da0e77a6146164f5a9056b9c
8799cd5a9c16bb5fca6793c5c082421bc2d27eddc260e766458866bfd538d169
b32b85ebe300ad36100995cd379af49efede570cb3bb7431869eca6bbc352ee6
22e3053946a256d54123201a11ee52efbb8bad115a52a520b1787187d2d9d279
9e7437e11c1069162ed9d38080e58332b84cbc497362541413f482de123a575b
60b1c4b98bac5860d0c0d01d20f638bf1fd9530fe862be0233fbe34dd926aff7
6c64d1666b4dae6564dd7cc2a3193c26a102207ab011788193fbbdc72ab661b5
a0c62d59fef021fa2a83c8a6853d24786c50c6ecceef5faf19be33a4b0ebf12d
56de0803fb6af6319ac559901b70918f1f605643558b513e63beef42586f34a3
92e31169e636a8b8ecd1b47527aee083ff27dd538bf8c25a0689dc13d48be24b
e38751bc54e507efcb7b6e6d1aa4c3a5cf535a4263004ece158332e565b09e86
d125747b99bed87b34eaccd173e0f0f6a56371bc17d9694f03b5988109fa3a80
50a4872c9079b2b23d6e9723bc5d4b646133dd699790cea95428e065a29c77b7
47dde2b8d34bb3fe2c4df6368f13b80f75b79152dc81b73f9989cbaf1bd677cd
dd2d22c6cc941f835b0f82fa0ae737be83385c4d974e2328f93a8dfab1a48efc
b07304f608c338ae6bed7b78fefaf8c790ce0d1c74d3cfad7aa29bb02f537c97
e0a57a086ad379198092d05092462a47332f337b
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
cleartomark

%%EndFont 
%%BeginFont: CMSY10
%!PS-AdobeFont-1.1: CMSY10 1.0
%%CreationDate: 1991 Aug 15 07:20:57

% Copyright (C) 1997 American Mathematical Society.  All Rights Reserved.

11 dict begin
/FontInfo 7 dict dup begin
/version (1.0) readonly def
/Notice (Copyright (C) 1997 American Mathematical Society. All Rights Reserved) readonly def
/FullName (CMSY10) readonly def
/FamilyName (Computer Modern) readonly def
/Weight (Medium) readonly def
/ItalicAngle -14.035 def
/isFixedPitch false def
end readonly def
/FontName /CMSY10 def
/PaintType 0 def
/FontType 1 def
/FontMatrix [0.001 0 0 0.001 0 0] readonly def
/Encoding 256 array
0 1 255 {1 index exch /.notdef put} for
dup 0 /minus put
dup 15 /bullet put
dup 18 /reflexsubset put
dup 21 /greaterequal put
dup 33 /arrowright put
dup 48 /prime put
dup 50 /element put
dup 55 /mapsto put
dup 96 /turnstileleft put
dup 102 /braceleft put
dup 103 /braceright put
dup 110 /backslash put
readonly def
/FontBBox{-29 -960 1116 775}readonly def
/UniqueXX 5000820 def
currentdict end
currentfile eexec
9b9c1569015f2c1d2bf560f4c0d52257bac8ced9b09a275ab231194ecf829352
05826f4e975dcecec72b2cf3a18899ccde1fd935d09d813b096cc6b83cdf4f23
b9a60db41f9976ac333263c908dcefcdbd4c8402ed00a36e7487634d089fd45a
f4a38a56a4412c3b0baffaeb717bf0de9ffb7a8460bf475a6718b0c73c571145
d026957276530530a2fbefc6c8f67052788e6703bb5ee49533870bca1f113ad8
3750d597b842d8d96c423ba1273ddd32f3a54a912a443fcd44f7c3a6fe3956b0
aa1e784aaec6fce08dae0c76da9d0a3eba57b98a6233d9e9f0c3f00fcc6b2c6a
9ba23af389e6dfff4efec3de05d6276c6be417703ce508377f25960ef4ed83b4
9b01b873f3a639ce00f356229b6477a081933fef3bb80e2b9dffa7f75567b1fa
4d739b772f8d674e567534c6c5bbf1cf615372be20b18472f7aa58be8c216dbd
df81cc0a86b6d8318ca68fe22c8af13b54d7576fe4ca5a7af9005ea5cc4edb79
c0ab668e4fec4b7f5a9eb5f0e4c088cd818ecc4feb4b40ec8bd2981bf2336074
b64c4302813551ec0153be72f1f9695b56a658dabe99f86661b49303d6565988
88bfe2c6ad3f28b68ea9b83725ea102a0b9393a25f33efc29df1996ac4dd61f5
f873f5babe16171ad53ce606645dd09e9afb6d3941bdc0cd7ebb88f0200c9064
f8a465c129d98ddd520c19393977300cae61793a145fd306e872b41ddf30a194
54bd87b3fcb0e9c81376a6926909c3dccc64ac983d542cac34b9a5138a785086
4172dfa14315ba381312d11d71173b89d7a23816471fd4441e043963e033168d
ce68fe06683901d17e37c6ff718b88f96d604d947120df32b14acbd8cbba94d5
68e380aeb9e444796dcc08f88c4384c4f59905b1e7a06d0d8630c2c122420644
a07019239d4ad42f93843bb7466d64afcedf826ca9cb1891ab7560e251cd55f1
0910758d1f1dc2ff5254070a6a57eabd0c55ad918fb0e103fa526486d2715535
8173119a6e0ae25d102333c65178fccade361cfb441d3fe57c79b110a0725181
69d729010f5ddb2a98678d87ec9541ec739f068f487b56bedd02861e2376374e
8a8f60fb7dd5063f326edf8e0ac1a710cad9d2e5b44aabcb037136e8b492b355
87c22a0bd2b0e8e9b02795f3514270165512b6e56820f6fd83a2164685fdcf3b
04f4b28175662d3b4c7c03ca2d8775fd1285ece7aa458d7e7b7dc45356188923
52ec2f94a5a029abdfb90924a7bfaa9c59ca618f2090c21a4792a4a4ccb56d06
dd6aac37bcfbee65c75f00961d1f7db79de1ed3d384e8b0275c00bf86e79952f
f3e7a6c2d4a301761fe0d0f337d39dc36574974e1db85bf1c954ab169682b3ef
975a47059c69dd0d3c46e3d34caaea77000dbf24fedfbb279e6e23b53e7b5695
a13025eda1f06c34d2ea02fdbb9d17fa6e0fe71426c4db59094daa510e26c8f4
71bcfdf0cb7bfd251b77f0ecff973d3c46bee940e76f5604284e3aac83d2af6f
9d42913f74950807ab394e93fecb0f5d565b6063cca95504b9d1a4dbdef50582
a7ce5fa5adadaa237a63dbf2b03cb594d25442ee1faa9a13faed378f0ae83f66
6a0541241523c461cdfd61b177ed5cc0030358deea4b71cc949c26e555c375e7
de7e75519a3fa458a23de3e78fc3b48d8b8bec1051fdc72a5f61cc7661eac217
08ba28be00321a8acdc2b614a666f3d7765eb9c35067362affda4f538ced3483
41dcd368777c2a4fab595a5a8fc8acef18b8e0232afbfa9c10da3ba16e4e5304
99bce12408ccc423dfe964f31f6a3e23360d92333b9d570d1d1c56e71145815e
13ec72f312eb2d5561dcc94d32c016a884de26c3af660dd83bc9e06e9d0bdaf7
3b7f8d6d0e098a9957f8448ad9ff05e5d0705128543295227268f87e87baed46
4131c8277fc40561de78f6b1b7e2c62566f4c2f381bfafe2a7bcda8160d0a189
80678a13caf045cf09c6482777ebfd119a1c517ffb577c83ce62238cb9040fed
4321a8e095fc20860279580ac9b9d28798b6769915d4b1fcf25f2f3ce1d46408
03c0da45e20ba963db21c4e7869d10ba2a0c1474a2d1c41904d435f5cb716495
20570f4251241d49b809dfe33d620ce08e64238dc0745b38870bf5468492ffe3
5fe5bacb8fdcadebb0a58ce66e3cba715350ac01cff79afc995f6627c31dc984
886550b70b72d6e637620abcda8fb153c9083bd5f15bbc932d3f5b6ca66e0aa1
d11c90a95c2d90c0d862090d5493a28a21166f043d230cde95582f98b9634878
82e28fc144f8d105e22633d5ad0e7e24a708a394a60bf4a0416a9c0dcd8a67e1
11e0dab8023c1393151a81b480d684d3822023e2458681ce0e5ceda0a5520d2a
3fa91b4eb812077fc512f8b4852363aa3349bf981e803eeb14faabaa641824e1
b1372f1178c10e651f4e4c99d5f2256c01b4e5a1ea29944205b1cf07c527a924
15358d4a6d46167243082e8caa57b1e92b4985bc11fed7738b471a80cd5eed7f
77b7fa24cd68f9df552ccad8ca130c09808655808695e7872f758fafafb7c333
f0b2aead3767c54037970c297e8e63a646fd98f601de6182e3407857398e137f
b6e7fda5565774a2420c18aa842d030d1813624ffd1141c5b8ef6083f6245e3f
9f72436cebe8a6d2a19a6b848977382370fb90a8cf99c05342440e4d7a3aeda5
88582103441e7a3872b43d9faffd316f10525953d2f09de1bf510cfd79c68b0d
2cca456b5d84a49045f938dc19a696b543b326e012040ec440f8d6af364d6f41
7f45b84eae67ad5d8735ebcf637018fd0aa9d2e2416355c20935652d
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
cleartomark

%%EndFont 
%%BeginFont: CMMI10
%!PS-AdobeFont-1.1: CMMI10 1.100
%%CreationDate: 1996 Jul 23 07:53:57

% Copyright (C) 1997 American Mathematical Society.  All Rights Reserved.

11 dict begin
/FontInfo 7 dict dup begin
/version (1.100) readonly def
/Notice (Copyright (C) 1997 American Mathematical Society. All Rights Reserved) readonly def
/FullName (CMMI10) readonly def
/FamilyName (Computer Modern) readonly def
/Weight (Medium) readonly def
/ItalicAngle -14.04 def
/isFixedPitch false def
end readonly def
/FontName /CMMI10 def
/PaintType 0 def
/FontType 1 def
/FontMatrix [0.001 0 0 0.001 0 0] readonly def
/Encoding 256 array
0 1 255 {1 index exch /.notdef put} for
dup 58 /period put
dup 59 /comma put
readonly def
/FontBBox{-32 -250 1048 750}readonly def
/UniqueXX 5087385 def
currentdict end
currentfile eexec
80347982ab3942d930e069a70d0d48311d725e830d1c76fba12e12486e989c98
74c2b527f0925722787027f44470d484262c360cdfdddf3657533a57bb16f730
48bfbbfcb73a650484015441fdc837add94ac8fbd2022e3ec8f115d4b4bb7b7f
15388f22cc6198efe768bd9fceb3446ee4a8dc27d6cd152485384ef5f59381ff
da43f2d20c8fb08aa27ab2015b774db10dacfdcd33e60f178c461553146ab427
bdd7da12534ba078ad3d780414930da4f8d58abefd45db119b10eb409dd89792
3c6e705479464a4b310b58348c4b42393988fef4925cf984423aaf65fea9f0e6
4629953bcf50b919d968d99bd185f83112b2759cc411764e9bde677f57c5ee5a
c555448d5f81a16259ded1e11bf4119d53e8ab07a802df900d3a2d5ccc1c6876
d29c5e9effb7af3ef83400b0910c07873a8c56fa7b1eb1ba426043b00cc95dbe
dc6e136cbbbcb3f67509964f9f281ebf81fe5b018122eaf66c4a838487e82e18
6e006093042848a903efb3469ab6b4049767aadb95c30408dfd58d8a10f4cb22
168decd9f3ee100f07b49aa44c92139b669cc312ba20192454eb2375be6284b0
26659d964b96ae82d4942e758027fcf23c25ed01115af27ce7f20efe2a822bb6
84004f20243a49c9e93301fc21b80815c033c3e2ba58ef53da2157d524b395f2
b37abca13bc6a2f42e824ab7e47106176b0d6db267fbb795ac7425582df2e3dc
55863468a9200742bd7b552c48f8cf58bc21343bd3b95abfa140f33f37c6f3f7
8b0d8a5154eb7c1f62ec598267f13e841a3e64172663935ac8b665d86540d316
ddece329c008049c5e74b27d59022c5515059bc3b89370b1bc6a169c888bb325
e0b74282d6f053a50da4024ed1e433271a32ab8c17d41c632b41cf9f3ecd5fe1
24daf7aea7ce8a63047b245822930d517df7baaafa69d2d17f7d93cebd45416d
f3459365434123a76ccf883a4973bab19807e1f0c4bab03a45f7ed69ff2660ff
3963e4def11001eec4238c368a39d874fd30b3c14f4186ec7700fbce22abe468
eb32baf7b0164f8f21a9b5e706b91411faaa44467cb2180ab03de375c1ab93e9
76e11ab92fdd4a7280a6d1a8dc65c4c89d04c8ed6988045a2a3de9a4c7b1efd3
75b6d05a48a30c24d13b30ca0bd0790ff38c7bf80a49c406aece637ba3dab713
d2a0ab88194a6726ed116209a6dfbf8479f499cd1bb30f59da64f9d3b14d5882
5469b1dec824e3c4f27c483f1bf4eef3c1d0180d173ab28fd0933555658779e1
97ba0ea0169c74bd71010af89102d507b74e14ff251361f191b580f489ffd336
57a6a0b00e2b274ad76f9662a5638e33f5d2a95d18d05bff6364ec98c326c4af
3f34bcddee7c233881c062a3b7ce05941ab7eaa461d2522e0d1c4706ef0cf1f1
c00ed747723fbec6b808878588b6825ab76a84ede7b2a721fe5b32527ae277a3
1267a9eca5866e3f5e258bb1f6921af02bba34f43b295daae99dc276f1b651b7
295a2f533e48276b9a19b442584f3a7963a20a34e9c2606d67355ecb20fba303
663e98893fc494c4dd742c189118dff2ea0fcbbdab8aba98fd3655fb4b8b
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
cleartomark

%%EndFont 
%%BeginFont: CMTT8
%!PS-AdobeFont-1.1: CMTT8 1.0
%%CreationDate: 1991 Aug 20 16:46:05

% Copyright (C) 1997 American Mathematical Society.  All Rights Reserved.

11 dict begin
/FontInfo 7 dict dup begin
/version (1.0) readonly def
/Notice (Copyright (C) 1997 American Mathematical Society. All Rights Reserved) readonly def
/FullName (CMTT8) readonly def
/FamilyName (Computer Modern) readonly def
/Weight (Medium) readonly def
/ItalicAngle 0 def
/isFixedPitch true def
end readonly def
/FontName /CMTT8 def
/PaintType 0 def
/FontType 1 def
/FontMatrix [0.001 0 0 0.001 0 0] readonly def
/Encoding 256 array
0 1 255 {1 index exch /.notdef put} for
dup 34 /quotedbl put
dup 36 /dollar put
dup 37 /percent put
dup 39 /quoteright put
dup 40 /parenleft put
dup 41 /parenright put
dup 43 /plus put
dup 44 /comma put
dup 45 /hyphen put
dup 46 /period put
dup 48 /zero put
dup 49 /one put
dup 50 /two put
dup 51 /three put
dup 52 /four put
dup 53 /five put
dup 58 /colon put
dup 59 /semicolon put
dup 60 /less put
dup 61 /equal put
dup 62 /greater put
dup 64 /at put
dup 65 /A put
dup 66 /B put
dup 67 /C put
dup 68 /D put
dup 69 /E put
dup 70 /F put
dup 71 /G put
dup 72 /H put
dup 73 /I put
dup 76 /L put
dup 77 /M put
dup 78 /N put
dup 79 /O put
dup 80 /P put
dup 81 /Q put
dup 83 /S put
dup 84 /T put
dup 86 /V put
dup 87 /W put
dup 90 /Z put
dup 91 /bracketleft put
dup 92 /backslash put
dup 93 /bracketright put
dup 95 /underscore put
dup 97 /a put
dup 98 /b put
dup 99 /c put
dup 100 /d put
dup 101 /e put
dup 102 /f put
dup 103 /g put
dup 104 /h put
dup 105 /i put
dup 107 /k put
dup 108 /l put
dup 109 /m put
dup 110 /n put
dup 111 /o put
dup 112 /p put
dup 113 /q put
dup 114 /r put
dup 115 /s put
dup 116 /t put
dup 117 /u put
dup 118 /v put
dup 119 /w put
dup 120 /x put
dup 121 /y put
dup 122 /z put
dup 123 /braceleft put
dup 124 /bar put
dup 125 /braceright put
dup 126 /asciitilde put
readonly def
/FontBBox{-5 -232 545 699}readonly def
/UniqueXX 5000830 def
currentdict end
currentfile eexec
9b9c1569015f2c1d2bf560f4c0d52257bacdd6500abda5ed9835f6a016cfc8f0
0b6c052ed76a87856b50f4d80dfaeb508c97f8281f3f88b17e4d3b90c0f65ec3
79791aacdc162a66cbbc5be2f53aad8de72dd113b55a022fbfee658cb95f5bb3
2ba0357b5e050fddf264a07470bef1c52119b6fbd5c77ebed964ac5a2bbec9d8
b3e48ae5bb003a63d545774b922b9d5ff6b0066ece43645a131879b032137d6d
823385fe55f3402d557fd3b4486be533de8dbe3ccd493ef4c9656d5d5b76d531
9e704539dd76b065f45e6d6f62ec499c9ab91923a364237ef75e1d62d52df3a9
43713cbc63b16c1880feedd1633766248fed9d060ff709951f2ec84ecdc06bbd
9cc4a865e1f275455525e5ac7e2e6289615e98cf7ce3763b6914d3a4c5b75b29
b8043dbd898ccd5be448064cf1af2f80f969a44b4f9b801c42f6d6a6d0c3ff42
e0b1cff748c1fc49b598eadde0c2802dd591c54b802ffd24cb7a7639295713d5
4e639514ac78460672c9c51742ae2014e4137ba4303051c06f686395aaef86c9
9d7f9a97009436c2ff55b770de3e80cef0d53f4df46aacecc21632c0c676e2f5
ca7bb101a239a0ff67ebd37a6b8c4c8246dc2c90b759dc03fb26bde8f134f552
23ef3d6496aa0c4a2d7b6398de6e6a0474ee1b0d78b2d865614609f1db92fc56
4ab5921078b4944e11a2162902f0e04f4b29448aaa22b4ea92fac48f8dc47535
d717dc7acd08b25d391c97c6c540ae0a98be5d6a8da564ab73e8b5d3b5e1989d
6e25c3a35ea44d596b5fd6b2373b30de7d59c1831245edb76d6a67816ab91a80
a27a6597c6dfd274db8b3e45cb01aedee59ba6efa1428e41ed557f051012a389
9b195ea44a4e4d0067398d9d40ea26195efbffd2cf785540bbeb8964f6391361
904fa5e187e4af3baeb4e8cbe7558fb7049c94a1769a2ff0b44f679bf6f14d8a
974bb8bdc735d5a9798c89d7d81176ba98dc22dddf6766acd52020e3ddcbc94b
71ad8a336dbe9262f302d8e8d5ced4481b19a586e1d73d0138ab0b732226185e
8cfb8408890ecb590f032a5633352c42df62a7dd1a3cb4fb12083709edc26146
f31161bae67a54aa5b41ca7af61b515c100b38a01b77f831245a013f804584b7
bb764dab019978bf8ed8324c76847ef522a63183cb82ccbdab4c6239681b239b
5a69536c5b133fd554243b2d0771fbee46e6eb13998584c971abcc882a0ac6b8
7c6ec33fb2b1166197881805262a49cc7a3f2f707771421ac84030abdbb3e516
ec49f11288d7fd88ecb739f0dd9e878bab123d309afdc510d6c5f88c407814eb
cd152cf11c82fd147e30b81bbaf068f8a7a2d2fb185f64cb28ca41e83828b45b
30035dc390fae5b1be2dbc2afb9a900e84bf78bc62495b2c9e8d2ed6a711d855
fa85edd2cc6e8dd052c8b033427a84e754563540f02e55fd9190d389cb805c84
c7ca9ead2c4d4182d94877945f371786ca923d25887f02bff88bade5e587b568
3a8b315a9c9c6fdd129985e9d686aa271203516432c27fb6a8ae74bf5a57c110
6c7aaee457ca0749dbd20620aa3c4852484754081037bf60fc4a8c2546d22bd3
e7a0bb084d97c5f881f33edafbf80e5a3a444a8c5ad68744aaf5a42ac1e6f5e9
8ca000e679d61bd38a6c6c02ce9c415cbf3ee89e681c20e747b20556611c18f5
d0f8640402a964894e07afa0a5230220828934546c8385547cbe4463ede35bc4
c2833981bc0a538eaf2578ea6ec5ba649c46bfe80460923a056829e6488be999
46e61577d03ab6a82f7ab82a4d6505b0af9077ebc16b66b5b68c537fcff9db06
e259dfd4c834d54014d77dd2cfed6fec04e66ef054f8e4ae581cf415b0d6e8cd
be0553cc80e8a51eb73c7315bd99f627af774bd86ea2310c69c9a478e26620dd
f94dbfc016c3bd18955431c9f76ceab834471c115b27c314e2e5d821b2a1ce56
9ee0dd1804e93ccb6a67eeeb2fdd1ce0fe859d5ec1056cd9088d7be939bd9f2f
b90b066eeec5b69b97f566f3273c07cd5fa328b44c55661a15d7b3ace3cc38ea
af04ea2bbd8130ddaf170f8e0fd3f0fbc87b9be97f046f78b46584dcfbf22f8b
f1bea869c0ea81224f95ce8345742869b2b70924d91305f1925a4abe9d23e283
03e5f63a7113090cffab5529b2c7743394c48dc8dead2a465f8f0fc0399c56b0
6f3f6cec560bc577a4c0daaa6a54016e01373dfec2829fbd583ad12570c8e8f0
585a7e8e889657267372dcfe7c1ceb31a1d6469568c3071a42203a64edf85291
7c8370681a26d1257246acc92ff04e4cf56d3081ff6390d4f9f30f3b189033ca
7d35825f03b2e740d34e334fe29f7395e225d9ff5972ebe25be7c617dfee6076
13ba35c680455d544169b785586bfacd2479dc7a679fb62338503d2c732998b2
538be009ec65dc9b50bec5686e05783e75404bb5e36c2988e11def1ec6f3057d
e0f7045fc5f87863bce7560d427eded328266071296a67b19c4afd6e58733db3
cace629e4d596e253e9a642b855acaf23c0eaa47fb2349b03b9527be27378a04
1d25959704424119552d7c01e5cfd0a53cfecbd8c4b3dcaac743a7ddd29fd1ed
b8978b572f8f96bd3e22d9415672615807b71570ac3ea9b27af628370bf513d1
0ea2dd849c3236e9d4adb361a65d98503e8f480e449a9c5245d2df5ff287d390
3114b6fa2288a29fd3edd89afe6eea5088973c91181007f88635657e1ee99f67
edaa7045f851aa8fb6ad01c2317fcfbf68762ea1e6da9b700956427be8540add
461a0da7f41619c4137b5e9faff7c710103a650833bc68cd448484ceebf064e1
7b79aeeb637569e0969b8de797ba0ce673cb7e1f492969c32f8d819229b7a59a
365fc668406c5e86bf199521a2baed1f7c90ca9fc6b62ae241fec7e8ebaec45b
7c1616e2db9b503244993a0895388004655e8f2d05378a55edb9353b056d8562
dabd168665fc905e0561301f268fa06d2655c8354d9c7a5f9cc9ed3695654d7c
f3f4fc7d494974dbd23058cef2d3a6ac720f8e434fceba0bfa0a1c898283d815
ddce468e18d07bb1453a1330311bd7a6592e449b04b5cc022e6d4ed72cd362e1
8c891e4e236bf5b3d6bf9dce78011499f5a55a241fe93453a76b4eee94db2f90
c6f6dae052ff461a7bee2a4278807be8bd3fa8438d8f934a52f44307434a684c
39347ee67f35ff823ce82cda0805f127779038c7fe4ffac6a03b71cc403cefd9
d59f695043b1d4a1a4482f8b195350b25d2989d8fdf5dfd86defd17af26f3f86
987078dacbe91c6dd974d6355274d1c3a96886889fb90b88ae07bf28d1166d49
bd6bfa8a659b5884e342924601e7e57e14aabbe8f8c407233e7f9957ce5f48f8
bd25507ff3744cc4c82e23ac04cf19c4aab11fce9f47c4b0f7b1b2af8cf897b0
6cdb079b90a2a3de511b284a48e0fa7baaaecc37920c21af2563c33c6c39e91c
12131a0051d2f2a1132dbc5aac193cdea8bf545693eea8b705b1f467afdd3a01
c80c742cfba4546ba61a8acfcf5bcdf3811e5537da2e1411e38e61ce57476f8e
e394f40201e51cefccc8f2095cf70ee293f4da438eca8379a7703f2d8bb75b75
2bf8c7e3a124b8c9af2103f97c57d742d2dfae4a64ce134d17b3965966da85ce
ed9e236f50d9d9447795284beda9e54a611cd44144f9852e1466432673acdb07
f811f252dd5f6664e287195380feb2b00778f15f230ac1bf388711bda036b249
cf168e51b2849c8a2638fdf7f54d13f5d83d6eefbfa422ec07259d9ee2891f8c
a5598e98b21419304f6e4c666e70819beaea5e7379f809e249bf7e3fb3c20137
19201d48d15a3638c720b19c34df4130a63b2dde02c6f1da0958593102ebddff
60c23172bee3c42965d92cc659d5f61d90f589f37fbe2dc01605ad8230f1054d
bf49884387978f753b92009f9a385b5edb43dfa0690bc67c59e71d494d46a6f6
23633c649ede97cee537989a39ab1947993861aa34f3b52d0e50836c833f86d4
c9de411a53d62123ca30b5b25e0dd6b95d9f94037df96a0788546c8be57169ca
39f22f3ed055bc59010242a933bd29143ed7fa2d1e3610510213c626212eac66
74c684342b911fe2663d433d7c2632770f2fa95d1b0482c65b9caa85360a2e37
83a86540ed7b484d47764749b59a0bb20fb79e06d8754393bacb3b096bfda296
9317020df9b92eea80fb998f68a060285d2e1e9eb31efec425cef4dd6cd3b55e
5ab85735c16ed85dc34f71ff78bc4286097522c6b4d9b9e864942e9ecee528ca
b43b83f753989d1e6fec7cd4da378ad207d73895fb2a3ba62dd7b2af6bd05a91
877fa1b2f48bb4aa399861cfb650af20c15b55c87a206c3f0625205b5345e3dd
be4bc155cf34992668772f0bee34479446366aafa58f76e32062084589ba8756
407d249c50dd9745227caaf4f425a16b9719489bb0fd481ef34410d73fb8e57a
891967e34527317cf33725b20b017e3ac2a56448fe8dce6dfb7830efe4ee457a
85fffa09687a4c45aaf8c34579118a98e04e287a973dfb5a7981387a41cc1b8f
f3474c165840defc306f3899fd48217bf797788a59f64167b8d0b6a4475607da
6e012686ee83de1c8bf55928add54e335822929d02e9350eec24e90264c9339e
98a10e862889d14cd6cc4296305f16f46be05f762b00fdf9372e23f553edc080
7163f6afdc87bd4df812648e65cc1ae5769cf46a75cb420d053029cafb7b56b3
74ad0a171881ee3c71770075a0e2df6c158ef7c5391d8d90551cbd27eb7e1b02
ba06f28a85fd0e30e56049fb4a68d85be84cccf75d76fb900dc2d2f083e515a7
c2580961c338b76741fe39a1c4c3652d1de1ccf23e5eba926bb55a955c64df49
fa50d29b40eb2a9aff4c240134dd859ab3656bf80fccc99e6abf21ec0fa8c8eb
d1b6e9879659c979e1f15c693595f2a64b679f76e4e63aad795537a810f66fe6
ae86565f474ad346dc18d0ce6abbd7a73f91009bda19a34cdb0f55f156bcd4a2
38b859d45ca9ab15b690bbcd84165d73f9a709b923d358e2afbcf99fb3e95fab
1e79532bbbf37ef4eb9b42ae0c17ecac54e71c40b208e4be498f005ff17da2d9
f4ad522fe4500cdc97529ea4ea1ab94b6922d68afac70aa7ee478f2e7f7ba9de
6855c8a407ac47261bb5c1c03c9d3786c1fc9d1a306d9ca23cd61a5de3427b35
5008409e39b547fbcf9e10252cd08d31d1178e818bf3082547df1765370a7bf9
d2752c126edca8a951b3c23de3c5ce5e291fb883f9e207e66815c38988bf99ce
3b3eb4b567e139f5f0c3fbc0aadf9da48af4a50d6b3c1a38fcda62b09bcc465d
19e151770f617d3abf421b13f1cd4c08f8b6a35fe3eca9e1051757bd269a00b2
483ba1943c328bdfb9847b44557f9c0e7393679b95407c299dc8fc403937538f
a7798ce4c09fe26528351eebf0f472b82fb2deb4d1328836a174be455c7ecaaf
cffcf5cf2bc072c3b745d462bb4e0382465127dc0ece787b7e0683b60e6d9996
584a3fa4c8e4d3017d1d6bfa11899c7ba1dec5338e5a098dda0dbe3a837bb1c8
d0e343a03eb94d09365cc457a9416eb314249d59f0dd562a284964172fc9d206
9ced7ec583c6606be50c8a7440b2bc11578817aec824b6451f154b0fcba55665
460241edf343e7b022e7f1042bd77603b740b28bf51534e901e3aa4fd00487c0
77120effa26066ab7e5cbe839565990b5199f2ebbec92ce83d0d58be5e7b4652
1be345233b92c4072a07b034719201812274be3f7fd725bb9d6292403c5ff6a3
c41d761be3aeb22bec9be81f8560ffde369d23deba0103bbc8f7cd3d1b3b48b5
46eadb3d29caf2d8320604f0653840189a456ef1e220f73db56a2e87e43605ca
dc014dc5bbc561ae5b858a877eddc7bc7bf03bbfeceb0a94f87e2fc18d9a3d59
3e8e2b28c74d257d3dfa41ebe8a597a6c517a8330eb3350c65baad7f8185c8bb
ab4aa8de8e217a000034cff2139d94aedc55f132179c10f006260c2f3689db5c
d692137c9c5b810cbf0d1793b4148a2952dc68c35f96cd4f9cbf7ab87adf0e6f
d6f2ed51eee08575809455df65ff7d355ce7511d1045782445dbeb7d29c31e4e
27fadb458699611f5a9412bcdba6ea5857bf737517bcef0b255047b500dd0cc8
aa1acdc6281d05eb7e2299e840357abd6ab97f2e12d03c7f85396a3c26b64976
9678104c68de4175d6ff90f7ad70060da1ff649727a9eda248296881b316eed6
fc96ea71f2c7a9e735bf65c4c94cbf524bbf2870c5067072cf7bda5623b60a80
4ecb8596e3b7599b4522009e80d86c3f2f8e51f67a66963d031a3350a39c4d71
c7f79d2ca55a6d895a6252bafd04a29e2a41cfff1e74d94ccea43f22914ac84a
1cf67706db13f3b2f8d89167d1940a1456093ac598a0938640ad38f753740467
c7ec3e1ff8ee93d7733611841f988920bbb71243233a7e797ce87b83a3edf286
31c3adf913de9f8c5ef73e874fbf2ae4298ca0daf4ba077141236611903c1b8d
dbf53c573f58f9678e304e98f239e2a493eeb70367d699ca703d17358897c489
4bb6b2fe7e8becbaef800aa00ab339a6d53dd535406ab6917526b88dee7cffd8
123afa90cd913e97a29bff405299a35aeecba91c5b1d0fe60148206cba3fdfe7
ca2ca98091016651acfa2c65a99dfde5a12cdcce1a88b6d26069de12eb24cfda
6457a4a50aec1fa6aa1f5159695e062c22a004c6abdd4023510256a4f6f2a3dc
513d311e440f443e3da0d55861028ffbc05ea21b5416ab5130e08149b89ae0e5
2a83c5a1715122bf3562badf7a42de0edc38725a898561fb287c5d52082bf281
16d8d7bc9f64a284a1ba08aed5b1bedcd1ad15693fe61707eab0cb3faee720d0
529a32936c3a5cc38af1320b90108e2b261c2c147258265cd64aa3af40dfa86c
402981ee9838630cb07bbbf7392805cb0c2dccda2d5537f87a8f270a2d537e0c
7dce9b9f3f08d95e60036e45b148da34cd89e158c2dc5d58b08d4147a3252c67
723e271c0c8f1e8f4cc811383910d9fb94349e83711974fc1d9bb99140db1436
9888abdee8ddc776adc10d42f2d82c81327b0dc11da1557636828e2881f33484
cfc232ddac00e63ebc7e36a5179e03dfb82f440825140d9043fe286f256adc71
d64faf320ef5bc9fdfeb61de5cd49706a069cd49eb41319b53ce0fb992f92cdf
cd03ee81e3b0aa47d287b943f1c61a1e411e233fc56961cd0ada91c43ac7cba9
76182fcf4f572cd76cf9dbdd7e2db29ba82c2ce6e62e63d420d4deb8c67da1be
f1038a2f1a287f3fa2d19de97c321318229b0d396a44e4db3bca5b37123fafdb
a8b58f17a200c148a382211869fed5c2abe53538e8ba76e83e8e835ba0136467
70931dcc37b4ba7f6a2370f5ca485ec108c3297ffa330a1ab8df1a5a4e414754
7979a5e8b852ba75df917d63fd020335a8977a5db3625e1b64d646d915d699f6
04b3e341a14a37c06dd418fd00118cfdb2cb6c17e1983eaefec74d866a56b828
2f6f940e39fe20ded3d474780acdb301e45cbb530b9630d9ecaae355f62d0ab4
8ccc4b182ed7bf9044c1e239e74057cec496201ccd61361f9ef0a92e6382ca39
432b8327f43696634f2cc5c7d92796d62fb722badc3d5d1ec222aa88ea7a0bfc
03b3ed0902d78ccae65aff410775671f1709cb103783c0a1837445126d9d0923
d0a8d99be5fe4aec423279874bbbadaa2dea8efb506511ebb5cfa6c256cdca31
65b7cd435ec63fd28981916869269c338445803c4805e60bbd4feeb0e6c6cab8
0b0a0466f50c20c9c5ae9db204710a598637d039f3113cf311e216b7dbcba5f3
2c82eb43ce7d86c61f971d04fa3a62a80de77b4240a48a918ef0910df7e2613b
6dd853f3949b3f69539ac262a9650215c65bbe52dc30fbe943eb910a7db96ddc
985af42f43cc57b25fdd4ad8842e83e81a5f47cf370d473ae168f5a167cbe52c
1ea8f55bca797ae1eee77b297cf7b4d500799ddf00b971264cf45d604face118
14cf18f6ec1a8f229abd57bc5a3a78206abd519baba569da4bca466d0da995ba
39fd0868fbec977d46d31c714b429d5fa6ea2ad4af1e2c899c2bda5546ed2130
c9c64fed80f393b06bf9c58ef2b24bad0d10adb7143bd5e0bf2ed3e7d1cdca4a
57eccd6b357386aba632518ba1dbb02caef527484307f5156fa52b8af8a04d56
521ddc9e7423fb6f394fb62c6b89c7dff5fcbc297c2ce5a99235f26941d417c8
d8784b2061f4b71b3186f8190ad38fd6cd03c0c4bc1e0c0a98d6289b67be8a08
470335e7f50ea2b2858df166665d5558f80ffcc2552632e41780df6e6b22dc7c
d57a6076bce38833057bb7f5b2a3e49ee87e7cfb9e46c74f55906208589e62e3
aafdab8625f7ce351d3c958604dd645486f1eda4cebd5ce833da16fe3f6716da
4f1e7a45e03532b3191f4293a0cc69f10ed1acd5d418c54a03c834c4104d8dbd
dcd2897599390dcc3dba0620f056db34587584f79982de4467090536938c639d
4b6f715681ba20c84f15f76f508a1908bd7529f0a36966132f6102e6ea95223c
a59b9114b070f40bbfbc008417bdfb1a2f3d99bd9610961c85eeec51fb109085
5bb86a24b2c17550a948dc1f1495aa5d89d06ceffb3f77aed84fedd24deadfed
024f5f7e333b037e7c62917aeb12005d29ca85d7caa26cfa4845e2c16b9a49b3
678d654aef49bdac9e664ba3b403a1bcc1b8027bcedc8869c07316ed3baba47c
d5fa29a95bc960eb487c75b98fb8bac3a9993378da6e35a13b63373365102afd
974413137bc281113c2a4cc0b63b12f6f992f28eedf02c209a688bfcc71fc75c
89520dc1db168e050d0e96dab6bd6fcda1a34b5b103065f4602705b8146089d4
aa42f57b113ef23ef3d5cb3990568d85530b68978896f38eb68ac8dd04470c9d
d72d594ce0de1a1cad449acec77a6a700a5df2efdb98dd1e37458d801e85e8e2
8729aaa7eacabf719658e3d60468a240e7312506648c1b096a183734af1b5e4d
598ffbcbeb3afcec05d008b08e38f977b59f9084b1fce814b7dec36af15d6034
73796d8f5c3668edb1c6f3ba8f65f750326c499411ab3f3a90d27641d30d1bb8
2d62de3bd2d0262da56578c670d0cfdb22e9928d30b08a76b9052e8f3ae5d5de
b76f774d3cfbff68c1893cc799116823e0e25c6795c07cfbf222dced83728aac
7c2a50cd3fddb88c5f79f006841af7d6eb8456948d017930e26cddccb523a873
d7bd6de12fd7015fd6608b4625b5e9f7359d686e3a2ddb5ec33e53eb9ca2149c
4b0188a0a3a4df6aee696f856bd45f8dd0f6ac5a5e81c1d75b4bfd9ae5f9d77f
c7ccc72a99d9e700bea1899e1b7d77bd35497d0e83ce0f6d88aa32d43c2a21b4
590a609e1833e0011951243e2009984623f24c40cd1e525a89db00d31d454401
1a6498185aba97f92d26458f0cf119a54b9e28bc1418f96dead799c33d46d686
d5c5f9478d6d10cb812ff6bb83118d2a433c7385ef8a99eadbf3c125ebb85fed
da7df89b3f866573f26b2a4a849be362fe8fd1647e2f85b1aff2aed15750fbca
3ee914af7a04728273fd66864b6ea0c4fd70e6da74c3cfc6ebf0494e79167f87
e7823b7be3de0aa9c6f4c9305163efc270d1a84410e385367ebca8e2902febe3
7e65013dc37ea08af3008c90b682d9c6404779dd2ace7ca43f12423eb82ca7fb
da73539a1064833b8b61c69b5da0b2fbcd9709862363830a4aed659308b7fc20
873c8e8a102ced41c2385831d650f391c53e92eb657022c3f385e6c97b78cbca
da7fa733bd0036c92d30a2452605c4cf5170d49711bbf8f86983b4b6da8d7b58
f7fb97fcffb7926bb5f7e550a5489674e731aae5c75c3af06666f01d65e7b630
7f9bc42668d9195b951037b6dc67ca0248a49f48581c0501f17ca9f5127b101c
1878ff2ad6e86fe1a3ab3cc97289bf3d49e08cba30b916305e9088b7725b12b7
dcffdaa9071832639310bba7694bc57dd66458f24ba4545f715e56804862dcc8
bb845dbf659eecec96c37c8e77aa592a66f679ff89c3434d91a44f0575204945
dd047d4179212820918f0f2caef51bc38045370d503b1e75f97702bb49e9f2a9
168803c69a29c76ce76feffd0dfa539d36ae8560010fc22393e3810e6d25a651
8740f81f479c94872016ca7d61f5fede9831740529e74445697fbf20a00cecea
bdca34fc8ca52f738263ca920e51cac239d3446f2ad3ffdd4c78c512d3f0a3f7
e9b7945818a37dee7bb695377a9448e796312a21d77e8226e2bb56ff8e8ac2f7
37481905e6a239f91e4f8aec669ec5b5603297ea37bd5abf26bc5c2557205ad2
54ed4a1ca412fd92ec1373324bb89d7b60325b9454ac3b8d875398607e66708c
0b55c09fbb1ea3e7a6c8fc7ce2627fa2626985a7d2f16a9f3dcc99081434dea6
697ce2a6a2d3329fc51669f4bf310a6cef8df0f729552e5116712fb4269be8bd
f64afa103af5d269e6a54a56af16f3a732505613f6f71278b753effb1143749c
259be3b08e6367e74d4de36ad9d84be1d2553455b9d22c52b762d73c66c5bc2b
e286c07bfc4a3277f2452bd1c5fdb60ffbe6919ea3dc20a2b14e531a2aa2e702
d324fd242a7b825cb0a400472406223df6b534b36f85ef9cecbb024100e43dba
e1f546746ba8b10f57ae77c3474e428b50d090ff5cc9fead10063de1f3ded316
9fffaa89961ec285c19f5850a585e5e62cc94215779a1ba70deb1220ee8b9461
2c91068b764f7838cb5cb196bd3e629738818f65eb0d685c96035bb320ed692e
bd84bbe9376bdf9e5eac1c102dcc172ecd9cd3b5f2f0c3926c00fe57577d0db4
0957a6a6a3770af2b277fdad549e3cf77cb83c64b6ce107febc625017501f23d
54521adcc32d7042132059b9fb411cec41f1f3e49d573c7e647ce6ccdbc49bd5
34e8e4428dcb7fe9b677132cc79b590e9f34c33d9c9a1c7ac15598b866e2aaaf
b40c41a9647b352cefa963527c487dc31f5bf1cdad3608c22df482a96a7ed391
a5b55c4b21d01f1901ad1e0dc1ae1cd6897048f6ede4eeddf2be144b6af30a38
c29524a10152a5308976acbad5306c86dbde024998ea945799241922806953e6
bbafd0c07b639b2df9172f0ae1a54aa91471c8ce0e86b3bb6216a63c22597f35
4f7245bdf08186e6b21e82a205e199ff9e6798323e271dec8bad4c1f146e9bbd
c89ca91feb24cc81e40c8ea51f72a43bb8cefc2f12e214e0175aa8151baa0d80
d4871b8f61511a83819e86087f8dd0b416c09072652be13c351ff53e8f528bc1
56c12ea0c8ee7513238a0eba5c6e96a19296aa859fb112be4bd0f999fd67da9d
c3bb6f435712152ff3c92bf088dc0e0e62baddd1076c08eb3b0e7b2afcb83e3d
d9f1f493594abc7b041d49824217cff13ba11fead8769ef11d3a184e91a1adbe
df0e207a80815c625d678a8cb5e7602110a5efe544197ad65bce566671873ee9
6af2000870322aac447d4fb4c7583104a49bd1898eec6758f33db455ad9e3858
9b434cd7006f95ea60fe472d8ad1a941cf84029a3c9ab7caedbaac7d58dfc8df
be96e5449ce62c39cc17d619e773f3a14bed9fee2e5bfd2caf3fab7efb0bf708
2d63dbf480524a382f2f817ad1f78a16c18e54df4af9256fb884f6ff7b7e7230
9f9571cc6f1fa5992144efb18da40443577d2a13c6fd5ea663733f2e79ff1809
865457c7f5ecbb4df6ce4747dad70c6b642bdf79fdbd02dad608ab61f8a1cd3e
0e0f2b1409fc4b7f66b651dd758c30f3008d6a622119c37bc086af0c8e9bde0f
8093526ee2c192a1e71858d01c72324ad67d4e71f97f142bd977ed01605730e2
20419632e242929f57cac5c5a50792a830e80f76ebf240a43f864749df4b630f
989424b23ae76f3261b8617e79dd9d15f8eb0d30877b3c5cba15b9c9f66c32dc
4759dce907f300979e9c7cae5f7d27c92f699baa184169b9ad3b59d9a22ae931
50a1aa9ee2f0b9a7dda31120707a2daab34eb81cede31f88e1bf8a37ce837591
95353c28907579e559e0df961a3d7dae1b68422b325135b6c17ca6883cd6f55e
e7f4b4534dca9a46fc6dd3cb0a01ed96bb7d8b4e27f2e297d766cfa0da21732d
d629059da1084683b086beacc69ef759dcc7b95277a8d1c3c1676fa0fcac1c59
8e75b1cd6c2d9e0a1fa6f0d3b999c197fe578f07dec854ec32b3e7ba7874f880
03b7c5191d7e55725581e0a700bd8d5a56ec794d1ca4a1565b03534b46831562
6ff68f18d3ee70a3b7333c1b2ff7c80bfefc720ef5cdc023b7818e911237974c
8636733e467d1507b78093f357d442b7ffa67c1617d59c9918c3fa7dcdc8199d
b0aa85c741a9b9a8ffa4dba60d9749b479e719e5502ab4070b8969fb399d822b
f484552439c6f39c67f4f5d3aec2a01a9e24660871f0d6e1057ece9709f938a3
1936713b9435266276940a560841cb4b4687289b95319c10b1190e191ef70b8e
01d0812c5c5213fc7afb7313741e3ef3af537777724fc0d0f31318ba12b28054
6b64bdf376fe1cb38ecd0cf0e5e76718f1934d2b13c76698672b5bd7b0d7cc46
bcc9edb1be2841f6b17915f8ccb5cac2dda10a9052c590b2dff0790d8a1d644f
d900fa1238a389cecf29757e0e62d56aa4496e13235495dbe26ca95a3618aecc
6f98cc119486c74d704a1d0f39c4aa171bc79b72e4c480a3d2301dea7c7c9821
9b398f06da78cae1dc10599aa08bd9d9fecd7024825d0484a25b0ca0c21e8ea9
d255605562e469f10b1acf73779e98dac1a6baf7c8bae5dd6e8cc023540e8e1c
04aadfe37bd75ddf44be98e5f560e9b47f34757ab3c62ed018a270c74ef6f458
c1b98ef181a7aaec57cf34669cb7a0317e7e71700a8845b5b02abe891bd0d4d6
f9beac865731c1a7444280dc8b98cac9948f4ad2b717be654a331abf075d2e14
6dc0fc9ec96dfd64cc71e5a261d925b4e18b1ea78d127d19bf477d8f777895d4
72450fd6ebd5c03f5800b6e05bb2348582fce47600b5a5f5950ba457ae4d4312
d21c2a6dc422f65724d2ea5cb7f415407ca436a3280b2a9dd91e534f0e060763
cbe568af353cd25a7b6cdca29d01558d7c91ba686fdc22a01ddcbea074c78bfc
e5ee14b2641565be11c3370c3e18c958ae1989d61307647b9c2558781810b7d8
64f0c942ec5bd1aff5cfcaeb0745b09d684482b01787129e036527a387abe656
55109edc7fe75366a76383247a2aeb8cb8dae2b84025d71d0a16b779818f0fbb
567d4f938688290352ec6fc0ab864bd207d188209541011814f1eff4bf53d50d
a93d25546624b4a66c467147de7d5456153e5e11dc29149077d481ef3a3a74bd
479d43daf833e1ac84da636b1e7babdd7518b2db87b8ca4552d0a2f1ca1d7d9b
f56db40d931cb2c43c26d2e060c74cd6bbae6ded0ef58cec194c7f17a1a25bb2
8fb1c8b8243cb6bce3fa43d2a074026b9de0d1773c287f3b853a21c420600ce2
4780d6934d25f9577740152a5fa87ad88f7b51da6f57d6c3a984c85e4d1b7381
e1d302642443ee77aeaf09739ef3403ec8042fcdc22d0899356f23146a4b7a75
751d1cf8a6af5360811c299088a07dda96cd332dec89001442386a7c6e42fb08
ed97555bca2157141809c0aa6d22b12bd88295de4f1405c8e2c5408f3cb12371
3c1c8ca3e7fa89e18647435f60726493c38fd637259c0a1acc274174fd61c316
588dba7b1c3c532e2286647f6af0b56a6a93cef57ad07d97853b8aee5d2353c9
d80096ac0a5bfc85868e3787c250c1fba2ce97accd5ea5bdba5fc4a625113c74
68ba4471a158783b90d1914edd7e8c8a71f237958cbc370559633d0280bcf157
3f583f9f19284fada01aa30c775ef05cca21baf4c66b148e536c3d85edb41cba
119014cdff4e4192b841ce8535899ffdb366af6878444d6ce2e4d5a6d4c5796d
ba71ef7001e5104d7ddf711a483f0b83a0e5a71d6735ad4991aa331f3b9526b8
1f58f0dca0f999a9293d93c3244b2e805e4e50ed73418ecad9ab0783d7f73955
b56c64805606ac856f62a033ecc825292cb11647c85461d6d840330ab489c5d3
7b721880543244de38b8e465da7c5d1e0209457d7f32080d60f4b03b64f885df
3997c3c3e114e6997688e55e58084939d4cd801b3f19197ad3f764603e8d8bca
a4a842d1f9ec5c9050bb02ed1a6a479675d6f696ca4523e5c91507aed538f1b8
6ebcea55c3ff135555203532568fdca8618aaee24cf16d34633370a2bdba80bc
d3c3a255c2adcd2785db0b332ea829ab4c635f8fed564384d7b3747d8122b276
942be089727cc11f0457058dfe6f91e47d9008985f7377bee7f98c1d144ef3ee
18bbfb0c3278665e2530f4023710dbdcce9e9fc96cedf020e74c74b81597c8e5
dd767f4d80be140b78a7c2d82a035152e7dfc0eac40ba50b41d9a5c745e458c1
03e45dc3c32fbfdb2ac1d7c8b9aa6b7148aab3b8ec1804f9adeda20480b9d283
efe113fe1294ed8503995e0c04ecf8a0a5a9d611ce16afecfc3d1014b1528441
75717e637d8b807fb3e79c93350af509268bac7a859424daab55cdbe3ce9ac5d
0fedfe4c10e3949f80682aa3dafecc3088f4cc29f54cadebd8464e0fcffcfab9
89bfc76693bdab4ccc63280055b52ce7beb39d5de682e7fb4c8ca3f91dd109fd
a4fbf8501cfdd86e17d60fd1065b858a539407f0dcf9a3e5a41f7ff35d87e750
152ae118f2b466345b0e23747f93467e142d26f356d1c4bd3ac83e1696bc97a7
8584dbd3d04dc95686d6ea8fb48cd6af9710711e43237e5f2d3fda73011f0ec8
4f826f529ff7a7e1ec28023f3a297d85dbeb560ee0e60bb99e991ed9104180c9
8aa0be966f742d1ed9996482019968e8947cc334319ea1c35ba4112084851f7b
6d200f00dc108d9745ec705b9833c839f067f564b977344e2022fd5130de7571
7820439e5a1047f6923d432c359a743e7f3ed67cdf80dbf08a4395fd67534bfb
8e6bb1f2f7358df393b1807e5427566fae32be2c8782bbe47725af80a51054c8
52e172f8122c077db3a2748179e54b7c150f8000fbb43dec8211f8396ea174be
60be18f4ca6c9c3246609da7c6f7fbdc1ae7a8a51335868cdf7bcc125f389bb8
46d73c5cb53d947c619cfc000067b70794df2f06c785d915e96c379ff35172f4
958628986b3d331adf8b5ca63a06c81797c45e5a42fb33354685adf61ba5a94c
e14217072a028661ac0eefdf40172a2d20c66cee8cba40afe9e8b42e97a624a5
cc665a0d41adb141d5d028dcaf21ef971f060cdbf9f63f36c5b510bfc15b852f
41f10711446de267e3a455f4ba9a3bcb03475e077141feb4720be1550ff5cdcd
6681f4155b15eaa493fb9b9cabe23650333fe6237b739cd932e06df00d5a3f25
325d740ea9bd29d22880fe6177996cdf39248f8af9970e9f05d63c6cfcb36130
15a1535a24edd8683d7134233660b0236f255201f67187679be7d64e088ffa96
2e8b30f427f314380c28ce18a4884c454e63a06e17c87c5c6181fb9849d56760
16f1c9b2419398824baaeb89a681acefb2c9dde42f8cfe92a2d4843e14b10c6c
4ad310597ce3762329eee6b44f3b80200d12173bb3ba02ba0429542e5d66e1ce
795359d7f994be2cbfd722e8c869a35bb8ba263e45196ee067a20e912228af58
103a487e7cf4442390be0c60e4cbfeef186c3cdf87506a8295cacb052d7ba00f
4ec5029af410e7c552ccf40d4343ee60f019fa1f6d1e0ff982f9ce5d0afdbfec
90d02a4af47f68d0d2de98f00bbe17cd1f4330cb8fb10a767cefbed96f4e7c0f
87921e035e4dba5c4979ec9edd6880ccd9628ca850c5d56b581d597ca6468db0
05f39522da851f566dee439154319ddc092229cb2a637e207d695dddeb221a51
983a4128fc7846d9ca7efa529caebf2113aca90f8601ad14da080f19ec03b2fe
f15da39727237916e2266ec3df211db3c6fb7ab53ab1fd76dac533a23a45edf7
2198956bebb498f8db2e34ea72fddeb5eccc0e75246a8e18c30ce552739b125b
c1d7d3a8066b5957d6727e5b06184e592013c6a72c7762ac53f80bcb3d03957a
b708fd86fc16ba4d68474c6d6ef08bf8aa881fffc53671508559a30c200102aa
2b7ba32ddc150c9f1c1b61b86bfe55458935d8332eb8de178776d7168d1f0057
221448f5f6f4cf6143d1680833d2ecefaccb2137dbbc065de9562b5067912853
b4ce2a0162a826206e1aafe47adc68634ad14b0a040c1b231946db17826b1bd7
95d31f83a851eba6de504bf629f4523edee9da57de1510a4333227ec74e9f29c
f844e5af6b03cb22010b0d87c3d98cadbc20f5e06c048f51baaeec11d041a184
1d600a7d39d696db13a33856b824d8c06d33698106da951a34855f2b3343537d
132ed8f18ef7364546d463b3792c10499f2099de41c43485bbb681b819bd4cc8
f58cd707692e18fd0d68ae96c8ee5d7694862ba07f5ebcc6c31bfc8a77b58a29
a68c3d7674678bdc9eca734c8690b6ea19b52f4841cd6ffb195597fa6bb6736a
24bc58d80e5f8d36b87d92f15b679c300edd27fc55072b7a11dd18a79e4b7b27
9a6f871337ef60cd139638f91ea1eed18a6e7e0a64a6da55b917b66cf9a90561
b7de9b0a2cedb4af8a0deb930c4ed4e16e72796c8f52ecca9e4f9d8f37fdfd4d
f37a5e66a76c30c1aabef8a347ac1b8061b2fb6ecb
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
cleartomark

%%EndFont 
%%BeginFont: CMTT9
%!PS-AdobeFont-1.1: CMTT9 1.0
%%CreationDate: 1991 Aug 20 16:46:24

% Copyright (C) 1997 American Mathematical Society.  All Rights Reserved.

11 dict begin
/FontInfo 7 dict dup begin
/version (1.0) readonly def
/Notice (Copyright (C) 1997 American Mathematical Society. All Rights Reserved) readonly def
/FullName (CMTT9) readonly def
/FamilyName (Computer Modern) readonly def
/Weight (Medium) readonly def
/ItalicAngle 0 def
/isFixedPitch true def
end readonly def
/FontName /CMTT9 def
/PaintType 0 def
/FontType 1 def
/FontMatrix [0.001 0 0 0.001 0 0] readonly def
/Encoding 256 array
0 1 255 {1 index exch /.notdef put} for
dup 33 /exclam put
dup 34 /quotedbl put
dup 35 /numbersign put
dup 36 /dollar put
dup 37 /percent put
dup 39 /quoteright put
dup 40 /parenleft put
dup 41 /parenright put
dup 42 /asterisk put
dup 43 /plus put
dup 44 /comma put
dup 45 /hyphen put
dup 46 /period put
dup 47 /slash put
dup 48 /zero put
dup 49 /one put
dup 50 /two put
dup 51 /three put
dup 52 /four put
dup 53 /five put
dup 55 /seven put
dup 58 /colon put
dup 59 /semicolon put
dup 60 /less put
dup 61 /equal put
dup 62 /greater put
dup 65 /A put
dup 66 /B put
dup 67 /C put
dup 68 /D put
dup 69 /E put
dup 70 /F put
dup 71 /G put
dup 73 /I put
dup 76 /L put
dup 77 /M put
dup 78 /N put
dup 79 /O put
dup 80 /P put
dup 81 /Q put
dup 82 /R put
dup 83 /S put
dup 84 /T put
dup 85 /U put
dup 86 /V put
dup 87 /W put
dup 88 /X put
dup 89 /Y put
dup 90 /Z put
dup 91 /bracketleft put
dup 92 /backslash put
dup 93 /bracketright put
dup 95 /underscore put
dup 97 /a put
dup 98 /b put
dup 99 /c put
dup 100 /d put
dup 101 /e put
dup 102 /f put
dup 103 /g put
dup 104 /h put
dup 105 /i put
dup 107 /k put
dup 108 /l put
dup 109 /m put
dup 110 /n put
dup 111 /o put
dup 112 /p put
dup 113 /q put
dup 114 /r put
dup 115 /s put
dup 116 /t put
dup 117 /u put
dup 118 /v put
dup 119 /w put
dup 120 /x put
dup 121 /y put
dup 122 /z put
dup 123 /braceleft put
dup 124 /bar put
dup 125 /braceright put
dup 126 /asciitilde put
readonly def
/FontBBox{-6 -233 542 698}readonly def
/UniqueXX 5000831 def
currentdict end
currentfile eexec
9b9c1569015f2c1d2bf560f4c0d52257bacdd6500abda5ed9835f6a016cfc8f0
0b6c052ed76a87856b50f4d80dfaeb508c97f8281f3f88b17e4d3b90c0f65ec3
79791aacdc162a66cbbc5be2f53aad8de72dd113b55a022fbfee658cb95f5bb3
2ba0357b5e050fddf264a07470bef1c52119b6fbd5c77ebed964ac5a2bbec9d8
b3e48ae5bb003a63d545774b922b9d5ff6b0066ece43645a131879b032137d6d
823385fe55f3402d557fd3b4486be465959b1188f76df7824c135a7fb382c4e1
1b0ddfe856b6f34552ca48c24b57dd8448fac257c4d93fb122e1218fd36b99b2
d79dadb8a66613ef11039be77816a7a2d6781fe0d69cecc36232ae87a172afe0
95532a8c7ff40bdd4a5fcfb6ccfd8f73c572231734e0609c6743ee11010f6579
820b367c49069ac1d45760c0ce8dc1e67e2beb72be6d287910547e1b4bb52465
b75947d224998223275a2c340a1c14c04328cc2935c53ee2723f1de6357a291e
14863f6c1411477b3ea074052b30a4c1ef03ab324d678307e1cb02c7aaffa90b
73975378b9debcd3f6aab626a361be8068c60edd0b2be4a7bbf4efa21cc23607
bf7e2556c17b5923d7b0fc036d5fea743c55f2bbf72e8a61995bd63d7104a085
b8dd5a83d9077376a4ae8f0c048606bb9e84c640c52d0a95b35d48cfafd6ebe3
d6eb0ed88c1212818ca93e40614740a77c446b792d02945642014a5d55ba970e
f97dcdd5b839f621a052d1085a1e668161d3ac0227c7867324ede883589b39e5
d152793009cb5a08eb6719a44dd01b6147e3436bdbb28215ce3d29a3b1dfc72b
d942f8cb3376b4e12cff53a793d935346ceb2afc3428cd9313c671ec1911252c
19de341556999aaf7417aa5085daa35ee71353fdc2c7d83ec2dedaabb1b89b99
e4cb5282159cbfb45a286f8d6bf3abdedccbdcebaf6994b17f1be07d10f00cba
47f2fbf66c0cf524494c53786b0f88f5d96a18a086fbfd22b6cd3108ee918369
8b342fe978502afdebf98632d63bc149de9eab94230a55327fb96b72a85ef6b7
acde791164e8f856e95058b875b02a2262b85a2ff02fddaaffc3a476f7abdb58
f5b1df019a4ca14695cf1f238756b3ce61ffa44d543341b9c1a3b422ad6ad0be
db2f2ef0ad1d60a8589decb250451260a0dfafca04c4435a350b80b75f198c1e
ccddca12489fe22c127dbb5c933103e2fa039b8c39baa8049df9a7e71d460374
e5ba202105445e77f945ad6039345773c2fb3a42f96dcfadc152bd2697fa31ad
038853e6b54a896cb1e238250ae0b63481b1a1fdfe27ac62c1ab55926b088000
703c91383e831a159ff92bc1b81ed5e2c9a97f3e30723d68014eb70afc93be46
18c79a083b23b04d9b48ade516533ac2bba6a8a405326a4e84079a26bce00ee2
a54d94fe7c10910d782d51bf9f8e875d974b4a239df60da8b6ef986722ecbe38
70b2a80cde33d9e2fe1e8552a40ecae330a24ddc84afd3b91816a715dcf75dcc
c17db61b066cb4f44831f9a80d119dbbf822a3b92f8ee240ac7a753d4587e5e4
72dcfb45aef8b41d333c3bffd3b791fd184a6a47148c19ec607960762aee2e44
a9c4901996e6def0df725288b0fe6699c553dd8da1c50f6ca400dcaf7e65615c
6e5f89273a00213201575bcf38777f2d87c4679748008db68dfb7d4211bbe84d
d7887a54e5e2a5b0fee047f50c9a94cec8598eaa67849bf1acd19195db35e286
bd708165e7267750e41428697c1aebd6f3dcb5e987107f9b06a37f7aee233c69
725426222c891e41ac56197d6caaa0b9e3da9ee4120b3f6354d43b9f197fc6fe
9242d52d38af5e68607bf4dcabb290a3947dcd5ccd4496453c8a055c23ac1c72
95dd4c016f5f3454723d94c341cd294fac118a72c914f7b51ab8a15052d58427
2a07d09d0b05e76d68376531fae8ece32a7a79d27a31ac8071391f43021b74b1
727333767e6fcfbc98e8585d61e6e2ebf743fe0b81fa5386c76016ca76157a38
10385b11b6659379820786221f027ec9089135ea10b42b2eb2b6b49351989137
f800146bb2587fd1a95bf8bc07b62fe20da33b153bbb9f0b770605a19b99dd4f
067da37255758920508c1f6e887108ba2896580c1b51d3daa8217ee300b6c889
ca4adfe2b95596b8f89d88a2645cc4145d705075ddee8e18a4937c33cc8080b8
eaf170307d6c792f3a783879e0d7309eb14cee8b498e236f955a60c2e1010fc0
a39bf8fab32d95336fc000433a20c30226427bac291485172693d9bda88f8dcd
6d248981423f38e37b63b31c8d80f6ee7e8b5e1c7dfed9bc07edbb3e7796df0c
036d6ddef648b05c9c97613b3fa1ae2af58bd834699aa90853119645f161c9fb
913e8efde513fc66a2f16194810da20d32367a54f1d2b20a8b4661e2da7f34bd
bd5a6c4c53c2686a318152cf90fdb6a29baf48c71931fdb04c435dd5da055eed
2b2dc3545d461a5e4f39e7b71824516a3694f622353555f155ac6533acdfd7bd
b97db38b4ef0bf3306e560843f34185e1679bd17c8a3c7313c220b98a90c7a0b
417d4943659edad0587fc86fe6c67abaecf57d8877416eecb3d9c92c3b0f64d6
084666a6194cbe0441be9c3a575c26e5c65eec4f3d534deec31838bf84e19b23
f2243f0d36bf61cf54a4f8c80ac752e5fe566b732c6157b4904f3e40be37a421
3748f7a0f60506211ce251a671fbaef796ad3e3b4971081fdae55e00960794b6
67e56627aeaff2fbe9ba9a1ba54d707e59e5f1389c2973459f0e635910201a37
7eb289ae103e5502f01a2f58821227d0b9f6d416f503c47a9dd6b39b1bb5f801
6cb9df5aa5f8221f5ca5150a3729593b0fc6ab8ed169a6caafb8bf65d88a7a8d
b197e8fcd37b1748db11dcf144299d30a202452a7144c14e709039d5adda3875
0c0d0cd27a76721de38d7f58b738be4e237704f3ed4485c603058d073cd2bc69
472f68520135290c1b5565ff91e2a719d7579b8f9fae533724a31dc8cac1a55c
2321e62d476ba89e1cd881c9c7238a07d862ac7d70a0598ecb589f0e3c56a9af
8206e20434de4631132ed7c74593c32d3b4ac5e5518b4c7b604c0ac5b7f14556
93dc2ff29aa9970acc3652ce063e278c8b2dd15c38cded09323c3ff767f6105b
287a7df0a135d3c233a2995dfc004a10a168dc33c469abfc750a30675be96cd1
8d142aa9bb539ea25ef4bd9a6f1f26053eba25727cce13722b74cccd1ca886e3
d831177e0178ee6cd7969d15b8e56bcc3246953a216945d47fe44df9b7ba6ab2
b1abfc5bc64f735d4dc9fea7f64c3ced995dd91f773f3806684ac4de0615e3c9
1e41d3a013dd7856be55bd176c11ff58d8c9eb618a00d316d88926d6de05e107
6a12ba9ee85c6f8f8641ce6670ff797bdc52b94712a21dca29af6613b54a0209
615eb7dcb4b71c400487e1f04245e019e1bfa478044e882bd07eb9406060c867
466fd79dd436c9e8f65deb0695cb95d3e56f58b779098c5011870977bd6fefe3
bfdbd4243c4fd65b123a80a959d3dc864a04c5bd2a586afd895bfd7846404c0a
6678a4b3ffa91e0b801056d286f63672a7a1b645447e8196ffd3e37ba193f069
0a76858d0a8549755d844a6fc5ca901d76910f138f2ef6eb1f08a32f0c1bbe4f
61e9a1e35c4cc3e04fe913443cd444510dcb822da725a06e3708d17432645607
75ead569931fc1ae2d7f99c1d7f60a40bf38ed214cc5fcbd65f324a66f5e0e7f
a6a60b20ed5885be8c0122b93b6a9b68a5d4367e016361f4ac088996809eae7b
bbff88ad957bb40cd3bf941a746359b67cd9927b149c448ff8488cc26ff43984
f9708c76a7e327223e2722c9fea0855c9b5a80f2a4eae7ac4a53d992cbdd7acc
52dd715665225216273f53f8a09d7931dcdf4e23a014f390a4a306e1aec1a6e2
871d6cd841e9d1ae417240fe121b77945b8524cff76d2d6c7477c69bc73c2e32
96288ba4de7f0e880d784feadb65a008f22fc443fb02a37b971cc252b02435d3
10561732297c217e6ef0755d5ca452a04111cb301880cd84bafedc3dcd256872
f37aedb175416d60cc4521c0691b920cbe606a8df9f8ca04f83e0831eee8ad3f
41f1831a83a91c29d1b45050b7c000b0d33600fefe9bf467633b85bd492639b9
d2724bced4e19b1d2d01e4643f9257eeba9dc66463ed1f2e1b8d6d59454d3cd8
360876aba2983ea4a7fccac0bf35dcc3196732feb82c0d9b134ed1e4f0bca8df
39ee087bf2a4643cafabbacf7997519c3ba24cb504017b3715df61e6fc1442de
44f2354193d7d479d547c82d85e35d36dcdf751fc032162894ba407c752a4a6c
ddf4db2c82a3ad2c2b52b99445951f7802cfe96b4936afbdd333292be8bd0d55
c37c4fdf211f1517a999037739d9b5c9fe287e17ab7ce49cc8fbda5a66946b7f
47386a4fd0b14155cbdfce3d9ab080879c4c3e55249430c107630e0af2298cc5
6395fd50327eed433dddd3e9e1b99393719b5b815b171de468a2805dde271f5d
5f5d24fe810db3adce3675e034cb39aca4a0685e6527f6478a329133c47112be
2ada2f4bd43c0cf79c41d773b92ddcc3b3b08ea32b50ce37223df064f5808788
f06bc068a26a8126c78314c7743922116ca7d963eee0bb3f1fee250642240a66
444909ead18bd559d240ff295c3842a9a4ca4a535a440640084ab76a56e84093
22d1a1183d3b67bfadc5f15bb4d5913f401e4e092161a09af7a4c57e5771a129
9d1d74cd9408bc13ef742e42139b771100fd778f47f570bac876729dbc105728
03f0c27855dfb76643567c7a5e0b6c4de84fb11dff044b44443dbc5f8768ed83
bbce86d1746f4ffb6d0009acf9ebe8fc12a0db92d1dde3d03667894aeff47be6
bcc094e42e25151560958be1629627450c6130add360a6159c2590ef32300a6d
beb4dcf632ad9d63bdce5d8ec6f489c6dd30099c6966ba32def5c9b2da53e640
239909ff8299757ec3cf410adb34dc87d66d1c1d7c8d88efcb724efc4748a69c
6cc8861420f13e6b3b6e159747abf954cfec625580c760e062280c3448805e9a
d0d2dcfe30c35c0e6d71e8104d2997d8bb9609ee8b784096ee3514b920c4f4fa
b9740980d8952432307fdebab734e7e8dc363e718bc0613c5d2613416b191cda
156d67e6a2e329d9d7c657942868c9f518fee866e683de82be76802f7d888b8e
4b8638ef7e2abecfff8c325756b9237509a57300e2316843daefdf0ec45dd6f0
a7b03a6a050924eae631cf1b3a9ed55615d0d40a51d91b77f678e72b7681c2fd
16a63c25ba1476c8ee0615697c4028062ae51d239631968c8f18e1bee692d67e
9e837e38478088264329a1e8431d8de8fcceb67a06a04c057657420521fa7adb
49fd8e142d68a6cccc1bb1818d8c606473c9c0c771ef3c4c0b5ff6e0b4bcff0d
b7979b3d687b46a1bfefc1792ec80848490c8e2bfde673977e6d5d36eecfec91
4a01232626172d4cdf78769da8482ac7fc9b3035c7c3f0ff7012b17d423bcb03
95c545f05916abe3f05c5b958f9b0fd2aef81eb6ecd328b05e3b539fa9cc526e
45b9863fc0b198a2e4eff068ee2580bd45490e6257f34253b3141843f481d1e8
e0213014a2efacbdee376c1283039f331be7523e3b926719d07f3098126c4220
7f8a565fa433eb01bea265af955d70b9d31ab09bdd3b83b17319da16f4ecc19f
9d46f1bf7e3504cdc083563075b237eef088301ec7f5aecb16e4bab0610699e9
9962ce513b01c7b0dce6d000c3eb9a736a98f225e0567d06de7c3d447bf414c4
3f8a8ede48efad105fb4e3e292ebe449023c696bd3c7b93dd76f73539aaa2dc6
32305d269a52e379206fd5408ec7499c16827d0f629a43d78bca41b664f23907
f48223ab542db6c8cec4937996529c0d4b87efd83d0c9353a3a710d14b63f416
5236cd47777ce8cc42d547f0a61c2dfa78633d27923d5947c0f230afe0a15ed1
347c7c507525d140c46d528774e303c79d0316b1d1664b052201bab4fd3755ba
d41245cede41e5d61814fca0ab3e51ed2268afb933d080d91970378dd2343ba9
83749769cc690c4ed197d310942ba7b6781a13c9387563f15e781dc679e6783b
b794cd1c59fb3350e25ab6bf6b8df883ee8f9821f95d44de00e22eb06d75d63b
34d0aa7fbba5e46fd2a4ca63372d24ac9520a516e479e1441e0829d5d3725f70
7fd7ddbfd60a6d466328a7aa3d055dbbd4498c9477e7ff695f88039bc946fd20
88f0305ec19408dffe33d737f6111db1aad460d99edfa834dc06cd64080d6596
fca2f18b7775160e1699b32e487245ed8bab891fdcfc908460cff23cbb163d5a
2e735407fb0e654c7de995d2ac41f1a64a33b0256ab5fd9532a894570a5dc6df
9ce5fd907b788794fa2c82038d54c1d0c6a928b48de122ab217d9c0c01c7c554
986a96a633b34fd346ebacbceece8842891adceb3356203a8b45ae892a421d3d
a0169c1c5f304140fc2ead38df5ef9c12cf89e9cea67996c0dd7d6760d8c578b
13c87da337c8a6e9863d078525367ce12073960ee176ccda1e6f2757acb8152d
8dca9c2730a0699bff3c0e4a5f670fcd4d9cb93304b500bebd850b256f809584
421ff17a8baf4832d00ea5b7699b075d5ea4e58f91298c1d79966290e3781785
1c53acb1b868eec431720feeefd203de2a5ce7d4b5a568303a9a096e8abf9a72
a8f309ba0cdef737d9241cee8af40bbf19f2d47a8182a7ceb4e585c229ce31d7
c7ae231d800ab7256e7ba0e352a64e1513ed40e8826e53122686210cc9186f86
05a9be1ea0e0b6aa240f1d29e18483c1ae02298e45aaef09c79100c3a762b4d7
23dfe9ab8d1b6666a70d033c2380385ab4ea30aabc461f53a2a78d8796e71400
1c27f829f4fb7c19624c2c34f6e369019825b719ccd91ed3d029dcee14a8e77a
59191db2b9c82baf27fa6b90ebe1c7e084274b311a53d0be558a8999b7e0ef8f
0178beaa908aa929b3f3abcb765112b024bbedf774035e4ea3ad689d69fa417a
c0f09fd163e134ac4fb645ec2dc15a789e161fbe69bddf33335d401ed8bfee95
170d344a10e3b811d2f6cb4d0883fc63dbad98ee79eea595d35e0a4bf2569f9c
26b89b209cc45bb4d136c864ae4b1d0facb6a30b575de2208aae5a4fb7ecf2c9
fcccba0af21205e85e4982d782437f418cd5576d95a78688b6de32b27a377813
162cd7ed558c373df795f4f91168180dcc5d901fbe6ceb8e785261630a444fdc
1eaa65c38985900deb5b05d0dc01a3020749562363881a2ee56598918e462186
4fa75565b9a812eae3d69d5b0e63297b7fac79b8231100b21eedc05351150a8c
ac77c19ce9492843cca6b8451945f00d9191bf6c4c6b78f444b1c995780d6c87
0bbc108f2f6e1ac20b879a39781de0d44159581a0a0cc1736f92e85a9db754ef
a880d3cf436be58858d57d711e887d9b7266c28a624e79a9ff1859fc5ce5476f
06e9d792e5ed6a3cae39d513615e333bca8b77914082f81ec675de9e23579cda
f7b2a8e9b13a2db8e528899a0e88cca21323d8b0f1bad13b2db74e686dfe04e3
09f23a32a3315afd7539fc14070a9076d11ad4f4d626aaf8da36f96e16fa38da
8163582b6239ce5789c5fb4cbd95c66a2e9f03f8d6ff23069df89344614723f3
aa489d660c5dab0834adbbc018d8720e49fa637507222d94d64610fc87d82e9c
697ad3525fda0a2f7282a8ad69c60cbb59fa847a41514b374df3ea69ade681a3
3af30fc5d1425d4f18d31fee34dc4223b739bcd7f8ec9cdfc290a8fb6484ce51
3bb162aa5c7ad534ebe7e42d4cbad805b694d301e2e6a6b59af0e90bfdc3de61
40f6998dff2eccc55420d4ca3716da2ac2aa1d058e58f2b9853d2366eb3c7f55
e0ba10b8cf862253e3108c2eb9ba1fcba8f0f95557b245005c69eff26576b9fe
ff3ef00e627b227abb1b7784a2c9d4ca8429e08580fefe3019f8e81382f04aa9
7b8322f144ef0bcade91de2b55d9ca6839817ac45c15f8799e2ec0ff3aeb6a11
bbbc95043b5f43ff57dade95b99474d360e70061f4ee709da567990b59b9d53f
c2020e0692ecbd42340afd3858ca70fbabf3b93e939932dbf0808211f0f8a9af
0ed92d801af1cc354d5ce5aa1ee06ecccfc649c66f89c20f80ea6e9a382767c5
9197bd60d5c1c875f0afdd891ca3ab7e2802316680f55227eb6df68ad9715750
89cea2e1746b8cfdf764aad2f0673dde332a404bcc9071caabb2066d955c18a2
0c1bddb8f8918d99a67734c0b08bcc68e0ab853c38e49903ae9e1b928a910167
703e8d3d57ad5511d89ae5b3fc75b57d2ac886a862637fef2cbeea5cfc1ef7fa
252a7922236fa1938ced34f9acd0504361d0d7ef5972984d65f2546e3cdcdbce
8ee011bbbed76e8d9ed79c3c6091f0d662fd8980a53154e957f97e7db1032e4e
a6fe9f2bffafa37610a553ad2c1a7f1cf17a5b737fbe9c04c11cccc1c77a158d
9ef725d8c9cac42e1d21620693c7dc5dd66304fcf17756214664973f3d3f7194
e7aa9b5f226ff14b1d8c806c2459453747b1b0569f7fb6baa60b21e4100bd0e2
7e8f9ad82ef1e46eacb686954f3dd44c51c4cd4bf1dd006fe8b061c1a636cee2
d9c2075a6bd959f26a23c6fda9a33c2428f5dd92592fdf733fdfbf0e701ccaa3
09496c380522bfec2b750b6eb3aaedcb4f1c0c61e20e25d8d2b193e0a631c029
3256843737c3bba43dd86b9333bcf18e20b45f34f9f5cf92a3a0d138eb282775
e684a648268e2329c044605fc01cb2ec3910e4ac3cf9a725e2ef9797f7fc4c82
a985358abc58881a67bb69eb82d902ac6a918151339f5ed5d2b91eccfd602a83
0df1094f626b9ae270453474ea40b60bfcc0e0221e0f1c7c409fc7a554095a58
a6a552645674fe6fac9fe54b24adcae1f9d19158f9f20e22b492c2b2f7e8e92b
e077d78696e16126af8386d3a01a61268088551f0abcbd049e0477bb4bf1069b
aa845956d76cba2e9329e3572031ae43329c11c4af7310d20067487187aadbe1
29fe5a406f6185d4d9bf54edfe0278b484c3e2916ec78ea07cb91db92b52e232
14b5ff6476f915d680715e56d83dbec6baf42b366b76645609f251656f04870d
3e520d316b79c490825dea8e3a600a32488b769dc4232b297815456f9db6a278
370a3cb57aab3f5a50c84e8c344c77c0916b272a82d686d09c465301e8632ced
0f06d3d77d6ff3d5f7cda96c361857e7164d65340e2aeca7e1f6f93570444c94
ea7e63f51bb063a48807d67dc70711d6cacaec15aa1c8cc4c34a79f7e28f2a86
3e14200613128435f1843e3760ae2dde10af08dfe1d038ceeb8bf3574f9760f5
180ebfab40eaf1d03c9c4f62d0bbdbd0a7dce52dc3fcc3a5a8361f6690d2361b
385d62fe9e7ab3b15bbb0499e7f6ada5471a98baa7333786292e52a2109e883e
9456e2ef683406059610ffa62270b65ce4e4842de22c5136ca997ff2226f6048
8ad6a7730577b89569d9d4aef3202d8a1f2c59f8b725d4e02ab1faf653e3921a
1d1e763385eaf9d3a53e248c9790c6b6509765a61e0d4bda3177d14511bb6a21
a2c89d6629c6e0a7bb2e2b4bdfcc531dddd4dc8e477deb2f41842535298655c4
473eabb6094b891d5b0e6916c4ab53587e1162125431596553edd360f23bc422
7615d117eff5e5d05c2125f0d49a058f3ec43a56bbd4ca144bbab5fbf3d9a2b4
1e80b3d2b849a2fe83cea7a3b90dd0b04b656b11d3c91e0d4a07e2062837f2be
b9a4351136cf7c4b29f6356738e62948b10f2021adaea723ca23438967fbe4c0
83fd713be0908c8113897523c2653ced496c6e47beceb55546a702d62f292269
0cfd73ef3066da4f58c5d451b2825a101149e6611c1a81e08bac02665d34c2d0
8ca0709e65b36c192cfca6131e373bb1cc901f0f60cd84012b95863223bdd9ba
6078a8d25cdda9c7aa57de796892b1badaee9322d5cc5fa69ddc66cbc2023a98
9d74b8cd4259542e2da740988592803ebb1258fa8484980ec0c15d2dc8fe0d50
f815c1a3aa9ca897b6d3d87ced446b01e11387f1a89e98bbfa8efb9fb95efdc4
492cbcbc2c4ed7d31131bd23a0b985d593627beff4b874785991936ac3d6ce50
535452e4d4a385116cd6d622a2c1ccedffd60fcbe6fc82da6e0c164d74603b1e
6da0cffc6d94fcde2acb766da0ab20d9f09476e0662afa1088db41f3f677215b
63ff3d5f62582c7dcfa55ef9a33ed8093b5646038285bed5e0f641b6125f67fb
b69a49bd265cadf6b1cd19102a7e0c726dea31bd51f1bc0b26dd6cfd5b01f83d
8bb323ba75afe47abdc142df514acfd3ac4b03361dd143103a7e60f91b772ab2
686bcd310582a4e0a225863715cd47146b6eb142216d9b3b476f8c06f06f5e90
f703c29a8a1065c24d97099fc341f703c960000dcc596b873b4221722209b198
67b03d7d30e9c7f1522be050fc00c5237f882d0a1c24553b8643a03f74573a58
e1e02098bcbd49d18447d324160255397c1dbfa6d32e888f7d2aa080e1e3ab3d
cd1b38c82b87ab073a884f54bf5af50606e4827cfc439107f0e7cf44ff4a757c
8892dff5ea3d03d6edd6950b64df3f3be7c084b8057a7180018a7e282a94c9e3
8a532ecba4ee848468b456e46a269d1364b25792f7eb3c81cc5fe6d50c0af96c
7ef2ccde7393a0dd9fd7138088e79067e4ebcf083f23db3dda1fa955cfabb304
b814927c8731f3774b43f131a980c97fb53e0019ac2b1c5120c016f97e1b33c4
f881b34df3b2844f27f548bddfe575737df3c5e52e15b45911cc1e1669b569ba
1d338d4f6a97646e2c32154b873eddd6a793f8c296f1f54a4cbbbbe4a6136da6
b91adec086a78e99dd71de63a2ed5ccb79be146dc25ed78d186127e4f41bf42d
ccb46cfc8a87ecbba524cd636ccd561bd35f55bc5e3c9a0df5c28b910d6b6728
d80add44cb06f16d283b17bbc54dc6918f630be91981331e89779a9c8929c959
d1c4a1da650f45bc1fdf372e6ce0a724ff8985d54a75118e1bbe58ed00e60e24
de86e0d6dd6fe2e402c5a025b1486665df5b4faf8184f1fceb42876fd37d1ddf
89cc369064edf6d164318400b316114d69638b209fc817a9459e850468381fac
30a3cf2fa4b42e308d6ef8fc2764f5031d79e42ba95c590e5069bc6c39ab54e7
41bead461cd129fcbf9c44d93325456817138b4c24cd2587a9e898907a05bfc7
0d3fc0fc957457fbee05c0726c0d63c7fbcec4a858a5eb6bbbdffcf6c66c9619
5d6a27252837ca2772db7d13d448be0e9ad5b7f20578372652bc99ae32db40f9
2a5cc0c75fcbef6ebdb0b28f03bbc6fe889713b2114ed0f057ba80930530d5e4
c4e552adcc7f8993a32e0fb0c8c1f86659551134398cec02476b3cafa9c600a3
d4b2c8dd26f8b6f01b8e573a2b8deca9b00b8721627d11f6bcd5031bae0023da
827a97aa9d739ae71182ff8e87152fb063d971a4cd11a149fd4e64ccc19b6ccd
31e1c1633c588d2a302f9957be1c23cca712306d0a88814537337203c302bace
ca4d134ed6e716ce0af40463eccecf9dae887a78c8d364ff07cc46bb37273f6a
51b6571320ea5307427f9003a18a40db12749aae473ac3cd798eb4f3442a5e02
fe7e6292be30f9a2cba8f4d37738c8d91cdaf27cc722bfb2a4cefdab5d68c0aa
9582447ca5433589bde3c61eae22c3fb0badbe0c742285e9ab888ba0578e255f
3906bf80a272cffbeea016c47e69fe69c68936c2b21e317e2bef4091a4711463
8bc9ad6a1b22a05c0a1b2340436dca385dffb17482e072276f61a76e8218dbbc
e2fd49c69566ce0457a3d03ac57facee9167c05e063206d37c0a1e5acc5db35f
f797bcc4552d0aa96908ce5b0a07b3820ee7ad33df88db64214301cde0389aec
cec75cb5df88f22b43f89a90fe8059cced9457b324559cd760b87c7cea90e642
91ddfa068c71894fc619064e5a56452a84fbbf83b048cbc749af18265c59aef0
5133628020d460e0826c829d02a62733cccb4c012c0e9504bf26372f53835254
13e8823588626437f8c16a551912b3f1fe923d6cb6cf47a61ba149ae043a9cca
d0b82317b270276fad9e751597eec5f9d837bbb773741a2c27a9628cedcf8c0d
5b59b42922794ffbfe98b080d031e86397e263a58c10ec143b24f896feb3c82f
6476c0095ca0545ed320a9fe9e91dce574cdfe56d372f0527c8887bf38abcb72
fcb964cafd1e844d7e2a68530f0d34ec87e922f67b6e2b7ec72be05f7d97eac3
c7fb3f253bf2083fca4a94da41363c4c574aad70b63c793d02622ae30beaaa9e
da8ce44954b0b13245313dd1c38b5e4e418ffa2c63021ff43ff2144ef335ee9c
535c37fd53ccfe2ca39857efd2ebe8045facc86301a1d48ae995e514f560916d
aa88f73a071bf34358ab31343a6b43524d43f29ac708ca18e9f0f268cac00cbb
15db3d81e060a3f1c36ab523301e048139971c1f952287d45662487d8cdb162f
fa8fca20fd1c6f96949540f2f8ed85a3bb0b0896571a2eb2ba32b35e92e2d8d6
3f2d95641a850efe9e6b13bb166a148a2f396f8707d74965961b0b7f6ff5632a
7eea219949dea11a9bdc5e28ab61c38ea93b220d7adf2abbe560cc7a72190b86
d0db10661b8e1ad2a4075e0ba3475be794f04d4f9df31f9cf41d8a0fb76e6d31
7b9cd893a5ce68cf8c57d4b28d4e6f0d4d25816948714b0d7390a824dfbea4fb
2786035e2b32b1ddefd41a8fbd60aab731ab8afe8082316db3c50d2d5204f93a
93a081b5704203c3755b8aabadae41c45e779ac2934af767f9c533e3f98a78f4
f4f575174494ff3b7c60eb2f2abd0d8cbda7ad5256c276f538e8c026d66b6c91
dd92367f6450698e237c9ace4e3234a91319c0c826dd5661d2b4af03a9c3ccae
0e144b35f0031ba8dfa19651caa884a9b4645e261432d23f41cc8a04b275b649
250318d18ab58a7e005f09032b028ed0c0c486a7f3bd3353be84b7c9556fca79
9f299579084cfadeae8b6824ab3b1e77bda04e19275e39bd906bfd30660f3fbf
92542c1f0a743b7090b1fbe272b358df90dfeef1a88aa4a64075741dae638c27
bc31444f572498cd020169e72ca9ed9c770a334162e441b72188987a42233756
988531d65202b4242661f2ab7533c62b2cb44f9e78c585886db475b1faebbb25
9915abeddb8419415f52ed54e49788e1e734f10d9e9a7f61d836af7df9f926f9
844d0beb24112ca61fd0c1a646c53418b5225dfa795955e257d403956c01223f
0090884e1ff77ba954449a42cadc974a435a3fb1d45ab3816aadf94bed07ee1e
0b2bfebde5ea597a75b67be7fbdf20f48553a27704e8e9a8604df0c5c19a92df
f4ecd98ff8398e44a9fc00aebd2e6a89cdba926319b15d97d1ad8b1f6cc2a7d5
d3eb05ae7c4864d5041fd75ac7d0ed62c460274e8c434bcc6820edb2111a2968
ef58d3d09eceb0ea66bdb1b4931835aac5baedaf22dfb77dcd68a0a862c459bf
1b47be8f2fef16e9b7005efdd1d4e3fd2208174e4efab81d43547fccad34344d
6dbb9610b3ab1ba5d2555496386c93671ed0f3fa55df330e53984444aa3c6a77
5036291d219b759453d5540f81afec830d4711cb741435bb1246a9046663bcbc
819badf6ca5421952b5ce28d7871d877f6e4dabb5fabb667aeaf7aff0c7d7095
1619f9898211da45012a0240d93aa06235489dc9c4be4badabefb8372c8f9e1e
79480937cdd1b18fe7a1f10965e2916dff744db5b2ad6b86cfac15c2e9d67753
2959a3d0c792f1cea71e823df82bf43ce7b5bfd6d0bb09619f6921673febca11
7670a9b2a26f1c8ce8cedc915b586e929346b4c553e032ae38a16e5d523e3fba
b5d3dc0cbcf94e82ace3b49e88365ef5c0f2ec2afcbc3ae7324c41d533185e8b
b4abc019a3e23d8ee90d099a778ed742d7383790de0dd3cc41357b04e3ef69a4
5bbeeb52cfca7424ddf904594dfbdb165cb0617900df8f8a2f5449b79b18c37b
91b3a29a81a012faa43460699662ae6832d2265ae6827a0ee29711dd118db31a
20b87ff876b39211312310de93fd6ae2e2f2b2dc5f8ad1e9cf967eac8a1129be
b01d48f59015531e1e8637d4587d24ed735503c005d8a246b4173992799c8d20
426cf9c510f92b81819d8faffc069ff63a91dd5fdf4033d1506c8d31d44118a8
d4b138bbac9fda926b3c8141627a5314c1bb586bc957aa92020251b325b5fc20
1a3c8210a1ebac7231bac905bc7c4ae833347a0b98f0eef976781bb7c9332fd0
e65a31cdfc43070ad83b49644d2dc760b8d0a24a280ab501b56626751e83af67
ae7970f15a3a45175777edcb731ef90986082a8c5f21342fc5d15a8d0ea3083f
b9de0172e52aff460af16c3382f27bb145af10ea64d388e2f35d6bffd7053425
1fdf84cb58f0e4ff651d866d278f04f896386eed1a02925e3f0ccc2019a01759
1c26cfd7430ac7c697cfe586e3cad128e455c4d7a3d2e128a66215ca4b0b0779
aa1e7807449db6ad685a05c186fc7419aaa97576a8e41d4ae55e60be96a8f7ef
2a93f63deab153451df5d0554806f1718046b1a69d8f9e52c701375eeec36c78
e358739b7f2ba0047658f8f77f0c774eda0eebe476ef2871513f226f32b110ab
16f18f78ad75f4068fbdf1fe3ab724fd5bac47b47aea95c6da0c565a7b5060da
b9ad3d2f62b2020a412be61acba4d03dca44ce9d9ed799c2ae7f7e8da812b4f3
cdb9aa2007cd564b6d8af7f20b97ae987a19ebbd3b71bbf839cf6bb250f58c18
f6c1e534ba0606cf695a8adafa93042962b75e80052cbddc447228db3ece1c5a
53ad6a11eaad9cc66f0eb5dcf9fc2cf490166d6e524a5902acb22324b7df7b0a
d2b7339f6f8728de757e17d81263a5804bc0f42b55fc6768077515b6cb367b17
2992a21cdf5fe15f6d35da394f25ffaba87baae0ee92a328e2f032c7f861bf54
8b21e4a36b29e132337a65948aa817c42cd9dfd0ec8101b9bb57b98c4245fa60
3ae32667ad74b3d102e8481c72b6cf4c6842bd14a0467d2c1ae5c6e249dc84e5
9b3752529f9cad6673f927fd8b4b217bb424d6eb46744f62b0d46479f22855b0
781ad6244ffe0c81ef39f5afd1265518037c48ab37c54f78a2acff2291d6cfc1
a055cd7adf0730b2f04b701faebdbdcf34c79cb2022bf96b6e2fcd6a7b04ae28
b306231afc426d59fbf48f09c0cdd192b2eda85b45be601ff9673ef97df7760c
0b432c52139a50229f3de338a570d04c78e9a0c1dddcbc6f1cba5de8bd29c5fa
7b1fbd48bee5d06af2e27996b9c440fe8de7b65146bd7b6c927f92c166a787c2
3a6578d173cbf0cdb30129c7c0481d9ee1834c437ec92f06b31ffe923c34fe24
2d618d47a844c9002a5060cabff2a023aaf48299a250873fc3c08ed7d555b498
8bc31966201d91b8c4bd2311f7b08543b63fff5a313f5a82656dbe32b5680dd7
48849cc1e3aa2b5ffb8a4b6cb435b46353f676164b427192d57efdb2e1a3cc1b
93c93e9a119feecde8c9670993407aceae3c0de83b7eb0eb4e2112cd34aadecc
a59e0c57a96d1d8f5292c890016720a6853bffcbe3c1b17af56df9ea19bd8a18
5d2a7129efd9255e134ac3d68044df6ad4cbd21d7f96385e65519dcf85cc0b6d
dbc857a098f48a7b88d818d863c801457a4b1fb1657cb93ab2e87806555fdd0c
7eabcd13287bd1c3b0f4cf44d528dd64c61415cdd472314cf0ce2f19cdf43bbc
3be66225d9a53152b7cc33ebe68e1f47939f46cba8bd05e769758c655116c02b
d5aac2909860607f0e8823832743876dd33f8a591c335d9f772642b3850cea75
6a1abe43ece2edd977421f4d87e64ae8a86bd646f4a03145aed8715f3dcfeac5
f12401d8112a3b422948a317dedce9dc06c3ac16f4e0ad76fc97ea3596c8ec75
c05a269abea78881a3161f00e403a37d270a7062e837f40ef8b0e20b7de7c371
4071e76046c361f006d707ef4efdc787ceeec7eb56dc2ea76f1dc718af0970c6
017e3e35e9719c6e741d0f9b62f6d713fd05539cfd6027bb88603100ee567b0c
9a062896572614f5915e0ebdda3adfa5204784e052408de88c822fb235758f43
b96c82a58d312f2316cf9bb5dfdb4b0b902824c69ad629fdcd3fae46496c1b46
8dad95f5ca59f98c89deb4078ac66b02f4f4157b8876d73257462a304c5ab75c
8825f2e31b1c63e854b196d22f843708f0da4512161caff2d8fdb27140c1cc17
59adfbf7c2debd1c3c74d78d58b0b8d647b6724ad9d987e47094f296519058fd
32b6648561b16bbd485bd1da61e33855cab7cc0716af146570c650b20cfbff77
c503c583e1766100a3d700d4b0d1d1b9a014f148869c3c7a6941cc9dad06465d
ecac084c1de75d48786ce7294d8dbe3bb3d50320c033f4813694c871ef76670f
dde06a502507810f7056f7aeb7dee753b6e7f5f8621149279d0bc69f7f02a999
0da266f8e48b3af247a001d94117c12b9ee9fbeb57b4441554567aadc9b5dfda
99fb6cdb77e294827b19af94b0524aff9d45b185c4b493a204ff3c9c51199eae
6601aa0cb249b1342ad9a47bfdc52a002060c89e20e7a18df7cb2d6d9b020ea8
9414dd340e0da4190869b75c9c31e97b365886943e0dbe6336930d36d02c0f1c
e29b245f8dcb203fc28d3f1729348f2c9caaeb1ead1771a90668f7909d7ce3e1
54d116899296c2ff0d87046be9149803520865d4deb1c8544d995d3cf5f94811
be17b7020a2d16242d0c6f1b3e28655a755f229d3e130ddb7944fdf317db4231
b07fe7abca3f89964f9934a1e19a5d687b7f0b771aef5e2aa93859ac2efd56dc
406f6b492a31416abde165a8af15027c60abf14de0b49291ea41a982fc2c841f
a99c589099df648df6e0f1a20ca9ec8ff96ffee0dd24fb356dc3b975d454c429
0c99081835bbcd010c7e1bc7d2c66437acca0df9b23c2d4a24a7380862f1479f
e6d986bafeb569861d729363d581465bddd16fffa170e9a0164563a5b425c5bd
56af2bec2dcf0c63445265163f5c345a232d5f1b5a214fa646b6fb8f103679ed
f2032b982fdc61b82c19869db0ad28b564b5aa94e1f763333c62c2ceb9a7be93
7d88a25ac054e6dd42d60dd9a6721d87cb762f1e68fcfd6fa458e2327d8a9a34
543e4de912c43fa27fdcb38c978d02009b408a4fc24e22c12a48123ecf7293bc
94709f987e03dba0c6a84091ef92ccf31e0c4fa3f2367316a93afcd8c22a2cb4
02afc652bd8505547fcea9ea0781d5faf9021995168f3e76fb66c65a4c93f3ae
0644d7218fb2805e7b280f940bc51522599a8ab8413fa757123e4a6f28df2978
2c12ba280db5b2b5aebc582edf2ace870af6ecd7f3ad2da55bb450a6851c5ec8
d7983052f77a6d43e3504ee0e8403f5637b60af2357bbea622e08df6dd220f02
31ed8067fae948e8176d87e2bf40e1da94371c5eba4c23f38bb52b6df28f922d
6b0a663c17f6145c805f8fe5f7532e837797f5cd56a4e23098e4bad01bfae9b2
7d214006c0da82dccda08b32942bd29f3bba7c7d6d53b27d38e24192957b98c2
36aa47f58c17ae5c29c7629c3ccc7a018024a4f500b585d8b0b09749fe17f116
e7946d78ae4c83ffe78ea0afe9342b9ea7c920a8118661ec0830531a3a464e4d
eb3997992b
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
cleartomark

%%EndFont 
TeXDict begin 40258431 52099146 1000 600 600 (meta-haskell.dvi)
@start /Fa 134[41 4[25 1[36 1[46 46 46 66 25 2[25 1[46
1[41 1[41 1[46 12[51 4[66 1[76 51 7[66 61 14[46 46 46
46 46 1[23 6[30 39[{TeXBase1Encoding ReEncodeFont}26
91.3242 /Times-Italic rf /Fb 174[52 81[{}1 99.6264 /CMITT10
rf /Fc 212[45 43[{}1 58.1154 /CMR10 rf /Fd 207[16 48[{}1
58.1154 /CMSY10 rf /Fe 166[43 43 1[43 43 37 33 40 1[33
43 43 53 37 43 1[20 2[33 37 1[40 40 43 65[{
TeXBase1Encoding ReEncodeFont}19 59.7758 /Times-Roman
rf /Ff 135[34 2[37 1[34 22 1[37 1[37 1[15 2[15 3[37 1[34
15[45 1[52 11[45 49 49 45 66[{TeXBase1Encoding ReEncodeFont}16
67.2474 /Helvetica rf /Fg 196[16 59[{}1 58.1154 /CMMI10
rf /Fh 133[23 1[26 4[23 4[29 11[29 29 13[29 4[39 10[39
36 66[{TeXBase1Encoding ReEncodeFont}10 58.1154 /Times-Italic
rf /Fj 162[21 1[21 29[58 19[29 29 40[{}5 74.7198 /CMR10
rf /Fk 134[44 44 1[44 50 28 39 39 50 50 50 50 72 28 2[28
50 50 28 44 50 44 1[50 12[55 50 61 1[61 2[83 55 2[33
2[61 61 72 66 9[50 50 50 50 50 50 50 50 50 50 28 25 33
1[67 40[50 2[{TeXBase1Encoding ReEncodeFont}47 99.6264
/Times-Italic rf /Fl 196[21 21 58[{}2 74.7198 /CMMI10
rf /Fm 129[35 35 35 35 35 35 35 35 35 35 35 35 35 35
35 35 35 35 35 35 1[35 35 35 35 35 35 35 35 35 1[35 1[35
35 35 35 2[35 35 1[35 35 1[35 35 35 35 35 35 2[35 35
35 35 35 35 35 35 35 35 1[35 35 35 35 35 4[35 35 35 35
35 35 1[35 35 35 35 1[35 35 35 1[35 35 1[35 34[{}75 66.4176
/CMTT8 rf /Fn 203[29 29 29 29 29 48[{TeXBase1Encoding ReEncodeFont}5
58.1154 /Times-Roman rf /Fo 139[33 45 43[45 71[{}3 74.7198
/Symbol rf /Fp 145[37 6[37 37 5[46 40[0 4[50 16[75 11[58
2[58 2[37 14[58{}11 74.7198 /CMSY10 rf /Fq 138[33 18
26 22 1[33 33 2[18 33 1[18 33 33 1[29 1[29 33 29 9[63
6[37 48 6[48 21[33 1[33 3[17 44[{TeXBase1Encoding ReEncodeFont}22
66.4176 /Times-Roman rf /Fr 134[37 1[54 1[42 25 29 33
42 42 37 42 62 21 42 1[21 42 37 25 33 1[33 1[37 12[50
42 10[58 1[46 18[37 37 37 2[19 25 45[{TeXBase1Encoding ReEncodeFont}29
74.7198 /Times-Bold rf /Fs 129[39 39 39 39 39 39 39 39
39 39 39 39 39 39 39 39 39 39 39 39 1[39 39 39 39 39
39 39 39 39 1[39 1[39 39 39 39 39 39 39 39 39 39 39 39
39 39 39 39 39 39 2[39 1[39 39 39 39 39 39 39 2[39 39
39 39 39 2[39 1[39 39 39 39 39 39 39 39 39 39 39 39 39
39 39 1[39 39 39 39 39 33[{}82 74.7198 /CMTT9 rf /Ft
105[37 27[29 33 33 50 33 37 21 29 29 37 37 37 37 54 21
33 21 21 37 37 21 33 37 33 37 37 9[62 1[54 42 37 2[46
54 50 62 42 1[33 25 54 54 46 46 1[50 46 46 7[37 37 37
1[37 1[37 37 37 37 2[25 19 50 1[25 25 25 8[25 27[37 2[{
TeXBase1Encoding ReEncodeFont}61 74.7198 /Times-Italic
rf /Fu 104[75 37 1[33 33 24[33 37 37 54 37 37 21 29 25
37 37 37 37 58 21 37 21 21 37 37 25 33 37 33 37 33 3[25
1[25 46 54 54 71 54 54 46 42 50 54 42 54 54 66 46 54
29 25 54 54 42 46 54 50 50 54 1[33 1[42 1[21 21 37 37
37 37 37 37 37 37 37 37 21 19 25 19 42 1[25 25 25 5[25
29[42 42 2[{TeXBase1Encoding ReEncodeFont}83 74.7198
/Times-Roman rf /Fv 134[50 50 72 50 55 33 39 44 55 55
50 55 83 28 55 33 28 55 50 33 44 55 44 55 50 9[100 2[66
55 72 78 1[78 1[94 66 78 1[39 78 78 61 1[72 72 66 72
1[50 5[50 50 50 50 50 50 50 50 50 50 2[33 25 40[55 55
2[{TeXBase1Encoding ReEncodeFont}57 99.6264 /Times-Bold
rf /Fw 134[37 2[37 1[21 37 25 2[42 42 1[17 2[17 42 42
21 42 42 37 1[42 11[54 1[50 54 2[58 1[62 42 2[21 54 58
1[50 30[50 38[{TeXBase1Encoding ReEncodeFont}27 74.7193
/Helvetica rf /Fx 134[45 3[50 25 45 30 1[50 50 50 75
2[20 20 50 50 25 50 50 45 1[50 12[55 60 2[60 5[45 9[91
17[25 46[{TeXBase1Encoding ReEncodeFont}24 89.6632 /Helvetica
rf /Fy 139[45 75 52 1[82 82 82 120 37 75 1[37 1[82 45
75 3[75 12[82 6[112 4[97 26[45 45[{TeXBase1Encoding ReEncodeFont}18
134.495 /Helvetica-Bold rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%BeginPaperSize: Letter
letter
%%EndPaperSize

%%EndSetup
%%Page: 1 1
1 0 bop 671 248 a Fy(T)-8 b(emplate)37 b(Meta-pr)m(ogramming)h(f)m(or)g
(Haskell)768 553 y Fx(Tim)24 b(Sheard)376 636 y Fw(OGI)d(School)e(of)h
(Science)g(&)g(Engineer)q(ing)405 719 y(Oregon)f(Health)f(&)j(Science)e
(Univ)n(ersity)588 835 y Fx(sheard@cse)o(.ogi.edu)2492
553 y(Simon)24 b(P)l(e)n(yton)g(Jones)2516 636 y Fw(Microsoft)c
(Research)g(Ltd)2421 752 y Fx(simonpj@microsoft.com)-150
1353 y Fv(Abstract)-150 1487 y Fu(W)-6 b(e)19 b(propose)i(a)f(ne)n(w)g
(e)o(xtension)h(to)f(the)f(purely)i(functional)f(programming)-150
1570 y(language)32 b(Hask)o(ell)g(that)f(supports)h Ft(compile-time)e
(meta-pr)m(o)o(gr)o(amming)p Fu(.)-150 1653 y(The)15
b(purpose)h(of)f(the)g(system)g(is)f(to)h(support)g(the)g
Ft(algorithmic)h Fu(construction)-150 1736 y(of)j(programs)h(at)e
(compile-time.)-150 1868 y(The)25 b(ability)g(to)h(generate)g(code)g
(at)f(compile)h(time)f(allo)n(ws)h(the)f(program-)-150
1951 y(mer)c(to)g(implement)g(such)g(features)g(as)g(polytypic)h
(programs,)g(macro-lik)o(e)-150 2034 y(e)o(xpansion,)33
b(user)d(directed)g(optimization)g(\(such)g(as)f(inlining\),)j(and)e
(the)-150 2117 y(generation)25 b(of)g(supporting)g(data)g(structures)g
(and)g(functions)g(from)f(e)o(xist-)-150 2200 y(ing)19
b(data)g(structures)h(and)f(functions.)-150 2333 y(Our)d(design)h(is)f
(being)i(implemented)f(in)f(the)h(Glasgo)n(w)f(Hask)o(ell)h(Compiler)m
(,)-150 2416 y Fs(ghc)p Fu(.)-150 2582 y Fv(Categories)25
b(and)g(Subject)i(Descriptors)-150 2715 y Fu(D.3.3)19
b([)p Fr(Softwar)o(e)p Fu(]:)j(Programming)e(Languages)-150
2881 y Fv(General)25 b(T)-9 b(erms)-150 3015 y Fu(Languages,)20
b(Design)-150 3181 y Fv(K)n(eyw)o(ords)-150 3314 y Fu(Meta)f
(programming,)h(templates)-150 3480 y Fv(1)99 b(Intr)n(oduction)16
3613 y Fu(\223Compile-time)18 b(program)g(optimizations)g(are)g
(similar)f(to)g(po-)16 3696 y(etry:)49 b(more)32 b(are)g(written)f
(than)i(are)e(actually)i(published)g(in)16 3779 y(commercial)e
(compilers.)59 b(Hard)31 b(economic)g(reality)g(is)f(that)16
3862 y(man)o(y)c(interesting)f(optimizations)g(ha)o(v)o(e)g(too)g
(narro)n(w)g(an)h(au-)16 3945 y(dience)33 b(to)g(justify)f(their)g
(cost...)63 b(An)32 b(alternati)n(v)o(e)h(is)f(to)g(al-)16
4028 y(lo)n(w)23 b(programmers)h(to)e(de\002ne)i(their)e(o)n(wn)h
(compile-time)g(op-)16 4111 y(timizations.)29 b(This)20
b(has)h(already)g(happened)i(accidentally)f(for)16 4194
y(C++,)29 b(albeit)e(imperfectly)-5 b(...)48 b([It)26
b(is])h(ob)o(vious)i(to)e(functional)16 4277 y(programmers)i(what)e
(the)h(committee)g(did)g(not)f(realize)h(until)16 4360
y(later:)i([C++])22 b(templates)h(are)g(a)f(functional)i(language)g(e)n
(v)n(alu-)16 4443 y(ated)19 b(at)g(compile)g(time...)-5
b(\224)22 b([12)q(].)-149 5383 y Fq(Hask)o(ell)d(W)-5
b(orkshop,)17 b(Oct)g(2002,)g(Pittsb)o(ur)o(gh)2049 1353
y Fu(Robinson')l(s)32 b(pro)o(v)o(ocati)n(v)o(e)g(paper)f(identi\002es)
g(C++)g(templates)g(as)g(a)g(ma-)2049 1436 y(jor)m(,)i(albeit)d
(accidental,)k(success)e(of)f(the)f(C++)h(language)h(design.)59
b(De-)2049 1519 y(spite)18 b(the)h(e)o(xtremely)g(baroque)h(nature)f
(of)g(template)f(meta-programming,)2049 1602 y(templates)37
b(are)g(used)g(in)g(f)o(ascinating)g(w)o(ays)g(that)g(e)o(xtend)g(be)o
(yond)i(the)2049 1685 y(wildest)18 b(dreams)h(of)g(the)f(language)i
(designers)g([1].)i(Perhaps)d(surprisingly)-5 b(,)2049
1768 y(in)28 b(vie)n(w)h(of)f(the)g(f)o(act)h(that)f(templates)h(are)f
(functional)h(programs,)i(func-)2049 1851 y(tional)19
b(programmers)g(ha)o(v)o(e)g(been)h(slo)n(w)e(to)h(capitalize)g(on)g
(C++')l(s)f(success;)2049 1934 y(while)31 b(there)h(has)g(been)h(a)e
(recent)h(\003urry)g(of)g(w)o(ork)g(on)g Ft(run-time)g
Fu(meta-)2049 2017 y(programming,)39 b(much)d(less)e(has)g(been)i(done)
f(on)g Ft(compile-time)f Fu(meta-)2049 2100 y(programming.)41
b(The)24 b(Scheme)h(community)g(is)f(a)g(notable)h(e)o(xception,)i(as)
2049 2183 y(we)19 b(discuss)g(in)g(Section)g(10.)2049
2327 y(In)28 b(this)f(paper)m(,)j(therefore,)g(we)d(present)h(the)g
(design)g(of)g(a)g(compile-time)2049 2410 y(meta-programming)23
b(e)o(xtension)f(of)f(Hask)o(ell,)h(a)f(strongly-typed,)i(purely-)2049
2493 y(functional)f(language.)32 b(The)22 b(purpose)g(of)g(the)f(e)o
(xtension)i(is)e(to)g(allo)n(w)h(pro-)2049 2576 y(grammers)d(to)f
Ft(compute)h Fu(some)f(parts)h(of)f(their)g(program)h(rather)f(than)g
Ft(write)2049 2659 y Fu(them,)h(and)h(to)f(do)g(so)g(seamlessly)h(and)g
(con)m(v)o(eniently)-5 b(.)25 b(The)19 b(e)o(xtension)h(can)2049
2742 y(be)d(vie)n(wed)h(both)g(as)f(a)g(template)g(system)h(for)f(Hask)
o(ell)g(\()6 b Ft(\036)-31 b(a)17 b(la)g Fu(C++\),)g(as)g(well)2049
2825 y(as)h(a)g(type-safe)h(macro)g(system.)k(W)-6 b(e)18
b(mak)o(e)h(the)f(follo)n(wing)h(ne)n(w)g(contrib)o(u-)2049
2908 y(tions:)2136 3078 y Fp(\017)42 b Fu(W)-6 b(e)16
b(describe)i(ho)n(w)f(a)g(quasi-quotation)i(mechanism)f(for)e(a)h
(language)2215 3161 y(with)23 b(binders)i(can)f(be)g(precisely)h
(described)g(by)f(a)g(translation)g(into)2215 3244 y(a)29
b(monadic)h(computation.)54 b(This)29 b(allo)n(ws)g(the)g(use)g(of)g(a)
g(gensym-)2215 3327 y(lik)o(e)16 b(operator)h(e)n(v)o(en)g(in)f(a)g
(purely)h(functional)g(language)g(lik)o(e)f(Hask)o(ell)2215
3410 y(\(Sections)j(6.1)g(and)g(9\).)2136 3530 y Fp(\017)42
b Fu(A)27 b(staged)h(type-checking)h(algorithm)f(co-routines)g(between)
g(type)2215 3613 y(checking)17 b(and)f(compile-time)g(computations.)24
b(This)15 b(staging)h(is)g(use-)2215 3696 y(ful,)26 b(because)h(it)e
(supports)h(code)g(generators,)i(which)d(if)g(written)g(as)2215
3779 y(ordinary)e(programs,)h(w)o(ould)g(need)f(to)f(be)h(gi)n(v)o(en)g
(dependent)i(types.)2215 3862 y(The)h(language)i(is)e(therefore)h(e)o
(xpressi)n(v)o(e)g(and)g(simple)f(\(no)h(depen-)2215
3945 y(dent)15 b(types\),)h(b)o(ut)f(still)e(secure,)j(because)g(all)e
(run-time)h(computations)2215 4028 y(\(either)30 b(hand-written)h(or)g
(computed\))h(are)e(al)o(w)o(ays)h(type-check)o(ed)2215
4111 y(before)20 b(the)o(y)f(are)g(e)o(x)o(ecuted)h(\(Section)e(7\).)
2136 4232 y Fp(\017)42 b Fu(Rei\002cation)23 b(of)h(programmer)o
(-written)f(components)j(is)d(supported,)2215 4315 y(so)f(that)g
(computed)h(parts)f(of)g(the)g(program)h(can)f(analyze)h(the)f(struc-)
2215 4398 y(ture)17 b(of)h(user)o(-written)e(parts.)23
b(This)17 b(is)g(particularly)g(useful)h(for)f(b)o(uild-)2215
4481 y(ing)34 b(\223boilerplate\224)g(code)g(deri)n(v)o(ed)g(from)g
(data)f(type)h(declarations)2215 4564 y(\(Sections)k(5)19
b(and)38 b(8.1\).)2049 4733 y(In)16 b(addition)h(to)f(these)g(original)
h(contrib)o(utions,)g(we)f(ha)o(v)o(e)g(synthesized)i(pre-)2049
4816 y(vious)26 b(w)o(ork)f(into)g(a)g(coherent)h(system)f(that)g(pro)o
(vides)h(ne)n(w)f(capabilities.)2049 4899 y(These)19
b(include)2136 5068 y Fp(\017)42 b Fu(The)21 b(representation)h(of)f
(code)h(by)g(an)f(ordinary)h(algebraic)g(datatype)2215
5151 y(mak)o(es)29 b(it)e(possible)i(use)g(Hask)o(ell')l(s)f(e)o
(xisting)g(mechanisms)h(\()p Fs(case)2215 5234 y Fu(analysis\))f(to)g
(observ)o(e)g(the)g(structure)g(of)g(code,)i(thereby)e(allo)n(wing)2215
5317 y(the)17 b(programmer)g(to)g(write)f(code)h Ft(manipulation)h
Fu(programs,)g(as)e(well)2215 5400 y(as)j(code)h Ft(g)o(ener)o(ation)g
Fu(programs)g(\(Sections)f(6.2)g(and)h(9.3\).)1931 5649
y(1)p eop
%%Page: 2 2
2 1 bop -63 83 a Fp(\017)42 b Fu(This)27 b(is)h(augmented)h(by)f(a)g
(quotation)h(monad,)i(that)c(encapsulates)16 166 y(meta-programming)k
(features)f(such)h(as)f(fresh)g(name)g(generation,)16
249 y(program)18 b(rei\002cation,)f(and)h(error)f(reporting.)23
b(A)17 b(monadic)i(library)e(of)16 332 y Ft(syntax)i(oper)o(ator)o(s)h
Fu(is)e(b)o(uilt)g(on)h(top)g(of)f(the)h(algebraic)g(datatypes)g(and)16
415 y(the)24 b(quotation)i(monad.)40 b(It)24 b(pro)o(vides)h(an)g
(easy-to-use)g(interf)o(ace)g(to)16 498 y(the)18 b(meta-programming)h
(parts)f(of)g(the)g(system)g(\(Sections)f(4,)h(6,)g(6.3,)16
581 y(and)i(Section)e(8\).)-63 702 y Fp(\017)42 b Fu(A)26
b(quasi-quote)h(mechanism)h(is)d(b)o(uilt)h(on)h(top)f(of)g(the)g
(monadic)i(li-)16 785 y(brary)-5 b(.)30 b(T)-5 b(emplate)21
b(Hask)o(ell)g(e)o(xtends)h(the)f(meta-le)n(v)o(el)h(operations)g(of)16
868 y(static)28 b(scoping)i(and)f(static)f(type-checking)j(into)e(the)f
(object-le)n(v)o(el)16 951 y(code)f(fragments)f(b)o(uilt)g(using)g(its)
g(quasi-quote)h(mechanism)g(\(Sec-)16 1034 y(tions)20
b(9)h(and)g(7.1\).)27 b(Static)19 b(scoping)j(and)f(type-checking)h(do)
f(not)g(au-)16 1117 y(tomatically)d(e)o(xtend)g(to)g(code)h(fragments)f
(b)o(uilt)f(using)h(the)g(algebraic)16 1200 y(datatype)f
(representation;)g(the)o(y)f(w)o(ould)h(ha)o(v)o(e)e(to)h(be)g
(\223programmed\224)16 1283 y(by)j(the)g(user)h(\(Sections)e(9)h(and)h
(9.3\).)-63 1403 y Fp(\017)42 b Fu(The)30 b(rei\002cation)f(f)o
(acilities)g(of)h(the)g(quotation)g(monad)h(allo)n(ws)f(the)16
1486 y(programmer)25 b(\(at)f(compile-time\))h(to)f(query)h(the)f
(compiler')l(s)h(inter)o(-)16 1569 y(nal)19 b(data)g(structures,)g
(asking)g(questions)h(such)f(as)g(\223What)g(is)f(the)h(line)16
1652 y(number)h(in)f(the)g(source-\002le)h(of)f(the)g(current)h
(position?\224)k(\(useful)c(for)16 1735 y(error)26 b(reporting\),)j(or)
e(\223What)f(is)g(the)g(kind)h(of)g(this)f(type)h(construc-)16
1818 y(tor?\224)d(\(Section)18 b(8.2\).)-63 1939 y Fp(\017)42
b Fu(A)17 b(meta-program)i(can)f(produce)h Ft(a)f(gr)m(oup)h(of)e
(declar)o(ations)p Fu(,)i(includ-)16 2022 y(ing)29 b(data)g(type,)j
(class,)f(or)d(instance)i(declarations,)i(as)c(well)h(as)f(an)16
2105 y Ft(e)o(xpr)m(ession)20 b Fu(\(Section)f(5.1\).)-150
2276 y Fv(2)99 b(The)26 b(basic)f(idea)-150 2410 y Fu(W)-6
b(e)29 b(be)o(gin)i(with)e(an)h(e)o(xample)g(to)g(illustrate)f(what)h
(we)f(mean)i(by)f(meta-)-150 2493 y(programming.)89 b(Consider)41
b(writing)f(a)g(C-lik)o(e)g Fs(printf)i Fu(function)f(in)-150
2576 y(Hask)o(ell.)23 b(W)-6 b(e)19 b(w)o(ould)h(lik)o(e)f(to)f(write)h
(something)h(lik)o(e:)-72 2709 y Fs(printf)41 b("Error:)g(\045s)f(on)f
(line)h(\045d.")h(msg)e(line)-150 2842 y Fu(One)24 b(cannot)g(de\002ne)
g Fs(printf)g Fu(in)f(Hask)o(ell,)i(because)f Fs(printf)p
Fu(')l(s)h(type)f(de-)-150 2925 y(pends,)d(in)f(a)g(complicated)h(w)o
(ay)-5 b(,)21 b(on)g(the)f(v)n(alue)h(of)f(its)f(\002rst)g(ar)o(gument)
i(\(b)o(ut)-150 3008 y(see)h([5])f(for)h(an)g(ingenious)h(alternati)n
(v)o(e\).)31 b(In)21 b(T)-5 b(emplate)22 b(Hask)o(ell,)g(though,)-150
3091 y(we)g(can)g(de\002ne)g Fs(printf)g Fu(so)g(that)g(it)f(is)g
Ft(type-safe)h Fu(\(i.e.)31 b(report)22 b(an)f(error)h(at)-150
3174 y(compile-time)k(if)e Fs(msg)i Fu(and)g Fs(line)g
Fu(do)g(not)g(ha)o(v)o(e)f(type)h Fs(String)g Fu(and)g
Fs(Int)-150 3257 y Fu(respecti)n(v)o(ely\),)g Ft(ef)o(\002cient)g
Fu(\(the)f(control)g(string)g(is)f(interpreted)h(at)f(compile)-150
3341 y(time\),)e(and)g Ft(user)o(-de\002nable)h Fu(\(no)f(\002x)o(ed)g
(number)h(of)f(compiler)g(e)o(xtensions)-150 3424 y(will)j(e)n(v)o(er)h
(be)h(enough\).)46 b(Here)26 b(is)f(ho)n(w)i(we)f(write)f(the)h(call)g
(in)g(T)-5 b(emplate)-150 3507 y(Hask)o(ell:)-72 3640
y Fs($\(printf)42 b("Error:)e(\045s)g(on)g(line)g(\045d"\))g(msg)g
(line)-150 3773 y Fu(The)17 b(\223)p Fs($)p Fu(\224)h(says)g(\223e)n(v)
n(aluate)h(at)e(compile)h(time\224;)g(the)f(call)g(to)h
Fs(printf)h Fu(returns)-150 3856 y(a)h(Hask)o(ell)f(e)o(xpression)i
(that)f(is)f(spliced)h(in)g(place)g(of)f(the)h(call,)f(after)g(which)
-150 3939 y(compilation)k(of)g(the)g(original)f(e)o(xpression)i(can)f
(proceed.)36 b(W)-6 b(e)22 b(will)f(often)-150 4022 y(use)26
b(the)g(term)f(\223splice\224)h(for)g Fs($)672 3995 y
Fn(1)705 4022 y Fu(.)43 b(The)25 b(splice)h Fs($\(printf)41
b(...\))27 b Fu(returns)-150 4105 y(the)19 b(follo)n(wing)g(code:)-72
4239 y Fs(\(\\)40 b(s0)g(->)g(\\)f(n1)h(->)46 4322 y("Error:)h(")e(++)h
(s0)g(++)f(")h(on)g(line)g(")f(++)h(show)g(n1\))-150
4455 y Fu(This)27 b(lambda)g(abstraction)h(is)e(then)i(type-check)o(ed)
h(and)f(applied)f(to)g Fs(msg)-150 4538 y Fu(and)20 b
Fs(line)p Fu(.)j(Here)c(is)g(an)g(e)o(xample)h(interacti)n(v)o(e)f
(session)g(to)g(illustrate:)-79 4684 y Fm(prompt>)37
b($\(printf)g("Error:)h(\045s)e(at)f(line)i(\045d"\))f("Bad)h(var")f
(123)-9 4759 y(::)g([Char])-9 4833 y("Error:)h(Bad)g(var)f(at)g(line)g
(123")p -150 4897 801 4 v -49 4958 a Fn(1)-16 4985 y
Fu(Note)f(that)f(in)g(T)-5 b(emplate)34 b(Hask)o(ell)h(that)f
Fs($)g Fu(follo)n(wed)h(by)g(an)g(open)-150 5068 y(parenthesis)27
b(or)f(an)g(alphabetic)h(character)f(is)g(a)g(special)g(syntactic)g
(form.)-150 5151 y(So)21 b Fs(x)40 b($y)21 b Fu(means)i(\223)p
Fs(x)e Fu(applied)i(to)e(splice)h Fs(y)p Fu(\224,)g(whereas)g
Fs(x)39 b($)h(y)21 b Fu(means)i(the)-150 5234 y(ordinary)i(in\002x)f
(application)g(of)g(the)g(function)h Fs($)f Fu(just)g(as)g(it)f(does)i
(in)f(ordi-)-150 5317 y(nary)17 b(Hask)o(ell.)23 b(The)16
b(situation)h(is)f(v)o(ery)h(similar)f(to)g(that)h(of)f(\223)p
Fs(.)p Fu(\224,)h(where)g Fs(A.b)-150 5400 y Fu(means)j(something)g
(dif)n(ferent)f(from)g Fs(A)39 b(.)h(b)p Fu(.)2049 83
y(The)21 b(function)h Fs(printf)p Fu(,)h(which)f(is)e(e)o(x)o(ecuted)j
(at)e(compile)g(time,)g(is)g(a)h(pro-)2049 166 y(gram)d(that)f
(produces)i(a)e(program)i(as)e(its)g(result:)23 b(it)17
b(is)h(a)h Ft(meta-pr)m(o)o(gr)o(am)p Fu(.)24 b(In)2049
249 y(T)-5 b(emplate)19 b(Hask)o(ell)g(the)g(user)g(can)g(de\002ne)h
Fs(printf)g Fu(thus:)2127 373 y Fs(printf)41 b(::)f(String)g(->)g(Expr)
2127 456 y(printf)h(s)f(=)f(gen)h(\(parse)g(s\))2049
581 y Fu(The)26 b(type)g(of)f Fs(printf)i Fu(says)f(that)g(it)e
(transforms)i(a)g(format)g(string)f(into)h(a)2049 664
y(Hask)o(ell)i(e)o(xpression,)j(of)c(type)h Fs(Expr)p
Fu(.)50 b(The)27 b(auxiliary)h(function)h Fs(parse)2049
747 y Fu(breaks)18 b(up)f(the)g(format)g(string)g(into)g(a)f(more)i
(tractable)f(list)f(of)g(format)h(spec-)2049 830 y(i\002ers:)2127
954 y Fs(data)41 b(Format)f(=)g(D)f(|)h(S)f(|)g(L)h(String)2127
1037 y(parse)h(::)f(String)g(->)g([Format])2049 1161
y Fu(F)o(or)18 b(e)o(xample,)2163 1295 y Fs(parse)40
b("\045d)g(is)g(\045s")150 b Ft(r)o(e)n(t)5 b(ur)r(ns)150
b Fs([D,)40 b(L)f(")h(is)f(",)h(S])2049 1429 y Fu(Ev)o(en)27
b(though)h Fs(parse)g Fu(is)f(e)o(x)o(ecuted)h(at)e(compile)i(time,)g
(it)e(is)h(a)f(perfectly)2049 1512 y(ordinary)j(Hask)o(ell)g(function;)
k(we)c(lea)o(v)o(e)f(its)f(de\002nition)i(as)f(an)h(e)o(x)o(ercise.)
2049 1595 y(The)21 b(function)i Fs(gen)e Fu(is)g(much)i(more)e
(interesting.)31 b(W)-6 b(e)21 b(\002rst)g(gi)n(v)o(e)g(the)h(code)2049
1678 y(for)d Fs(gen)g Fu(assuming)h(e)o(xactly)f(one)h(format)f
(speci\002er:)2127 1802 y Fs(gen)40 b(::)g([Format])h(->)f(Expr)2127
1885 y(gen)g([D])119 b(=)39 b([|)h(\\n)g(->)f(show)h(n)g(|])2127
1968 y(gen)g([S])119 b(=)39 b([|)h(\\s)g(->)f(s)h(|])2127
2051 y(gen)g([L)g(s])g(=)f(lift)h(s)2049 2176 y Fu(The)35
b(results)g(of)g Fs(gen)h Fu(are)f(constructed)i(using)e(the)h
Ft(quasi-quote)g Fu(nota-)2049 2259 y(tion)e(\227)f(the)h
(\223templates\224)h(of)f(T)-5 b(emplate)33 b(Hask)o(ell.)68
b(Quasi-quotations)2049 2342 y(are)40 b(the)f(user')l(s)h(interf)o(ace)
g(to)f(representing)i(Hask)o(ell)f(programs,)45 b(and)2049
2425 y(are)28 b(constructed)g(by)h(placing)f(quasi-quote)h(brack)o(ets)
g Fs([|)39 b(_)h(|])28 b Fu(around)2049 2508 y(ordinary)54
b(Hask)o(ell)f(concrete)h(syntax)g(fragments.)126 b(The)53
b(function)2049 2591 y Fs(lift)40 b(::)g(String)g(->)g(Expr)15
b Fu(\223lifts\224)f(a)h(string)f(into)h(the)g Fs(Expr)g
Fu(type,)h(pro-)2049 2674 y(ducing)24 b(an)e Fs(Expr)i
Fu(which,)f(if)f(e)o(x)o(ecuted,)i(w)o(ould)f(e)n(v)n(aluate)h(to)e
Fs(lifts)p Fu(')l(s)i(ar)o(-)2049 2757 y(gument.)g(W)-6
b(e)18 b(ha)o(v)o(e)i(more)f(to)g(say)g(about)h Fs(lift)f
Fu(in)g(Section)g(9.1)2049 2881 y(Matters)e(become)g(more)g
(interesting)g(when)h(we)e(w)o(ant)h(to)g(mak)o(e)g Fs(gen)g
Fu(recur)o(-)2049 2964 y(si)n(v)o(e,)g(so)h(that)f(it)f(can)i(deal)f
(with)g(an)g(arbitrary)g(list)f(of)h(format)h(speci\002ers.)k(T)-6
b(o)2049 3047 y(do)20 b(so,)f(we)h(ha)o(v)o(e)f(to)h(gi)n(v)o(e)f(it)g
(an)h(auxiliary)g(parameter)m(,)f(namely)i(an)e(e)o(xpres-)2049
3130 y(sion)e(representing)g(the)f(string)h(to)f(pre\002x)g(to)h(the)f
(result,)g(and)h(adjust)g(the)f(call)2049 3213 y(in)j
Fs(printf)h Fu(accordingly:)2049 3346 y Fm(printf)37
b(::)f(String)h(->)f(Expr)2049 3421 y(printf)h(s)f(=)f(gen)h(\(parse)h
(s\))f([|)g("")g(|])2049 3570 y(gen)g(::)g([Format])i(->)d(Expr)i(->)f
(Expr)2049 3645 y(gen)g([])318 b(x)36 b(=)f(x)2049 3720
y(gen)h(\(D)107 b(:)35 b(xs\))h(x)g(=)f([|)h(\\n->)h($\(gen)f(xs)g([|)g
($x++show)i(n)d(|]\))h(|])2049 3794 y(gen)g(\(S)107 b(:)35
b(xs\))h(x)g(=)f([|)h(\\s->)h($\(gen)f(xs)g([|)g($x++s)h(|]\))f(|])2049
3869 y(gen)g(\(L)g(s)g(:)f(xs\))h(x)g(=)f(gen)i(xs)e([|)h($x)g(++)g
($\(lift)h(s\))f(|])2049 4011 y Fu(Inside)30 b(quotations,)j(the)c
(splice)h(annotation)h(\()p Fs($)p Fu(\))e(still)f(means)j(\223e)n(v)n
(aluate)2049 4094 y(when)c(the)f(quasi-quoted)h(code)g(is)f
(constructed\224;)k(that)c(is,)h(when)g Fs(gen)f Fu(is)2049
4177 y(called.)d(The)18 b(recursi)n(v)o(e)g(calls)f(to)h
Fs(gen)g Fu(are)g(therefore)g(run)g(at)f(compile)h(time,)2049
4260 y(and)g(the)g(result)g(is)f(spliced)h(into)g(the)g(enclosing)g
(quasi-quoted)i(e)o(xpression.)2049 4343 y(The)f(ar)o(gument)g(of)g
Fs($)g Fu(should,)h(as)f(before,)g(be)g(of)g(type)g Fs(Expr)p
Fu(.)2049 4467 y(The)h(second)h(ar)o(gument)f(to)f(the)h(recursi)n(v)o
(e)g(call)g(to)f Fs(gen)h Fu(\(its)f(accumulating)2049
4550 y(parameter\))k(is)f(of)h(type)g Fs(Expr)p Fu(,)h(and)f(hence)h
(is)e(another)h(quasi-quoted)i(e)o(x-)2049 4633 y(pression.)41
b(Notice)24 b(the)h(ar)o(guments)g(to)g(the)f(recursi)n(v)o(e)h(calls)g
(to)f Fs(gen)h Fu(refer)2049 4716 y(to)e(object-v)n(ariables)h(\()p
Fs(n)p Fu(,)g(and)g Fs(s)p Fu(\),)f(bound)i(in)e(outer)g(quasi-quotes.)
38 b(These)2049 4799 y(occurrences)20 b(are)f(within)g(the)f(static)h
(scope)g(of)g(their)g(binding)h(occurrence:)2049 4882
y(static)e(scoping)j(e)o(xtends)e(across)h(the)f(template)g(mechanism.)
2049 5026 y Fv(3)99 b(Wh)o(y)25 b(templates?)2049 5151
y Fu(W)-6 b(e)20 b(write)h(programs)g(in)g(high-le)n(v)o(el)h
(languages)g(because)g(the)o(y)g(mak)o(e)f(our)2049 5234
y(programs)k(shorter)e(and)i(more)f(concise,)h(easier)e(to)h(maintain,)
h(and)f(easier)2049 5317 y(to)29 b(think)g(about.)54
b(Man)o(y)30 b(lo)n(w)f(le)n(v)o(el)g(details)g(\(such)g(as)g(data)h
(layout)f(and)2049 5400 y(memory)h(allocation\))f(are)g(abstracted)h(o)
o(v)o(er)f(by)g(the)g(compiler)m(,)j(and)e(the)1931 5649
y(2)p eop
%%Page: 3 3
3 2 bop -150 83 a Fu(programmer)19 b(no)e(longer)i(concerns)f(himself)g
(with)f(these)g(details.)23 b(Most)18 b(of)-150 166 y(the)24
b(time)g(this)f(is)h(good,)i(since)e(e)o(xpert)g(kno)n(wledge)i(has)e
(been)h(embedded)-150 249 y(into)18 b(the)g(compiler)m(,)h(and)f(the)g
(compiler)h(does)g(the)f(job)g(in)g(manner)h(superior)-150
332 y(to)i(what)g(most)f(users)i(could)f(manage.)30 b(But)21
b(sometimes)g(the)g(programmer)-150 415 y(kno)n(ws)j(more)g(about)g
(some)g(particular)f(details)g(than)h(the)g(compiler)f(does.)-150
498 y(It')l(s)14 b(not)h(that)g(the)g(compiler)g(couldn')o(t)g(deal)g
(with)f(these)i(details,)f(b)o(ut)f(that)h(for)-150 581
y(economic)j(reasons)f(it)e(just)h(doesn')o(t)h([12)q(].)k(There)c(is)f
(a)g(limit)f(to)h(the)h(number)-150 664 y(of)j(features)g(an)o(y)h
(compiler)f(writer)g(can)g(put)h(into)f(an)o(y)g(one)h(compiler)l(.)27
b(The)-150 747 y(solution)20 b(is)f(to)h(construct)g(the)f(compiler)h
(in)g(a)f(manner)i(in)e(which)h(ordinary)-150 830 y(users)f(can)h
(teach)f(it)f(ne)n(w)h(tricks.)-150 984 y(This)j(is)h(the)g(rationale)g
(behind)h(T)-5 b(emplate)22 b(Hask)o(ell:)31 b(to)23
b(mak)o(e)g(it)g(easy)g(for)-150 1067 y(programmers)16
b(to)e(teach)h(the)g(compiler)g(a)f(certain)h(class)f(of)h(tricks.)21
b(What)14 b(do)-150 1150 y(compilers)j(do?)23 b(The)o(y)17
b(manipulate)h(programs!)23 b(Making)18 b(it)e(easy)h(for)f(users)-150
1233 y(to)23 b(manipulate)i(their)e(o)n(wn)h(programs,)h(and)f(also)f
(easy)h(to)g(interlace)f(their)-150 1316 y(manipulations)f(with)f(the)g
(compiler')l(s)h(manipulations,)g(creates)g(a)f(po)n(wer)o(-)-150
1399 y(ful)e(ne)n(w)g(tool.)-150 1552 y(W)-6 b(e)18 b(en)m(vision)h
(that)f(T)-5 b(emplate)19 b(Hask)o(ell)f(will)g(be)g(used)h(by)g
(programmers)h(to)-150 1635 y(do)f(man)o(y)h(things.)-63
1789 y Fp(\017)42 b Ft(Conditional)25 b(compilation)g
Fu(is)f(e)o(xtremely)g(useful)h(for)f(compiling)h(a)16
1872 y(single)i(program)g(for)f(dif)n(ferent)g(platforms,)i(or)e(with)g
(dif)n(ferent)h(de-)16 1955 y(b)o(ugging)h(options,)h(or)d(with)g(a)h
(dif)n(ferent)g(con\002guration.)47 b(A)26 b(crude)16
2038 y(approach)f(is)d(to)h(use)g(a)g(preprocessor)i(lik)o(e)e
Fs(cpp)g Fu(\227)f(indeed)i(se)n(v)o(eral)16 2121 y(compilers)k(for)f
(Hask)o(ell)h(support)g(this)f(directly)g(\227)g(b)o(ut)g(a)g(mecha-)16
2204 y(nism)g(that)g(is)g(part)g(of)h(the)f(programming)h(language)h(w)
o(ould)f(w)o(ork)16 2287 y(much)20 b(better)l(.)-63 2407
y Fp(\017)42 b Ft(Pr)m(o)o(gr)o(am)33 b(r)m(ei\002cation)h
Fu(enables)f(programs)h(to)e(inspect)h(their)f(o)n(wn)16
2490 y(structure.)27 b(F)o(or)19 b(e)o(xample,)i(generate)g(a)f
(function)h(to)f(serialise)g(a)g(data)16 2573 y(structure,)e(based)g
(on)g(the)f(data)h(type)f(declaration)h(for)g(that)f(structure.)-63
2694 y Fp(\017)42 b Ft(Algorithmic)23 b(pr)m(o)o(gr)o(am)h
(construction)g Fu(allo)n(ws)f(the)g(programmer)h(to)16
2777 y(construct)29 b(programs)h(where)e(the)h(algorithm)g(that)f
(describes)h(ho)n(w)16 2860 y(to)e(construct)h(the)f(program)i(is)e
(simpler)g(than)g(the)h(program)g(itself.)16 2943 y(Generic)f
(functions)i(lik)o(e)e Fs(map)g Fu(or)h Fs(show)g Fu(are)f(prime)g(e)o
(xamples,)j(as)16 3026 y(are)g(compile-time)h(specialized)g(programs)g
(lik)o(e)g Fs(printf)p Fu(,)i(where)16 3109 y(the)19
b(code)h(compiled)g(is)e(specialized)i(to)f(compile-time)g(constants.)
-63 3229 y Fp(\017)42 b Ft(Abstr)o(actions)27 b(that)g(tr)o(anscend)h
(the)e(abstr)o(action)i(mec)o(hanisms)g(ac-)16 3312 y(cessible)44
b(in)g(the)g(langua)o(g)o(e)p Fu(.)99 b(Examples)45 b(include:)73
b(introduc-)16 3395 y(ing)39 b(higher)o(-order)g(operators)g(in)g(a)f
(\002rst-order)g(language)i(using)16 3478 y(compile-time)21
b(macros;)h(or)f(implementing)h(inte)o(ger)e(inde)o(x)o(ed)i(func-)16
3561 y(tions)17 b(\(lik)o(e)g Fs(zip1)p Fu(,)h Fs(zip2)p
Fu(,)g(...)k Fs(zip)p Ft(n)p Fu(\))c(in)f(a)g(strongly)h(typed)g
(language.)-63 3682 y Fp(\017)42 b Ft(Optimizations)22
b Fu(may)g(teach)g(the)g(compiler)g(about)h(domain-speci\002c)16
3765 y(optimizations,)h(such)f(as)g(algebraic)g(la)o(ws,)g(and)h
(in-lining)f(opportu-)16 3848 y(nities.)-150 4001 y(In)31
b(T)-5 b(emplate)31 b(Hask)o(ell,)j(functions)e(that)f(e)o(x)o(ecute)h
(at)e(compile)i(time)f(are)-150 4084 y(written)21 b(in)g(the)h(same)f
(language)i(as)f(functions)g(that)f(e)o(x)o(ecute)i(at)e(run)g(time,)
-150 4167 y(namely)j(Hask)o(ell.)35 b(This)22 b(choice)i(is)e(in)h
(sharp)g(contrast)g(with)g(man)o(y)g(e)o(xist-)-150 4250
y(ing)17 b(systems;)h(for)f(e)o(xample,)h Fs(cpp)g Fu(has)f(its)g(o)n
(wn)g(language)i(\()p Fs(#if)p Fu(,)e Fs(#define)-150
4333 y Fu(etc.\),)29 b(and)g(template)f(meta-programs)h(in)f(C++)g(are)
g(written)g(entirely)g(in)-150 4416 y(the)c(type)g(system.)37
b(A)24 b(big)g(adv)n(antage)h(of)f(our)g(approach)h(is)e(that)g(e)o
(xisting)-150 4499 y(libraries)g(and)i(programming)g(skills)f(can)g(be)
g(used)h(directly;)h(ar)o(guably)-5 b(,)26 b(a)-150 4582
y(disadv)n(antage)18 b(is)d(that)g(e)o(xplicit)g(annotations)i(\(\223)p
Fs($)p Fu(\224)f(and)g(\223)p Fs([|)40 b(|])p Fu(\224\))16
b(are)f(nec-)-150 4665 y(essary)20 b(to)f(specify)h(which)g(bits)f(of)g
(code)h(should)g(e)o(x)o(ecute)g(when.)25 b(Another)-150
4748 y(consequence)f(is)d(that)h(the)f(programmer)i(may)f(erroneously)h
(write)e(a)g(non-)-150 4831 y(terminating)d(function)h(that)e(e)o(x)o
(ecutes)i(at)f(compile)g(time.)k(In)c(that)g(case,)g(the)-150
4914 y(compiler)27 b(will)f(f)o(ail)g(to)h(terminate;)j(we)d(re)o(gard)
f(that)h(as)g(a)f(programming)-150 4997 y(error)19 b(that)g(is)f(no)i
(more)f(a)o(v)o(oidable)g(than)g(di)n(v)o(er)o(gence)h(at)f(run)g
(time.)-150 5151 y(In)24 b(the)h(rest)e(of)i(the)f(paper)h(we)f
(\003esh)g(out)h(the)f(details)g(of)g(our)h(design.)40
b(As)-150 5234 y(we)24 b(shall)g(see)h(in)f(the)h(follo)n(wing)f
(sections,)i(it)e(turns)h(out)f(that)g(the)h(simple)-150
5317 y(quasi-quote)30 b(and)g(splice)f(notation)g(we)g(ha)o(v)o(e)g
(introduced)h(so)f(f)o(ar)g(is)g(not)-150 5400 y(enough.)2049
83 y Fv(4)99 b(Mor)n(e)26 b(\003exible)f(construction)2049
209 y Fu(Once)f(one)g(starts)f(to)g(use)h(T)-5 b(emplate)23
b(Hask)o(ell,)h(it)f(is)g(not)g(long)h(before)g(one)2049
292 y(disco)o(v)o(ers)g(that)f(quasi-quote)i(and)f(splice)f(cannot)h(e)
o(xpress)g(an)o(ything)h(lik)o(e)2049 375 y(the)19 b(full)f(range)i(of)
f(meta-programming)i(opportunities)f(that)e(we)h(w)o(ant.)2049
499 y(Hask)o(ell)j(has)g(b)o(uilt-in)f(functions)i(for)e(selecting)i
(the)e(components)j(from)e(a)2049 582 y(pair)m(,)c(namely)h
Fs(fst)f Fu(and)h Fs(snd)p Fu(.)k(But)18 b(if)g(we)g(w)o(ant)g(to)g
(select)g(the)h(\002rst)e(compo-)2049 665 y(nent)i(of)g(a)g(triple,)f
(we)h(ha)o(v)o(e)g(to)g(write)f(it)g(by)i(hand:)2127
790 y Fs(case)41 b(x)e(of)h(\(a,b,c\))h(->)e(a)2049 915
y Fu(In)19 b(T)-5 b(emplate)19 b(Hask)o(ell)g(we)g(can)g(instead)g
(write:)2127 1040 y Fs($\(sel)41 b(1)e(3\))h(x)2049 1164
y Fu(Or)19 b(at)f(least)h(we)g(w)o(ould)g(lik)o(e)g(to.)k(But)c(ho)n(w)
g(can)h(we)f(write)f Fs(sel)p Fu(?)2127 1289 y Fs(sel)40
b(::)g(Int)g(->)g(Int)g(->)f(Expr)2127 1372 y(sel)h(i)g(n)f(=)h([|)f
(\\x)h(->)g(case)g(x)f(of)h(...)g(|])2049 1497 y Fu(Uh)22
b(oh!)33 b(W)-6 b(e)21 b(can')o(t)h(write)f(the)h(\223)p
Fs(...)p Fu(\224)h(in)f(ordinary)h(Hask)o(ell,)f(because)i(the)2049
1580 y(pattern)e(for)g(the)g(case)g(e)o(xpression)h(depends)g(on)g
Fs(n)p Fu(.)31 b(The)22 b(quasi-quote)h(no-)2049 1663
y(tation)j(has)h(brok)o(en)h(do)n(wn;)j(instead,)d(we)f(need)g(some)g
(w)o(ay)g(to)f(construct)2049 1746 y(Hask)o(ell)19 b(syntax)h(trees)f
(more)g(directly)-5 b(,)19 b(lik)o(e)g(this:)2049 1871
y Fs(sel)40 b(::)g(Int)g(->)f(Int)h(->)g(Expr)2049 1954
y(sel)g(i)f(n)h(=)f(lam)h([pvar)h("x"])f(\(caseE)g(\(var)g("x"\))h
([alt]\))2127 2037 y(where)g(alt)f(::)f(Match)2363 2120
y(alt)h(=)f(simpleM)i(pat)f(rhs)2363 2286 y(pat)g(::)f(Patt)2363
2369 y(pat)h(=)f(ptup)h(\(map)g(pvar)h(as\))2363 2535
y(rhs)f(::)f(Expr)2363 2618 y(rhs)h(=)f(var)h(\(as)g(!!)g(\(i-1\)\))g
(--)g(!!)g(is)f(0)h(based)2363 2784 y(as)g(::)f([String])2363
2867 y(as)79 b(=)39 b(["a"++show)j(i)d(|)h(i)f(<-)h([1..n])g(])2049
2992 y Fu(In)23 b(this)g(code)h(we)f(use)g Ft(syntax-construction)j
(functions)e Fu(which)f(construct)2049 3075 y(e)o(xpressions)k(and)f
(patterns.)44 b(W)-6 b(e)26 b(list)e(a)i(fe)n(w)g(of)g(these,)h(their)e
(types,)j(and)2049 3158 y(some)19 b(concrete)h(e)o(xamples)g(for)f
(reference.)2127 3282 y Fs(--)40 b(Syntax)h(for)f(Patterns)2127
3365 y(pvar)158 b(::)40 b(String)h(->)e(Patt)433 b(--)39
b(x)2127 3448 y(ptup)158 b(::)40 b([Patt])h(->)e(Patt)433
b(--)39 b(\(x,y,z\))2127 3531 y(pcon)158 b(::)40 b(String)h(->)e
([Patt])i(->)f(Patt)g(--)f(\(Fork)i(x)e(y\))2127 3614
y(pwild)119 b(::)40 b(Patt)825 b(--)39 b(_)2127 3780
y(--)h(Syntax)h(for)f(Expressions)2127 3864 y(var)197
b(::)40 b(String)h(->)e(Expr)433 b(--)39 b(x)2127 3947
y(tup)197 b(::)40 b([Expr])h(->)e(Expr)433 b(--)39 b(\(x,3+y\))2127
4030 y(app)197 b(::)40 b(Expr)g(->)g(Expr)g(->)g(Expr)197
b(--)39 b(f)h(x)2127 4113 y(lam)197 b(::)40 b([Patt])h(->)e(Expr)h(->)g
(Expr)119 b(--)39 b(\\)h(x)f(y)h(->)f(5)2127 4196 y(caseE)119
b(::)40 b(Expr)g(->)g([Match])h(->)e(Expr)80 b(--)39
b(case)h(x)g(of)g(...)2127 4279 y(simpleM)h(::)f(Patt)g(->)g(Expr)g(->)
g(Match)158 b(--)39 b(x:xs)h(->)g(2)2049 4403 y Fu(The)22
b(code)h(for)f Fs(sel)h Fu(is)e(more)i(v)o(erbose)g(than)g(that)f(for)g
Fs(printf)h Fu(because)g(it)2049 4486 y(uses)d(e)o(xplicit)g
(constructors)h(for)f(e)o(xpressions)i(rather)e(than)g(implicit)f
(ones.)2049 4569 y(In)24 b(e)o(xchange,)i(code)e(construction)h(is)e
(fundamentally)j(more)d(\003e)o(xible,)i(as)2049 4652
y Fs(sel)31 b Fu(sho)n(ws.)60 b(T)-5 b(emplate)31 b(Hask)o(ell)g(pro)o
(vides)h(a)f(full)g(f)o(amily)g(of)g(syntax-)2049 4735
y(construction)h(functions,)j(such)d(as)f Fs(lam)h Fu(and)g
Fs(pvar)f Fu(abo)o(v)o(e,)k(which)d(are)2049 4818 y(documented)21
b(in)e(Appendix)h(A.)2049 4943 y(The)26 b(tw)o(o)h(styles)f(can)h(be)g
(mix)o(ed)f(freely)-5 b(.)46 b(F)o(or)26 b(e)o(xample,)i(we)e(could)i
(also)2049 5026 y(write)18 b Fs(sel)i Fu(lik)o(e)f(this:)2127
5151 y Fs(sel)40 b(::)g(Int)g(->)g(Int)g(->)f(Expr)2127
5234 y(sel)h(i)g(n)f(=)h([|)f(\\)h(x)f(->)h($\(caseE)h([|)f(x)f(|])h
([alt]\))g(|])2441 5317 y(where)2520 5400 y(alt)g(=)f(simpleM)i(pat)f
(rhs)1931 5649 y Fu(3)p eop
%%Page: 4 4
4 3 bop 321 83 a Fs(pat)40 b(=)f(ptup)h(\(map)g(pvar)h(as\))321
166 y(rhs)f(=)f(var)h(\(as)g(!!)g(\(i-1\)\))321 249 y(as)79
b(=)39 b(["a"++show)j(i)d(|)h(i)f(<-)h([1..n])g(])-150
374 y Fu(T)-6 b(o)23 b(illustrate)f(the)h(idea)h(further)m(,)f(suppose)
i(we)e(w)o(ant)g(an)g(n-ary)h Fs(zip)f Fu(func-)-150
457 y(tion,)c(whose)g(call)g(might)g(look)g(lik)o(e)g(this:)-72
582 y Fs($\(zipN)41 b(3\))f(as)f(bs)h(cs)-150 707 y Fu(where)19
b Fs(as)p Fu(,)f Fs(bs)p Fu(,)h(and)g Fs(cs)g Fu(are)f(lists,)g(and)h
Fs(zipN)40 b(::)g(Int)g(->)f(Expr)20 b Fu(gener)o(-)-150
790 y(ates)f(the)g(code)h(for)e(an)i(n-ary)f Fs(zip)p
Fu(.)k(Let')l(s)c(start)f(to)h(write)f Fs(zipN)p Fu(:)-72
914 y Fs(zipN)41 b(::)e(Int)h(->)g(Expr)-72 997 y(zipN)h(n)e(=)h([|)f
(let)h(zp)g(=)f($\(mkZip)i(n)f([|)f(zp)h(|]\))g(in)f(zp)h(|])-72
1163 y(mkZip)h(::)f(Int)f(->)h(Expr)g(->)g(Expr)-150
1288 y Fu(The)54 b(meta-function)i Fs(zipN)f Fu(generates)g(a)g(local)f
(let)g(binding)i(lik)o(e)-150 1371 y(\()p Fs(let)40 b(zip3)g(=)f(...)h
(in)g(zip3)p Fu(\).)f(The)24 b(body)h(of)f(the)g(binding)h(\(the)f
(dots)-150 1454 y Fs(...)p Fu(\))18 b(is)f(generated)i(by)f(the)f
(auxiliary)h(meta-function)h Fs(mkZip)f Fu(de\002ned)h(be-)-150
1537 y(lo)n(w)-5 b(.)42 b(The)26 b(function)g(de\002ned)g(in)f(the)g
(let)g(\()p Fs(zip3)h Fu(in)f(the)h(e)o(xample)g(in)f(this)-150
1620 y(paragraph\))c(will)e(be)h(recursi)n(v)o(e.)27
b(The)19 b(name)i(of)f(this)f(function)i(doesn')o(t)f(re-)-150
1703 y(ally)25 b(matter)m(,)i(since)e(it)g(is)g(used)h(only)h(once)f
(in)f(the)h(result)f(of)g(the)h(let,)g(and)-150 1786
y(ne)n(v)o(er)18 b(escapes)g(the)g(scope)g(of)f(the)g(let.)22
b(It)17 b(is)g(the)g(whole)h(let)e(e)o(xpression)j(that)-150
1869 y(is)h(returned.)29 b(The)20 b(name)h(of)g(this)f(function)h(must)
g(be)f(passed)i(to)e Fs(mkZip)i Fu(so)-150 1953 y(that)15
b(when)g Fs(mkZip)h Fu(generates)g(the)f(body)-5 b(,)17
b(the)e(let)f(will)g(be)h(properly)h(scoped.)-150 2036
y(The)j(size)g(of)g(the)g(zipping)g(function,)h Fs(n)p
Fu(,)e(is)h(also)g(a)g(parameter)g(to)g Fs(mkZip)p Fu(.)-150
2160 y(It')l(s)h(useful)h(to)g(see)g(what)g Fs(mkZip)h
Fu(generates)g(for)f(a)g(particular)g Fs(n)g Fu(in)f(under)o(-)-150
2243 y(standing)i(ho)n(w)g(it)f(w)o(orks.)32 b(When)21
b(applied)i(to)e Fs(3)p Fu(,)h(and)g(the)f(object)h(v)n(ariable)-150
2326 y Fs(\(var)40 b("ff"\))22 b Fu(it)f(generates)h(a)f(v)n(alue)h(in)
f(the)h Fs(Expr)f Fu(type.)31 b(Pretty-printing)-150
2409 y(that)19 b(v)n(alue)g(as)g(concrete)h(syntax)g(we)f(get:)-150
2534 y Fs(\\)39 b(y1)h(y2)g(y3)g(->)7 2617 y(case)g(\(y1,y2,y3\))i(of)
85 2700 y(\(x1:xs1,x2:xs2,x3:xs3\))j(->)282 2783 y(\(x1,x2,x3\))c(:)e
(ff)h(xs1)g(xs2)g(xs3)85 2866 y(\(_,_,_\))h(->)f([])-150
2991 y Fu(Note)21 b(ho)n(w)g(the)g(parameter)g Fs(\(var)40
b("ff"\))21 b Fu(ends)h(up)f(as)g(a)f(function)i(in)e(one)-150
3074 y(of)29 b(the)g(arms)h(of)f(the)g(case.)54 b(When)29
b(the)h(user)f(le)n(v)o(el)g(function)h Fs(zipN)g Fu(\(as)-150
3157 y(opposed)23 b(to)d(the)h(auxiliary)g(function)h
Fs(mkZip)p Fu(\))f(is)g(applied)g(to)g Fs(3)g Fu(we)f(obtain)-150
3240 y(the)e(full)g(let.)k(Note)d(ho)n(w)g(the)f(name)h(of)f(the)g
(bound)i(v)n(ariable)f Fs(zp0)p Fu(,)g(which)f(is)-150
3323 y(passed)i(as)f(a)g(parameter)g(to)g Fs(mkZip)h
Fu(ends)f(up)h(in)f(a)f(recursi)n(v)o(e)i(call.)-150
3448 y Fs(let)40 b(zp0)g(=)46 3531 y(\\)g(y1)f(y2)h(y3)g(->)164
3614 y(case)g(\(y1,y2,y3\))h(of)203 3697 y
(\(\(x1:xs1\),\(x2:xs2\),\(x3:xs3\)\))46 b(->)438 3780
y(\(x1,x2,x3\))c(:)d(zp0)h(xs1)g(xs2)g(xs3)203 3863 y(\(_,_,_\))h(->)f
([])-150 3946 y(in)g(zp0)-150 4071 y Fu(The)16 b(function)g
Fs(mkZip)h Fu(operates)f(by)g(generating)h(a)f(b)o(unch)g(of)g
(patterns)g(\(e.g.)-150 4154 y Fs(y1)p Fu(,)27 b Fs(y2)p
Fu(,)h Fs(y3)e Fu(and)g Fs(\(x1:xs1,x2:xs2,x3:xs3\))p
Fu(\),)32 b(and)27 b(a)e(b)o(unch)i(of)f(e)o(x-)-150
4237 y(pressions)e(using)g(the)f(v)n(ariables)g(bound)i(by)f(those)f
(patterns.)36 b(Generating)-150 4320 y(se)n(v)o(eral)31
b(patterns)f(\(each)h(a)f(pattern-v)n(ariable\),)j(and)e(associated)g
(e)o(xpres-)-150 4403 y(sions)16 b(\(each)g(an)g(e)o(xpression-v)n
(ariable\))h(is)e(so)h(common)h(we)e(abstract)h(it)f(into)-150
4486 y(a)k(function)-150 4611 y Fs(genPE)40 b(::)g(::)g(String)g(->)g
(Int)g(->)g(\([Patt],[Expr]\))-150 4694 y(genPE)g(s)g(n)f(=)h(let)g(ns)
f(=)h([)f(s++\(show)i(i\))f(|)f(i)h(<-)g([1..n]])321
4777 y(in)f(\(map)i(pvar)f(ns,)g(map)g(var)f(ns\))-150
4943 y(--)h(genPe)g("x")g(2)f(-->)-150 5026 y(--)79 b(\([pvar)41
b("x1",pvar)g("x2"],[var)g("x1",var)g("x2"]\))-150 5151
y Fu(In)24 b Fs(mkZip)g Fu(we)g(use)f(this)h(function)g(to)g(construct)
g(three)g(lists)e(of)i(matching)-150 5234 y(patterns)g(and)h(e)o
(xpressions.)39 b(Then)25 b(we)e(assemble)i(these)f(pieces)h(into)f
(the)-150 5317 y(lambda)f(abstraction)g(whose)f(body)i(is)d(a)h(case)h
(analysis)f(o)o(v)o(er)h(the)f(lambda)-150 5400 y(abstracted)e(v)n
(ariables.)2049 83 y Fs(mkZip)40 b(::)g(Int)g(->)g(Expr)g(->)f(Expr)
2049 166 y(mkZip)h(n)g(name)g(=)f(lam)h(pYs)g(\(caseE)h(\(tup)f(eYs\))g
([m1,m2]\))2127 249 y(where)2206 332 y(\(pXs,)g(eXs\))80
b(=)39 b(genPE)h("x")80 b(n)2206 415 y(\(pYs,)40 b(eYs\))80
b(=)39 b(genPE)h("y")80 b(n)2206 498 y(\(pXSs,eXSs\))42
b(=)d(genPE)h("xs")h(n)2206 581 y(pcons)f(x)g(xs)79 b(=)39
b([p|)h($x)g(:)f($xs)h(|])2206 664 y(b)79 b(=)39 b([|)h($\(tup)g(eXs\))
g(:)g($\(apps\(name)h(:)f(eXSs\)\))g(|])2206 747 y(m1)g(=)f(simpleM)i
(\(ptup)f(\(zipWith)h(pcons)g(pXs)f(pXSs\)\))g(b)2206
830 y(m2)g(=)f(simpleM)i(\(ptup)f(\(copies)h(n)f(pwild\)\))g(\(con)g
("[]"\))2049 950 y Fu(Here)17 b(we)g(use)h(the)f(quasi-quotation)i
(mechanism)f(for)f(patterns)g Fs([p|)40 b(_)g(|])2049
1033 y Fu(and)18 b(the)f(function)h Fs(apps)p Fu(,)g(another)g(idiom)g
(w)o(orth)f(abstracting)h(into)f(a)g(func-)2049 1116
y(tion)i(\227)f(the)h(application)h(of)f(a)g(function)h(to)e(multiple)h
(ar)o(guments.)2127 1236 y Fs(apps)41 b(::)e([Expr])i(->)f(Expr)2127
1319 y(apps)h([x])236 b(=)39 b(x)2127 1402 y(apps)i(\(x:y:zs\))g(=)e
(apps)h(\()g([|)f($x)h($y)g(|])f(:)h(zs)g(\))2049 1522
y Fu(The)17 b(message)h(of)f(this)g(section)h(is)f(this.)22
b(Where)17 b(it)f(w)o(orks,)i(the)f(quasi-quote)2049
1605 y(notation)i(is)f(simple,)h(con)m(v)o(enient,)g(and)h(secure)f
(\(it)e(understands)k(Hask)o(ell')l(s)2049 1688 y(static)k(scoping)h
(and)g(type)g(rules\).)42 b(Ho)n(we)n(v)o(er)m(,)28 b(quasi-quote)f
(alone)f(is)f(not)2049 1771 y(enough,)d(usually)f(when)g(we)g(w)o(ant)g
(to)f(generate)h(code)h(with)e(sequences)i(of)2049 1854
y(indeterminate)16 b(length.)23 b(T)-5 b(emplate)15 b(Hask)o(ell')l(s)h
(syntax-construction)h(func-)2049 1937 y(tions)22 b(\()p
Fs(app)p Fu(,)h Fs(lam)p Fu(,)f Fs(caseE)p Fu(,)h(etc.\))32
b(allo)n(w)21 b(the)h(programmer)h(to)f(drop)h(do)n(wn)2049
2020 y(to)f(a)h(less)f(con)m(v)o(enient)i(b)o(ut)e(more)h(e)o(xpressi)n
(v)o(e)g(notation)g(where)g(\(and)g(only)2049 2103 y(where\))c
(necessary)-5 b(.)2049 2236 y Fv(5)99 b(Declarations)25
b(and)h(r)n(ei\002cation)2049 2356 y Fu(In)c(Hask)o(ell)g(one)h(may)f
(add)h(a)f(\223)p Fs(deriving)p Fu(\224)i(clause)e(to)g(a)g
Fs(data)h Fu(type)f(dec-)2049 2439 y(laration:)2049 2559
y Fs(data)40 b(T)g(a)f(=)h(Tip)f(a)h(|)f(Fork)h(\(T)g(a\))g(\(T)g(a\))
78 b(deriving\()42 b(Eq)d(\))2049 2679 y Fu(The)33 b
Fs(deriving\()41 b(Eq)f(\))32 b Fu(clause)i(instructs)e(the)h(compiler)
g(to)g(generate)2049 2762 y(\223boilerplate\224)d(code)h(to)e(allo)n(w)
g(v)n(alues)i(of)e(type)h Fs(T)g Fu(to)f(be)h(compared)h(for)2049
2845 y(equality)-5 b(.)54 b(Ho)n(we)n(v)o(er)m(,)33 b(this)c(mechanism)
h(only)g(w)o(orks)f(for)g(a)h(handful)g(of)2049 2928
y(b)o(uilt-in)19 b(type)i(classes)f(\()p Fs(Eq)p Fu(,)g
Fs(Ord)p Fu(,)h Fs(Ix)f Fu(and)h(so)f(on\);)g(if)g(you)h(w)o(ant)f
(instances)2049 3011 y(for)k(other)g(classes,)h(you)f(ha)o(v)o(e)g(to)g
(write)f(them)h(by)g(hand.)39 b(So)23 b(tiresome)h(is)2049
3094 y(this)f(that)f(W)m(instanle)o(y)h(wrote)g(DrIFT)-6
b(,)22 b(a)h(pre-processor)h(for)f(Hask)o(ell)g(that)2049
3177 y(allo)n(ws)30 b(the)h(programmer)g(to)f(specify)h(the)f
(code-generation)i(algorithm)2049 3260 y(once,)d(and)e(then)g(use)g
(the)f(algorithm)h(to)f(generate)i(boilerplate)f(code)g(for)2049
3343 y(man)o(y)18 b(data)g(types)g([17)q(].)k(Much)c(w)o(ork)g(has)g
(also)g(been)g(done)h(on)f(poly-typic)2049 3426 y(algorithms,)g(whose)g
(e)o(x)o(ecution)h(is)e(speci\002ed,)h(once)h(and)f(for)g(all,)f(based)
h(on)2049 3509 y(the)h(structure)g(of)g(the)g(type)g([9)q(,)f(6].)2049
3629 y(T)-5 b(emplate)28 b(Hask)o(ell)g(w)o(orks)g(lik)o(e)g(a)g
(fully-inte)o(grated)h(v)o(ersion)f(of)g(DrIFT)-6 b(.)2049
3712 y(Here)19 b(is)f(an)i(e)o(xample:)2167 3832 y Fs(data)40
b(T)f(a)h(=)f(Tip)h(a)g(|)f(Fork)h(\(T)g(a\))g(\(T)f(a\))2167
3998 y(splice)h(\(genEq)h(\(reifyDecl)g(T\)\))2049 4118
y Fu(This)17 b(code)h(sho)n(ws)h(tw)o(o)e(ne)n(w)h(features)g(we)f(ha)o
(v)o(e)h(not)f(seen)h(before:)23 b(rei\002ca-)2049 4201
y(tion)17 b(and)g(declaration)h(splicing.)k(Rei\002cation)17
b(in)m(v)o(olv)o(es)g(making)h(the)f(inter)o(-)2049 4284
y(nal)h(representation)i(of)e Fs(T)g Fu(a)o(v)n(ailable)h(as)f(a)g
(data)h(structure)f(to)h(compile-time)2049 4367 y(computations.)25
b(Rei\002cation)18 b(is)h(co)o(v)o(ered)h(in)e(more)i(detail)e(in)h
(Section)g(8.1.)2049 4516 y Fk(5.1)99 b(Declar)o(ation)23
b(splicing)2049 4636 y Fu(The)36 b(construct)h Fs(splice)k(\(...\))c
Fu(may)g(appear)h(where)e(a)h Ft(declar)o(ation)2049
4719 y(gr)m(oup)30 b Fu(is)e(needed,)k(whereas)d(up)g(to)g(no)n(w)g(we)
f(ha)o(v)o(e)h(only)g(seen)h Fs($\(...\))2049 4802 y
Fu(where)19 b(an)h Ft(e)o(xpr)m(ession)g Fu(is)f(e)o(xpected.)25
b(As)19 b(with)f Fs($)p Fu(,)h(a)g Fs(splice)i Fu(instructs)e(the)2049
4885 y(compiler)e(to)g(run)g(the)f(enclosed)i(code)g(at)e
(compile-time,)h(and)g(splice)g(in)g(the)2049 4968 y(resulting)i
(declaration)h(group)g(in)f(place)g(of)g(the)g Fs(splice)h
Fu(call)3679 4941 y Fn(2)3712 4968 y Fu(.)2049 5088 y(Splicing)27
b(can)g(generate)h(one)f(or)g(more)g(declarations.)47
b(In)27 b(our)g(e)o(xample,)2049 5171 y Fs(genEq)19 b
Fu(generated)g(a)f(single)g Fs(instance)i Fu(declaration)f(\(which)f
(is)g(essential)p 2049 5229 801 4 v 2150 5290 a Fn(2)2183
5317 y Fu(An)j(aside)g(about)h(syntax:)27 b(we)20 b(use)h(\223)p
Fs(splice)p Fu(\224)i(rather)d(than)h(\223)p Fs($)p Fu(\224)g(only)2049
5400 y(because)f(the)f(latter)f(seems)i(rather)f(terse)f(for)h(a)g
(declaration)h(conte)o(xt.)1931 5649 y(4)p eop
%%Page: 5 5
5 4 bop -150 83 a Fu(for)21 b(the)g(particular)g(application)h(to)f
Fs(deriving)p Fu(\),)i(b)o(ut)e(in)g(general)h(it)e(could)-150
166 y(also)27 b(generate)h(one)g(or)f(more)h Fs(class)p
Fu(,)h Fs(data)p Fu(,)h Fs(type)p Fu(,)f(or)f(v)n(alue)f(declara-)-150
249 y(tions.)-150 370 y(Generating)c(declarations,)h(rather)e(than)g(e)
o(xpressions,)i(is)e(useful)h(for)f(pur)o(-)-150 453
y(poses)e(other)g(than)f(deri)n(ving)i(code)f(from)f(data)h(types.)k
(Consider)c(again)g(the)-150 536 y(n-ary)g Fs(zip)f Fu(function)h(we)f
(discussed)i(in)e(Section)g(4.)24 b(Ev)o(ery)c(time)e(we)h(write)-150
619 y Fs($\(zipN)41 b(3\))e(as)h(bs)g(cs)22 b Fu(a)g(fresh)g(cop)o(y)i
(of)e(a)g(3-w)o(ay)h(zip)f(will)f(be)i(gener)o(-)-150
702 y(ated.)g(That)c(may)g(be)g(precisely)g(what)f(the)h(programmer)h
(w)o(ants)f(to)f(say)-5 b(,)19 b(b)o(ut)-150 785 y(he)h(may)f(also)h(w)
o(ant)f(to)h(generate)g(a)f(single)g(top-le)n(v)o(el)h(zip)g(function,)
f(which)-150 868 y(he)g(can)h(do)f(lik)o(e)g(this:)-72
990 y Fs(zip3)41 b(=)e($\(zipN)i(3\))-150 1111 y Fu(But)20
b(he)g(might)g(w)o(ant)g(to)g(generate)g(all)g(the)g(zip)g(functions)g
(up)h(to)e(10,)i(or)f(20,)-150 1194 y(or)f(whate)n(v)o(er)l(.)24
b(F)o(or)18 b(that)h(we)f(can)i(write)-72 1315 y Fs(splice)41
b(\(genZips)g(20\))-150 1436 y Fu(with)15 b(the)h(understanding)i(that)
e Fs(zip1)p Fu(,)h Fs(zip2)p Fu(,)f(...)21 b(,)16 b Fs(zip20)h
Fu(are)f(brought)h(into)-150 1519 y(scope.)-150 1655
y Fv(6)99 b(Quasi-quotes,)48 b(Scoping,)f(and)d(the)f(Quotation)-1
1755 y(Monad)-150 1877 y Fu(Ordinary)24 b(Hask)o(ell)g(is)f(statically)
g(scoped,)j(and)e(so)f(is)h(T)-5 b(emplate)23 b(Hask)o(ell.)-150
1960 y(F)o(or)18 b(e)o(xample)i(consider)g(the)f(meta-function)h
Fs(cross2a)g Fu(belo)n(w)-5 b(.)-72 2081 y Fs(cross2a)41
b(::)f(Expr)g(->)g(Expr)g(->)g(Expr)-72 2164 y(cross2a)h(f)f(g)f(=)h
([|)f(\\)h(\(x,y\))g(->)g(\($f)g(x,)f($g)h(y\))g(|])-150
2285 y Fu(Ex)o(ecuting)32 b Fs(cross2a)41 b(\(var)f("x"\))g(\(var)g
("y"\))32 b Fu(we)f(e)o(xpect)h(that)g(the)-150 2368
y(\()p Fs(var)40 b("x")p Fu(\))19 b(and)h(the)f(\()p
Fs(var)40 b("y")p Fu(\))19 b(w)o(ould)h(not)f(be)h(inadv)o(ertently)g
(captured)-150 2451 y(by)33 b(the)f(local)h(object-v)n(ariables)h
Fs(x)e Fu(and)h Fs(y)g Fu(inside)f(the)h(quasi-quotes)h(in)-150
2534 y Fs(cross2a)p Fu(')l(s)20 b(de\002nition.)j(Indeed,)d(this)f(is)f
(the)h(case.)-150 2656 y Fs(prompt>)41 b(cross2a)g(\(var)f("x"\))g
(\(var)g("y"\))-150 2739 y(Displaying)i(top-level)f(term)f(of)g(type:)g
(Expr)-150 2822 y(\\)f(\(x0,y1\))i(->)f(\(x)g(x0,y)g(y1\))-150
2943 y Fu(The)18 b(quasi-quote)h(notation)g(renames)g
Fs(x)f Fu(and)g Fs(y)p Fu(,)g(and)h(we)f(get)g(the)g(e)o(xpected)-150
3026 y(result.)k(This)15 b(is)h(ho)n(w)g(static)f(scoping)i(w)o(orks)g
(in)e(ordinary)i(Hask)o(ell,)f(and)h(the)-150 3109 y(quasi-quotes)23
b(lift)d(this)h(beha)o(vior)h(to)f(the)g(object-le)n(v)o(el)h(as)f
(well.)30 b(Unfortu-)-150 3192 y(nately)-5 b(,)19 b(the)f(syntax)h
(construction)g(functions)h Fs(lam)p Fu(,)e Fs(var)p
Fu(,)h Fs(tup)p Fu(,)f(etc.)23 b(do)c(not)-150 3275 y(beha)o(v)o(e)h
(this)e(w)o(ay)-5 b(.)24 b(Consider)-72 3396 y Fs(cross2b)41
b(f)f(g)7 3479 y(=)f(lam)h([ptup)h([pvar)f("x",)276 b(pvar)40
b("y"]])242 3562 y(\(tup)80 b([app)40 b(f)f(\(var)h("x"\),app)h(g)f
(\(var)g("y"\)]\))-150 3683 y Fu(Applying)20 b Fs(cross2b)g
Fu(to)f Fs(x)g Fu(and)h Fs(y)e Fu(results)h(in)g(inadv)o(ertent)h
(capture.)-72 3805 y Fs(prompt>)41 b(cross2b)g(\(var)f("x"\))g(\(var)h
("y"\))-72 3888 y(Displaying)h(top-level)f(term)f(of)g(type:)g(Expr)-72
3971 y(\\)g(\(x,y\))g(->)g(\(x)g(x,y)g(y\))-150 4092
y Fu(Since)22 b(some)g(program)h(generators)g(cannot)g(be)f(written)g
(using)g(the)g(quasi-)-150 4175 y(quote)30 b(notation)g(alone,)i(and)e
(it)f(appears)h(that)f(the)g(syntax)i(construction)-150
4258 y(functions)e(are)f(inadequate)h(for)f(e)o(xpressing)h(static)e
(scoping,)32 b(it)27 b(appears)-150 4341 y(that)20 b(we)f(are)h(in)g
(trouble:)25 b(we)20 b(need)h(some)f(w)o(ay)g(to)g(generate)g(fresh)g
(names.)-150 4424 y(That)f(is)f(what)h(we)g(turn)g(to)g(ne)o(xt.)-150
4576 y Fk(6.1)99 b(Secr)l(ets)25 b(Re)o(vealed)-150 4698
y Fu(Here,)20 b(then,)g(is)g(one)h(correct)f(rendering)h(of)f
Fs(cross)h Fu(in)f(T)-5 b(emplate)20 b(Hask)o(ell,)-150
4781 y(without)f(using)h(quasi-quote:)-72 4902 y Fs(cross2c)41
b(::)f(Expr)g(->)g(Expr)g(->)g(Expr)-72 4985 y(cross2c)h(f)f(g)f(=)7
5068 y(do)h({)f(x)h(<-)f(gensym)i("x")125 5151 y(;)e(y)h(<-)f(gensym)i
("y")125 5234 y(;)e(ft)h(<-)f(f)125 5317 y(;)g(gt)h(<-)f(g)125
5400 y(;)g(return)i(\(Lam)f([Ptup)g([Pvar)h(x,Pvar)f(y]])2873
83 y(\(Tup)79 b([App)40 b(ft)g(\(Var)g(x\))3108 166 y(,App)g(gt)g
(\(Var)g(y\)]\)\))2324 249 y(})2049 373 y Fu(In)19 b(this)g(e)o(xample)
g(we)g(re)n(v)o(eal)g(three)g(secrets:)2136 497 y Fp(\017)42
b Fu(The)26 b(type)h Fs(Expr)g Fu(is)f(a)h(synon)o(ym)h(for)e(monadic)i
(type,)g Fs(Q)40 b(Exp)p Fu(.)46 b(In-)2215 580 y(deed,)19
b(the)g(same)h(is)e(true)h(of)g(declarations:)2293 701
y Fs(type)41 b(Expr)f(=)f(Q)h(Exp)2293 784 y(type)h(Decl)f(=)f(Q)h(Dec)
2136 904 y Fp(\017)i Fu(The)32 b(code)i(returned)f(by)g
Fs(cross2c)g Fu(is)f(represented)i(by)f(ordinary)2215
987 y(Hask)o(ell)27 b(algebraic)h(datatypes.)48 b(In)26
b(f)o(act)h(there)g(are)g(tw)o(o)g(algebraic)2215 1070
y(data)c(types)g(in)g(this)f(e)o(xample:)32 b Fs(Exp)23
b Fu(\(e)o(xpressions\))h(with)e(construc-)2215 1153
y(tors)e Fs(Lam)p Fu(,)g Fs(Tup)p Fu(,)g Fs(App)p Fu(,)g(etc;)g(and)g
Fs(Pat)h Fu(\(patterns\),)e(with)h(constructors)2215
1236 y Fs(Pvar)p Fu(,)f Fs(Ptup)p Fu(,)h(etc.)2136 1357
y Fp(\017)42 b Fu(The)d(monad,)46 b Fs(Q)p Fu(,)39 b(is)g(the)g
(quotation)i(monad.)85 b(It)39 b(supports)i(the)2215
1440 y(usual)22 b(monadic)g(operations)h(\()p Fs(bind)p
Fu(,)f Fs(return)p Fu(,)g Fs(fail)p Fu(\))g(and)g(the)g
Fs(do)p Fu(-)2215 1523 y(notation,)d(as)g(well)g(as)g(the)g
Fs(gensym)h Fu(operation:)2293 1643 y Fs(gensym)41 b(::)f(String)g(->)g
(Q)g(String)2049 1767 y Fu(W)-6 b(e)45 b(generate)i(the)f
Fs(Expr)g Fu(returned)h(by)f Fs(cross2c)h Fu(using)g(Hask)o(ell')l(s)
2049 1850 y(monadic)31 b Fs(do)p Fu(-notation.)56 b(First)29
b(we)g(generate)i(a)f(fresh)f(name)i(for)e Fs(x)h Fu(and)2049
1933 y Fs(y)19 b Fu(using)g(a)f(monadic)i Fs(gensym)p
Fu(,)f(and)h(then)f(b)o(uild)f(the)h(e)o(xpression)g(to)g(return.)2049
2016 y(Notice)k(that)h(\(tiresomely\))f(we)g(also)h(ha)o(v)o(e)f(to)h
(\223perform\224)g Fs(f)f Fu(and)h Fs(g)f Fu(in)h(the)2049
2099 y(monad,)i(gi)n(ving)e Fs(ft)g Fu(and)h Fs(gt)f
Fu(of)f(type)i Fs(Exp)p Fu(,)g(because)g Fs(f)e Fu(and)i
Fs(g)e Fu(ha)o(v)o(e)h(type)2049 2182 y Fs(Q)39 b(Exp)26
b Fu(and)f(might)g(do)g(some)g(internal)g Fs(gensym)p
Fu(s.)41 b(W)-6 b(e)24 b(will)g(see)h(ho)n(w)g(to)2049
2265 y(a)o(v)o(oid)19 b(this)f(pain)i(in)f(Section)f(6.3.)2049
2389 y(T)-6 b(o)23 b(summarize,)i(in)e(T)-5 b(emplate)23
b(Hask)o(ell)g(there)g(are)h(three)f(\223layers\224)h(to)f(the)2049
2472 y(representation)33 b(of)e(object-programs,)36 b(in)c(order)g(of)f
(increasing)i(con)m(v)o(e-)2049 2556 y(nience)20 b(and)f(decreasing)h
(po)n(wer:)2136 2680 y Fp(\017)42 b Fu(The)16 b(bottom)h(layer)f(has)h
(tw)o(o)f(parts.)23 b(First,)15 b Ft(or)m(dinary)j(alg)o(ebr)o(aic)f
(data)2215 2763 y(types)i Fu(represent)h(Hask)o(ell)f(program)h
(fragments)f(\(Section)g(6.2\).)2215 2883 y(Second,)29
b Ft(the)e(quotation)h(monad)p Fu(,)i Fs(Q)p Fu(,)c(encapsulates)i(the)
f(notion)h(of)2215 2966 y(generating)j(fresh)f(names,)j(as)d(well)f(as)
h(f)o(ailure)g(and)h(input/output)2215 3049 y(\(Section)19
b(8\).)2136 3169 y Fp(\017)42 b Fu(A)26 b(library)h(of)f
Ft(syntax-construction)j(functions)p Fu(,)g(such)e(as)g
Fs(tup)g Fu(and)2215 3253 y Fs(app)p Fu(,)h(lift)d(the)h(corresponding)
i(algebraic)f(data)f(type)g(constructors,)2215 3336 y(such)19
b(as)g Fs(Tup)f Fu(and)h Fs(App)p Fu(,)g(to)f(the)h(quotation-monad)h
(le)n(v)o(el,)f(pro)o(viding)2215 3419 y(a)g(con)m(v)o(enient)h(w)o(ay)
g(to)f(access)g(the)g(bottom)g(layer)h(\(Section)e(6.3\).)2136
3539 y Fp(\017)42 b Ft(The)31 b(quasi-quote)h(notation)p
Fu(,)i(introduced)e(in)e(Section)h(2,)i(is)e(most)2215
3622 y(con)m(v)o(enient)f(b)o(ut,)g(as)e(we)h(ha)o(v)o(e)f(seen,)j
(there)e(are)f(important)h(meta-)2215 3705 y(programs)h(that)f(it)g
(cannot)h(e)o(xpress.)54 b(W)-6 b(e)29 b(will)f(re)n(visit)h(the)g
(quasi-)2215 3788 y(quote)20 b(notation)h(in)e(Section)g(9,)h(where)g
(we)f(sho)n(w)h(ho)n(w)g(it)f(is)g(b)o(uilt)g(on)2215
3871 y(top)g(of)g(the)g(pre)n(vious)h(layers.)2049 3995
y(The)g(programmer)i(can)f(freely)f(mix)h(the)f(three)h(layers,)f
(because)i(the)e(latter)2049 4078 y(tw)o(o)e(are)g(simply)g(con)m(v)o
(enient)h(interf)o(aces)f(to)g(the)g(\002rst.)k(W)-6
b(e)17 b(no)n(w)h(discuss)h(in)2049 4161 y(more)k(detail)f(the)g
(\002rst)f(tw)o(o)h(layers)h(of)f(code)h(representation.)34
b(W)-6 b(e)22 b(lea)o(v)o(e)g(a)2049 4244 y(detailed)d(discussion)h(of)
f(quasi-quotes)i(to)d(Section)h(9.)2049 4404 y Fk(6.2)99
b(Datatypes)24 b(for)g(code)2049 4529 y Fu(Since)e(object-programs)i
(are)e(data,)i(and)f(Hask)o(ell)f(represents)h(data)g(struc-)2049
4612 y(tures)17 b(using)h(algebraic)g(datatypes,)g(it)f(is)g(natural)g
(for)g(T)-5 b(emplate)17 b(Hask)o(ell)h(to)2049 4695
y(represent)i(Hask)o(ell)f(object-programs)h(using)g(an)f(algebraic)g
(datatype.)2049 4819 y(The)28 b(particular)g(data)g(types)g(used)g(for)
g(T)-5 b(emplate)27 b(Hask)o(ell)i(are)e(gi)n(v)o(en)i(in)2049
4902 y(Appendix)j(B.)57 b(The)30 b(highlights)h(include)g(algebraic)g
(datatypes)g(to)g(rep-)2049 4985 y(resent)e(e)o(xpressions)i(\()p
Fs(Exp)p Fu(\),)h(declarations)e(\()p Fs(Dec)p Fu(\),)i(patterns)d(\()p
Fs(Pat)p Fu(\),)j(and)2049 5068 y(types)21 b(\()p Fs(Typ)p
Fu(\).)29 b(Additional)21 b(data)g(types)g(are)g(used)g(to)g(represent)
g(other)g(syn-)2049 5151 y(tactic)h(elements)i(of)f(Hask)o(ell,)h(such)
f(as)g(guarded)h(de\002nitions)g(\()p Fs(Body)p Fu(\),)g
Fs(do)2049 5234 y Fu(e)o(xpressions)h(and)f(comprehensions)i(\()p
Fs(Statement)p Fu(\),)g(and)e(arithmetic)f(se-)2049 5317
y(quences)g(\()p Fs(DotDot)p Fu(\).)31 b(W)-6 b(e)21
b(ha)o(v)o(e)g(used)h(comments)h(freely)e(in)g(Appendix)i(B)2049
5400 y(to)c(illustrate)f(the)h(algebraic)h(datatypes)f(with)g(concrete)
h(syntax)f(e)o(xamples.)1931 5649 y(5)p eop
%%Page: 6 6
6 5 bop -150 83 a Fu(W)-6 b(e)21 b(ha)o(v)o(e)g(tried)f(to)h(mak)o(e)h
(these)g(data)f(types)g(complete)h(yet)f(simple.)30 b(The)o(y)-150
166 y(are)21 b(modelled)h(after)e(Hask)o(ell')l(s)h(concrete)h(surf)o
(ace)g(syntax,)g(so)f(if)f(you)i(can)-150 249 y(write)28
b(Hask)o(ell)i(programs,)i(you)d(should)h(be)g(able)f(to)g(use)g(the)g
(algebraic)-150 332 y(constructor)20 b(functions)g(to)e(represent)i
(them.)-150 467 y(An)f(adv)n(antage)h(of)e(the)h(algebraic)g(approach)h
(is)e(that)h(object-program)h(rep-)-150 550 y(resentations)k(are)g
(just)f(ordinary)h(data;)i(in)d(particular)m(,)h(the)o(y)g(can)g(be)g
(anal-)-150 633 y(ysed)c(using)f(Hask)o(ell')l(s)g Fs(case)h
Fu(e)o(xpression)g(and)g(pattern)f(matching.)-150 768
y(Disadv)n(antages)k(of)e(this)f(approach)j(are)e(v)o(erbosity)g(\(to)g
(construct)h(the)f(rep-)-150 851 y(resentation)c(of)f(a)g(program)h
(requires)g(considerably)h(more)e(ef)n(fort)g(than)h(that)-150
934 y(required)h(to)f(construct)i(the)e(program)h(itself\),)f(and)h
(little)e(or)i(no)g(support)g(for)-150 1017 y(semantic)24
b(features)g(of)f(the)h(object)g(language)h(such)f(as)g(scoping)g(and)h
(typ-)-150 1100 y(ing.)-150 1289 y Fk(6.3)99 b(The)26
b(syntax-construction)c(functions)-150 1425 y Fu(The)28
b(syntax-construction)i(functions)f(of)g(Section)f(4)g(stand)h(re)n(v)o
(ealed)g(as)-150 1508 y(the)g(monadic)i(v)n(ariants)f(of)f(the)g
(corresponding)j(data)e(type)f(constructor)l(.)-150 1591
y(F)o(or)22 b(e)o(xample,)i(here)f(are)g(the)f(types)h(of)g(the)g
Fs(data)g Fu(type)g(constructor)h Fs(App)p Fu(,)-150
1674 y(and)c(its)e(monadic)i(counterpart)g(\(remember)f(that)g
Fs(Expr)h Fu(=)e Fs(Q)40 b(Exp)p Fu(\):)-72 1809 y Fs(App)g(::)g(Exp)79
b(->)40 b(Exp)79 b(->)40 b(Exp)-72 1892 y(app)g(::)g(Expr)g(->)g(Expr)g
(->)g(Expr)-150 2027 y Fu(The)20 b(ar)o(guments)g(of)f
Fs(app)h Fu(are)g Ft(computations)p Fu(,)h(whereas)f(the)f(ar)o
(guments)i(of)-150 2110 y Fs(App)g Fu(are)h Ft(data)f(values)p
Fu(.)30 b(Ho)n(we)n(v)o(er)m(,)22 b Fs(app)g Fu(is)e(no)i(more)f(than)h
(a)f(con)m(v)o(enience)-150 2193 y(function,)c(which)g(simply)f
(performs)h(the)f(ar)o(gument)h(computations)g(before)-150
2276 y(b)o(uilding)i(the)g(result:)-72 2411 y Fs(app)40
b(::)g(Expr)g(->)g(Expr)g(->)g(Expr)-72 2494 y(app)g(x)g(y)f(=)h(do)f
({)h(a)f(<-)h(x;)g(b)f(<-)h(y;)g(return)g(\(App)g(a)g(b\)})-150
2629 y Fu(This)29 b(con)m(v)o(enience)i(is)e(v)o(ery)g(w)o(orth)h
(while.)53 b(F)o(or)28 b(e)o(xample,)33 b(here)c(is)g(yet)-150
2712 y(another)20 b(v)o(ersion)f(of)g Fs(cross)p Fu(:)-72
2847 y Fs(cross2d)41 b(::)f(Expr)g(->)g(Expr)g(->)g(Expr)-72
2930 y(cross2d)h(f)f(g)7 3013 y(=)f(do)h({)g(x)f(<-)h(gensym)g("x")203
3096 y(;)g(y)f(<-)h(gensym)g("y")203 3179 y(;)g(lam)f([ptup)i([pvar)f
(x,)g(pvar)g(y]])438 3262 y(\(tup)h([app)f(f)f(\(var)h(x\))635
3345 y(,app)g(g)f(\(var)h(y\)]\))203 3428 y(})-150 3564
y Fu(W)-6 b(e)18 b(use)h(the)g(monadic)g(v)o(ersions)h(of)e(the)h
(constructors)h(to)e(b)o(uild)h(the)f(result,)-150 3647
y(and)h(thereby)h(a)o(v)o(oid)f(ha)o(ving)g(to)g(bind)g
Fs(ft)g Fu(and)g Fs(gt)g Fu(\223by)h(hand\224)g(as)e(we)h(did)g(in)-150
3730 y Fs(cross2c)p Fu(.)24 b(Instead,)c Fs(lam)p Fu(,)f
Fs(app)p Fu(,)g(and)g Fs(tup)p Fu(,)g(will)f(do)i(that)e(for)h(us.)-150
3865 y(In)g(general,)g(we)g(use)g(the)g(follo)n(wing)h(nomenclature:)
-63 4000 y Fp(\017)42 b Fu(A)14 b(four)o(-character)h(type)h(name)f
(\(e.g.)21 b Fs(Expr)p Fu(\))15 b(is)g(the)f(monadic)i(v)o(ersion)16
4083 y(of)j(its)f(three-character)i(algebraic)f(data)h(type)f(\(e.g.)k
Fs(Exp)p Fu(\).)-63 4203 y Fp(\017)42 b Fu(A)23 b(lo)n(wer)o(-cased)g
(function)h(\(e.g.)36 b Fs(app)p Fu(\))24 b(is)e(the)i(monadic)g(v)o
(ersion)g(of)16 4295 y(its)18 b(upper)o(-cased)i(data)g(constructor)f
(\(e.g.)k Fs(App)p Fu(\))1279 4268 y Fn(3)1313 4295 y
Fu(.)-150 4430 y(While)32 b Fs(Expr)i Fu(and)f Fs(Decl)h
Fu(are)e(monadic)i(\(computational\))g(v)o(ersions)g(of)-150
4513 y(the)23 b(underlying)i(concrete)f(type,)h(the)e(corresponding)j
(types)d(for)g(patterns)-150 4596 y(\()p Fs(Patt)p Fu(\))i(and)h(types)
g(\()p Fs(Type)p Fu(\))f(are)g(simply)g(synon)o(yms)i(for)e(the)g
(underlying)-150 4679 y(data)19 b(type:)-72 4814 y Fs(type)41
b(Patt)f(=)f(Pat)-72 4897 y(type)i(Type)f(=)f(Typ)p -150
4980 801 4 v -49 5041 a Fn(3)-16 5068 y Fu(F)o(or)d(constructors)i
(whose)f(lo)n(wer)o(-case)f(name)h(w)o(ould)g(clash)g(with)-150
5151 y(Hask)o(ell)15 b(k)o(e)o(yw)o(ords,)i(lik)o(e)d
Fs(Let)p Fu(,)i Fs(Case)p Fu(,)g Fs(Do)p Fu(,)f Fs(Data)p
Fu(,)h Fs(Class)p Fu(,)g(and)f Fs(Instance)-150 5234
y Fu(we)j(use)g(the)g(con)m(v)o(ention)h(of)f(suf)n(\002xing)h(those)f
(lo)n(wer)o(-case)g(names)g(with)g(the)-150 5317 y(initial)j(letter)g
(of)g(their)h(type:)29 b Fs(letE)p Fu(,)22 b Fs(caseE)p
Fu(,)g Fs(doE)p Fu(,)f Fs(dataD)p Fu(,)i Fs(classD)p
Fu(,)f(and)-150 5400 y Fs(instanceD)p Fu(.)2049 83 y(Reason:)32
b(we)24 b(do)f(not)h(need)g(to)f Fs(gensym)h Fu(when)g(constructing)g
(patterns)g(or)2049 166 y(types.)34 b(Look)22 b(again)h(at)f
Fs(cross2d)h Fu(abo)o(v)o(e.)35 b(There)22 b(w)o(ould)h(be)f(no)h
(point)g(in)2049 249 y Fs(gensym)p Fu('ing)f Fs(x)f Fu(or)g
Fs(y)f Fu(inside)h(the)g(pattern,)g(because)h(these)f(v)n(ariables)h
(must)2049 332 y(scope)e(o)o(v)o(er)f(the)g(body)h(of)f(the)g(lambda)h
(as)f(well.)2049 469 y(Ne)n(v)o(ertheless,)j(we)f(pro)o(vide)i(type)e
(synon)o(yms)i Fs(Patt)f Fu(and)g Fs(Type)p Fu(,)g(together)2049
552 y(with)k(their)g(lo)n(wer)o(-case)g(constructors)h(\()p
Fs(pvar)p Fu(,)h Fs(ptup)f Fu(etc.\))45 b(so)26 b(that)h(pro-)2049
635 y(grammers)c(can)g(use)f(a)h(consistent)f(set)h(\227)e(lo)n(wer)o
(-case)i(when)g(w)o(orking)g(in)2049 718 y(the)h(computational)h
(setting)f(\(e)n(v)o(en)h(though)g(only)g(the)f(formation)g(of)g
Fs(Exp)2049 801 y Fu(and)i Fs(Dec)f Fu(are)g(computational\),)i(and)f
(upper)o(-case)f(when)h(w)o(orking)g(in)f(the)2049 884
y(algebraic)20 b(datatype)f(setting.)2049 1020 y(The)31
b(syntax-construction)i(functions)f(are)f(no)g(more)g(than)h(an)f
(ordinary)2049 1103 y(Hask)o(ell)c(library)-5 b(,)28
b(and)f(one)f(that)h(is)f(readily)g(e)o(xtended)i(by)f(the)f(program-)
2049 1186 y(mer)l(.)37 b(W)-6 b(e)22 b(ha)o(v)o(e)i(seen)g(one)g(e)o
(xample)h(of)e(that,)h(in)f(the)h(de\002nition)g(of)f
Fs(apps)2049 1269 y Fu(at)c(the)h(end)g(of)f(Section)g(4,)h(b)o(ut)f
(man)o(y)h(others)g(are)f(possible.)25 b(F)o(or)19 b(e)o(xample,)2049
1352 y(consider)g(this)e(v)o(ery)h(common)h(pattern:)k(we)18
b(wish)f(to)h(generate)h(some)f(code)2049 1435 y(that)g(will)f(be)h(in)
g(the)g(scope)g(of)g(some)h(ne)n(wly-generated)h(pattern;)e(we)g(don')o
(t)2049 1519 y(care)27 b(what)f(the)g(names)i(of)e(the)g(v)n(ariables)h
(in)g(the)f(pattern)h(are,)h(only)f(that)2049 1602 y(the)o(y)d(don')o
(t)f(clash)h(with)f(e)o(xisting)g(names.)37 b(One)24
b(approach)h(is)d(to)i Fs(gensym)2049 1685 y Fu(some)19
b(ne)n(w)f(v)n(ariables,)h(and)g(then)g(construct)g(both)g(the)f
(pattern)g(and)h(the)g(e)o(x-)2049 1768 y(pression)26
b(by)g(hand,)h(as)e(we)g(did)h(in)f Fs(cross2d)p Fu(.)43
b(But)25 b(an)h(alternati)n(v)o(e)f(is)g(to)2049 1851
y(\223clone\224)i(the)f(whole)g(pattern)g(in)f(one)i(fell)e(sw)o(oop,)j
(rather)e(than)g(generate)2049 1934 y(each)20 b(ne)n(w)f(v)n(ariable)g
(one)h(at)f(a)f(time:)2049 2070 y Fs(cross2e)41 b(f)e(g)h(=)2127
2153 y(do)g({)g(\(vf,p\))g(<-)g(genpat)g(\(ptup)h([pvar)f("x",pvar)h
("y"]\))2245 2236 y(;)f(lam)g([p])f(\(tup[app)i(f)f(\(vf)g("x"\),app)h
(g)e(\(vf)h("y"\)]\))2245 2319 y(})2049 2456 y Fu(The)34
b(function)g Fs(genpat)40 b(::)g(Patt)g(->)g(Q)f(\(String->Expr,)k
(Patt\))2049 2539 y Fu(alpha-renames)18 b(a)f(whole)g(pattern.)23
b(It)16 b(returns)i(a)e(ne)n(w)i(pattern,)f(and)h(a)e(func-)2049
2622 y(tion)g(which)h(maps)g(the)f(names)h(of)g(the)f(v)n(ariables)h
(in)f(the)h(original)f(pattern)h(to)2049 2705 y Fs(Expr)p
Fu(s)g(with)f(the)g(names)h(of)f(the)g(v)n(ariables)h(in)f(the)g
(alpha-renamed)i(pattern.)2049 2788 y(It)h(is)f(easy)i(to)f(write)f(by)
i(recursion)g(o)o(v)o(er)f(the)g(pattern.)24 b(Such)19
b(a)g(scheme)h(can)2049 2871 y(e)n(v)o(en)g(be)f(mix)o(ed)g(with)g(the)
g(quasi-quote)h(notation.)2049 3008 y Fs(cross2e)41 b(f)e(g)h(=)2127
3091 y(do)g({)g(\(vf,p\))g(<-)g(genpat)g([p|)g(\(x,y\))h(|])2245
3174 y(;)f(lam)g([p])f([|)h(\()g($f)f($\(vf)h("x"\),)h($g)e($\(vf)i
("y"\))f(\))f(|])2245 3257 y(})2049 3393 y Fu(This)18
b(usees)g(the)g(quasi-quote)h(notation)g(for)f(patterns:)23
b Fs([p|)40 b(_)f(|])18 b Fu(that)g(we)2049 3476 y(mentioned)26
b(in)f(passing)h(in)f(Section)g(4.)42 b(W)-6 b(e)25 b(also)g(supply)h
(a)f(quasi-quote)2049 3559 y(notation)15 b(for)g(declarations)g
Fs([d|)40 b(_)f(|])15 b Fu(and)h(types)f Fs([t|)40 b(_)f(|])p
Fu(.)22 b(Of)14 b(course)2049 3642 y(all)25 b(this)g(renaming)i
(happens)g(automatically)f(with)f(the)g(quasi-quotation.)2049
3725 y(W)-6 b(e)18 b(e)o(xplain)i(that)f(in)g(detail)f(in)h(Section)g
(9.)2049 3902 y Fv(7)99 b(T)-7 b(yping)26 b(T)-9 b(emplate)25
b(Hask)o(ell)2049 4040 y Fu(T)-5 b(emplate)30 b(Hask)o(ell)g(is)g
(strongly)g(typed)h(in)f(the)g(Milner)g(sense:)46 b(a)30
b(well-)2049 4123 y(typed)j(program)f(cannot)h(\223go)g(wrong\224)f(at)
g(run-time.)62 b(T)m(raditionally)-5 b(,)35 b(a)2049
4206 y(strongly)28 b(typed)g(program)g(is)f(\002rst)g(type-check)o(ed,)
k(then)d(compiled,)i(and)2049 4289 y(then)c(e)o(x)o(ecuted)h(\227)e(b)o
(ut)g(the)h(situation)g(for)g(T)-5 b(emplate)25 b(Hask)o(ell)h(is)f(a)h
(little)2049 4372 y(more)18 b(complicated.)23 b(F)o(or)17
b(e)o(xample)i(consider)f(again)g(our)g(v)o(ery)g(\002rst)e(e)o(xam-)
2049 4455 y(ple:)2127 4591 y Fs($\(printf)42 b("Error:)e(\045s)g(on)g
(line)g(\045d"\))g("urk")g(341)2049 4728 y Fu(It)21 b(cannot)h(readily)
f(be)h(type-check)o(ed)i(in)d(this)g(form,)g(because)i(the)e(type)h(of)
2049 4811 y(the)e(spliced)g(e)o(xpression)h(depends,)g(in)f(a)g
(complicated)h(w)o(ay)-5 b(,)20 b(on)g(the)g(v)n(alue)2049
4894 y(of)g(its)g(string)g(ar)o(gument.)27 b(So)20 b(in)g(T)-5
b(emplate)20 b(Hask)o(ell)g(type)h(checking)g(tak)o(es)2049
4977 y(place)e(in)g(stages:)2136 5114 y Fp(\017)42 b
Fu(First)33 b(type)i(check)h(the)f(body)g(of)g(the)f(splice;)43
b(in)34 b(this)g(case)h(it)f(is)2215 5197 y Fs(\(printf)41
b("Error:)g(\045s)e(on)h(line)g(\045d"\))g(::)g(Expr)p
Fu(.)2136 5317 y Fp(\017)i Fu(Ne)o(xt,)25 b(compile)g(it,)f(e)o(x)o
(ecute)h(it,)g(and)g(splice)f(the)g(result)g(in)g(place)h(of)2215
5400 y(the)19 b(call.)k(In)c(our)g(e)o(xample,)g(the)g(program)h(no)n
(w)g(becomes:)1931 5649 y(6)p eop
%%Page: 7 7
7 6 bop 94 83 a Fs(\(\\)40 b(s0)g(->)g(\\)f(n1)h(->)212
166 y("Error:)h(")e(++)h(s0)g(++)g(")f(on)h(line)g(")f(++)h(show)g
(n1\))330 249 y("urk")g(341)-63 369 y Fp(\017)i Fu(No)n(w)17
b(type-check)i(the)e(resulting)g(program,)h Ft(just)e(as)i(if)e(the)h
(pr)m(o)o(gr)o(am-)16 452 y(mer)i(had)h(written)e(that)h(pr)m(o)o(gr)o
(am)h(in)f(the)g(\002r)o(st)g(place)p Fu(.)-150 583 y(Hence,)g(type)g
(checking)i(is)d(intimately)g(interlea)o(v)o(ed)h(with)g
(\(compile-time\))-150 666 y(e)o(x)o(ecution.)-150 796
y(T)-5 b(emplate)23 b(Hask)o(ell)h(is)f(a)g(compile-time)h(only)g
(meta-system.)37 b(The)24 b(meta-)-150 879 y(le)n(v)o(el)f(operators)h
(\(brack)o(ets,)h(splices,)g(rei\002cation\))e(should)h(not)g(appear)g
(in)-150 962 y(the)c(code)g(being)h(generated.)26 b(F)o(or)19
b(e)o(xample,)i Fs([|)39 b(f)h([|)f(3)h(|])g(|])19 b
Fu(is)h(ille-)-150 1045 y(gal.)h(There)16 b(are)f(other)g(restrictions)
g(as)g(well.)21 b(F)o(or)14 b(e)o(xample,)j(this)e(de\002nition)-150
1128 y(is)k(ille)o(gal)e(\(unless)j(it)e(is)h(inside)g(a)g
(quotation\):)-72 1278 y Fs(f)40 b(x)f(=)h($\(zipN)g(x\))-150
1428 y Fu(Why?)28 b(Because)21 b(the)f(\223)p Fs($)p
Fu(\224)h(says)f(\223e)n(v)n(aluate)i(at)e(compile)h(time)f(and)h
(splice\224,)-150 1511 y(b)o(ut)f(the)g(v)n(alue)h(of)f
Fs(x)h Fu(is)e(not)i(kno)n(wn)g(until)f Fs(f)h Fu(is)e(called.)28
b(This)20 b(is)f(a)h(common)-150 1594 y(staging)g(error)l(.)-150
1725 y(T)-6 b(o)19 b(enforce)h(restrictions)f(lik)o(e)h(these,)f(we)g
(break)h(the)f(static-checking)i(part)-150 1808 y(of)16
b(the)f(compiling)i(process)g(into)e(three)h(states.)22
b Ft(Compiling)16 b Fu(\()p Ft(C)p Fu(\))f(is)g(the)h(state)-150
1891 y(of)28 b(normal)g(compilation.)49 b(W)m(ithout)28
b(the)f(meta-operators)i(the)e(compiler)-150 1974 y(w)o(ould)19
b(al)o(w)o(ays)f(be)g(in)g(this)g(state.)k(The)c(compiler)g(enters)g
(the)g(state)g Ft(Br)o(ac)o(k)o(et)-150 2057 y Fu(\()p
Ft(B)p Fu(\))h(when)i(compiling)g(code)f(inside)h(quasi-quotes.)27
b(The)20 b(compiler)h(enters)-150 2140 y(the)15 b(state)g
Ft(Splicing)g Fu(\()p Ft(S)p Fu(\))g(when)h(it)e(encounters)i(an)g(e)o
(xpression)g(escape)f(inside)-150 2223 y(quasi-quoting)21
b(brack)o(ets.)j(F)o(or)18 b(e)o(xample,)h(consider:)-72
2373 y Fs(f)40 b(::)g(Int)g(->)f(Expr)-72 2456 y(f)h(x)f(=)h([|)g(foo)f
($\(zipN)i(x\))f(|])-150 2606 y Fu(The)18 b(de\002nition)g(of)f
Fs(f)h Fu(is)f(statically)h(check)o(ed)h(in)f(state)f
Ft(C)p Fu(,)g(the)h(call)f(to)h Fs(foo)g Fu(is)-150 2689
y(typed)i(in)f(state)f Ft(B)p Fu(,)g(b)o(ut)h(the)g(call)f(to)h
Fs(zipN)h Fu(is)e(typed)i(in)f(state)f Ft(S)p Fu(.)-150
2819 y(In)k(addition)g(to)g(the)g(states,)g(we)g(count)h(le)n(v)o(els,)
f(by)g(starting)g(in)g(state)g(0,)g(in-)-150 2902 y(crementing)c(when)g
(processing)h(under)f(quasi-quotes,)g(and)g(decrementing)-150
2985 y(when)26 b(processing)i(inside)e Fs($)f Fu(or)h
Fs(splice)p Fu(.)45 b(The)26 b(le)n(v)o(els)g(are)g(used)g(to)g(dis-)
-150 3068 y(tinguish)h(a)g(top-le)n(v)o(el)g(splice)g(from)g(a)g
(splice)g(inside)g(quasi-quotes.)48 b(F)o(or)-150 3151
y(e)o(xample)-72 3301 y Fs(g)40 b(x)f(=)h($\(h)g([|)f(x*2)h(|]\))-150
3452 y Fu(The)25 b(call)g(to)g Fs(h)g Fu(is)f(statically)h(check)o(ed)i
(in)d(state)h Ft(S)h Fu(at)f(le)n(v)o(el)g(-1,)h(while)f(the)-150
3535 y Fs(x*2)i Fu(is)f(check)o(ed)i(in)e(state)g Ft(B)g
Fu(at)g(le)n(v)o(el)g(0.)45 b(These)27 b(three)f(states)g(and)h(their)
-150 3618 y(le)o(gal)20 b(transitions)g(are)g(re\003ected)g(in)h
(Figure)f(1.)27 b(T)m(ransitions)20 b(not)h(in)f(the)g(di-)-150
3701 y(agram)e(indicate)g(error)g(transitions.)23 b(It)17
b(is)g(tempting)h(to)g(think)g(that)g(some)g(of)-150
3784 y(the)23 b(states)g(can)g(be)h(mer)o(ged)f(together)m(,)i(b)o(ut)d
(this)h(is)g(not)g(the)g(case.)36 b(T)m(ransi-)-150 3867
y(tions)21 b(on)h Fs($)g Fu(from)f(state)g Ft(C)g Fu(imply)h
(compile-time)f(computation,)i(and)f(thus)-150 3950 y(require)i(more)g
(complicated)g(static)f(checking)i(\(including)f(the)g(computa-)-150
4033 y(tion)19 b(itself!\))j(than)e(transitions)f(on)g
Fs($)g Fu(from)g(the)g(other)g(states.)-150 4163 y(The)28
b(rules)g(of)g(the)g(diagram)h(are)f(enforced)h(by)f(wea)o(ving)h(them)
f(into)g(the)-150 4246 y(type)20 b(check)o(er)l(.)28
b(The)20 b(formal)f(typing)i(judgments)g(of)f(the)g(type)h(check)o(er)g
(are)-150 4329 y(gi)n(v)o(en)d(in)f(Figure)g(2;)h(the)o(y)f(embody)i
(the)e(transition)h(diagram)g(by)f(supplying)-150 4412
y(cases)i(only)h(for)f(le)o(gal)f(states.)23 b(W)-6 b(e)18
b(no)n(w)i(study)f(the)g(rules)g(in)g(more)g(detail.)-150
4588 y Fk(7.1)99 b(Expr)l(essions)-150 4719 y Fu(W)-6
b(e)21 b(be)o(gin)i(with)e(the)h(rules)f(for)h(e)o(xpressions,)h
(because)g(the)o(y)f(are)g(simpler;)-150 4802 y(indeed,)32
b(the)o(y)d(are)g(just)g(simpli\002cations)g(of)f(the)h
(well-established)h(rules)-150 4885 y(for)25 b(MetaML)h([16)q(].)42
b(The)26 b(type)g(judgment)g(rules)g(for)f(e)o(xpressions)i(tak)o(es)
-150 4968 y(the)19 b(con)m(v)o(entional)i(form)688 5101
y Fo(G)41 b Fp(`)820 5070 y Fh(n)820 5120 y(s)893 5101
y Ft(e)16 b Fu(:)h Fo(t)-150 5234 y Fu(where)29 b Fo(G)g
Fu(is)g(an)g(en)m(vironment)i(mapping)f(v)n(ariables)g(to)f(their)g
(types)g(and)-150 5317 y(binding)22 b(states,)e Ft(e)h
Fu(is)f(an)h(e)o(xpression,)h Fo(t)e Fu(is)g(a)h(type.)29
b(The)20 b(state)h Ft(s)f Fu(describes)-150 5400 y(the)f
Ft(state)g Fu(of)g(the)g(type)g(check)o(er)m(,)h(and)g
Ft(n)f Fu(is)f(the)h(le)n(v)o(el,)g(as)g(described)h(abo)o(v)o(e.)p
3 setlinewidth np 2934 472 345 198.18 284.60 arc st 0 setgray
3 setlinewidth np 2959 143 a 3021 138 li 2964 113 li
closepath fil 0 setgray np 2959 143 a 3021 138 li 2964
113 li closepath st 3 setlinewidth np 2511 742 94 306.87
593.13 arc st 0 setgray 3 setlinewidth np 2434 725 a
2455 666 li 2409 708 li closepath fil 0 setgray np 2434
725 a 2455 666 li 2409 708 li closepath st 3 setlinewidth
np 3191 1081 94 306.87 593.13 arc st 0 setgray 3 setlinewidth
np 3113 1065 a 3135 1007 li 3088 1048 li closepath fil
0 setgray np 3113 1065 a 3135 1007 li 3088 1048 li closepath
st 3 setlinewidth np 2934 558 345 75.40 161.82 arc st
0 setgray 3 setlinewidth np 2964 918 a 3021 893 li 2959
888 li closepath fil 0 setgray np 2964 918 a 3021 893
li 2959 888 li closepath st 3 setlinewidth np 3172 855
168 0.00 360.00 arc st 3 setlinewidth np 2530 515 168
0.00 360.00 arc st 3 setlinewidth np 3210 175 168 0.00
360.00 arc st 0 setgray 3 setlinewidth np 3036 309 a
3059 251 li 3012 291 li closepath fil 0 setgray np 3036
309 a 3059 251 li 3012 291 li closepath st 3 setlinewidth
np 3059 251 a 3051 262 li 3047 269 li 3042 276 li 3036
285 li 3029 296 li 3022 308 li 3016 320 li 3009 333 li
3003 347 li 2998 362 li 2992 378 li 2988 395 li 2985
414 li 2983 434 li 2982 455 li 2983 478 li 2986 498 li
2989 518 li 2994 537 li 3000 554 li 3006 570 li 3013
585 li 3019 599 li 3027 612 li 3035 624 li 3043 636 li
3051 648 li 3058 659 li 3066 668 li 3073 677 li 3079
685 li 3085 691 li 3090 696 li 3093 700 li 3094 702 li
3096 704 li 3097 704 li st 0 setgray 3 setlinewidth np
3300 670 a 3248 704 li 3310 698 li closepath fil 0 setgray
np 3300 670 a 3248 704 li 3310 698 li closepath st 3
setlinewidth np 3248 704 a 3256 701 li 3261 699 li 3268
697 li 3276 694 li 3285 690 li 3294 686 li 3303 681 li
3313 675 li 3323 669 li 3333 662 li 3342 653 li 3352
644 li 3361 633 li 3370 621 li 3378 607 li 3385 591 li
3393 573 li 3399 554 li 3403 534 li 3406 515 li 3408
495 li 3408 476 li 3408 458 li 3406 440 li 3404 422 li
3402 405 li 3399 389 li 3396 372 li 3392 356 li 3388
341 li 3384 326 li 3380 312 li 3376 299 li 3373 287 li
3370 277 li 3367 269 li 3364 262 li 3363 257 li 3362
254 li 3361 252 li 3361 251 li st 2509 213 a Fs([|)39
b(|])3062 1240 y(reify)2379 910 y(reify)2760 968 y(splice)2760
825 y($)2492 515 y Ff(C)3134 893 y(S)3172 213 y(B)3436
477 y Fs($)-488 b([|)39 b(|])2343 1397 y Fr(Figur)o(e)18
b(1.)23 b(T)-6 b(yping)18 b(states)h(f)n(or)h(T)-7 b(emplate)18
b(Hask)o(ell)2049 1674 y Fu(Rule)25 b Fe(B)t(R)t(A)r(C)t(K)t(E)t(T)c
Fu(says)i(that)f(when)i(in)e(one)i(of)f(the)g(states)f
Ft(C)g Fu(or)h Ft(S)p Fu(,)g(the)g(e)o(x-)2049 1757 y(pression)h
Fs([|)p Fu(e)p Fs(|])g Fu(has)g(type)g Ff(Q)19 b(Exp)p
Fu(,)24 b Ft(r)m(e)m(gar)m(dless)h(of)e(the)g(type)h(of)f(e)p
Fu(.)37 b(Ho)n(w-)2049 1840 y(e)n(v)o(er)m(,)18 b(notice)h(that)f
Ft(e)f Fu(is)h(still)f(type-check)o(ed,)j(b)o(ut)e(in)g(a)g(ne)n(w)g
(state)g Ft(B)p Fu(,)f(and)i(we)2049 1923 y(increment)k(the)g(le)n(v)o
(el.)35 b(This)22 b(re\003ects)g(the)h(le)o(gal)f(transitions)h(from)g
(Figure)2049 2006 y(1,)h(and)g(emphasizes)h(that)e(we)h(can)g(only)g
(use)g(the)h Fe(B)t(R)t(A)r(C)t(K)t(E)t(T)d Fu(typing)i(rule)2049
2089 y(when)c(in)e(one)i(of)f(the)g(listed)f(states.)2049
2226 y(T)-6 b(ype)22 b(checking)h(the)f(term)f Fs(e)h
Fu(detects)g(an)o(y)g(internal)g(type)g(inconsistencies)2049
2309 y(right)31 b(a)o(w)o(ay;)38 b(for)31 b(e)o(xample)h
Fs([|)40 b('a')g(+)f(True)h(|])32 b Fu(w)o(ould)g(be)g(rejected)2049
2392 y(immediately)-5 b(.)57 b(This)30 b(represents)h(an)f(interesting)
h(design)g(compromise:)2049 2475 y(meta-functions,)i(including)e(the)f
(code)g(fragments)h(that)e(the)o(y)h(generate,)2049 2558
y(are)d(statically)h(check)o(ed,)j(b)o(ut)c(that)g(does)i(not)e
(guarantee)i(that)e(the)h(meta-)2049 2641 y(function)g(can)f(produce)h
(only)f(well-typed)h(code,)h(so)e(completed)h(splices)2049
2724 y(are)22 b(re-check)o(ed.)33 b(W)-6 b(e)21 b(belie)n(v)o(e)i(this)
e(is)h(a)f(ne)n(w)h(approach)i(to)d(typing)i(meta-)2049
2807 y(programs.)31 b(This)20 b(approach)j(catches)f(man)o(y)g(errors)f
(as)g(early)g(as)g(possible,)2049 2890 y(a)o(v)o(oids)26
b(the)g(need)h(for)e(using)i(dependent)h(types,)g(yet)e(is)f(still)g
(completely)2049 2973 y(type-safe.)2049 3111 y(Notice,)39
b(too,)f(that)d(there)g(is)g(no)g(rule)g(for)g(quasi-quotes)h(in)f
(state)f Ft(B)h Fu(\226)2049 3194 y(quasi-quotes)28 b(cannot)f(be)g
(nested,)i(unlik)o(e)e(multi-stage)g(languages)h(such)2049
3277 y(as)19 b(MetaML.)2049 3414 y(Rule)30 b Fe(E)t(S)t(C)t
Fu(B)f(e)o(xplains)g(ho)n(w)f(to)h(type)f(check)i(a)e(splice)g
Fs($)q Ft(e)g Fu(inside)g(quasi-)2049 3497 y(quotes)18
b(\(state)f Ft(B)p Fu(\).)f(The)h(type)h(of)f Ft(e)g
Fu(must)h(be)f Ff(Q)i(Exp)p Fu(,)e(b)o(ut)g(that)g(tells)g(us)g(noth-)
2049 3580 y(ing)e(about)i(the)e(type)h(of)f(the)g(e)o(xpression)i(that)
e Ft(e)g Fu(will)f(e)n(v)n(aluate)i(to;)g(hence)h(the)2049
3663 y(use)g(of)f(an)h(unspeci\002ed)h Fo(t)p Fu(.)k(There)16
b(is)g(no)h(problem)g(about)h(soundness,)g(ho)n(w-)2049
3746 y(e)n(v)o(er:)35 b(the)25 b(e)o(xpression)h(in)e(which)h(the)g
(splice)g(sits)f(will)f(be)i(type-check)o(ed)2049 3829
y(later)l(.)2049 3967 y(Indeed,)h(that)d(is)h(precisely)g(what)g
(happens)i(in)d(Rule)j Fe(E)t(S)t(C)t Fu(S)r(,)21 b(which)j(deals)2049
4050 y(with)16 b(splicing)g(when)g(in)g(state)g Ft(C)p
Fu(.)f(The)h(e)o(xpression)h Ft(e)f Fu(is)g(type)g(check)o(ed,)i(and)
2049 4133 y(then)h(e)n(v)n(aluated,)i(to)d(gi)n(v)o(e)i(a)f(ne)n(w)g(e)
o(xpression)h Ft(e)3301 4106 y Fd(0)3322 4133 y Fu(.)j(This)18
b(e)o(xpression)j(is)d(then)2049 4216 y(type)26 b(check)o(ed)i(from)e
(scratch)g(\(in)g(state)f Ft(C)p Fu(\),)g(just)h(as)g(if)f(the)h
(programmer)2049 4299 y(had)20 b(written)e(it)g(in)h(the)g(\002rst)f
(place.)2049 4436 y(Rules)h Fe(L)t(A)t(M)f Fu(and)h Fe(V)l(A)t(R)f
Fu(deal)f(with)g(staging.)23 b(The)17 b(en)m(vironment)h
Fo(G)f Fu(contains)2049 4519 y(assumptions)f(of)f(the)g(form)g
Fj(\()p Ft(x)e Fu(:)g Fj(\()p Fo(s)p Fl(;)8 b Ft(m)p
Fj(\)\))p Fu(,)15 b(which)g(records)h(not)f(only)g Ft(x)p
Fu(')l(s)g(type)2049 4602 y(b)o(ut)k(also)h(the)g(le)n(v)o(el)f
Ft(m)h Fu(at)f(which)h(it)f(w)o(as)h(bound)h(\(rule)g
Fe(L)t(A)t(M)r Fu(\).)j(W)-6 b(e)19 b(think)h(of)2049
4685 y(this)26 b(en)m(vironment)i(as)f(a)g(\002nite)f(function.)47
b(Then,)28 b(when)g(a)e(v)n(ariable)h Ft(x)g Fu(is)2049
4768 y(used)19 b(at)f(le)n(v)o(el)g Ft(n)p Fu(,)g(we)g(check)h(that)f
Ft(n)g Fu(is)g(later)f(than)i(\()p Fp(\025)p Fu(\))e(its)h(binding)h
(le)n(v)o(el,)f Ft(m)2049 4851 y Fu(\(rule)j Fe(V)l(A)t(R)r
Fu(\).)2049 5046 y Fk(7.2)99 b(Declar)o(ations)2049 5184
y Fu(Figure)25 b(2)g(also)g(gi)n(v)o(es)h(the)f(rules)g(for)g(typing)h
(declarations,)h(whose)f(judg-)2049 5267 y(ments)19 b(are)g(of)g(form:)
2822 5400 y Fo(G)40 b Fp(`)2953 5369 y Fh(n)2953 5418
y(s)3026 5400 y Ft(d)t(ecl)21 b Fu(:)16 b Fo(G)3257 5369
y Fd(0)1931 5649 y Fu(7)p eop
%%Page: 8 8
8 7 bop -147 3 1995 4 v -147 2930 4 2927 v 526 144 a
Fu(States:)64 b Ft(s)17 b Fp(\022)c Ft(C)r Fl(;)8 b Ft(B)p
Fl(;)g Ft(S)370 227 y Fu(E)t Fe(X)t(P)t(R)t(E)t(S)t(S)t(I)t(O)t(N)t(S)t
Fu(:)64 b Fo(G)40 b Fp(`)1034 200 y Fh(n)1034 246 y(s)1107
227 y Ft(e)o(x)6 b(pr)19 b Fu(:)d Fo(t)489 488 y(G)40
b Fp(`)620 457 y Fh(n)p Fc(+)p Fn(1)620 512 y Fh(B)767
488 y Ft(e)17 b Fu(:)g Fo(t)p 345 546 687 5 v 1056 563
a Fe(B)t(R)t(A)r(C)t(K)t(E)t(T)345 638 y Fo(G)40 b Fp(`)476
607 y Fh(n)473 658 y(C)r Fg(;)p Fh(S)603 638 y Fs([|)p
Ft(e)p Fs(|])17 b Fu(:)g Ff(Q)g(Exp)65 890 y Fo(G)40
b Fp(`)196 859 y Fh(n)196 911 y(S)270 890 y Ft(e)17 b
Fu(:)f Ff(Q)h(Exp)p 65 948 477 5 v 566 965 a Fe(E)t(S)t(C)t
Fu(B)84 1040 y Fo(G)41 b Fp(`)216 1009 y Fh(n)p Fc(+)p
Fn(1)216 1063 y Fh(B)363 1040 y Fs($)p Ft(e)17 b Fu(:)f
Fo(t)991 819 y(G)41 b Fp(`)1123 792 y Fn(0)1120 844 y
Fh(C)1204 819 y Ft(e)1237 792 y Fd(0)1274 819 y Fu(:)16
b Fo(t)987 903 y Ff(r)q(unQ)i Ft(e)f Fp(7!)f Ft(e)1328
876 y Fd(0)929 994 y Fo(G)41 b Fp(`)1061 967 y Fn(0)1061
1019 y Fh(S)1134 994 y Ft(e)17 b Fu(:)f Ff(Q)h(Exp)p
888 1031 560 5 v 1472 1048 a Fe(E)t(S)t(C)t Fu(S)982
1122 y Fo(G)40 b Fp(`)1113 1091 y Fn(0)1110 1143 y Fh(C)1194
1122 y Fs($)q Ft(e)16 b Fu(:)h Fo(t)572 1277 y Ft(x)g
Fp(2)g Fo(G)p 170 1335 966 5 v 1160 1352 a Fe(R)t(E)t(I)t(F)t(Y)t
Fu(D)t Fe(E)t(C)t(L)170 1427 y Fo(G)40 b Fp(`)301 1396
y Fh(n)298 1448 y(C)r Fg(;)p Fh(S)428 1427 y Fs(reifyDecl)i
Ft(x)56 b Fu(:)16 b Ff(Q)h(Dec)73 1621 y Fo(G)p Fu(;)8
b Fj(\()p Ft(x)17 b Fu(:)g Fj(\()p Fo(t)326 1632 y Fh(x)355
1621 y Fl(;)8 b Ft(n)p Fj(\)\))41 b Fp(`)566 1590 y Fh(n)566
1639 y(s)639 1621 y Ft(e)17 b Fu(:)f Fo(t)p 73 1679 687
5 v 783 1695 a Fe(L)t(A)t(M)77 1770 y Fo(G)41 b Fp(`)209
1739 y Fh(n)209 1789 y(s)282 1770 y Fp(n)17 b Ft(x)g
Fs(->)p Ft(e)g Fu(:)f Fo(t)584 1781 y Fh(x)631 1770 y
Fp(!)g Fo(t)1042 1600 y(G)g Ft(x)34 b Fj(=)f(\()p Fo(t)p
Fl(;)8 b Ft(m)p Fj(\))1147 1683 y Ft(n)17 b Fp(\025)g
Ft(m)p 1000 1702 477 5 v 1501 1718 a Fe(V)l(A)t(R)1070
1793 y Fo(G)p Fl(;)31 b Fp(`)1213 1762 y Fh(n)1213 1811
y(s)1287 1793 y Ft(x)17 b Fu(:)f Fo(t)p -50 1898 1801
4 v -6 2040 a Fu(D)t Fe(E)t(C)t(L)t(A)t(R)t(A)m(T)t(I)t(O)t(N)t(S)t
Fu(:)99 b Fo(G)41 b Fp(`)757 2013 y Fh(n)757 2059 y(s)830
2040 y Ft(d)t(ecl)21 b Fu(:)16 b Fo(G)1061 2013 y Fd(0)1212
2040 y Fo(G)40 b Fp(`)1343 2013 y Fh(n)1343 2059 y(s)1416
2040 y Fj([)p Ft(d)t(ecl)t Fj(])16 b Fu(:)h Fo(G)1689
2013 y Fd(0)139 2204 y Fo(G)p Fu(;)8 b Fj(\()p Ft(x)17
b Fu(:)f Fj(\()p Fo(t)391 2217 y Fn(1)424 2204 y Fl(;)8
b Ft(n)p Fj(\)\))p Fu(;)g Fj(\()j Ft(f)28 b Fu(:)16 b
Fj(\()p Fo(t)765 2217 y Fn(1)815 2204 y Fp(!)g Fo(t)939
2217 y Fn(2)972 2204 y Fl(;)8 b Ft(n)p Fj(\)\))41 b Fp(`)1183
2174 y Fh(n)1183 2223 y(s)1256 2204 y Ft(e)17 b Fu(:)f
Fo(t)1376 2217 y Fn(2)p 139 2263 1271 5 v 1434 2279 a
Fe(F)t(U)t(N)280 2354 y Fo(G)40 b Fp(`)411 2323 y Fh(n)411
2372 y(s)503 2354 y Ft(f)28 b(x)17 b Fj(=)g Ft(e)25 b
Fu(:)16 b Fp(f)p Fj(\()11 b Ft(f)28 b Fu(:)16 b Fo(t)968
2367 y Fn(1)1018 2354 y Fp(!)g Fo(t)1142 2367 y Fn(2)1175
2354 y Fj(\))1204 2365 y Fh(s)1231 2354 y Fp(g)399 2522
y Fo(G)40 b Fp(`)530 2495 y Fn(0)527 2547 y Fh(C)611
2522 y Fj([)p Ft(d)669 2535 y Fn(1)703 2522 y Fl(;)8
b(:)g(:)g(:)g(;)g Ft(d)885 2533 y Fh(n)918 2522 y Fj(])17
b Fu(:)f Fo(G)1038 2495 y Fd(0)411 2606 y Ff(r)q(unQ)i
Ft(e)f Fp(7!)f Fj([)p Ft(d)777 2619 y Fn(1)810 2606 y
Fl(;)8 b(:)g(:)g(:)g(;)g Ft(d)992 2617 y Fh(n)1026 2606
y Fj(])464 2697 y Fo(G)40 b Fp(`)595 2670 y Fn(0)592
2722 y Fh(C)676 2697 y Ft(e)17 b Fu(:)f Ff(Q)h Fj([)p
Ff(Dec)p Fj(])p 358 2733 743 5 v 1124 2750 a Fe(S)t(P)t(L)t(I)t(C)t(E)
452 2825 y Fo(G)40 b Fp(`)583 2794 y Fn(0)580 2846 y
Fh(C)664 2825 y Ff(splice)17 b Ft(e)g Fu(:)f Fo(G)985
2794 y Fd(0)p 1845 2930 4 2927 v -147 2933 1995 4 v 154
3010 a Fr(Figur)o(e)i(2.)23 b(T)-6 b(yping)19 b(rules)f(f)n(or)h(T)-7
b(emplate)19 b(Hask)o(ell)-150 3272 y Fu(Here,)34 b Fo(G)d
Fu(is)g(the)g(en)m(vironment)i(in)e(which)h(the)f(declarations)h
(should)g(be)-150 3355 y(check)o(ed,)22 b(while)e Fo(G)364
3328 y Fd(0)404 3355 y Fu(is)f(a)h(mini-en)m(vironment)i(that)d(gi)n(v)
o(es)i(the)f(types)h(of)f(the)-150 3438 y(v)n(ariables)g(bound)g(by)f
Ft(d)t(ecl)567 3411 y Fn(4)601 3438 y Fu(.)-150 3560
y(Most)i(rules)f(are)g(quite)h(con)m(v)o(entional;)h(for)e(e)o(xample,)
h(Rule)h Fe(F)t(U)t(N)g Fu(e)o(xplains)-150 3643 y(ho)n(w)g(to)g(type)g
(function)h(de\002nitions.)31 b(The)22 b(rule)g(for)f(splicing)i(is)e
(the)h(inter)o(-)-150 3726 y(esting)j(one,)h(and)f(it)f(follo)n(ws)g
(the)g(same)h(pattern)g(as)f(for)g(splicing)h(e)o(xpres-)-150
3809 y(sions.)43 b(First)24 b(type-check)k(the)d(spliced)h(e)o
(xpression)h Ft(e)p Fu(,)f(then)g(run)g(it,)g(then)-150
3892 y(typecheck)21 b(the)e(declarations)g(it)g(returns.)-150
4014 y(The)i(ability)g(to)h(generate)g(a)f(group)i(of)e(declarations)h
(seems)g(to)f(be)h(of)g(fun-)-150 4097 y(damental)k(usefulness,)h(b)o
(ut)e(it)g(raises)g(an)g(interesting)g(complication:)37
b Ft(we)-150 4180 y(cannot)27 b(e)o(ven)g(r)m(esolve)g(the)g(le)o
(xical)e(scoping)j(of)e(the)g(pr)m(o)o(gr)o(am,)j(let)d(alone)-150
4263 y(the)19 b(types,)g(until)g(splicing)g(has)g(been)h(done)p
Fu(.)-150 4386 y(F)o(or)e(e)o(xample,)i(is)e(this)h(program)h(v)n
(alid?)-72 4508 y Fs(splice)41 b(\(genZips)g(20\))-72
4591 y(foo)f(=)g(zip3)g("fee")g("fie")h("fum")-150 4713
y Fu(W)-6 b(ell,)23 b(it)f(is)g(v)n(alid)h(if)f(the)h(splice)g(brings)h
Fs(zip3)f Fu(into)g(scope)h(\(as)e(we)h(e)o(xpect)-150
4796 y(it)i(to)h(do\))g(and)g(not)g(if)f(it)g(doesn')o(t.)44
b(Similar)24 b(remarks)i(naturally)g(apply)h(to)-150
4879 y(the)20 b Fs(instance)i Fu(declaration)f(produced)h(by)f(the)f
Fs(genEq)h Fu(function)g(of)f(Sec-)-150 4962 y(tion)i(5.1.)34
b(If)21 b(the)i(module)g(contains)g(se)n(v)o(eral)g Fs(splice)p
Fu(s,)h(it)d(may)i(not)f(be)h(at)-150 5045 y(all)18 b(ob)o(vious)j(in)d
(which)i(order)f(to)g(e)o(xpand)h(them.)-150 5167 y(W)-6
b(e)24 b(tackle)g(this)f(complication)i(by)g(assuming)g(that)f(the)g
(programmer)h(in-)-150 5250 y(tends)e(the)h Fs(splice)p
Fu(s)g(to)f(be)g(e)o(xpanded)i(top-to-bottom.)36 b(More)23
b(precisely)-5 b(,)p -150 5312 801 4 v -49 5373 a Fn(4)-16
5400 y Fu(A)19 b(single)g(Hask)o(ell)h(declaration)f(can)h(bind)f(man)o
(y)h(v)n(ariables.)2049 83 y(to)28 b(type-check)i(a)e(group)h(of)f
(declarations)h Fj([)p Ft(d)3291 96 y Fn(1)3324 83 y
Fl(;)8 b(:)g(:)g(:)g(;)g Ft(d)3506 95 y Fh(N)3553 83
y Fj(])p Fu(,)30 b(we)e(follo)n(w)g(the)2049 166 y(follo)n(wing)19
b(procedure:)2136 288 y Fp(\017)42 b Fu(Group)20 b(the)f(declarations)g
(as)g(follo)n(ws:)2969 420 y Fj([)o Ft(d)3026 433 y Fn(1)3060
420 y Fl(;)8 b(:)g(:)g(:)g(;)g Ft(d)3242 431 y Fh(a)3276
420 y Fj(])2972 503 y Fs(splice)20 b Ft(e)3259 514 y
Fh(a)2932 586 y Fj([)o Ft(d)2989 599 y Fh(a)p Fc(+)p
Fn(2)3097 586 y Fl(;)8 b(:)g(:)g(:)g(;)g Ft(d)3279 600
y Fh(b)3313 586 y Fj(])2972 669 y Fs(splice)20 b Ft(e)3259
683 y Fh(b)3093 752 y Fl(:)8 b(:)g(:)2976 835 y Fs(splice)20
b Ft(e)3263 846 y Fh(z)2928 918 y Fj([)p Ft(d)2986 931
y Fh(z)p Fc(+)p Fn(2)3087 918 y Fl(;)8 b(:)g(:)g(:)g(;)g
Ft(d)3269 930 y Fh(N)3316 918 y Fj(])2215 1051 y Fu(where)30
b(the)g(only)h Fs(splice)g Fu(declarations)g(are)f(the)g(ones)h
(indicated)2215 1134 y(e)o(xplicitly)-5 b(,)20 b(so)g(that)g(each)h
(group)g Fj([)p Ft(d)3157 1147 y Fn(1)3190 1134 y Fl(;)8
b(:)g(:)g(:)g(;)g Ft(d)3372 1145 y Fh(a)3406 1134 y Fj(])p
Fu(,)19 b(etc,)h(are)g(all)g(ordinary)2215 1217 y(Hask)o(ell)f
(declarations.)2136 1337 y Fp(\017)42 b Fu(Perform)21
b(con)m(v)o(entional)i(dependenc)o(y)g(analysis,)f(follo)n(wed)g(by)f
(type)2215 1420 y(checking,)e(on)f(the)f(\002rst)f(group.)24
b(All)16 b(its)h(free)g(v)n(ariables)h(should)g(be)g(in)2215
1503 y(scope.)2136 1624 y Fp(\017)42 b Fu(In)26 b(the)g(en)m(vironment)
h(thus)f(established,)i(type-check)g(and)e(e)o(xpand)2215
1707 y(the)19 b(\002rst)f Fs(splice)p Fu(.)2136 1827
y Fp(\017)42 b Fu(T)-6 b(ype-check)20 b(the)f(result)g(of)g(e)o
(xpanding)i(the)e(\002rst)f Fs(splice)p Fu(.)2136 1947
y Fp(\017)42 b Fu(In)29 b(the)g(augmented)i(en)m(vironment)g(thus)e
(established,)j(type-check)2215 2030 y(the)19 b(ne)o(xt)g(ordinary)h
(group,)2136 2151 y Fp(\017)42 b Fu(And)19 b(so)g(on.)2049
2273 y(It)28 b(is)g(this)g(algorithm)h(that)f(implements)h(the)f
(judgment)i(for)e(declaration)2049 2356 y(lists)18 b(that)h(we)g(used)g
(in)g(the)g(rule)i Fe(S)t(P)t(L)t(I)t(C)t(E)r Fu(:)2724
2488 y Fo(G)40 b Fp(`)2855 2457 y Fh(n)2855 2506 y(s)2928
2488 y Fj([)p Ft(d)2986 2501 y Fn(1)3020 2488 y Fl(;)8
b(:)g(:)g(:)g(;)g Ft(d)3202 2499 y Fh(n)3235 2488 y Fj(])16
b Fu(:)h Fo(G)3355 2457 y Fd(0)2049 2675 y Fk(7.3)99
b(Restrictions)23 b(on)i(declar)o(ation)d(splicing)2049
2798 y Fu(Notice)k(that)g(the)g(rule)g(for)i Fe(S)t(P)t(L)t(I)t(C)t(E)d
Fu(assumes)i(that)f(we)g(are)g(in)g(state)f Ft(C)h Fu(at)2049
2881 y(le)n(v)o(el)c(0.)31 b(W)-6 b(e)21 b(do)h(not)f(permit)h(a)f
(declaration)h Fs(splice)h Fu(in)e(an)o(y)i(other)e(state.)2049
2964 y(F)o(or)d(e)o(xample,)i(we)f(do)g(not)g(permit)g(this:)2127
3086 y Fs(f)40 b(::)g(Int)g(->)f(Expr)2127 3169 y(f)h(x)f(=)h([|)g(let)
2559 3252 y(splice)h(\(h)e(x\))2481 3335 y(in)g(\(p,q\))2363
3418 y(|])2049 3540 y Fu(where)20 b Fs(h)40 b(::)f(Int)h(->)g(Decl)p
Fu(.)27 b(When)20 b(type-checking)i Fs(f)e Fu(we)g(cannot)h(run)2049
3623 y(the)26 b(computation)h Fs(\(h)40 b(x\))26 b Fu(because)i
Fs(x)e Fu(is)f(not)i(kno)n(wn)g(yet;)i(b)o(ut)d(until)g(we)2049
3706 y(ha)o(v)o(e)h(run)g Fs(\(h)40 b(x\))27 b Fu(we)g(do)h(not)f(kno)n
(w)h(what)e(the)h Fs(let)h Fu(binds,)h(and)f(so)f(we)2049
3789 y(cannot)22 b(sensibly)g(type-check)h(the)e(body)h(of)f(the)g
Fs(let)p Fu(,)h(namely)g Fs(\(p,q\))p Fu(.)30 b(It)2049
3872 y(w)o(ould)19 b(be)f(possible)g(to)g(gi)n(v)o(e)g(up)g(on)g
(type-checking)i(the)e(body)h(since,)f(after)2049 3955
y(all,)k(the)g(result)f(of)h(e)n(v)o(ery)h(call)e(to)h
Fs(f)g Fu(will)e(itself)h(be)i(type-check)o(ed,)h(b)o(ut)e(the)2049
4038 y(logical)c(conclusion)h(of)f(that)g(line)g(of)g(thought)h(w)o
(ould)f(be)g(gi)n(v)o(e)h(up)f(on)g(type-)2049 4121 y(checking)23
b(the)e(body)h(of)f(an)o(y)h(quasi-quote)g(e)o(xpression.)31
b(Doing)22 b(so)f(w)o(ould)2049 4204 y(be)k(sound,)h(b)o(ut)f(it)e(w)o
(ould)j(defer)e(man)o(y)h(type)g(errors)g(from)f(the)h(de\002nition)
2049 4287 y(site)k(of)g(the)g(meta-function)h(to)f(its)f(call)h
(site\(s\).)53 b(Our)29 b(choice,)j(pending)2049 4370
y(further)19 b(e)o(xperience,)h(is)e(to)h(err)g(on)g(the)g(side)g(of)g
(earlier)g(error)g(detection.)2049 4492 y(If)d(you)h(w)o(ant)g(the)f
(ef)n(fect)g(of)h(the)f Fs(f)h Fu(abo)o(v)o(e,)g(you)g(can)g(still)e
(get)i(it)e(by)i(dropping)2049 4575 y(do)n(wn)j(to)f(a)g(lo)n(wer)f(le)
n(v)o(el:)2127 4697 y Fs(f)40 b(::)g(Int)g(->)f(Expr)2127
4780 y(f)h(x)f(=)h(letE)g(\(h)g(x\))f(\(tup)h([var)h("p",)f(var)g
("q"]\))2049 4902 y Fu(In)21 b(f)o(act,)g(we)g(currently)g(restrict)f
Fs(splice)i Fu(further:)27 b(it)21 b(must)g(be)g(a)g
Ft(top-le)o(vel)2049 4985 y Fu(declaration,)32 b(lik)o(e)d(Hask)o(ell')
l(s)g Fs(data)p Fu(,)j Fs(class)p Fu(,)g(and)e Fs(instance)g
Fu(declara-)2049 5068 y(tions.)h(The)22 b(reason)g(for)f(this)h
(restriction)f(concerns)i(usability)f(rather)f(than)2049
5151 y(technical)i(comple)o(xity)-5 b(.)35 b(Since)22
b(declaration)i(splices)e(introduce)i(unspeci-)2049 5234
y(\002ed)15 b(ne)n(w)g(bindings,)h(it)e(may)h(not)g(be)g(clear)g(where)
g(a)g(v)n(ariable)g(that)f(occurs)i(in)2049 5317 y(the)h(original)g
(program)h(is)f(bound.)24 b(The)17 b(situation)g(is)f(similar)h(for)g
(Hask)o(ell')l(s)2049 5400 y(e)o(xisting)26 b Fs(import)g
Fu(statements:)36 b(the)o(y)26 b(bring)g(into)f(scope)h(an)g
(unspeci\002ed)1931 5649 y(8)p eop
%%Page: 9 9
9 8 bop -150 83 a Fu(collection)20 b(of)f(bindings.)26
b(By)20 b(restricting)f Fs(splice)i Fu(to)e(top)h(le)n(v)o(el)g(we)f
(mak)o(e)-150 166 y(a)24 b(w)o(orthwhile)g(gain:)33 b
Ft(given)25 b(an)f(occurr)m(ence)i(of)d Fs(x)p Ft(,)i(if)e(we)h(can)h
(see)f(a)f(le)o(x-)-150 249 y(ically)k(enclosing)i(binding)f(for)g
Fs(x)p Ft(,)h(that)f(is)f(indeed)h Fs(x)p Ft(')m(s)g(binding)p
Fu(.)49 b(A)28 b(top)-150 332 y(le)n(v)o(el)20 b Fs(splice)i
Fu(cannot)g(hide)e(another)i(top-le)n(v)o(el)f(binding)g(\(or)f
(import\))h(for)-150 415 y Fs(x)16 b Fu(because)i(Hask)o(ell)e(does)h
(not)g(permit)f(tw)o(o)g(de\002nitions)h(of)f(the)g(same)h(v)n(alue)
-150 498 y(at)i(top)h(le)n(v)o(el.)k(\(In)c(contrast,)f(a)g(nested)i
Fs(splice)f Fu(could)g(hide)g(the)g(enclosing)-150 581
y(binding)27 b(for)f Fs(x)p Fu(.\))43 b(Indeed,)28 b(one)f(can)f(think)
g(of)g(a)g(top-le)n(v)o(el)g Fs(splice)h Fu(as)f(a)-150
664 y(kind)20 b(of)e(programmable)j Fs(import)f Fu(statement.)-150
824 y Fv(8)99 b(The)26 b(quotation)g(monad)f(r)n(e)o(visited)-150
955 y Fu(So)j(f)o(ar)g(we)g(ha)o(v)o(e)g(used)h(the)f(quotation)i
(monad)f(only)g(to)f(generate)h(fresh)-150 1038 y(names.)34
b(It)22 b(has)h(other)g(useful)f(purposes)i(too,)f(as)g(we)f(discuss)h
(in)g(this)f(sec-)-150 1121 y(tion.)-150 1297 y Fk(8.1)99
b(Rei\002cation)-150 1428 y Fu(Rei\002cation)20 b(is)g(T)-5
b(emplate)21 b(Hask)o(ell')l(s)f(w)o(ay)h(of)g(allo)n(wing)g(the)g
(programmer)-150 1511 y(to)26 b(query)i(the)e(state)g(of)h(the)f
(compiler')l(s)h(internal)g(\(symbol\))g(tables.)45 b(F)o(or)-150
1594 y(e)o(xample,)19 b(the)g(programmer)h(may)g(write:)-72
1724 y Fs(module)41 b(M)f(where)-72 1890 y(data)h(T)e(a)h(=)f(Tip)h(a)f
(|)h(Fork)g(\(T)g(a\))f(\(T)h(a\))-72 2056 y(repT)h(::)e(Decl)-72
2139 y(repT)i(=)e(reifyDecl)i(T)-72 2305 y(lengthType)h(::)e(Type)-72
2388 y(lengthType)i(=)d(reifyType)j(length)-72 2554 y(percentFixity)h
(::)c(Q)h(Int)-72 2637 y(percentFixity)j(=)c(reifyFixity)j(\(\045\))-72
2804 y(here)f(::)e(Q)h(String)-72 2887 y(here)h(=)e(reifyLocn)-150
3017 y Fu(First,)32 b(the)e(construct)h Fs(reifyDecl)41
b(T)31 b Fu(returns)f(a)g(computation)i(of)e(type)-150
3100 y Fs(Decl)f Fu(\(i.e.)51 b Fs(Q)39 b(Dec)p Fu(\),)31
b Ft(r)m(epr)m(esenting)f Fu(the)f(type)f(declaration)i(of)e
Fs(T)p Fu(.)g(If)g(we)-150 3183 y(performed)g(the)f(computation)h
Fs(repT)f Fu(\(perhaps)h(by)f(writing)f Fs($repT)p Fu(\))i(we)-150
3266 y(w)o(ould)20 b(obtain)f(the)g Fs(Dec)p Fu(:)-72
3396 y Fs(Data)41 b("M:T")f(["a"])7 3479 y([Constr)h("M:Tip")g([Tvar)f
("a"],)46 3562 y(Constr)h("M:Fork")164 3645 y([Tapp)f(\(Tcon)h(\(Name)f
("M:T"\)\))h(\(Tvar)f("a"\),)203 3728 y(Tapp)g(\(Tcon)h(\(Name)f
("M:T"\)\))h(\(Tvar)f("a"\)]])7 3811 y([])-150 3941 y
Fu(W)-6 b(e)25 b(write)g(\223)p Fs(M:T)p Fu(\224)i(to)f(mean)g
(unambiguously)i(\223the)f Fs(T)e Fu(that)h(is)f(de\002ned)i(in)-150
4024 y(module)20 b Fs(M)p Fu(\224)f(\227)g(we)g(say)g(that)g
Fs(M:T)h Fu(is)f(its)f Ft(original)i(name)p Fu(.)k(Original)19
b(names)-150 4107 y(are)24 b(not)f(part)h(of)g(the)f(syntax)i(of)e
(Hask)o(ell,)i(b)o(ut)f(the)o(y)f(are)h(necessary)h(if)e(we)-150
4190 y(are)18 b(to)f(describe)i(\(and)f(indeed)g(implement\))g(the)g
(meta-programming)h(cor)o(-)-150 4274 y(rectly)-5 b(.)23
b(W)-6 b(e)19 b(will)e(say)j(more)f(about)h(original)f(names)g(in)g
(Section)g(9.1.)-150 4404 y(In)30 b(a)g(similar)g(w)o(ay)-5
b(,)33 b Fs(reifyDecl)41 b(f)p Fu(,)33 b(gi)n(v)o(es)d(a)g(data)g
(structure)h(that)f(rep-)-150 4487 y(resents)d(the)g(v)n(alue)g
(declaration)h(for)e Fs(f)p Fu(;)31 b(and)c(similarly)f(for)h(classes.)
47 b(In-)-150 4570 y(deed,)24 b(rei\002cation)d(pro)o(vides)j(a)e
(general)h(w)o(ay)f(to)g(get)h(at)f(compile-time)g(in-)-150
4653 y(formation.)35 b(The)23 b(construct)g Fs(reifyType)41
b(length)24 b Fu(returns)f(a)g(computa-)-150 4736 y(tion)g(of)f(type)h
Fs(Type)h Fu(\(i.e.)33 b Fs(Q)40 b(Typ)p Fu(\))23 b(representing)h(the)
e(compiler')l(s)h(kno)n(wl-)-150 4819 y(edge)35 b(about)g(the)f(type)h
(of)f(the)g(library)g(function)h Fs(length)p Fu(.)70
b(Similarly)-150 4902 y Fs(reifyFixity)21 b Fu(tells)d(the)h(\002xity)g
(of)g(its)f(ar)o(gument,)h(which)g(is)g(useful)g(when)-150
4985 y(\002guring)24 b(out)h(ho)n(w)f(to)g(print)g(something.)40
b(Finally)-5 b(,)25 b Fs(reifyLocn)p Fu(,)i(returns)-150
5068 y(a)c(computation)h(with)f(type)g Fs(Q)40 b(String)p
Fu(,)24 b(which)g(represents)f(the)g(location)-150 5151
y(in)29 b(the)g(source)g(\002le)f(where)i(the)f Fs(reifyLocn)h
Fu(occurred.)54 b(Reify)29 b(al)o(w)o(ays)-150 5234 y(returns)23
b(a)f(computation,)j(which)e(can)g(be)g(combined)h(with)e(other)h
(compu-)-150 5317 y(tations)h(at)g(compile-time.)38 b(Rei\002cation)23
b(is)h(a)g(language)h(construct,)h(not)e(a)-150 5400
y(function;)19 b(you)h(cannot)g(say)f Fs(\(map)41 b(reifyType)g(xs\))p
Fu(,)19 b(for)g(e)o(xample.)2049 83 y(It)36 b(is)g(important)h(that)f
(rei\002cation)g(returns)g(a)h(result)f(in)g(the)h(quotation)2049
166 y(monad.)g(F)o(or)23 b(e)o(xample)h(consider)g(this)f(de\002nition)
h(of)f(an)h(assertion)f(func-)2049 249 y(tion:)2127 362
y Fs(assert)41 b(::)f(Expr)314 b(--)40 b(Bool)g(->)g(a)f(->)h(a)2127
445 y(assert)h(=)f([|)f(\\)h(b)f(r)h(->)2598 528 y(if)g(b)f(then)h(r)g
(else)2677 611 y(error)g(\("Assert)h(fail)f(at)g(")2990
694 y(++)g($reifyLocn)i(|])2049 808 y Fu(\(Notice)26
b(the)h(comment)g(gi)n(ving)g(the)g(type)g(of)f(the)h(e)o(xpression)h
(generated)2049 891 y(by)23 b Fs(assert)p Fu(;)h(here)f(is)e(where)i
(the)f(more)h(static)e(type)i(system)f(of)g(MetaML)2049
974 y(w)o(ould)e(be)f(nicer)l(.\))k(One)c(might)g(in)m(v)o(ok)o(e)h
Fs(assert)g Fu(lik)o(e)f(this:)2127 1087 y Fs(find)41
b(xs)e(n)h(=)f($assert)i(\(n<10\))g(\(xs)f(!!)f(n\))2049
1200 y Fu(When)19 b(the)g Fs($assert)h Fu(splice)f(is)g(e)o(xpanded,)h
(we)f(get:)2127 1313 y Fs(find)41 b(xs)e(n)2206 1396
y(=)g(\(\\)h(b)g(r)f(->)h(if)f(b)h(then)g(r)f(else)2677
1480 y(error)h(\("Assert)h(fail)f(at)g(")f(++)2951 1563
y("line)i(22)e(of)h(Foo.hs"\)\))2284 1646 y(\(n)g(<)g(10\))f(\(xs)h(!!)
g(n\))2049 1759 y Fu(It)25 b(is)g(vital,)h(of)f(course,)i(that)e(the)h
Fs(reifyLocn)h Fu(captures)f(the)f(location)h(of)2049
1842 y(the)c Ft(splice)g(site)f Fu(of)h Fs(assert)p Fu(,)i(rather)e
(than)g(its)f Ft(de\002nition)i(site)f Fu(\227)f(and)i(that)2049
1925 y(is)e(precisely)g(what)g(we)g(achie)n(v)o(e)h(by)f(making)h
Fs(reifyLocn)g Fu(return)g(a)e(com-)2049 2008 y(putation.)29
b(One)21 b(can)g(tak)o(e)g(the)g(same)g(idea)g(further)m(,)g(by)g
(making)h Fs(assert)p Fu(')l(s)2049 2091 y(beha)o(viour)16
b(depend)h(on)f(a)f(command-line)h(ar)o(gument,)h(analogous)f(to)f
Fs(cpp)p Fu(')l(s)2049 2174 y(command)20 b(mechanism)g(for)f
(de\002ning)h(symbols)g Fs(-Dfoo)p Fu(:)2127 2287 y Fs(cassert)41
b(::)f(Expr)275 b(--)40 b(Bool)g(->)g(a)f(->)h(a)2127
2370 y(cassert)h(=)f(do)f({)h(mb)g(<-)f(reifyOpt)i("DEBUG")2637
2453 y(;)f(if)g(isNothing)h(mb)f(then)2834 2536 y([|)f(\\b)h(r)f(->)h
(r)g(|])2716 2619 y(else)2834 2702 y(assert)g(})2049
2816 y Fu(Here)155 b(we)f(assume)i(another)f(rei\002cation)g(function)
2049 2899 y Fs(reifyOpt)41 b(::)f(String)g(->)g(Maybe)g(String)p
Fu(,)143 b(which)118 b(returns)2049 2982 y Fs(Nothing)28
b Fu(if)d(there)i(is)f(no)g Fs(-D)h Fu(command)h(line)e(option)h(for)f
(the)g(speci\002ed)2049 3065 y(string,)19 b(and)g(the)g(de\002ned)h(v)n
(alue)f(if)g(there)g(is)f(one.)2049 3178 y(One)26 b(could)h(go)f(on.)45
b(It)26 b(is)f(not)h(yet)g(clear)g(ho)n(w)h(much)g(rei\002cation)e(can)
i(or)2049 3261 y(should)e(be)g(allo)n(wed.)39 b(F)o(or)23
b(e)o(xample,)j(it)d(might)i(be)f(useful)g(to)g(restrict)g(the)2049
3344 y(use)h(of)g Fs(reifyDecl)i Fu(to)e(type)h(constructors,)h
(classes,)f(or)g(v)n(ariables)f(\(e.g.)2049 3427 y(function\))18
b(declared)h(at)e(the)h(top)g(le)n(v)o(el)g(in)f(the)h(current)g
(module,)h(or)f(perhaps)2049 3510 y(to)j(just)f(type)h(constructors)h
(declared)f(in)g Fs(data)g Fu(declarations)h(in)e(imported)2049
3593 y(modules.)29 b(It)20 b(may)h(also)f(be)h(useful)g(to)f(support)i
(additional)f(kinds)g(of)g(rei\002-)2049 3676 y(cation)e(making)h
(other)f(compiler)h(symbol)f(table)g(information)h(a)o(v)n(ailable.)
2049 3806 y Fk(8.2)99 b(F)-7 b(ailur)l(e)2049 3920 y
Fu(A)26 b(compile-time)g(meta-program)h(may)f Ft(fail)p
Fu(,)h(because)g(the)f(programmer)2049 4004 y(made)f(some)g(error)l(.)
39 b(F)o(or)24 b(e)o(xample,)j(we)d(w)o(ould)h(e)o(xpect)g
Fs($\(zipN)41 b(\(-1\)\))2049 4087 y Fu(to)29 b(f)o(ail,)i(because)f
(it)e(does)i(not)f(mak)o(e)h(sense)f(to)g(produce)i(an)e(n-ary)g
Fs(zip)2049 4170 y Fu(function)24 b(for)e Fp(\000)p Fu(1)h(ar)o
(guments.)36 b(Errors)22 b(of)h(this)g(sort)g(are)g(due)g(to)g
(inappro-)2049 4253 y(priate)e(use,)g(rather)g(than)h(bogus)g
(implementation)g(of)f(the)g(meta-program,)2049 4336
y(so)e(the)g(meta-programmer)h(needs)g(a)f(w)o(ay)g(to)g(cleanly)h
(report)f(the)g(error)l(.)2049 4449 y(This)k(is)h(another)g(place)g
(where)g(the)g(quotation)h(monad)g(is)e(useful.)38 b(In)24
b(the)2049 4532 y(case)19 b(of)g Fs(zipN)h Fu(we)f(can)g(write:)2127
4645 y Fs(zipN)41 b(::)e(Int)h(->)g(Expr)2127 4728 y(zipN)h(n)2206
4811 y(|)e(n)h(<=)g(1)157 b(=)39 b(fail)h("Arg)g(to)g(zipN)g(must)g(be)
g(>=)g(2")2206 4894 y(|)f(otherwise)j(=)d(...as)h(before...)2049
5007 y Fu(The)15 b Fs(fail)h Fu(is)f(the)g(standard)h(monadic)g
Fs(fail)g Fu(operator)m(,)g(from)f(class)g Fs(Monad)p
Fu(,)2049 5090 y(whose)20 b(type)f(\(in)g(this)f(instance\))i(is)2127
5204 y Fs(fail)41 b(::)e(String)i(->)f(Q)f(a)2049 5317
y Fu(The)21 b(compiler)h(can)g(\223catch\224)g(errors)f(reported)h(via)
g Fs(fail)p Fu(,)g(and)g(gracefully)2049 5400 y(report)d(where)g(the)o
(y)h(occured.)1931 5649 y(9)p eop
%%Page: 10 10
10 9 bop -150 83 a Fk(8.3)99 b(Input/output)-150 228
y Fu(A)22 b(meta-program)i(may)f(require)g(access)g(to)g(input/output)h
(f)o(acilities.)33 b(F)o(or)-150 311 y(e)o(xample,)19
b(we)g(may)h(w)o(ant)f(to)g(write:)-72 455 y Fs(splice)41
b(\(genXML)g("foo.xml"\))-150 600 y Fu(to)30 b(generate)h(a)e(Hask)o
(ell)i(data)f(type)g(declaration)h(corresponding)h(to)e(the)-150
683 y(XML)g(schema)i(stored)f(in)f(the)h(\002le)f Fs("foo.xml")p
Fu(,)35 b(together)c(with)f(some)-150 766 y(boilerplate)19
b(Hask)o(ell)g(functions)h(to)f(w)o(ork)h(o)o(v)o(er)f(that)g(data)g
(type.)-150 910 y(T)-6 b(o)26 b(this)f(end,)j(we)e(can)h(easily)f(pro)o
(vide)h(a)e(w)o(ay)i(of)f(performing)h(arbitrary)-150
993 y(input/output)20 b(from)f(the)g(quotation)h(monad:)-72
1137 y Fs(qIO)40 b(::)g(IO)g(a)f(->)h(Q)f(a)-150 1281
y Fu(Naturally)-5 b(,)28 b(this)e(po)n(wer)h(is)g(open)g(to)f(ab)o
(use;)31 b(merely)c(compiling)g(a)f(mali-)-150 1364 y(cious)g(program)g
(might)g(delete)g(your)g(entire)f(\002le)g(store.)42
b(Man)o(y)27 b(compro-)-150 1447 y(mise)f(positions)h(are)f(possible,)i
(including)f(ruling)f(out)g(I/O)g(altogther)m(,)i(or)-150
1530 y(allo)n(wing)i(a)f(limited)g(set)h(of)f(benign)i(operations)f
(\(such)h(as)e(\002le)g(reading)-150 1613 y(only\).)37
b(This)24 b(is)f(a)g(polic)o(y)h(choice,)h(not)f(a)g(technical)g(one,)h
(and)f(we)f(do)i(not)-150 1696 y(consider)20 b(it)e(further)h(here.)
-150 1909 y Fk(8.4)99 b(Printing)23 b(code)-150 2054
y Fu(So)28 b(f)o(ar)g(we)g(ha)o(v)o(e)h(only)g(produced)h(code)f(in)f
(order)h(to)f(splice)h(it)e(into)i(the)-150 2137 y(module)16
b(being)h(compiled.)23 b(Sometimes)15 b(we)g(w)o(ant)h(to)g(write)e
(programs)j(that)-150 2220 y(generate)j(a)e(Hask)o(ell)i(program,)f
(and)h(put)f(it)f(in)h(a)f(\002le)h(\(rather)f(than)i(compil-)-150
2304 y(ing)26 b(it\).)43 b(The)26 b(Happ)o(y)h(parser)f(generator)h(is)
f(an)g(e)o(xample)g(of)g(an)g(e)o(xisting)-150 2387 y(program)19
b(that)e(follo)n(ws)h(this)g(paradigm.)23 b(Indeed,)c(for)f(pedagogic)h
(reasons,)-150 2470 y(it)24 b(is)h(e)o(xtremely)g(con)m(v)o(enient)i
(to)e(display)g(the)g(code)h(we)f(ha)o(v)o(e)g(generated,)-150
2553 y(rather)19 b(than)g(just)g(compile)g(it.)-150 2697
y(T)-6 b(o)16 b(this)h(end,)g(libraries)g(are)f(pro)o(vided)i(that)f
(mak)o(e)g Fs(Exp)p Fu(,)g Fs(Dec)p Fu(,)h(etc)e(instances)-150
2780 y(of)j(class)g Fs(Show)p Fu(.)-72 2924 y Fs(instance)42
b(Show)e(Exp)-72 3007 y(instance)i(Show)e(Dec)-72 3090
y(..etc..)-150 3234 y Fu(T)-6 b(o)29 b(display)h(code)g(constructed)h
(in)e(the)h(computational)h(frame)n(w)o(ork)f(we)-150
3317 y(supply)22 b(the)f(function)h Fs(runQ)40 b(::)g(Q)g(a)f(->)h(IO)f
(a)p Fu(.)30 b(Thus,)22 b(if)e(we)h(compile)-150 3400
y(and)f(run)f(the)g(program)-72 3545 y Fs(main)41 b(=)78
b(do)40 b({)f(e)h(<-)g(runQ)g(\(sel)g(1)f(3\))h(;)f(putStr)i(\(show)f
(e\))g(})-150 3689 y Fu(the)49 b(output)g(\223)p Fs(\\x)40
b(->)g(case)g(x)g(of)f(\(a,b,c\))i(->)f(a)p Fu(\224)49
b(will)e(be)j(pro-)-150 3772 y(duced.)56 b(Notice)30
b(the)f(absence)i(of)f(the)f(splicing)h Fs($)p Fu(!)55
b(\()p Fs(sel)30 b Fu(w)o(as)g(de\002ned)-150 3855 y(in)19
b(Section)g(4.\))-150 4068 y Fk(8.5)99 b(Implementing)24
b Fb(Q)-150 4213 y Fu(So)d(f)o(ar)g(we)g(ha)o(v)o(e)g(treated)g(the)g
Fs(Q)h Fu(monad)g(abstractly)-5 b(,)22 b(b)o(ut)e(it)h(is)g(easy)g(to)g
(im-)-150 4296 y(plement.)j(It)18 b(is)g(just)h(the)g
Fs(IO)g Fu(monad)h(augmented)h(with)d(an)i(en)m(vironment:)-72
4440 y Fs(newtype)41 b(Q)f(a)f(=)h(Q)f(\(Env)h(->)g(IO)g(a\))-150
4584 y Fu(The)19 b(en)m(vironment)h(contains:)-63 4729
y Fp(\017)42 b Fu(A)19 b(mutable)g(location)h(to)e(serv)o(e)i(as)e(a)h
(name)h(supply)g(for)f Fs(gensym)p Fu(.)-63 4849 y Fp(\017)42
b Fu(The)28 b(source)i(location)f(of)f(the)g(top-le)n(v)o(el)h(splice)g
(that)f(in)m(v)o(ok)o(ed)i(the)16 4932 y(e)n(v)n(aluation,)20
b(for)f Fs(reifyLocn)p Fu(.)-63 5052 y Fp(\017)42 b Fu(The)25
b(compiler')l(s)h(symbol)g(table,)g(to)f(support)i(the)e
(implementation)16 5135 y(of)19 b Fs(reifyDecl)p Fu(,)h
Fs(reifyFixity)p Fu(,)h Fs(reifyType)p Fu(.)-63 5256
y Fp(\017)42 b Fu(Command-line)20 b(switches,)f(to)g(support)g
Fs(reifyOpt)p Fu(.)-150 5400 y(Other)g(things)g(could,)h(of)e(course,)i
(readily)f(be)g(added.)2049 83 y Fv(9)99 b(Quasi-quotes)25
b(and)h(Lexical)f(Scoping)2049 215 y Fu(W)-6 b(e)25 b(ha)o(v)o(e)h
(introduced)h(the)f(quasi-quote)i(notation)e(informally)-5
b(,)28 b(and)e(it)f(is)2049 298 y(time)19 b(to)f(pay)i(it)e(direct)h
(attention.)2049 428 y(The)e(quasi-quote)h(notation)g(is)e(a)h(con)m(v)
o(enient)i(shorthand)f(for)f(representing)2049 511 y(Hask)o(ell)29
b(programs,)j(and)e(as)f(such)h(it)e(is)g Ft(le)o(xically)h(scoped)p
Fu(.)54 b(More)30 b(pre-)2049 594 y(cisely:)2215 725
y Ft(e)o(very)17 b(occurr)m(ence)i(of)e(a)g(variable)h(is)e(bound)j(to)
d(the)h(value)h(that)2215 808 y(is)e(le)o(xically)g(in)g(scope)i(at)e
(the)h(occurr)m(ence)h(site)e(in)h(the)f(original)2215
891 y(sour)m(ce)k(pr)m(o)o(gr)o(am,)g(befor)m(e)g(any)f(template)g(e)o
(xpansion)p Fu(.)2049 1022 y(This)k(ob)o(vious-sounding)j(property)e
(is)f(what)g(the)h(Lisp)f(community)h(calls)2049 1105
y Ft(hygienic)34 b(macr)m(os)g Fu([10].)66 b(In)33 b(a)g
(meta-programming)i(setting)e(it)g(is)g(not)2049 1188
y(nearly)19 b(as)g(easy)h(to)f(implement)g(as)g(one)g(might)g(think.)
2049 1319 y(The)27 b(quasi-quote)i(notation)f(is)g(implemented)g(on)g
(top)g(of)f(the)h(quotation)2049 1402 y(monad)f(\(Section)g(6\),)h(and)
f(we)f(sa)o(w)g(there)g(that)h(v)n(ariables)g(bound)g(inside)2049
1485 y(quasi-quotes)34 b(must)f(be)f(renamed)i(to)e(a)o(v)o(oid)g
(inadv)o(ertent)i(capture)f(\(the)2049 1568 y Fs(cross2a)21
b Fu(e)o(xample\).)27 b(But)20 b(that)g(is)f(not)h(all;)g(what)g(about)
h(v)n(ariables)f(bound)2049 1651 y Ft(outside)g Fu(the)f(quasi-quotes?)
2049 1828 y Fk(9.1)99 b(Cr)l(oss-sta)o(g)o(e)24 b(P)-8
b(er)o(sistence)2049 1959 y Fu(It)23 b(is)h(possible)h(for)f(a)f
(splice)h(to)g(e)o(xpand)i(to)e(an)g(e)o(xpression)h(that)f(contains)
2049 2042 y(names)18 b(that)g(are)g(not)f(in)h(scope)h(where)f(the)f
(splice)h(occurs,)g(and)h(we)e(need)i(to)2049 2125 y(tak)o(e)j(care)g
(when)g(this)g(happens.)32 b(Consider)23 b(this)e(rather)h(contri)n(v)o
(ed)g(e)o(xam-)2049 2208 y(ple:)2127 2339 y Fs(module)41
b(T\()f(genSwap)h(\))e(where)2206 2422 y(swap)h(\(a,b\))g(=)g(\(b,a\))
2206 2505 y(genSwap)h(x)e(=)h([|)f(swap)h(x)g(|])2049
2636 y Fu(No)n(w)19 b(consider)h(a)f(call)f(of)h Fs(genswap)i
Fu(in)d(another)i(module:)2127 2766 y Fs(module)41 b(Foo)f(where)2206
2849 y(import)h(T\()e(genSwap)i(\))2206 2932 y(swap)f(=)g(True)2206
3015 y(foo)79 b(=)40 b($\(genSwap)h(\(4,5\)\))2049 3146
y Fu(What)17 b(does)i(the)f(splice)g Fs($\(genSwap)41
b(\(4,5\)\))19 b Fu(e)o(xpand)g(to?)24 b(It)17 b(cannot)i(e)o(x-)2049
3229 y(pand)d(to)f Fs(\(swap)40 b(\(4,5\))16 b Fu(because,)g(in)f
(module)h Fs(Foo)p Fu(,)g(plain)f(\223)p Fs(swap)p Fu(\224)h(w)o(ould)
2049 3312 y(bind)23 b(to)e(the)h(boolean)i(v)n(alue)e(de\002ned)h(in)f
Fs(Foo)p Fu(,)h(rather)f(than)g(the)g Fs(swap)h Fu(de-)2049
3395 y(\002ned)c(in)g(module)g Fs(T)p Fu(.)g(Nor)f(can)i(the)e(splice)h
(e)o(xpand)h(to)f Fs(\(T.swap)41 b(\(4,5\)\))p Fu(,)2049
3478 y(using)25 b(Hask)o(ell')l(s)e(quali\002ed-name)i(notation,)h
(because)f(\223)p Fs(T.swap)p Fu(\224)g(is)f(not)2049
3561 y(in)d(scope)h(in)f Fs(Foo)p Fu(:)29 b(only)21 b
Fs(genSwap)i Fu(is)e(imported)h(into)f Fs(Foo)p Fu(')l(s)g(name)h
(space)2049 3644 y(by)d Fs(import)41 b(T\()f(genSwap)g(\))p
Fu(.)2049 3775 y(Instead,)19 b(we)h(e)o(xpand)g(the)f(splice)h(to)f
Fs(\(T:swap)40 b(\(4,5\)\))p Fu(,)20 b(using)g(the)g
Ft(orig-)2049 3858 y(inal)h(name)h Fs(T:swap)p Fu(.)32
b(Original)21 b(names)h(were)f(\002rst)f(discussed)j(in)e(Section)2049
3941 y(8.1)d(in)f(the)g(conte)o(xt)h(of)g(representations)g(returned)g
(by)g Fs(reify)p Fu(.)24 b(The)o(y)17 b(solv)o(e)2049
4024 y(a)23 b(similar)f(problem)h(here.)35 b(The)o(y)23
b(are)f(part)h(of)g(code)g(representations)h(that)2049
4107 y(must)d(unambiguously)j(refer)d(to)h(\(global,)g(top-le)n(v)o
(el\))f(v)n(ariables)h(that)f(may)2049 4190 y(be)i(hidden)h(in)e
(scopes)i(where)f(the)g(representations)g(may)h(be)f(used.)35
b(The)o(y)2049 4273 y(are)27 b(an)h(e)o(xtension)g(to)f(Hask)o(ell)h
(that)f(T)-5 b(emplate)27 b(Hask)o(ell)g(uses)h(to)f(imple-)2049
4356 y(ment)d(static)f(scoping)i(across)f(the)g(meta-programming)h(e)o
(xtensions,)h(and)2049 4439 y(are)18 b(not)h(accessible)g(in)f(the)g
(ordinary)h(part)f(of)h(Hask)o(ell.)k(F)o(or)17 b(e)o(xample,)i(one)
2049 4522 y(cannot)h(write)e Fs(M:map)40 b(f)g([1,2,3])p
Fu(.)2049 4653 y(The)19 b(ability)g(to)g(include)h(in)g(generated)g
(code)g(the)g(v)n(alue)g(of)f(a)g(v)n(ariable)h(that)2049
4736 y(e)o(xists)29 b(at)h(compile-time)g(has)g(a)f(special)h(name)g
(\227)f Ft(cr)m(oss-sta)o(g)o(e)i(per)o(sis-)2049 4819
y(tence)19 b Fu(\227)e(and)i(it)f(requires)h(some)f(care)h(to)f
(implement)g(correctly)-5 b(.)24 b(W)-6 b(e)18 b(ha)o(v)o(e)2049
4902 y(just)26 b(seen)h(what)f(happens)i(for)f(top-le)n(v)o(el)f(v)n
(ariables,)j(such)e(as)f Fs(swap)p Fu(,)j(b)o(ut)2049
4985 y(nested)22 b(v)n(ariables)g(require)f(dif)n(ferent)h(treatment.)
30 b(In)21 b(particular)m(,)h(consider)2049 5068 y(the)c(status)f(v)n
(ariable)h Fs(x)p Fu(,)g(which)g(is)f(free)g(in)g(the)h(quotation)h
Fs([|)39 b(swap)h(x)g(|])p Fu(.)2049 5151 y(Unlik)o(e)22
b Fs(swap)p Fu(,)h Fs(x)f Fu(is)g(not)g(a)g(top-le)n(v)o(el)g(binding)h
(in)f(the)g(module)g Fs(T)p Fu(.)g(Indeed,)2049 5234
y(nothing)k(other)g(than)g Fs(x)p Fu(')l(s)f(type)h(is)f(kno)n(wn)h
(when)g(the)g(module)g Fs(T)f Fu(is)g(com-)2049 5317
y(piled.)37 b(There)24 b(is)f(no)h(w)o(ay)g(to)f(gi)n(v)o(e)h(it)f(an)h
(original)f(name,)i(since)f(its)f(v)n(alue)2049 5400
y(will)18 b(v)n(ary)i(with)e(e)n(v)o(ery)i(call)e(to)h
Fs(genSwap)p Fu(.)1913 5649 y(10)p eop
%%Page: 11 11
11 10 bop -150 83 a Fu(Cross-stage)19 b(persistence)g(for)f(this)g
(kind)h(of)g(v)n(ariable)f(is)g(qualitati)n(v)o(ely)h(dif-)-150
166 y(ferent:)29 b(it)21 b(requires)h(turning)h(arbitrary)f(v)n(alues)g
(into)g(code.)33 b(F)o(or)21 b(e)o(xample,)-150 249 y(when)e(the)g
(compiler)h(e)o(x)o(ecutes)f(the)g(call)g Fs($\(genSwap)41
b(\(4,5\)\))p Fu(,)20 b(it)e(passes)-150 332 y(the)i
Ft(value)g Fj(\()p Fu(4)p Fl(;)8 b Fu(5)p Fj(\))20 b
Fu(to)f Fs(genSwap)p Fu(,)i(b)o(ut)e(the)h(latter)f(must)g(return)h(a)g
Ft(data)g(struc-)-150 415 y(tur)m(e)f Fu(of)g(type)h
Fs(Exp)p Fu(:)-150 539 y Fs(App)40 b(\(Var)g("T:swap"\))h(\(Tup)f([Lit)
h(\(Int)f(4\),)g(Lit)g(\(Int)g(5\)]\))-150 663 y Fu(Someho)n(w)-5
b(,)24 b(the)f(code)g(for)f Fs(genSwap)i Fu(has)f(to)g(\223lift\224)e
(a)i(v)n(alue)g(into)g(an)g Fs(Exp)p Fu(.)-150 746 y(T)-6
b(o)25 b(sho)n(w)g(ho)n(w)h(this)e(happens,)k(here)d(is)g(what)g
Fs(genSwap)h Fu(becomes)g(when)-150 829 y(the)19 b(quasi-quotes)h(are)f
(translated)g(a)o(w)o(ay:)-72 953 y Fs(genSwap)41 b(::)f(\(Int,Int\))h
(->)f(Expr)-72 1036 y(genSwap)h(x)f(=)f(do)h({)f(t)h(<-)f(lift)i(x)517
1119 y(;)e(return)i(\(App)f(\(Var)g("T:swap"\))h(t\))f(})-150
1244 y Fu(Here,)31 b(we)e(tak)o(e)g(adv)n(antage)i(of)e(Hask)o(ell')l
(s)g(e)o(xisting)g(type-class)g(mecha-)-150 1327 y(nism.)56
b Fs(lift)30 b Fu(is)f(an)h(o)o(v)o(erloaded)i(function)e(de\002ned)h
(by)f(the)g(type)g(class)-150 1410 y Fs(Lift)p Fu(:)-72
1534 y Fs(class)41 b(Lift)f(t)f(where)7 1617 y(lift)h(::)g(t)f(->)h
(Expr)-150 1741 y Fu(Instances)17 b(of)f Fs(Lift)g Fu(allo)n(w)g(the)g
(programmer)h(to)f(e)o(xplain)g(ho)n(w)h(to)e(lift)g(types)-150
1824 y(of)i(his)h(choice)g(into)g(an)f Fs(Expr)p Fu(.)24
b(F)o(or)16 b(e)o(xample,)j(these)e(ones)i(are)e(pro)o(vided)i(as)-150
1907 y(part)g(of)g(T)-5 b(emplate)18 b(Hask)o(ell:)-72
2031 y Fs(instance)42 b(Lift)e(Int)7 2114 y(lift)g(n)g(=)f(lit)h(\(Int)
g(n\))-72 2280 y(instance)i(\(Lift)e(a,Lift)g(b\))g(=>)g(Lift)g
(\(a,b\))g(where)7 2363 y(lift\(a,b\))h(=)f(tup)g([lift)g(a,)g(lift)g
(b])-150 2487 y Fu(T)-6 b(aking)37 b(adv)n(antage)i(of)e(type)g
(classes)g(in)g(this)f(w)o(ay)i(requires)f(a)g(slight)-150
2570 y(change)27 b(to)f(the)g(typing)h(judgment)i Fe(V)l(A)t(R)e
Fu(of)e(Figure)h(2.)44 b(When)26 b(the)g(stage)-150 2653
y Ft(s)c Fu(is)g Ft(B)f Fu(\227)h(that)g(is,)g(when)h(inside)f
(quasi-quotes)i(\227)d(and)i(the)f(v)n(ariable)h Ft(x)f
Fu(is)-150 2736 y(bound)27 b(outside)f(the)g(quasi)g(quotes)g(b)o(ut)g
(not)g(at)f(top)h(le)n(v)o(el,)h(then)f(the)f(type)-150
2819 y(check)o(er)h(must)f(inject)g(a)g(type)g(constraint)g
Fs(Lift)h Fo(t)p Fu(,)g(where)f Ft(x)g Fu(has)g(type)h
Fo(t)p Fu(.)-150 2902 y(\(W)-6 b(e)18 b(ha)o(v)o(e)h(omitted)g(all)g
(mention)h(of)e(type)i(constraints)f(from)g(Figure)g(2)g(b)o(ut)-150
2985 y(in)g(the)g(real)f(system)i(the)o(y)f(are)g(there,)g(of)g
(course.\))-150 3109 y(T)-6 b(o)23 b(summarize,)h(le)o(xical)f(scoping)
i(means)e(that)g(the)g(free)g(v)n(ariables)h(\(such)-150
3192 y(as)h Fs(swap)h Fu(and)g Fs(x)p Fu(\))g(of)f(a)g(top-le)n(v)o(el)
h(quasi-quote)h(\(such)f(as)f(the)g(right)h(hand)-150
3275 y(side)f(of)f(the)g(de\002nition)h(of)f Fs(genSwap)p
Fu(\))i(are)e(statically)g(bound)i(to)e(the)h(clo-)-150
3358 y(sure.)f(The)o(y)c(do)g(not)f(need)h(to)f(be)h(in)f(scope)h(at)f
(the)h(application)g(site)f(\(inside)-150 3441 y(module)k
Fs(Foo)g Fu(in)f(this)g(case\);)i(indeed)f(some)g(quite)f(dif)n(ferent)
h(v)n(alue)f(of)h(the)-150 3524 y(same)j(name)g(may)f(be)h(in)f(scope.)
43 b(There)26 b(is)f(nothing)h(terribly)f(surprising)-150
3608 y(about)c(this)f(\227)g(it)f(is)h(simply)g(le)o(xical)g(scoping)i
(in)e(action,)h(and)f(is)g(precisely)-150 3691 y(the)g(beha)o(viour)h
(we)f(w)o(ould)h(e)o(xpect)g(if)e Fs(genSwap)j Fu(were)e(an)g(ordinary)
h(func-)-150 3774 y(tion:)-72 3915 y Fs(genSwap)41 b(x)f(=)f(swap)h(x)
-150 4073 y Fk(9.2)99 b(Dynamic)25 b(scoping)-150 4197
y Fu(Occasionally)-5 b(,)18 b(the)f(programmer)h(may)f(instead)g(w)o
(ant)g(a)g Ft(dynamic)h Fu(scoping)-150 4281 y(strate)o(gy)29
b(in)f(generated)h(code.)53 b(In)28 b(T)-5 b(emplate)28
b(Hask)o(ell)h(we)f(can)h(e)o(xpress)-150 4364 y(dynamic)20
b(scoping)g(too,)f(lik)o(e)g(this:)-72 4488 y Fs(genSwapDyn)42
b(x)d(=)h([|)g($\(var)g("swap"\))h(x)e(|])-150 4612 y
Fu(No)n(w)59 b(a)g(splice)g(site)g Fs($\(genSwapDyn)42
b(\(4,5\)\))60 b Fu(will)e(e)o(xpand)j(to)-150 4695 y
Fs(\(swap)40 b(\(4,5\)\))p Fu(,)33 b Ft(and)d(this)f
Fs(swap)h Ft(will)f(bind)h(to)f(whate)o(ver)h Fs(swap)g
Ft(is)f(in)-150 4778 y(scope)20 b(at)g(the)f(splice)h(site)p
Fu(,)f(re)o(gardless)g(of)h(what)f(w)o(as)h(in)f(scope)h(at)g(the)f
(de\002-)-150 4861 y(nition)h(of)g Fs(genSwapDyn)p Fu(.)28
b(Such)20 b(beha)o(viour)h(is)f(sometimes)g(useful,)g(b)o(ut)g(in)-150
4944 y(T)-5 b(emplate)20 b(Hask)o(ell)h(it)f(is)g(clearly)g(\003agged)h
(by)g(the)g(use)g(of)f(a)h(string-quoted)-150 5027 y(v)n(ariable)k
(name,)i(as)e(in)f Fs(\(var)41 b("swap"\))p Fu(.)h(All)24
b(un-quoted)i(v)n(ariables)g(are)-150 5110 y(le)o(xically)19
b(scoped.)-150 5234 y(It)j(is)h(an)g(open)h(question)g(whether)g(this)e
(po)n(wer)i(is)f(desirable.)35 b(If)23 b(not,)h(it)e(is)-150
5317 y(easily)15 b(remo)o(v)o(ed,)h(by)f(making)h Fs(var)f
Fu(tak)o(e,)g(and)h Fs(gensym)f Fu(return,)h(an)f(abstract)-150
5400 y(type)k(instead)h(of)f(a)f Fs(String)p Fu(.)2049
83 y Fk(9.3)99 b(Implementing)24 b(quasi-quote)2049 209
y Fu(The)34 b(quasi-quote)i(notation)g(can)f(be)g(e)o(xplained)g(in)g
(terms)f(of)h(original)2049 292 y(names,)c(the)d(syntax)h(constructor)h
(functions,)h(and)e(the)f(use)h(of)f Fs(gensym)p Fu(,)2049
375 y Fs(do)23 b Fu(and)h Fs(return)p Fu(,)h(and)f(the)f
Fs(lift)h Fu(operation.)37 b(One)23 b(can)h(think)g(of)f(this)g(as)2049
458 y(a)f(translation)h(process,)h(from)e(the)h(term)f(within)g(the)g
(quasi-quotes)i(to)f(an-)2049 541 y(other)i(term.)42
b(Figure)25 b(3)g(mak)o(es)h(this)f(translation)g(precise)h(by)g(e)o
(xpressing)2049 624 y(the)20 b(translation)h(as)f(an)h(ordinary)g(Hask)
o(ell)f(function.)28 b(In)21 b(this)f(sk)o(eleton)h(we)2049
707 y(handle)j(enough)g(of)f(the)f(constructors)i(of)f
Fs(Pat)g Fu(and)g Fs(Exp)g Fu(to)g(illustrate)f(the)2049
790 y(process,)d(b)o(ut)g(omit)g(man)o(y)g(others)h(in)f(the)g
(interest)f(of)h(bre)n(vity)-5 b(.)2049 915 y(The)37
b(main)g(function,)42 b Fs(trE)p Fu(,)37 b(translates)g(an)h(e)o
(xpression)g(inside)f(quasi-)2049 998 y(quotes:)2127
1123 y Fs(trE)j(::)g(VEnv)g(->)g(Exp)g(->)f(Exp)2049
1248 y Fu(The)27 b(\002rst)g(ar)o(gument)h(is)f(an)h(en)m(vironment)h
(of)f(type)g Fs(VEnv)p Fu(;)k(we)27 b(ignore)h(it)2049
1331 y(for)g(a)f(couple)i(more)f(paragraphs.)52 b(Gi)n(v)o(en)28
b(a)f(term)h Fs(t)39 b(::)h(Exp)p Fu(,)30 b(the)e(call)2049
1414 y Fs(\(trE)40 b(cl)g(t\))22 b Fu(should)g(construct)h(another)f
(term)g Fs(t')39 b(::)h(Exp)p Fu(,)22 b Ft(suc)o(h)h(that)2049
1497 y Fs(t')k Ft(e)o(valuates)h(to)f Fs(t)p Fu(.)48
b(In)27 b(our)g Fs(genSwap)i Fu(e)o(xample,)g(the)e(compiler)h(trans-)
2049 1580 y(lates)17 b Fs(genSwap)p Fu(')l(s)h(body)-5
b(,)18 b Fs([|)40 b(swap)g(x)f(|])p Fu(,)17 b(by)h(e)o(x)o(ecuting)g
(the)f(translation)2049 1663 y(function)j Fs(trE)f Fu(on)g(the)g(ar)o
(guments:)2127 1788 y Fs(trE)40 b(cl)g(\(App)g(\(Var)g("swap"\))h
(\(Var)f("x"\)\))2049 1913 y Fu(The)19 b(result)g(of)f(the)h(call)g(is)
g(the)g Fs(Exp)p Fu(:)2127 2038 y Fs(\(App)41 b(\(App)f(\(Var)g
("app"\))2520 2121 y(\(App)g(\(Var)g("var"\))h(\(str)f("T:swap"\)\)\))
2324 2204 y(\(App)g(\(Var)g("lift"\))h(\(Var)f("x"\)\)\))2049
2329 y Fu(which)19 b(when)h(printed)f(as)g(concrete)h(syntax)g(is:)2127
2454 y Fs(app)40 b(\(var)h("T:swap"\))g(\(lift)f(x\))2049
2579 y Fu(which)21 b(is)f(what)h(we')l(d)g(e)o(xpect)g(the)g
(quasi-quoted)h Fs([|)40 b(swap)g(x)f(|])21 b Fu(to)g(e)o(x-)2049
2662 y(pand)f(into)f(after)f(the)h(quasi-quotes)i(are)e(translated)g
(out:)2127 2787 y Fs(genSwap)41 b(x)f(=)f(app)h(\(var)g("T:swap"\))i
(\(lift)e(x\))2049 2912 y Fu(\(It)27 b(is)g(the)h(en)m(vironment)h
Fs(cl)f Fu(that)g(tells)f Fs(trE)h Fu(to)g(treat)f Fs("swap")i
Fu(and)f Fs("x")2049 2995 y Fu(dif)n(ferently)-5 b(.\))2049
3120 y(Capturing)20 b(this)e(translation)h(process)h(as)f(a)g(Hask)o
(ell)g(function,)g(we)g(write:)2127 3246 y Fs(trE)40
b(cl)g(\(App)g(a)g(b\))2206 3329 y(=)f(App)h(\(App)g(\(Var)h("app"\))f
(\(trans)h(a\)\))f(\(trans)g(b\))2127 3412 y(trE)g(cl)g(\(Cond)g(x)g(y)
f(z\))2206 3495 y(=)g(App)h(\(App)g(\(App)h(\(Var)f("cond"\))h(\(trans)
f(x\)\))2637 3578 y(\(trans)h(y\)\))2441 3661 y(\(trans)g(z\))2127
3744 y(trE)f(cl)g(...)g(=)f(...)2049 3869 y Fu(There)19
b(is)f(a)h(simple)g(pattern)g(we)g(can)h(capture)f(here:)2120
4003 y Fm(trE)36 b(cl)g(\(App)g(a)g(b\))141 b(=)36 b(rep)g("app")72
b(\(trEs)37 b(cl)f([a,b]\))2120 4078 y(trE)g(cl)g(\(Cond)g(x)g(y)f(z\))
h(=)g(rep)g("cond")h(\(trEs)g(cl)f([x,y,z]\))2120 4227
y(trEs)g(::)g(VEnv)g(->)g([Exp])h(->)f([Exp])2120 4302
y(trEs)g(cl)g(es)g(=)f(map)h(\(trE)h(cl\))f(es)2120 4451
y(rep)g(::)g(String)h(->)e([Exp])i(->)f(Exp)2120 4526
y(rep)g(f)f(xs)h(=)g(apps)g(\(Var)h(f\))e(xs)2190 4601
y(where)i(apps)f(f)g([])177 b(=)35 b(f)2402 4675 y(apps)h(f)g(\(x:xs\))
h(=)e(apps)i(\(App)f(f)g(x\))g(xs)2049 4818 y Fu(No)n(w)17
b(we)g(return)f(to)h(the)g(en)m(vironment,)h Fs(cl)40
b(::)g(VEnv)p Fu(.)23 b(In)16 b(Section)h(9.1)g(we)2049
4901 y(disco)o(v)o(ered)27 b(that)e(v)n(ariables)h(need)g(to)g(be)f
(treated)h(dif)n(ferently)g(depending)2049 4984 y(on)21
b(ho)n(w)f(the)o(y)g(are)h(bound.)28 b(The)20 b(en)m(vironment)h
(records)g(this)e(information,)2049 5067 y(and)h(is)e(used)i(by)f
Fs(trE)g Fu(to)g(decide)h(ho)n(w)f(to)g(translate)g(v)n(ariable)h
(occurrences:)2127 5192 y Fs(type)41 b(VEnv)197 b(=)39
b(String)i(->)e(VarClass)2127 5275 y(data)i(VarClass)g(=)e(Orig)h
(ModName)h(|)f(Lifted)g(|)g(Bound)2049 5400 y Fu(The)19
b Fs(VarClass)h Fu(for)f(a)g(v)n(ariable)h Ft(v)e Fu(is)h(as)g(follo)n
(ws:)1913 5649 y(11)p eop
%%Page: 12 12
12 11 bop -150 41 a Fm(trE)36 b(::)g(VEnv)g(->)g(Exp)g(->)g(Exp)-150
115 y(trE)g(cl)g(\(Var)g(s\))-79 190 y(=)f(case)i(cl)e(s)h(of)62
265 y(Bound)142 b(->)36 b(rep)g("var")h([Var)f(s])62
339 y(Lifted)107 b(->)36 b(rep)g("lift")h([Var)g(s])62
414 y(Orig)f(mod)g(->)g(rep)g("var")h([str)f(\(mod++":"++s\)]\))-150
564 y(trE)g(cl)g(e@\(Lit\(Int)i(n\)\))e(=)g(rep)g("Lit")h([rep)f("Int")
h([e]])-150 638 y(trE)f(cl)g(\(App)g(f)g(x\))71 b(=)36
b(rep)g("app")h(\(trEs)f(cl)g([f,x]\))-150 713 y(trE)g(cl)g(\(Tup)g
(es\))107 b(=)36 b(rep)g("tup")h([ListExp)g(\(trEs)g(cl)f(es\)])-150
788 y(trE)g(cl)g(\(Lam)g(ps)g(e\))g(=)g(Do)g(\(ss1)g(++)g([NoBindSt)i
(lam]\))-79 863 y(where)e(\(ss1,xs\))i(=)d(trPs)i(ps)132
937 y(lam)213 b(=)35 b(rep)i("lam")f([ListExp)i(xs,trE)f(cl)f(e])-150
1012 y(trE)g(cl)g(\(Esc)g(e\))g(=)g(copy)g(e)-150 1087
y(trE)g(cl)g(\(Br)g(e\))71 b(=)36 b(error)h("Nested)g(Brackets)g(not)g
(allowed")-150 1236 y(trEs)f(::)g(VEnv)h(->)f([Exp])g(->)g([Exp])-150
1311 y(trEs)g(cl)g(es)g(=)g(map)g(\(trE)g(cl\))g(es)-150
1460 y(copy)g(::)g(VEnv)h(->)f(Exp)g(->)g(Exp)-150 1535
y(copy)g(cl)g(\(Var)h(s\))141 b(=)36 b(Var)g(s)-150 1610
y(copy)g(cl)g(\(Lit)h(c\))141 b(=)36 b(Lit)g(c)-150 1684
y(copy)g(cl)g(\(App)h(f)e(x\))71 b(=)36 b(App)g(\(copy)h(cl)f(f\))g
(\(copy)g(cl)g(x\))-150 1759 y(copy)g(cl)g(\(Lam)h(ps)f(e\))f(=)h(Lam)g
(ps)g(\(copy)h(cl)f(e\))-150 1834 y(copy)g(cl)g(\(Br)g(e\))177
b(=)36 b(trE)g(cl)g(e)-150 1983 y(trP)g(::)g(Pat)g(->)g(\([Statement)i
(Pat)f(Exp)f(Dec],Pat\))-150 2058 y(trP)g(\(p)g(@)g(Pvar)g(s\))-79
2133 y(=)f(\()h([BindSt)h(p)f(\(rep)g("gensym")i([str)e(s]\)])-9
2207 y(,)g(rep)g("pvar")h([Var)f(s]\))-150 2282 y(trP)g(\(Plit)h(c\))
212 b(=)36 b(\([],rep)h("plit")g([Lit)f(c]\))-150 2357
y(trP)g(\(Ptup)h(ps\))177 b(=)36 b(\(ss,rep)h("ptup")g([ListExp)h
(qs]\))-9 2432 y(where)f(\(ss,qs\))g(=)f(trPs)g(ps)-150
2506 y(trP)g(\(Pcon)h(c)e(ps\))107 b(=)36 b(\(ss,rep)h("pcon")g([str)f
(c,ListExp)i(qs]\))-9 2581 y(where)f(\(ss,qs\))g(=)f(trPs)g(ps)-150
2656 y(trP)g(Pwild)319 b(=)36 b(\([],Var)h("pwild"\))-150
2805 y(trPs)f(::)g([Pat])h(->)f(\([Statement)i(Pat)e(Exp)h
(Dec],[Pat]\))-150 2880 y(trPs)f(ps)g(=)g(\(concat)h(ss,qs\))132
2955 y(where)g(\(ss,qs\))g(=)f(unzip)h(\(map)f(trP)g(ps\))-5
3054 y Fr(Figur)o(e)18 b(3.)24 b(The)18 b(quasi-quote)f(translation)h
(function)g Fs(trExp)p Fr(.)-63 3323 y Fp(\017)42 b Fs(Orig)23
b Ft(m)g Fu(means)g(that)f(the)h Ft(v)f Fu(is)h(bound)h(at)e(the)h(top)
g(le)n(v)o(el)f(of)h(module)16 3406 y Ft(m)p Fu(,)18
b(so)h(that)g Ft(m)e Fu(:)f Ft(v)j Fu(is)g(its)f(original)h(name.)-63
3526 y Fp(\017)42 b Fs(Lifted)27 b Fu(means)f(that)f
Ft(v)h Fu(is)f(bound)i(outside)f(the)g(quasi-quotes,)i(b)o(ut)16
3609 y(not)23 b(at)g(top)g(le)n(v)o(el.)34 b(The)23 b(translation)g
(function)h(will)e(generate)h(a)g(call)16 3692 y(to)c
Fs(lift)p Fu(,)h(while)e(the)i(type)f(check)o(er)i(will)d(later)g
(ensure)i(that)f(the)g(type)16 3775 y(of)g Ft(v)g Fu(is)f(in)h(class)g
Fs(Lift)p Fu(.)-63 3896 y Fp(\017)42 b Fs(Bound)33 b
Fu(means)g(that)f Ft(v)h Fu(is)f(bound)h(inside)g(the)f(quasi-quotes,)
37 b(and)16 3979 y(should)20 b(be)f(alpha-renamed.)-150
4105 y(These)24 b(three)f(cases)h(are)g(re\003ected)g(directly)f(in)h
(the)f(case)h(for)g Fs(Var)g Fu(in)f Fs(trE)-150 4188
y Fu(\(Figure)c(3\).)-150 4314 y(W)-6 b(e)18 b(need)i(an)f(auxiliary)h
(function)f Fs(trP)h Fu(to)f(translate)f(patterns)-72
4440 y Fs(trP)40 b(::)g(Pat)g(->)g(\([Statement)h(Pat)f(Exp)g
(Dec],Pat\))-150 4566 y Fu(The)25 b(\002rst)f(part)h(of)g(the)g(pair)g
(returned)h(by)g Fs(trP)f Fu(is)g(a)g(list)f(of)h Fs(Statement)p
Fu(s)-150 4649 y(\(representing)31 b(the)g(gensym)g(bindings)g
(generated)h(by)f(the)f(translation\).)-150 4732 y(The)17
b(second)i(part)e(of)g(the)g(pair)g(is)g(a)g Fs(Pat)h
Fu(representing)g(the)f(alpha-renamed)-150 4816 y(pattern.)36
b(F)o(or)22 b(e)o(xample,)i(when)g(translating)f(a)g(pattern-v)n
(ariable)h(\(such)g(as)-150 4899 y Fs(x)p Fu(\),)17 b(we)g(get)g(one)h
(binding)h(statement)e(\()p Fs(x)39 b(<-)h(gensym)g("x")p
Fu(\),)18 b(and)g(a)f(result)-150 4982 y(\()p Fs(pvar)40
b(x)p Fu(\).)-150 5108 y(W)m(ith)14 b Fs(trP)h Fu(in)g(hand,)i(we)d
(can)i(look)f(at)g(the)g Fs(Lam)g Fu(case)g(for)g Fs(trE)p
Fu(.)g(F)o(or)f(a)h(lambda)-150 5191 y(e)o(xpression)j(\(such)g(as)e
Fs(\\)40 b(f)f(x)h(->)g(f)f(x)p Fu(\))17 b(we)g(wish)f(to)h(generate)h
(a)f(local)g Fs(do)-150 5274 y Fu(binding)j(which)f(preserv)o(es)h(the)
f(scope)h(of)f(the)g(quoted)h(lambda.)-72 5400 y Fs(do)40
b({)g(f)f(<-)h(gensym)g("f")2245 83 y(;)g(x)f(<-)h(gensym)g("x")2245
166 y(;)g(lam)g([Pvar)g(f,Pvar)g(x])g(\(app)g(\(var)g(f\))g(\(var)g
(x\)\)})2049 289 y Fu(The)26 b(bindings)h Fs(\(f)40 b(<-)f(gensym)i
("f";)f(x)g(<-)f(gensym)i("x"\))26 b Fu(and)h(re-)2049
372 y(named)17 b(patterns)g Fs([Pvar)40 b(f,Pvar)h(x])16
b Fu(are)g(bound)i(to)e(the)g(meta-v)n(ariables)2049
455 y Fs(ss1)21 b Fu(and)g Fs(xs)f Fu(by)h(the)g(call)f
Fs(trPs)40 b(ps)p Fu(,)20 b(and)h(these)g(are)f(assembled)i(with)e(the)
2049 538 y(body)h Fs(\(app)40 b(\(var)g(f\))g(\(var)g(x\)\))20
b Fu(generated)g(by)g(the)g(recursi)n(v)o(e)g(call)f(to)2049
621 y Fs(trE)g Fu(into)g(the)g(ne)n(w)h Fs(do)f Fu(e)o(xpression)h
(which)f(is)g(returned.)2049 744 y(The)e(last)h(interesting)f(case)h
(is)f(the)h Fs(Esc)g Fu(case.)23 b(Consider)m(,)18 b(for)f(e)o(xample,)
i(the)2049 827 y(term)2127 950 y Fs([|)40 b(\(\\)g(f)f(->)h(f,)g(\\)f
(f)h(\(x,y\))g(->)g(f)f(y)h($\(w)f(a\))h(|])2049 1073
y Fu(The)19 b(translation)g Fs(trE)g Fu(translates)g(this)g(as)g(follo)
n(ws:)2127 1196 y Fs(tup)40 b([)g(do)g({)f(f)g(<-)h(gensym)h("f")2481
1279 y(;)e(lam)h([Pvar)g(f])g(\(var)g(f\))g(})2284 1362
y(,)g(do)g({)f(f)g(<-)h(gensym)h("f")2481 1445 y(;)e(x)g(<-)h(gensym)h
("x")2481 1528 y(;)e(y)g(<-)h(gensym)h("y")2481 1611
y(;)e(lam)h([Pvar)g(f,Ptup)h([Pvar)f(x,Pvar)h(y]])2677
1694 y(\(app)f(\(app)g(\(var)g(f\))g(\(var)g(y\)\))g(\(w)f(a\))h(})2284
1777 y(])2049 1900 y Fu(Notice)29 b(that)f(the)h(body)h(of)e(the)h
(splice)g Fs($\(w)40 b(a\))28 b Fu(should)i(be)f(transcribed)2049
1983 y(literally)23 b(into)h(the)f(translated)h(code)h(as)f
Fs(\(w)39 b(a\))p Fu(.)f(That)23 b(is)h(what)f(the)h
Fs(copy)2049 2066 y Fu(function)c(does.)2049 2189 y(Looking)40
b(no)n(w)g(at)f Fs(copy)p Fu(,)45 b(the)39 b(interesting)h(case)f(is)g
(when)h(we)f(reach)2049 2272 y(a)50 b(nested)g(quasi-quotation;)67
b(then)50 b(we)g(just)g(resort)f(back)i(to)f Fs(trE)p
Fu(.)2049 2355 y(F)o(or)26 b(e)o(xample,)j(gi)n(v)o(en)e(the)f(code)h
(transformer)g Fs(f)40 b(x)f(=)h([|)f($x)h(+)f(4)h(|])p
Fu(,)2049 2438 y(the)d(quasi-quoted)h(term)e(with)h(nested)g
(quotations)h(within)e(an)h(escape)2049 2521 y Fs([|)j(\\)f(x)h(->)f
(\()h($\(f)g([|)f(x)h(|]\),)g(5)f(\))h(|])19 b Fu(translates)g(to:)2049
2644 y Fs(do)40 b({)f(x)h(<-)f(gensym)i("x")2167 2727
y(;)e(lam)h([Pvar)g(x])g(\(tup)g([f)g(\(var)g(x\),lit)h(\(Int)f
(5\)]\)})2049 2867 y Fv(10)99 b(Related)26 b(w)o(ork)2049
3007 y Fk(10.1)99 b(C++)26 b(templates)2049 3131 y Fu(C++)k(has)g(an)h
(elaborate)f(meta-programming)i(f)o(acility)e(kno)n(wn)h(as)f
Ft(tem-)2049 3214 y(plates)c Fu([1].)43 b(The)26 b(basic)g(idea)g(is)f
(that)h(static,)h(or)e(compile-time,)j(compu-)2049 3297
y(tation)d(tak)o(es)h(place)g(entirely)f(in)g(the)h Ft(type)f(system)g
Fu(of)h(C++.)42 b(A)25 b(template)2049 3380 y(class)f(can)g(be)g
(considered)i(as)d(a)h(function)h(whose)f(ar)o(guments)h(can)f(be)g
(ei-)2049 3463 y(ther)e(types)g(or)f(inte)o(gers,)h(thus:)29
b Fs(Factorial<7>)p Fu(.)34 b(It)21 b(returns)g(a)h(type;)h(one)2049
3546 y(can)e(e)o(xtract)g(an)h(inte)o(ger)f(result)g(by)g(returning)h
(a)f Fs(struct)h Fu(and)f(selecting)h(a)2049 3629 y(con)m(v)o
(entionally-named)g(member)m(,)d(thus:)24 b Fs(Factorial<7>::RET)p
Fu(.)2049 3752 y(The)19 b(type)h(system)f(is)g(rich)g(enough)i(that)e
(one)h(can)f(construct)h(and)g(manipu-)2049 3835 y(late)d(arbitrary)g
(data)g(structures)g(\(lists,)f(trees,)h(etc\))g Ft(in)g(the)g(type)g
(system)p Fu(,)g(and)2049 3918 y(use)29 b(these)g(computations)h(to)f
(control)g(what)g(object-le)n(v)o(el)g(code)h(is)e(gen-)2049
4001 y(erated.)48 b(It)26 b(is)h(\(no)n(w\))g(widely)g(recognized)i
(that)e(this)g(type-system)g(com-)2049 4084 y(putation)f(language)h(is)
e(simply)g(an)h(e)o(xtraordinarily)g(baroque)h(functional)2049
4167 y(language,)j(full)25 b(of)i Ft(ad)g(hoc)g Fu(coding)h(tricks)e
(and)h(con)m(v)o(entions.)47 b(The)27 b(f)o(act)2049
4250 y(that)e(C++)g(templates)h(are)f(so)h(widely)f(used)h(is)f(v)o
(ery)h(strong)g(e)n(vidence)h(of)2049 4333 y(the)19 b(need)h(for)f
(such)g(a)g(thing:)24 b(the)19 b(barriers)f(to)h(their)g(use)g(are)g
(considerable.)2049 4456 y(W)-6 b(e)17 b(belie)n(v)o(e)i(that)e(T)-5
b(emplate)18 b(Hask)o(ell)g(tak)o(es)g(a)g(more)g(principled)g
(approach)2049 4539 y(to)24 b(the)g(same)g(task.)38 b(In)24
b(particular)m(,)h(the)f(static)f(computation)j(language)f(is)2049
4622 y(the)c Ft(same)h Fu(as)f(the)h(dynamic)g(language,)i(so)d(no)h
(ne)n(w)g(programming)h(idiom)2049 4705 y(is)d(required.)28
b(W)-6 b(e)20 b(are)h(not)g(the)f(\002rst)g(to)g(think)h(of)f(this)g
(idea,)h(of)g(course:)27 b(the)2049 4788 y(Lisp)19 b(community)h(has)f
(been)h(doing)g(this)e(for)h(years,)g(as)g(we)g(discuss)g(ne)o(xt.)2049
4944 y Fk(10.2)99 b(Sc)o(heme)25 b(macr)l(os)2049 5068
y Fu(The)33 b(Lisp)g(community)h(has)f(tak)o(en)h(template)f
(meta-programming)i(se-)2049 5151 y(riously)29 b(for)g(o)o(v)o(er)h
(twenty)f(years)h([11],)h(and)f(modern)g(Scheme)f(systems)2049
5234 y(support)24 b(elaborate)h(to)n(wers)e(of)h(language)h(e)o
(xtensions)f(based)h(entirely)e(on)2049 5317 y(macros.)k(Early)20
b(designs)h(suf)n(fered)g(badly)g(from)f(the)h(name-capture)g(prob-)
2049 5400 y(lem,)30 b(b)o(ut)d(this)h(problem)h(w)o(as)f(solv)o(ed)h
(by)f(the)g(e)n(v)o(olution)h(of)f(\223hygienic\224)1913
5649 y(12)p eop
%%Page: 13 13
13 12 bop -150 83 a Fu(macros)23 b([10,)f(4];)i(Dyb)o(vig,)f(Hieb)g
(and)g(Bruggeman')l(s)g(paper)g(is)f(an)h(e)o(xcel-)-150
166 y(lent,)18 b(self-contained)i(summary)g(of)f(the)g(state)g(of)g
(the)g(art)f([7].)-150 296 y(The)23 b(dif)n(ferences)g(of)g(v)o(ocab)o
(ulary)h(and)f(w)o(orld-vie)n(w)-5 b(,)24 b(combined)g(with)f(the)-150
379 y(subtlety)h(of)g(the)f(material,)i(mak)o(e)f(it)f(quite)h(dif)n
(\002cult)f(to)h(gi)n(v)o(e)g(a)f(clear)h(pic-)-150 462
y(ture)c(of)g(the)g(dif)n(ferences)h(between)f(the)g(Scheme)h(approach)
g(and)g(ours.)27 b(An)-150 545 y(immediately-ob)o(vious)k(dif)n
(ference)e(is)g(that)f(T)-5 b(emplate)29 b(Hask)o(ell)g(is)g(stati-)
-150 628 y(cally)22 b(typed,)i(both)e(before)h(e)o(xpansion,)h(and)f
(again)f(afterw)o(ards.)33 b(Scheme)-150 711 y(macro)f(e)o(xpanders)g
(do)g(ha)o(v)o(e)f(a)g(sort)g(of)g(static)f(type)i(system,)i(ho)n(we)n
(v)o(er)m(,)-150 794 y(which)27 b(reports)g(staging)h(errors.)46
b(Be)o(yond)28 b(that,)g(there)f(are)g(three)g(perv)n(a-)-150
877 y(si)n(v)o(e)22 b(w)o(ays)h(in)f(which)h(the)g(Scheme)f(system)h
(is)f(both)h(more)f(po)n(werful)h(and)-150 961 y(less)c(tractable)g
(than)g(ours.)-63 1091 y Fp(\017)42 b Fu(Scheme)19 b(admits)g(ne)n(w)h
(binding)g(forms.)j(Consider)c(this)g(macro)g(call:)134
1211 y Fs(\(foo)40 b(k)f(\(+)h(k)f(1\)\))16 1332 y Fu(A)15
b(suitably-de\002ned)i(macro)e Fs(foo)h Fu(might)g(require)f(the)h
(\002rst)e(ar)o(gument)16 1415 y(to)21 b(be)g(a)g(v)n(ariable)g(name,)h
Ft(whic)o(h)f(then)g(scopes)h(o)o(ver)g(the)f(second)h(ar)o(-)16
1498 y(gument)p Fu(.)i(F)o(or)18 b(e)o(xample,)i(this)e(call)h(to)g
(foo)g(might)g(e)o(xpand)h(to:)94 1618 y Fs(\(lambda)41
b(k)f(\(*)f(2)h(\(+)g(k)f(1\)\)\))16 1738 y Fu(Much)29
b(of)f(the)g(comple)o(xity)h(of)g(Scheme)f(macros)h(arises)f(from)g
(the)16 1821 y(ability)i(to)g(de\002ne)h(ne)n(w)f(binding)i(forms)e(in)
g(this)g(w)o(ay)-5 b(.)58 b(T)-5 b(emplate)16 1904 y(Hask)o(ell)19
b(does)h(this)f(too,)f(b)o(ut)h(much)h(more)f(clumsily)-5
b(.)94 2025 y Fs($\(foo)41 b("k")f([|)f($\(var)i("k"\))f(+)f(1)h(|]\))
16 2145 y Fu(On)16 b(the)f(other)h(hand,)h(at)f(least)f(this)g(mak)o
(es)i(clear)e(that)h(the)f(occurrence)16 2228 y Fs(var)40
b("k")19 b Fu(is)g(not)g(le)o(xically)g(scoped)h(in)f(the)g(source)h
(program.)16 2349 y(A)c(declaration)i(splice)f(\()p Fs(splice)40
b(e)p Fu(\))17 b Ft(does)g Fu(bind)g(v)n(ariables,)h(b)o(ut)e(dec-)16
2432 y(laration)32 b(splices)g(can)h(only)f(occur)h(at)f(top)g(le)n(v)o
(el)g(\(outside)g(quasi-)16 2515 y(quotes\),)19 b(so)g(the)g(situation)
h(is)e(more)h(tractable.)-63 2635 y Fp(\017)42 b Fu(Scheme)106
b(macros)f(ha)o(v)o(e)h(a)f(special)g(binding)i(form)16
2718 y(\()p Fs(define-syntax)p Fu(\))24 b(b)o(ut)e(the)f(call)g(site)h
(has)g(no)g(syntactic)g(baggage.)16 2801 y(Instead)h(a)f(macro)h(call)f
(is)g(identi\002ed)g(by)h(observing)h(that)e(the)h(tok)o(en)16
2884 y(in)33 b(the)g(function)g(position)h(is)e(bound)j(by)e
Fs(define-syntax)p Fu(.)68 b(In)16 2967 y(T)-5 b(emplate)23
b(Hask)o(ell,)g(there)g(is)f(no)i(special)f(syntax)g(at)g(the)g
(de\002nition)16 3050 y(site)d(\227)g(template)h(functions)h(are)e
(just)g(ordinary)i(Hask)o(ell)f(functions)16 3133 y(\227)d(b)o(ut)h(a)g
(splice)g(\()p Fs($)p Fu(\))g(is)f(required)i(at)e(the)h(call)g(site.)
16 3254 y(There)39 b(is)f(an)h(interesting)g(trade-of)n(f)g(here.)83
b(T)-5 b(emplate)38 b(Hask)o(ell)16 3337 y(\223macros\224)20
b(are)f(completely)h(higher)o(-order)g(and)g(\002rst)e(class,)h(lik)o
(e)g(an)o(y)16 3420 y(other)k(function:)31 b(the)o(y)22
b(can)h(be)g(passed)h(as)e(ar)o(guments,)i(returned)f(as)16
3503 y(results,)h(partially)e(applied,)j(constructed)f(with)f(anon)o
(ymous)i(lamb-)16 3586 y(das,)i(and)f(so)g(on.)43 b(Scheme)25
b(macros)h(are)g(pretty)f(much)h(\002rst)f(order:)16
3669 y(the)o(y)h(must)f(be)g(called)h(by)f(name.)43 b(\(Ba)o(wden)25
b(discussed)i(\002rst-class)16 3752 y(macros)20 b([2].\))-63
3872 y Fp(\017)42 b Fu(Scheme)31 b(admits)h(side)f(ef)n(fects,)j(which)
d(complicates)h(e)n(v)o(erything.)16 3955 y(When)h(is)f(a)h(mutable)g
(v)n(alue)g(instantiated?)66 b(Can)33 b(it)f(mo)o(v)o(e)h(from)16
4038 y(compile-time)c(to)f(run-time?)52 b(When)29 b(is)f(it)g(shared?)
53 b(And)29 b(so)g(on.)16 4121 y(Hask)o(ell)19 b(is)g(free)g(of)f
(these)i(complications.)-150 4297 y Fk(10.3)99 b(MetaML)25
b(and)f(its)g(derivatives)-150 4428 y Fu(The)18 b(goals)h(of)g(MetaML)f
([16)q(,)g(14,)g(13)q(])g(and)h(T)-5 b(emplate)18 b(Hask)o(ell)h(dif)n
(fer)f(sig-)-150 4511 y(ni\002cantly)-5 b(,)23 b(b)o(ut)f(man)o(y)h(of)
f(the)g(lessons)h(learned)g(from)f(b)o(uilding)g(MetaML)-150
4594 y(ha)o(v)o(e)27 b(in\003uenced)i(the)e(T)-5 b(emplate)27
b(Hask)o(ell)h(design.)49 b(Important)28 b(features)-150
4677 y(that)19 b(ha)o(v)o(e)g(migrated)g(from)g(MetaML)g(to)g(T)-5
b(emplate)19 b(Hask)o(ell)g(include:)-63 4827 y Fp(\017)42
b Fu(The)18 b(use)g(of)g(a)g(template)h(\(or)e(Quasi-quote)i
(notation\))g(as)f(a)g(means)h(of)16 4910 y(constructing)h(object)f
(programs.)-63 5031 y Fp(\017)42 b Fu(T)-6 b(ype-safety)h(.)30
b(No)20 b(program)i(fragment)f(is)g(e)n(v)o(er)g(e)o(x)o(ecuted)h(in)e
(a)h(con-)16 5114 y(te)o(xt)k(before)g(it)g(is)f(type-check)o(ed,)29
b(and)d(all)e(type)i(checking)g(of)f(con-)16 5197 y(structed)19
b(program)h(fragments)g(happens)g(at)f(compile-time.)-63
5317 y Fp(\017)42 b Fu(Static)24 b(scoping)i(of)f(object-v)n(ariables,)
i(including)f(alpha)g(renaming)16 5400 y(of)19 b(bound)h(object-v)n
(ariables)g(to)f(a)o(v)o(oid)g(inadv)o(ertent)h(capture.)2136
83 y Fp(\017)42 b Fu(Cross-stage)33 b(persistence.)63
b(Free)31 b(object-v)n(ariables)j(representing)2215 166
y(run-time)15 b(functions)h(can)g(be)f(mentioned)i(in)e(object-code)h
(fragments)2215 249 y(and)g(will)d(be)j(correctly)f(bound)h(in)f(the)g
(scope)g(where)h(code)f(is)g(created,)2215 332 y(not)k(where)g(it)g(is)
f(used.)2049 507 y Fa(10.3.1)90 b(MetaML)2049 650 y Fu(But)21
b(there)g(are)g(also)g(signi\002cant)g(dif)n(ference)h(between)g(T)-5
b(emplate)20 b(Hask)o(ell)2049 733 y(and)26 b(MetaML.)g(Most)g(of)g
(these)f(dif)n(ferences)i(follo)n(w)e(from)h(dif)n(ferent)g(as-)2049
816 y(sumptions)k(about)f(ho)n(w)h(meta-programming)g(systems)g(are)e
(used.)54 b(The)2049 899 y(follo)n(wing)35 b(assumptions,)k(used)c(to)f
(design)i(T)-5 b(emplate)34 b(Hask)o(ell,)k(dif)n(fer)2049
982 y(strongly)20 b(from)f(MetaML)-7 b(')l(s.)2136 1149
y Fp(\017)42 b Fu(Users)18 b(can)g(compute)h(portions)g(of)e(their)h
(program)h(rather)e(than)i(writ-)2215 1232 y(ing)28 b(them)g(and)h
(should)f(pay)h(no)f(run-time)g(o)o(v)o(erhead.)51 b(Hence)29
b(the)2215 1315 y(assumption)d(that)e(there)g(are)h(e)o(xactly)f(tw)o
(o)h(stages:)34 b(Compile-time,)2215 1398 y(and)26 b(Run-time.)41
b(In)25 b(MetaML,)g(code)h(can)f(be)g(b)o(uilt)f(and)i(e)o(x)o(ecuted,)
2215 1481 y(e)n(v)o(en)h(at)f(run-time.)45 b(In)26 b(T)-5
b(emplate)25 b(Hask)o(ell,)j(code)f(is)f(meant)g(to)g(be)2215
1564 y(compiled,)17 b(and)g(all)f(meta-computation)h(happens)h(at)e
(compile-time.)2136 1684 y Fp(\017)42 b Fu(Code)29 b(is)g(represented)h
(by)f(an)g(algebraic)h(datatype,)i(and)d(is)g(hence)2215
1767 y(amenable)j(to)f(inspection)g(and)h(case)f(analysis.)59
b(This)30 b(appears)i(at)2215 1850 y(\002rst,)16 b(to)g(be)g(at)g(odds)
i(with)d(the)i(static-scoping,)g(and)g(quasi-quotation)2215
1933 y(mechanisms,)28 b(b)o(ut)d(as)h(we)f(ha)o(v)o(e)h(sho)n(wn)g(can)
g(be)g(accomplished)h(in)2215 2016 y(rather)19 b(interesting)g(w)o(ay)h
(using)f(monads.)2136 2137 y Fp(\017)42 b Fu(Ev)o(erything)18
b(is)g(statically)f(type-check)o(ed,)j(b)o(ut)d(checking)i(is)f
(delayed)2215 2220 y(until)h(the)g(last)g(possible)h(moment)g(using)g
(a)f(strate)o(gy)h(of)f(just-in-time)2215 2303 y(type)j(checking.)33
b(This)21 b(allo)n(ws)h(more)g(po)n(werful)g(meta-programs)h(to)2215
2386 y(be)c(written)g(without)g(resorting)g(to)g(dependent)i(types.)
2136 2506 y Fp(\017)42 b Fu(Hand-written)30 b(code)g(is)f(rei\002able,)
g(I.e.)54 b(the)30 b(data)g(representing)g(it)2215 2589
y(can)20 b(be)f(obtained)i(for)e(further)g(manipulation.)25
b(An)o(y)20 b(run-time)f(func-)2215 2672 y(tion)24 b(or)f(data)h(type)g
(de\002nition)g(can)g(be)g(rei\002ed)g(\226)g(i.e.)36
b(a)24 b(data)g(struc-)2215 2755 y(ture)18 b(of)f(its)h(representation)
g(can)h(be)f(obtained)g(and)h(inspected)f(by)h(the)2215
2838 y(compile-time)g(functions.)2049 3005 y(Quasi-quotes)24
b(in)f(in)g(MetaML)h(indicate)f(the)g(boundary)j(between)d(stages)2049
3088 y(of)i(e)o(x)o(ecution.)42 b(Brack)o(ets)25 b(and)h(run)f(in)g
(MetaML)g(are)g(akin)h(to)e(quote)i(and)2049 3171 y(e)n(v)n(al)21
b(in)g(Scheme.)29 b(In)21 b(T)-5 b(emplate)20 b(Hask)o(ell,)i(brack)o
(ets)f(indicate)g(the)g(bound-)2049 3254 y(ary)e(between)h
(compile-time)f(e)o(x)o(ecution)h(and)f(run-time)g(e)o(x)o(ecution.)
2049 3396 y(One)h(of)g(the)g(main)g(breakthroughs)j(in)c(the)i(type)f
(system)g(of)g(MetaML)h(w)o(as)2049 3479 y(the)29 b(introduction)i(of)e
(quasi-quotes)i(which)f(respect)f(both)h(scoping)h Ft(and)2049
3562 y Fu(typing.)d(If)20 b(a)g(MetaML)g(code)h Ft(g)o(ener)o(ating)h
Fu(program)g(is)d(type-correct)i(then)2049 3645 y(so)i(are)g(all)g(the)
g(programs)h(it)e Ft(g)o(ener)o(ates)j Fu([16)q(].)35
b(This)22 b(property)i(is)f(crucial,)2049 3728 y(because)c(the)e
(generation)i(step)e(happens)i(at)f(run-time,)f(and)h(that)f(is)g(too)h
(late)2049 3811 y(to)h(start)f(reporting)i(type)f(errors.)2049
3953 y(Ho)n(we)n(v)o(er)m(,)27 b(this)e(security)g(comes)h(at)f(a)g
(price:)36 b(MetaML)25 b(cannot)h(e)o(xpress)2049 4037
y(man)o(y)d(useful)f(programs.)33 b(F)o(or)21 b(e)o(xample,)i(the)f
Fs(printf)h Fu(e)o(xample)f(of)g(Sec-)2049 4120 y(tion)g(2)f(cannot)i
(be)e(typed)i(by)f(MetaML,)f(because)i(the)f(type)g(of)f(the)h(call)f
(to)2049 4203 y Fs(printf)26 b Fu(depends)g(on)f(the)g(v)n(alue)h(of)f
(its)f(string)g(ar)o(gument.)42 b(One)25 b(w)o(ay)g(to)2049
4286 y(address)20 b(this)f(problem)h(is)f(using)h(a)g
Ft(dependent)i Fu(type)e(system,)f(b)o(ut)g(that)h(ap-)2049
4369 y(proach)g(has)f(distinct)f(disadv)n(antages)j(here.)i(F)o(or)18
b(a)g(start,)g(the)h(programmer)2049 4452 y(w)o(ould)25
b(ha)o(v)o(e)f(the)g(b)o(urden)h(of)f(writing)g(the)g(function)g(that)g
(transforms)h(the)2049 4535 y(format)g(string)g(to)h(a)f(type;)j(and)e
(the)g(type)f(system)h(itself)f(becomes)h(much)2049 4618
y(more)19 b(complicated)h(to)f(e)o(xplain.)2049 4760
y(In)h(T)-5 b(emplate)20 b(Hask)o(ell,)h(the)f(second)i(stage)f(may)f
(gi)n(v)o(e)h(rise)f(to)g(type)h(errors,)2049 4843 y(b)o(ut)26
b Ft(the)n(y)h(still)e(occur)j(at)e(compile)h(time)p
Fu(,)g(so)g(the)g(situation)f(is)h(much)g(less)2049 4926
y(serious)19 b(than)h(with)e(run-time)h(code)h(generation.)2049
5068 y(A)h(contrib)o(ution)h(of)f(the)g(current)g(w)o(ork)h(is)f(the)g
(de)n(v)o(elopment)i(of)e(a)g(seman-)2049 5151 y(tics)g(for)h
(quasi-quotes)h(as)f(monadic)h(computations.)33 b(This)22
b(allo)n(ws)f(quasi-)2049 5234 y(quotes)f(to)e(e)o(xist)h(in)g(a)f
(pure)i(language)g(without)f(side)g(ef)n(fects.)k(The)c(process)2049
5317 y(of)h(generating)g(fresh)g(names)g(is)g(encapsulated)h(in)e(the)h
(monad,)h(and)f(hence)2049 5400 y(quasi-quotes)g(are)f(referentially)g
(transparent.)1913 5649 y(13)p eop
%%Page: 14 14
14 13 bop -150 83 a Fa(10.3.2)90 b(MetaO'Caml)-150 212
y Fu(MetaO'Caml)19 b([3])g(is)f(a)h(staged)h(ML)e(implementation)i(b)o
(uilt)e(on)i(top)f(of)g(the)-150 295 y(O'Caml)e(system.)22
b(Lik)o(e)17 b(MetaML)h(it)e(is)h(a)g(run-time)g(code)g(generation)i
(sys-)-150 378 y(tem.)j(Unlik)o(e)16 b(MetaML)g(it)f(is)h(a)g(compiler)
g(rather)g(than)g(an)g(interpreter)m(,)g(gen-)-150 461
y(erating)22 b(compiled)h(byte-code)h(at)d(run-time.)33
b(It)21 b(has)i(demonstrated)g(some)-150 544 y(impressi)n(v)o(e)g
(performance)h(gains)f(for)g(staged)h(programs)f(o)o(v)o(er)h(their)e
(non-)-150 627 y(staged)28 b(counterparts.)48 b(The)27
b(translation)g(of)h(quasi-quotes)g(in)f(a)g(manner)-150
710 y(that)f(preserv)o(es)h(the)f(scoping-structure)i(of)e(the)g
(quoted)h(e)o(xpression)h(w)o(as)-150 793 y(\002rst)18
b(implemented)i(in)f(MetaO'Caml.)-150 955 y Fa(10.3.3)90
b(Macr)l(oML)-150 1085 y Fu(MacroML)23 b([8)q(])f(is)g(a)g(proposal)i
(to)f(add)g(compile-time)g(macros)g(to)f(an)h(ML)-150
1168 y(language.)66 b(MacroML)33 b(demonstrates)h(that)e(e)n(v)o(en)i
(macros)f(which)g(im-)-150 1251 y(plement)23 b(ne)n(w)g(binding)h
(constructs)f(can)g(be)g(gi)n(v)o(en)g(precise)g(semantics)g(as)-150
1334 y(staged)18 b(programs,)h(and)f(that)g(macros)g(can)g(be)g
(strongly)g(typed.)24 b(MacroML)-150 1417 y(allo)n(ws)j(the)h
(introduction)g(of)g(ne)n(w)g(hygenic)g(local)g(binders.)49
b(MacroML)-150 1500 y(supports)23 b(only)g(generati)n(v)o(e)h(macros.)
34 b(Macros)23 b(are)f Ft(limited)g(to)g(construct-)-150
1583 y(ing)h(ne)o(w)g(code)g(and)h(combining)g(code)f(fr)o(a)o(gments)p
Fu(;)i(the)o(y)e(cannot)h(analyze)-150 1666 y(code)c(fragments.)-150
1828 y Fa(10.3.4)90 b(Dynamic)21 b(T)-7 b(yping)-150
1957 y Fu(The)22 b(approach)h(of)e(just-in-time)h(type-checking)h(has)f
(its)f(roots)h(in)f(an)h(ear)o(-)-150 2040 y(lier)f(study)i([15])f(of)g
(dynamic)h(typing)f(as)g(staged)h(type-inference.)33
b(In)22 b(that)-150 2123 y(w)o(ork,)i(as)f(well)g(as)g(in)f(T)-5
b(emplate)23 b(Hask)o(ell,)h(typing)g(of)f(code)h(fragments)f(is)-150
2206 y(split)d(into)g(stages.)28 b(In)21 b(T)-5 b(emplate)20
b(Hask)o(ell,)h(code)g(is)f(\002nally)g(type-check)o(ed)-150
2289 y(only)k(at)f(top-le)n(v)o(el)h(splice)f(points)h(\()f
Fs(splice)i Fu(and)f Fs($)f Fu(in)h(state)f Ft(C)g Fu(\).)g(In)g(that)
-150 2372 y(w)o(ork,)k(code)f(is)f(type)g(check)o(ed)i(at)e(all)g
(splice)g(points.)43 b(In)25 b(addition,)i(code)-150
2455 y(construction)g(and)g(splice)f(point)h(type-checking)h(were)e
(run-time)g(acti)n(vi-)-150 2538 y(ties,)16 b(and)h(signi\002cant)g(ef)
n(fort)f(w)o(as)h(placed)g(in)f(reducing)i(the)f(run-time)f(o)o(v)o(er)
o(-)-150 2621 y(head)k(of)f(the)g(type-checking.)-150
2776 y Fv(11)99 b(Implementation)-150 2905 y Fu(W)-6
b(e)32 b(ha)o(v)o(e)h(a)g(small)g(prototype)h(that)f(can)g(read)g(T)-5
b(emplate)33 b(Hask)o(ell)g(and)-150 2988 y(perform)27
b(compile-time)g(e)o(x)o(ecution.)48 b(W)-6 b(e)27 b(are)g(in)f(the)h
(throes)g(of)g(scaling)-150 3071 y(this)18 b(prototype)h(up)g(to)f(a)g
(full)f(implementation,)i(by)g(embodying)h(T)-5 b(emplate)-150
3154 y(Hask)o(ell)19 b(as)g(an)g(e)o(xtension)h(to)f(the)g(Glasgo)n(w)h
(Hask)o(ell)f(Compiler)m(,)f Fs(ghc)p Fu(.)-150 3282
y(The)26 b Fs(ghc)g Fu(implementation)g(fully)g(supports)h(separate)f
(compilation.)44 b(In-)-150 3365 y(deed,)23 b(when)f(compiling)g(a)g
(module)g Fs(M)p Fu(,)g(only)g(functions)g(de\002ned)h(in)e(mod-)-150
3448 y(ules)d(compilied)g(earlier)f(than)g Fs(M)h Fu(can)g(be)f(e)o(x)o
(ecuted)i(a)e(compile)h(time.)k(\(Rea-)-150 3531 y(son:)35
b(to)25 b(e)o(x)o(ecute)h(a)e(function)i(de\002ned)f(in)g
Fs(M)g Fu(itself,)g(the)g(compiler)g(w)o(ould)-150 3614
y(need)20 b(to)f(compile)h(that)e(function)i(\227)f(and)h(all)e(the)h
(functions)h(it)f(calls)g(\227)f(all)-150 3697 y(the)d(w)o(ay)g
(through)h(to)f(e)o(x)o(ecutable)h(code)f(before)h(e)n(v)o(en)g
(type-checking)g(other)-150 3780 y(parts)j(of)h Fs(M)p
Fu(.\))e(When)i(a)f(compile-time)h(function)g(is)f(in)m(v)o(ok)o(ed,)h
(the)f(compiler)-150 3863 y(\002nds)27 b(its)f(pre)n(viously-compiled)k
(e)o(x)o(ecutable)e(and)f(dynamically)h(links)f(it)-150
3946 y(\(and)17 b(all)f(the)h(modules)g(and)g(packages)h(it)e
(imports\))h(into)f(the)h(running)g(com-)-150 4029 y(piler)l(.)33
b(A)22 b(module)i(consisting)f(completely)g(of)g(meta-functions)g(need)
h(not)-150 4112 y(be)g(link)o(ed)h(into)f(the)g(e)o(x)o(ecutable)i(b)o
(uilt)d(by)h(the)h(\002nal)e(link)h(step)h(\(although)-150
4195 y Fs(ghc)40 b(--make)20 b Fu(is)e(not)i(yet)f(cle)n(v)o(er)g
(enough)i(to)d(\002gure)h(this)g(out\).)-150 4350 y Fv(12)99
b(Further)27 b(w)o(ork)-150 4479 y Fu(Our)21 b(design)g(represents)h(w)
o(ork)f(in)g(progress.)29 b(Our)21 b(hope)g(is)g(that,)f(once)i(we)-150
4562 y(can)f(pro)o(vide)g(a)g(w)o(orking)g(implementation,)h(further)e
(w)o(ork)h(can)g(be)g(dri)n(v)o(en)-150 4645 y(directly)16
b(by)h(the)g(e)o(xperiences)g(of)f(real)h(users.)22 b(Meanwhile)17
b(there)g(are)f(man)o(y)-150 4728 y(a)o(v)o(enues)k(that)e(we)h
(already)h(kno)n(w)g(we)f(w)o(ant)g(to)g(w)o(ork)g(on.)-150
4857 y(W)m(ith)28 b(the)g(\(v)o(ery)h(important\))g(e)o(xception)h(of)e
(reifying)h(data)g(type)g(de\002ni-)-150 4940 y(tions,)d(we)f(ha)o(v)o
(e)g(said)g(little)e(about)j(user)o(-de\002ned)f(code)h(manipulation)g
(or)-150 5023 y(optimization,)18 b(which)f(is)f(one)i(of)f(our)g(adv)o
(ertised)h(goals;)g(we')o(ll)e(get)h(to)g(that.)-150
5151 y(W)-6 b(e)21 b(do)h(not)g(yet)g(kno)n(w)g(ho)n(w)h(confusing)g
(the)f(error)f(messages)i(from)e(T)-5 b(em-)-150 5234
y(plate)22 b(Hask)o(ell)g(will)f(be,)i(gi)n(v)o(en)f(that)g(the)o(y)g
(may)h(arise)e(from)h(code)h(that)f(the)-150 5317 y(programmer)f(does)f
(not)g(see.)25 b(At)19 b(the)g(least,)g(it)g(should)i(be)e(possible)i
(to)e(dis-)-150 5400 y(play)g(this)g(code.)2049 83 y(W)-6
b(e)16 b(ha)o(v)o(e)h(already)g(found)h(that)f(one)g(often)g(w)o(ants)g
(to)f(get)h(earlier)f(type)h(secu-)2049 166 y(rity)g(and)g(additional)h
(documentation)h(by)e(saying)h(\223this)f(is)f(an)h Fs(Expr)h
Fu(whose)2049 249 y(type)f(will)e(be)i Fs(Int)p Fu(\224,)g(lik)o(e)f
(MetaML)-7 b(')l(s)17 b(type)g Fs(<Int>)p Fu(.)23 b(W)-6
b(e)15 b(e)o(xpect)i(to)g(add)g(pa-)2049 332 y(rameterised)h(code)h
(types,)g(such)g(as)f Fs(Expr)40 b(Int)p Fu(,)18 b(using)h
Fs(Expr)40 b(*)18 b Fu(\(or)g(some)2049 415 y(such\))i(to)e(indicate)i
(that)e(the)h(type)h(is)e(not)h(statically)g(kno)n(wn.)2049
551 y(C++)d(templates)h(and)g(Scheme)f(macros)h(ha)o(v)o(e)g(a)f
(lighter)o(-weight)g(syntax)h(for)2049 634 y Ft(calling)j
Fu(a)g(macro)h(than)f(we)g(do;)h(indeed,)g(the)f(programmer)h(may)g
(not)f(need)2049 717 y(to)25 b(be)h(a)o(w)o(are)f(that)g(a)g(macro)h
(is)f(in)m(v)o(olv)o(ed)h(at)f(all.)41 b(This)25 b(is)g(an)h
(interesting)2049 800 y(trade-of)n(f,)c(as)g(we)f(discussed)i
(brie\003y)e(in)h(Section)f(10.2.)32 b(There)21 b(is)g(a)h(lot)f(to)
2049 883 y(be)f(said)h(for)f(reducing)h(syntactic)f(baggage)i(at)d(the)
i(call)e(site,)h(and)h(we)f(ha)o(v)o(e)2049 966 y(a)f(fe)n(w)g
(speculati)n(v)o(e)h(ideas)f(for)g(inferring)g(splice)g(annotations.)
2049 1142 y Fv(13)99 b(Ackno)o(wledgments)2049 1279 y
Fu(W)-6 b(e)21 b(w)o(ould)g(lik)o(e)g(particularly)h(to)f(thank)g
(Matthe)n(w)h(Flatt)e(for)h(se)n(v)o(eral)g(long)2049
1362 y(con)m(v)o(ersations)g(in)f(which)g(we)g(e)o(xplored)h(the)f
(relationship)g(between)g(T)-5 b(em-)2049 1445 y(plate)16
b(Hask)o(ell)g(and)h(Scheme)g(macros)f(\227)g(b)o(ut)g(an)o(y)g(errors)
g(on)h(our)f(compari-)2049 1528 y(son)j(between)g(the)f(tw)o(o)h
(remain)f(ours.)24 b(W)-6 b(e)17 b(also)i(thank)g(Magnus)h(Carlsson,)
2049 1611 y(Fer)o(gus)32 b(Henderson,)38 b(T)-6 b(on)o(y)33
b(Hoare,)j(Dick)c(Kieb)o(urtz,)k(Simon)c(Marlo)n(w)-5
b(,)2049 1694 y(Emir)23 b(P)o(asalic,)g(and)h(the)g(Hask)o(ell)f(w)o
(orkshop)j(referees,)e(for)f(their)g(helpful)2049 1777
y(comments)d(on)f(drafts)g(of)g(our)g(w)o(ork.)2049 1913
y(W)-6 b(e)28 b(w)o(ould)i(also)f(lik)o(e)g(to)g(thank)h(the)f
(students)g(of)g(the)g(class)g Ft(CSE583)h(\226)2049
1996 y(Fundamentals)24 b(of)f(Sta)o(g)o(ed)h(Computation)p
Fu(,)h(in)d(the)h(winter)g(of)g(2002,)h(who)2049 2079
y(participated)j(in)f(man)o(y)h(li)n(v)o(ely)f(discussions)i(about)f
(the)f(uses)h(of)f(staging,)2049 2162 y(especially)21
b(Bill)e(Ho)n(we,)i(whose)g(\002nal)f(project)g(moti)n(v)n(ated)h(T)m
(im)f(Sheard)h(to)2049 2245 y(be)o(gin)f(this)e(w)o(ork.)2049
2382 y(The)39 b(w)o(ork)h(described)g(here)g(w)o(as)f(supported)i(by)f
(NSF)e(Grant)h(CCR-)2049 2465 y(0098126,)26 b(the)d(M.J.)g(Murdock)i
(Charitable)e(T)m(rust,)h(and)g(the)f(Department)2049
2548 y(of)c(Defense.)2049 2723 y Fv(Refer)n(ences)2086
2860 y Fu([1])42 b(A.)30 b(Ale)o(xandrescu.)65 b Ft(Modern)32
b(C++)f(design)p Fu(.)65 b(Addison)31 b(W)-6 b(esle)o(y)h(,)2215
2943 y(2001.)2086 3063 y([2])42 b(A.)16 b(Ba)o(wden.)23
b(First-class)16 b(macros)i(ha)o(v)o(e)f(types.)23 b(In)17
b Ft(27th)g(A)n(CM)g(Sym-)2215 3146 y(posium)e(on)g(Principles)g(of)g
(Pr)m(o)o(gr)o(amming)g(Langua)o(g)o(es)i(\(POPL)m('00\))p
Fu(,)2215 3229 y(pages)j(133\226141,)h(Boston,)e(Jan.)g(2000.)h(A)m
(CM.)2086 3349 y([3])42 b(C.)20 b(Calcagno,)i(W)-7 b(.)20
b(T)-6 b(aha,)21 b(L.)e(Huang,)j(and)g(X.)e(Lero)o(y)-5
b(.)33 b(A)20 b(bytecode-)2215 3432 y(compiled,)25 b(type-safe,)f
(multi-stage)g(language.)42 b(T)-5 b(echnical)23 b(report,)2215
3515 y(Computer)d(Science)f(Department,)g(Y)-7 b(ale)18
b(Uni)n(v)o(ersity)-5 b(,)19 b(2002.)2086 3636 y([4])42
b(W)-7 b(.)16 b(Clinger)i(and)g(J.)f(Rees.)23 b(Macros)18
b(that)g(w)o(ork.)24 b(In)17 b Ft(19th)h(A)n(CM)f(Sym-)2215
3719 y(posium)e(on)g(Principles)g(of)g(Pr)m(o)o(gr)o(amming)g(Langua)o
(g)o(es)i(\(POPL)m('91\))p Fu(,)2215 3802 y(pages)j(155\226162.)h(A)m
(CM,)d(Jan.)h(1991.)2086 3922 y([5])42 b(O.)20 b(Dan)m(vy)-5
b(.)34 b(Functional)22 b(unparsing.)34 b Ft(J)n(ournal)22
b(of)f(Functional)g(Pr)m(o-)2215 4005 y(gr)o(amming)p
Fu(,)e(8,)g(No)o(v)-5 b(.)19 b(1998.)2086 4126 y([6])42
b(J.)27 b(de)g(W)m(it.)51 b(A)27 b(technical)h(o)o(v)o(ervie)n(w)f(of)g
(Generic)g(Hask)o(ell.)53 b(Mas-)2215 4209 y(ter')l(s)22
b(thesis,)g(INF-SCR-02-03,)g(Department)h(of)f(Information)h(and)2215
4292 y(Computing)d(Sciences,)f(Utrecht)g(Uni)n(v)o(ersity)-5
b(,)19 b(2002.)2086 4412 y([7])42 b(K.)25 b(Dyb)o(vig,)j(R.)d(Hieb,)i
(and)f(C.)f(Bruggeman.)50 b(Syntactic)26 b(abstrac-)2215
4495 y(tion)19 b(in)h(Scheme.)28 b Ft(Lisp)19 b(and)h(Symbolic)g
(Computation)p Fu(,)h(5:295\226326,)2215 4578 y(1993.)2086
4698 y([8])42 b(S.)c(E.)g(Ganz,)45 b(A.)38 b(Sabry)-5
b(,)44 b(and)c(W)-7 b(.)38 b(T)-6 b(aha.)92 b(Macros)40
b(as)f(multi-)2215 4781 y(stage)19 b(computations:)25
b(T)-6 b(ype-safe,)19 b(generati)n(v)o(e,)h(binding)g(macros)g(in)2215
4865 y(MacroML.)59 b(In)28 b Ft(Pr)m(oceedings)i(of)e(the)h(A)n(CM)f
(SIGPLAN)f(Interna-)2215 4948 y(tional)19 b(Confer)m(ence)h(on)g
(Functional)f(Pr)m(o)o(gr)o(amming)h(\(ICFP-2001\))p
Fu(,)2215 5031 y(Ne)n(w)f(Y)-8 b(ork,)19 b(September)g(2001.)h(A)m(CM)f
(Press.)2086 5151 y([9])42 b(R.)28 b(Hinze)i(and)f(S.)f(Pe)o(yton)i
(Jones.)60 b(Deri)n(v)n(able)30 b(type)f(classes.)60
b(In)2215 5234 y(G.)16 b(Hutton,)i(editor)m(,)f Ft(Pr)m(oceedings)h(of)
f(the)g(2000)h(Hask)o(ell)f(W)-7 b(orkshop,)2215 5317
y(Montr)m(eal)p Fu(,)32 b(number)d(NO)m(TTCS-TR-00-1)f(in)g(T)-5
b(echnical)29 b(Reports,)2215 5400 y(Sept.)18 b(2000.)1913
5649 y(14)p eop
%%Page: 15 15
15 14 bop -150 83 a Fu([10])42 b(E.)19 b(K)m(ohlbeck)o(er)m(,)i(D.)e
(Friedman,)h(M.)g(Felleisen,)f(and)h(B.)f(Duba.)30 b(Hy-)16
166 y(gienic)g(macro)h(e)o(xpansion.)64 b(In)30 b Ft(A)n(CM)g
(Symposium)h(on)f(Lisp)g(and)16 249 y(Functional)20 b(Pr)m(o)o(gr)o
(amming)p Fu(,)f(pages)h(151\226161.)h(A)m(CM,)d(1986.)-150
369 y([11])42 b(K.)15 b(Pitman.)20 b(Special)c(forms)g(in)g(Lisp.)k(In)
c Ft(A)n(CM)f(Symposium)i(on)f(Lisp)16 452 y(and)k(Functional)f(Pr)m(o)
o(gr)o(amming)p Fu(,)h(pages)g(179\226187.)g(A)m(CM,)f(1980.)-150
573 y([12])42 b(A.)19 b(D.)h(Robinson.)31 b(Impact)20
b(of)g(economics)i(on)e(compiler)h(optimiza-)16 656 y(tion.)38
b(In)23 b Ft(Pr)m(oceedings)g(of)g(the)f(A)n(CM)g(2001)i(J)m(ava)g(Gr)o
(ande)f(Confer)o(-)16 739 y(ence)o(,)c(Stanfor)m(d)p
Fu(,)h(pages)g(1\22610.)g(A)m(CM,)f(June)g(2001.)-150
859 y([13])42 b(T)-6 b(.)15 b(Sheard.)k(Accomplishments)e(and)f
(research)g(challenges)h(in)e(meta-)16 942 y(programming.)45
b(In)24 b(W)-7 b(.)23 b(T)-6 b(aha,)26 b(editor)m(,)f
Ft(Pr)m(oceedings)g(of)f(the)g(W)-7 b(ork-)16 1025 y(shop)22
b(on)g(Semantics,)g(Applications)f(and)h(Implementation)g(of)f(Pr)m(o-)
16 1108 y(gr)o(am)30 b(Gener)o(ation)g(\(SAIG'01\))p
Fu(,)i(v)o(olume)e(2196)h(of)e Ft(LNCS)p Fu(,)g(pages)16
1191 y(2\22644,)20 b(Berlin,)e(September)h(2001.)h(Springer)f(V)-8
b(erlag.)27 b(In)m(vited)19 b(talk.)-150 1312 y([14])42
b(T)-6 b(.)57 b(Sheard,)67 b(Z.)56 b(Benaissa,)67 b(and)58
b(M.)f(Martel.)150 b Ft(Intr)m(oduc-)16 1395 y(tion)95
b(to)g(Multista)o(g)o(e)h(Pr)m(o)o(gr)o(amming)g(Using)f(MetaML)p
Fu(.)16 1478 y(P)o(aci\002c)c(Softw)o(are)h(Research)h(Center)m(,)110
b(Ore)o(gon)93 b(Grad-)16 1561 y(uate)75 b(Institute,)87
b(2nd)76 b(edition,)88 b(2000.)206 b(A)-6 b(v)n(ailable)75
b(at)16 1644 y Fs(http://cse.ogi.edu/~sheard/pa)q(pers/)q(manu)q(al.p)q
(s)p Fu(.)-150 1764 y([15])42 b(M.)32 b(Shields,)i(T)-6
b(.)32 b(Sheard,)j(and)e(S.)e(L.)g(Pe)o(yton)h(Jones.)69
b(Dynamic)16 1847 y(typing)30 b(by)g(staged)f(type)h(inference.)60
b(In)29 b Ft(25th)h(A)n(CM)f(Symposium)16 1930 y(on)23
b(Principles)f(of)g(Pr)m(o)o(gr)o(amming)h(Langua)o(g)o(es)h(\(POPL)m
('98\))p Fu(,)e(pages)16 2013 y(289\226302,)f(San)e(Die)o(go,)f(Jan.)h
(1998.)h(A)m(CM.)-150 2134 y([16])42 b(W)-7 b(.)26 b(T)-6
b(aha)27 b(and)g(T)-6 b(.)27 b(Sheard.)52 b(Multi-stage)27
b(programming)h(with)f(e)o(x-)16 2217 y(plicit)k(annotations.)69
b(In)32 b Ft(A)n(CM)f(SIGPLAN)f(Symposium)j(on)g(P)-6
b(ar)o(-)16 2300 y(tial)22 b(Evaluation)i(and)g(Semantics-Based)g(Pr)m
(o)o(gr)o(am)f(Manipulation)16 2383 y(\(PEPM)13 b('97\))p
Fu(,)j(v)o(olume)f(32)g(of)f Ft(SIGPLAN)f(Notices)p Fu(,)i(pages)h
(203\226217.)16 2466 y(A)m(CM,)j(Amsterdam,)g(June)g(1997.)-150
2586 y([17])42 b(N.)20 b(W)m(instanle)o(y)-5 b(.)33 b(A)21
b(type-sensiti)n(v)o(e)g(preprocessor)i(for)e(Hask)o(ell.)33
b(In)16 2669 y Ft(Glasgow)e(W)-7 b(orkshop)32 b(on)f(Functional)h(Pr)m
(o)o(gr)o(amming)o(,)i(Ullapool)p Fu(,)16 2752 y(1997.)-150
2899 y Fv(A)100 b(Library)25 b(of)g(Monadic)g(Syntax)h(Operators)-150
3009 y Fm(--)36 b(The)g(Monad)-150 3084 y(instance)i(Monad)e(Q)-150
3158 y(gensym)h(::)f(String)h(->)f(Q)f(String)-150 3233
y(runQ)h(::)g(Q)g(a)f(->)h(IO)g(a)-150 3308 y(qIO)g(::)g(IO)g(a)f(->)h
(Q)g(a)-150 3457 y(--)g(Type)g(Synonyms.)i(3)e(letter)h(Algebraic,)h(4)
d(letter)i(Monadic)-150 3532 y(type)f(Expr)h(=)e(Q)h(Exp)-150
3607 y(type)g(Patt)h(=)e(Pat)-150 3681 y(type)h(Decl)h(=)e(Q)h(Dec)-150
3756 y(type)g(Type)h(=)e(Typ)-150 3906 y(type)h(Mat)72
b(=)35 b(Match)i(Pat)f(Exp)g(Dec)-150 3980 y(type)g(Mtch)h(=)e(Match)i
(Patt)g(Expr)f(Decl)-150 4130 y(type)g(Cls)72 b(=)35
b(Clause)i(Pat)g(Exp)f(Dec)-150 4204 y(type)g(Clse)h(=)e(Clause)i(=)f
(Patt)g(Expr)h(Decl)-150 4354 y(type)f(Stm)72 b(=)35
b(Statement)j(Pat)e(Exp)h(Dec)-150 4429 y(type)f(Stmt)h(=)e(Statement)j
(Patt)f(Expr)f(Decl)-150 4578 y(--)g(Lowercase)i(Patterns)-150
4653 y(plit)107 b(=)36 b(Plit;)107 b(pvar)36 b(=)g(Pvar)-150
4728 y(ptup)107 b(=)36 b(Ptup;)107 b(pcon)36 b(=)g(Pcon)-150
4802 y(ptilde)h(=)f(Ptilde;)h(paspat)g(=)e(Paspat)-150
4877 y(pwild)107 b(=)36 b(Pwild)-150 5026 y(--)g(Lowercase)i
(Expressions)-150 5101 y(var)e(s)247 b(=)36 b(return\(Var)i(s\))-150
5176 y(con)e(s)247 b(=)71 b(return\(Con)38 b(s\))-150
5251 y(lit)e(c)247 b(=)36 b(return\(Lit)i(c\))-150 5325
y(app)e(x)g(y)176 b(=)36 b(do)g({)f(a)h(<-)g(x;)g(b)f(<-)h(y;)g
(return\(App)i(a)e(b\)})-150 5400 y(lam)g(ps)g(e)141
b(=)36 b(do)g({)f(e2)h(<-)g(e;)g(return\(Lam)i(ps)e(e2\))g(})2049
83 y(lam1)g(p)g(e)141 b(=)36 b(lam)g([p])g(e)2049 158
y(tup)g(es)212 b(=)36 b(do)g({)f(es1)i(<-)e(sequence)j(es;)e
(return\(Tup)i(es1\)})2049 232 y(doE)e(ss)212 b(=)36
b(do)g({)f(ss1)i(<-)e(stmtsC)i(ss;)g(return\(Do)g(ss1\))g(})2049
307 y(comp)f(ss)177 b(=)36 b(do)g({)f(ss1)i(<-)e(stmtsC)i(ss;)g
(return\(Comp)h(ss1\))e(})2049 382 y(arithSeq)i(xs)d(=)h(do)g({)f(ys)h
(<-)g(dotdotC)h(xs;)g(return\(ArithSeq)i(ys\))d(})2049
457 y(listExp)h(es)71 b(=)36 b(do)g({)f(es1)i(<-)e(sequence)j(es;)e
(return\(ListExp)j(es1\)})2049 531 y(cond)d(x)g(y)g(z)70
b(=)36 b(do)g({)f(a)h(<-)g(x;)g(b)f(<-)h(y;)g(c)g(<-)f(z;)2719
606 y(return\(Cond)k(a)c(b)h(c\)})2049 681 y(letE)g(ds)g(e)106
b(=)36 b(do)g({)f(ds2)i(<-)e(sequence)j(ds;)e(e2)g(<-)g(e;)2719
756 y(return\(Let)j(ds2)d(e2\))g(})2049 830 y(caseE)h(e)e(ms)71
b(=)36 b(do)g({)f(e1)h(<-)g(e;)g(ms1)g(<-)g(mapM)g(matchC)h(ms;)2719
905 y(return\(Case)i(e1)d(ms1\))g(})2049 1054 y(--)g(Helper)h
(functions)h(for)e(Auxillary)i(Types)2049 1129 y(stmtC)f(::)f(Stmt)g
(Pattern)h(Expr)g(Decl)f(->)g(Q\(Stmt)h(Pat)f(Exp)g(Dec\))2049
1204 y(stmtC)h(\(NoBindSt)h(e\))d(=)h(do)g({)f(e1)h(<-)g(e;)g
(return\(NoBindSt)k(e1\))c(})2049 1279 y(stmtC)h(\(BindSt)g(p)f(e\))f
(=)h(do)g({)f(e1)h(<-)g(e;)g(return\(BindSt)j(p)d(e1\))g(})2049
1353 y(stmtC)h(\(ParSt)g(zs\))106 b(=)36 b(fail)g("No)h(parallel)g
(comprehensions)i(yet")2049 1428 y(stmtC)e(\(LetSt)g(ds\))106
b(=)36 b(do)g({)f(ds2)i(<-)e(sequence)j(ds;)2966 1503
y(return\(LetSt)h(ds2\))e(})2049 1652 y(stmtsC)g(ss)f(=)f(sequence)j
(\(map)e(stmtC)h(ss\))2049 1802 y(bodyC)g(::)f(Body)g(Expr)g(->)g
(Q\(Body)h(Exp\))2049 1876 y(bodyC)g(\(Normal)g(e\))106
b(=)36 b(do)g({)f(e1)h(<-)g(e;)g(return\(Normal)j(e1\))d(})2049
1951 y(bodyC)h(\(Guarded)g(ps\))f(=)g(do)g({)f(ps1)i(<-)e(mapM)i(f)e
(ps;)2966 2026 y(return\(Guarded)40 b(ps1\))c(})2225
2100 y(where)h(f)f(\(g,e\))g(=)g(do)g({)f(g1)h(<-)g(g;)g(e1)g(<-)g(e;)g
(return\(g1,e1\))j(})2049 2250 y(matchC)e(::)f(Match)h(Pattern)g(Expr)f
(Decl)h(->)f(Q\(Match)h(Pat)f(Exp)g(Dec\))2049 2325 y(matchC)h
(\(p,b,ds\))73 b(=)35 b(do)h({)g(b1)g(<-)g(bodyC)g(b;)g(ds1)g(<-)g
(sequence)i(ds;)2896 2399 y(return\(p,b1,ds1\)})2049
2549 y(dotdotC)f(\(From)g(x\))f(=)f(do)h({)g(a)f(<-)h(x;)g
(return\(From)j(a\)})2049 2623 y(dotdotC)e(\(FromThen)h(x)e(y\))2120
2698 y(=)f(do)h({)g(a)f(<-)h(x;)g(b)f(<-)h(y;)g(return\(FromThen)k(a)35
b(b\)})2049 2773 y(dotdotC)i(\(FromTo)h(x)d(y\))2120
2848 y(=)g(do)h({)g(a)f(<-)h(x;)g(b)f(<-)h(y;)g(return\(FromTo)j(a)d
(b\)})2049 2922 y(dotdotC)h(\(FromThenTo)i(x)c(y)h(z\))2120
2997 y(=)f(do)h({)g(a)f(<-)h(x;)g(b)f(<-)h(y;)g(c)g(<-)g(z;)f
(return\(FromThenTo)41 b(a)35 b(b)h(c\)})2049 3147 y(--)g(Other)h
(useful)g(functions)2049 3221 y(genPE)g(s)e(n)h(=)f(\(map)i(pvar)f
(ns,map)h(var)f(ns\))2084 3296 y(where)h(ns)f(=)f([)h(s++\(show)i(i\))d
(|)h(i)g(<-)f([1..n]])2049 3445 y(apps)h(::)g([Expr])h(->)f(Expr)2049
3520 y(apps)g([x])213 b(=)36 b(x)2049 3595 y(apps)g(\(x:y:zs\))i(=)e
(apps)g(\()g([|)f($x)h($y)g(|])g(:)g(zs)f(\))2049 3744
y(simpleM)i(p)f(e)f(=)h(\(p,Normal)i(e,[]\))2049 3819
y(clauseC)f(x)106 b(=)36 b(matchC)h(x)1913 5649 y Fu(15)p
eop
%%Page: 16 16
16 15 bop -150 83 a Fv(B)100 b(Algebraic)25 b(Datatype)g(Repr)n
(esentation)i(of)e(Hask)o(ell)-150 198 y Fm(module)37
b(SimpleData)h(where)-150 348 y(data)e(Lit)h(=)e(Int)h(Int)g(|)g(Char)g
(Char)-150 497 y(data)g(Pat)-79 572 y(=)f(Plit)i(Lit)953
b(--)36 b({)g(5)f(or)h('c')g(})-79 647 y(|)f(Pvar)i(String)848
b(--)36 b({)g(x)f(})-79 721 y(|)g(Ptup)i([Pat])883 b(--)36
b({)g(\(p1,p2\))h(})-79 796 y(|)e(Pcon)i(String)g([Pat])636
b(--)36 b(data)g(T1)g(=)g(C1)g(t1)g(t2;)g({C1)g(p1)g(p1})g(=)f(e)-79
871 y(|)g(Ptilde)i(Pat)883 b(--)36 b({)g(~p)f(})-79 946
y(|)g(Paspat)i(String)g(Pat)636 b(--)36 b({)g(x)f(@)h(p)f(})-79
1020 y(|)g(Pwild)1060 b(--)36 b({)g(_)f(})-150 1170 y(type)h(Match)h(p)
f(e)f(d)71 b(=)36 b(\()f(p)h(,Body)h(e,[d]\))107 b(--)36
b(case)g(e)g(of)g({)f(pat)i(->)e(body)i(where)g(decs)f(})-150
1244 y(type)g(Clause)h(p)f(e)g(d)f(=)h(\([p],Body)i(e,[d]\))107
b(--)36 b(f)g({)f(p1)h(p2)g(=)f(body)i(where)g(decs)f(})-150
1394 y(data)g(Exp)-79 1469 y(=)f(Var)h(String)884 b(--)36
b({)g(x)f(})-79 1543 y(|)g(Con)h(String)884 b(--)36 b(data)g(T1)g(=)g
(C1)g(t1)g(t2;)g(p)f(=)h({C1})g(e1)g(e2)-79 1618 y(|)f(Lit)h(Lit)989
b(--)36 b({)g(5)f(or)h('c'})-79 1693 y(|)f(App)h(Exp)g(Exp)848
b(--)36 b({)g(f)f(x)h(})-79 1768 y(|)f(Lam)h([Pat])h(Exp)777
b(--)36 b({)g(\\)f(p1)h(p2)g(->)g(e)f(})-79 1842 y(|)g(Tup)h([Exp])919
b(--)36 b({)g(\(e1,e2\))h(})-79 1917 y(|)e(Cond)i(Exp)f(Exp)g(Exp)671
b(--)36 b({)g(if)f(e1)h(then)h(e2)f(else)g(e3)g(})-79
1992 y(|)f(Let)h([Dec])h(Exp)777 b(--)36 b({)g(let)g(x=e1;)107
b(y=e2)36 b(in)g(e3)g(})-79 2066 y(|)f(Case)i(Exp)f([Match)h(Pat)f(Exp)
g(Dec])248 b(--)36 b({)g(case)g(e)g(of)f(m1;)i(m2)e(})-79
2141 y(|)g(Do)h([Statement)i(Pat)e(Exp)g(Dec])319 b(--)36
b({)g(do)f({)h(p)g(<-)f(e1;)i(e2)e(})71 b(})-79 2216
y(|)35 b(Comp)i([Statement)h(Pat)e(Exp)g(Dec])248 b(--)36
b({)g([)f(\(x,y\))i(|)e(x)h(<-)g(xs,)g(y)g(<-)f(ys)h(])g(})-79
2291 y(|)f(ArithSeq)j(\(DotDot)f(Exp\))495 b(--)36 b({)g([)f(1)h(,2)g
(..)f(10)h(])g(})-79 2365 y(|)f(ListExp)i([)f(Exp)g(])706
b(--)36 b({)g([1,2,3])h(})-150 2515 y(data)f(Body)h(e)-79
2589 y(=)e(Guarded)i([\(e,e\)])708 b(--)36 b(f)g(p)f({)h(|)f(e1)h(=)g
(e2)g(|)f(e3)h(=)g(e4)f(})h(where)h(ds)-79 2664 y(|)e(Normal)i(e)953
b(--)36 b(f)g(p)f(=)h({)f(e)h(})f(where)i(ds)-150 2814
y(data)f(Statement)i(p)e(e)f(d)-79 2888 y(=)g(BindSt)i(p)f(e)882
b(--)36 b({)g(p)f(<-)h(e)g(})-79 2963 y(|)f(LetSt)i([)e(d)h(])847
b(--)36 b({)g(let)g(f)f(x)h(=)f(e)h(})-79 3038 y(|)f(NoBindSt)j(e)882
b(--)36 b({)g(print)g(e)g(})-79 3112 y(|)f(ParSt)i([[Statement)h(p)e(e)
f(d]])354 b(--)36 b({)g(x)f(<-)h(xs)g(|)f(y)h(<-)g(ys,)g(z)g(<-)f(zs)h
(})-150 3262 y(data)g(DotDot)h(e)-79 3337 y(=)e(From)i(e)1023
b(--)36 b([)g({)f(0)h(..)g(})f(])-79 3411 y(|)g(FromThen)j(e)d(e)812
b(--)36 b([)g({)f(0,1)h(..)g(})g(])-79 3486 y(|)f(FromTo)i(e)f(e)882
b(--)36 b([)g({)f(0)h(..)g(10)f(})h(])-79 3561 y(|)f(FromThenTo)j(e)e
(e)f(e)671 b(--)36 b([)g({)f(0,2)h(..)g(12)g(})g(])-150
3710 y(data)g(Dec)-79 3785 y(=)f(Fun)h(String)h([Clause)h(Pat)e(Exp)g
(Dec])319 b(--)35 b({)h(f)g(p1)f(p2)h(=)g(b)f(where)i(decs)g(})-79
3860 y(|)e(Val)h(Pat)g(\(Body)h(Exp\))g([Dec])566 b(--)35
b({)h(p)g(=)f(b)h(where)g(decs)h(})-79 3934 y(|)e(Data)i(String)g
([String])g([Constr])h([String])73 b(--)35 b({)h(data)g(T)g(x)g(=)f(A)h
(x)f(|)h(B)f(\(T)h(x\))g(deriving)i(\(Z,W\)})-79 4009
y(|)d(Class)i([Typ])g(Typ)f([Dec])672 b(--)35 b({)h(class)h(Eq)f(a)f
(=>)h(Eq)g([a])g(where)h(ds)f(})-79 4084 y(|)f(Instance)j([Typ])e(Typ)h
([Dec])566 b(--)35 b({)h(instance)i(Show)e(w)g(=>)f(Show)i([w])f(where)
h(ds)e(})-79 4159 y(|)g(Proto)i(Name)f(Typ)919 b(--)35
b({)h(length)h(::)f([a])g(->)g(Int)g(})-150 4308 y(data)g(Constr)h(=)f
(Constr)h(String)g([Typ])-150 4457 y(data)f(Tag)-79 4532
y(=)f(Tuple)i(Int)883 b(--)36 b(\(,,\))-79 4607 y(|)f(Arrow)1025
b(--)36 b(\(->\))-79 4682 y(|)f(List)1060 b(--)36 b(\([]\))-79
4756 y(|)f(Name)i(String)g(deriving)g(Eq)389 b(--)36
b(Tree)-150 4906 y(data)g(Typ)-79 4980 y(=)f(Tvar)i(String)813
b(--)36 b(a)-79 5055 y(|)f(Tcon)i(Tag)918 b(--)36 b(T)f(or)h([])g(or)g
(\(->\))g(or)g(\(,,\))h(etc)-79 5130 y(|)e(Tapp)i(Typ)f(Typ)777
b(--)36 b(T)f(a)h(b)-150 5279 y(--)g(Left)g(out)g(things)h(implicit)h
(parameters,)g(sections,)g(complicated)h(literals,)f(default)f
(declarations)1913 5649 y Fu(16)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
